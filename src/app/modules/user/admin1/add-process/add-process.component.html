<div class="heading">
  <div class="page-title-wrapper">
    <ul>
      <li>Solutions Board</li>
      <ng-container *ngIf="process.processId">
        <li>Edit Solution</li>
      </ng-container>
      <ng-container *ngIf="(process.processId == null || process.processId == undefined)">
        <li>Create New Solution</li>
      </ng-container>
      <li>Process Name: {{process.processName}}</li>
    </ul>
  </div>
  <!--<ul>-->
  <!-- <li><a [routerLink]="['./dashboard']">Dashboard </a>/</li> -->
  <!--<li><a [routerLink]="['solution-board-dashboard']">Solution Board</a>/</li>
        <li>Add Process</li>
    </ul>-->
</div>

<div class="consen mainContainer padd-10" style="padding-top:10px !important;">
  <!-- <div class="steps-group">
        <ng-container>
            <button mat-button class="active"><span class="number">1</span> <label>Profile Info</label></button>
            <button mat-button><span class="number">2</span> <label>Upload Files</label></button>
            <button mat-button><span class="number">3</span> <label>Target Files</label></button>
            <button mat-button><span class="number">4</span> <label>Append Files</label></button>
            <button mat-button><span class="number">5</span> <label>Join Files</label></button>
            <button mat-button><span class="number">6</span> <label>Data Modelling</label></button>
        </ng-container>
    </div> -->
  <!-- [disabled]="isDisabled" -->

  <mat-tab-group class="steps-block" [(selectedIndex)]="selectedTab">
    <!--apStart-->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 0 ? 'completed' : ''">1</span>
        Add Process
      </ng-template>
      <ng-container *ngIf="tabs[0].id == 0 && tabs[0].isActive == true">
        <div class="inner-container">
          <form [formGroup]="Genericform">
            <div class="row">
              <div class="col-md-8">
                <div class="row">
                  <div class="col-md-12">
                    <mat-chip class="main" *ngIf="tabClientSpec">
                      <div class="input-group">
                        <label>Choose Client<sup>*</sup></label>
                        <mat-form-field appearance="fill">
                          <mat-select class="form-control" placeholder="Select Client" formControlName="chooseclient"
                            panelClass="addUsers"
                            [ngClass]="{'is-invalid':submited && Genericform.controls['chooseclient'].errors}">
                            <input type="text" placeholder="Search.."
                              style="position: sticky;display: inline-block;top: 0; z-index: 99;" id="myInput"
                              (keyup)="searchclientFilter($event)">
                            <mat-option *ngFor="let item of clients" [value]="item">{{item.organizationName}}
                            </mat-option>
                            <div class="form-control" *ngIf="clients?.length == 0">No data found</div> Â 
                          </mat-select>
                        </mat-form-field>

                        <!-- <select id="requesttype" placeholder="Request Type" formControlName="chooseclient">
                                                      [disabled]="isSelectedProcessType == 'Generic'"
                                                      <option hidden>Clients List</option>
                                                      <option value="1">iBridgeTechSoft</option>
                                                      <option value="2">Deloitte</option>
                                                  </select> -->
                        <!-- <mat-form-field appearance="fill">
                          <mat-select class="form-control reflect-model" placeholder="Select Client"
                            formControlName="chooseclient" [ngClass]="{
                                'is-invalid':
                                  submited &&
                                  Genericform.controls['chooseclient'].errors
                              }">
                             <input type="text" placeholder="Search.." id="myInput" (keyup)="applyFilter($event)"> -->
                        <!--   <mat-option *ngFor="let item of clients" [value]="item">{{ item.organizationName }}
                            </mat-option>
                          </mat-select>
                        </mat-form-field> -->
                      </div>
                    </mat-chip>
                  </div>
                </div>
                <div class="row genericSol">
                  <div class="col-md-12">
                    <div class="input-group">
                      <label>Process Name<sup>*</sup></label>
                      <input type="text" formControlName="processNameControl" class="form-control reflect-model"
                        [ngClass]="{
                            'is-invalid':
                              submited &&
                              Genericform.controls['processNameControl'].errors
                          }" />
                      <!-- <div
                              *ngIf="Genericform.controls['processNameControl'].invalid && (Genericform.controls['processNameControl'].touched || submited)">
                              <div class="error" *ngIf="Genericform.controls['processNameControl'].errors?.required">
                                  Process Name is required
                              </div>
                          </div> -->
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="input-group">
                      <label>Process Description<sup>*</sup></label>
                      <textarea formControlName="processDescriptionControl" style="height: 335px" [ngClass]="{
                              'is-invalid':
                                submited &&
                                Genericform.controls['processDescriptionControl']
                                  .errors
                            }" class="form-control reflect-model"></textarea>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="input-group" [ngClass]="(ISsubmited ||submited==false)?'selected':'is-invalid'">
                      <label>Select Industry / Sector<sup>*</sup></label>
                        <div class="col bord">
                          <div class="header">
                            <!-- <h3>Select Industry-Sector </h3> -->
                            <input type="checkbox" class="form-check-input" name="list_name" value="m1"
                              [checked]="selectunall" (change)="checkUncheckISAll($event)" id="selectAll" />
                            <label for="selectAll">All</label>
                            <input type="text" class="form-control reflect-model" placeholder="Search"
                              (keyup)="searchFilter($event)" />
                            <button mat-button>
                              <span class="dds-icon dds-icon_search__l__stroke"></span>
                            </button>
                          </div>
                         
                            <mat-accordion>
                            <div>
                              <mat-expansion-panel *ngFor="let indus of searchindusData" #example>
                                <!-- <div > -->
                                <mat-expansion-panel-header class="header1">
                                  <mat-panel-title>
                                    <span>
                                      {{ indus.industryName }}
                                    </span>
                                  </mat-panel-title>
                                  <!-- <span>
                                      <div class="dds-icon dds-icon_delete__l__stroke"></div>
                                      <div class="dds-icon dds-icon_edit__l__stroke" (click)="editIndustry($event)"></div>
                                    </span> -->
                                  <mat-panel-description>
                                    <div>
                                      <!-- <mat-icon *ngIf="!example.expanded"></mat-icon>
                                                                          <mat-icon *ngIf="example.expanded"></mat-icon> -->
                                    </div>
                                  </mat-panel-description>
                                </mat-expansion-panel-header>
                                <ng-template matExpansionPanelContent>
                                  <div>
                                    <div *ngFor="let sect of indus.sectorList" class="col-sm-4 subheading">
                                      <input type="checkbox" [checked]="sect.isSelected" name="first"
                                        (change)="isAllSelectedIS(sect, indus)" class="form-check-input" />
                                      <label class="form-check-label" for="exampleCheck1">{{ sect.sectorName }}</label>
                                    </div>
                                  </div>
                                </ng-template>
                                <!-- </div> -->
                              </mat-expansion-panel>
                            </div>
                          </mat-accordion>
                      </div>

                    </div>
                  </div>
                </div>
                <!--<div style="margin-top: 15px" class="col-md-12">
                        
                         <div
                            *ngIf="Genericform.controls['processDescriptionControl'].invalid && (Genericform.controls['processDescriptionControl'].touched || submited)">
                            <div class="error"
                                *ngIf="Genericform.controls['processDescriptionControl'].errors?.required">
                                Process Description is required
                            </div>
                        </div> 
                      </div>
                    </div>-->

              </div>
              <div class="col-md-4">
                <mat-chip *ngIf="tabSolDisplay">
                  <div class="row">
                    <div class="col-md-5">
                      <label class="form-check-label" for="onChangeAddFeatureList">Add to Feature List</label>
                      <div class="input-group flex-list">
                        <input type="checkbox" class="form-check-input" id="onChangeAddFeatureList"
                          (change)="onChangeAddFeatureList($event)" formControlName="addfeaturelist" />
                        <label>Yes</label>
                      </div>
                    </div>
                    <div class="col-md-7">
                      <div class="mat-card no-padding">
                        <label style="display:flex; align-items:center;">Display Solution <button mat-button
                            class="info-btn" (click)="userguidepopup()"
                            style="margin-left:auto;"><mat-icon>help</mat-icon></button></label>
                        <div class="input-group flex-list">
                          <!-- <div class="mat-card-div">
                                                      <input type="checkbox" class="form-check-input" id="New">
                                                      <label class="form-check-label" for="New">New (or)</label>
                                                  </div>
                                                  <div class="mat-card-div">
                                                      <input type="checkbox" class="form-check-input" id="Upcoming">
                                                      <label class="form-check-label" for="Upcoming">Upcoming</label>
                                                  </div> -->
                          <div class="mat-card-div" *ngFor="let item of selectedCheckBox">
                            <input type="checkbox" [checked]="item.isSelected" (change)="isAllSelected(item)"
                              class="form-check-input" />
                            <label class="form-check-label">{{
                              item.value
                              }}</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-chip>

                <div class="but upload-block" *ngIf="selectedProcessType == 'Generic'">
                  <form [formGroup]="fileForm">
                    <h6><sup>*</sup>Note: Upload image is mandatory.</h6>
                    <!-- <div *ngIf="demoimg" class="upload-button">
                      <label for="imgfile">
                        <!-- <img [src]="demo" alt=""
                        <input type="file" id="imgfile" accept="image/png, image/gif, image/jpeg" [ngClass]="{
                            'is-invalid':
                              submited && fileForm.controls['imgFile'].errors
                          }" (change)="imgFileUpload($event)" style="display: none" formControlName="imgFile" />
                      </label>
                      <!-- <p *ngIf="showFileNameUI?.img?.length > 30"> {{showFileNameUI?.img?.substr(0,30)}}...</p>
                                                <p *ngIf="showFileNameUI?.img?.length < 30">{{showFileNameUI?.img}}</p> 
                      <p *ngIf="showFileNameUI.img.length > 30">
                        {{ showFileNameUI.img.substr(0, 30) }}...
                      </p>
                      <p *ngIf="showFileNameUI.img.length < 30">
                        {{ showFileNameUI.img }}
                      </p>
                    </div> -->

                    <div class="upload-button"
                      [ngClass]="{'primary1' :(showFileNameUI.img != ''),'is-invalid':(submited && imginvalid)}">
                      <!-- [ngClass]="imageRenderClass()" -->
                      <!-- [ngClass]="{ 'is-invalid': (submited && fileForm.controls['imgFile'].invalid)}" -->
                      <!--  -->
                      <label for="imgfile" class="button">
                        <input type="file" id="imgfile" accept="image/png, image/gif, image/jpeg"
                          (change)="imgFileUpload($event)" style="display: none" formControlName="imgFile" />
                        <div class="upload-inner">
                          <div class="image-box">
                            <div class="icon image-icon"></div>
                          </div>
                          <div class="title">
                            <h5>Image</h5>
                            <p>Click to upload or drag and drop</p>
                            <p *ngIf="showFileNameUI.img?.length > 30">
                              {{ showFileNameUI.img.substr(0, 30) }}...
                            </p>
                            <p *ngIf="showFileNameUI.img?.length < 30">
                              {{ showFileNameUI.img }}
                            </p>
                          </div>
                        </div>
                        <!-- <span class="dds-icon dds-icon_upload__l__stroke"></span> -->
                        <div class="upload-note" *ngIf="showFileNameUI?.img?.length==0">
                          PNG, JPG, SVG & JPEG files are allowed
                        </div>
                        <!-- <img height="90%" *ngIf="imageUrl" [src]="imageUrl" class="image" /> -->
                      </label>

                      <div class="error">{{ errorMsgAP.img }}</div>
                    </div>

                    <!-- <div class="upload-button">
                                                <label for="imgfile" class="button" [ngClass]="{ 'is-invalid': submit && fileForm.controls['imgFile'].errors }">
                                                    <input type="file" id="imgfile" accept="image/png, image/gif, image/jpeg" formControlName="imgFile"
                                                        (change)="imgFileUpload($event)" style="display: none;"  />
                        
                                                    <span class="dds-icon dds-icon_upload__l__stroke"></span>
                                                    <br>
                                                    <h5>Upload Image</h5>
                                                    <p style="font-size: 9px;color: #707070;">Upload image (JPG or PNG Max size 100 kb)</p> -->
                    <!-- <img height="90%" *ngIf="imageUrl" [src]="imageUrl" class="image" /> -->
                    <!-- </label>
                                                <p *ngIf="showFileNameUI.img.length > 30"> {{showFileNameUI.img.substr(0,30)}}...</p>
                                                <p *ngIf="showFileNameUI.img.length < 30">{{showFileNameUI.img}}</p>
                                                <div class="error">{{errorMsgAP.img}}</div>
                                            </div> -->
                    <div class="upload-button" [ngClass]="{ 'primary1' :(showFileNameUI?.vid != '')}">
                      <!-- <img style="height:100px; width:100%; object-fit:contain;" [src]="item.demo" alt=""> -->
                      <label for="vidfile" class="button">
                        <input type="file" id="vidfile" (change)="vidFileUpload($event)" style="display: none" accept="video/mp4"
                          formControlName="vidFile" />

                        <div class="upload-inner">
                          <div class="image-box">
                            <div class="icon video-icon"></div>
                          </div>
                          <div class="title">
                            <h5>Video</h5>
                            <p>Click to upload or drag and drop</p>
                            <p *ngIf="showFileNameUI.vid?.length > 30">
                              {{ showFileNameUI.vid.substr(0, 30) }}...
                            </p>
                            <p *ngIf="showFileNameUI.vid?.length < 30">
                              {{ showFileNameUI.vid }}
                            </p>
                          </div>
                        </div>
                        <!-- <span class="dds-icon dds-icon_upload__l__stroke"></span><br> -->
                        <div class="upload-note" *ngIf="showFileNameUI?.vid?.length==0 ">
                          MP4 & WMV files are allowed
                        </div>
                      </label>

                    </div>
                    <div class="upload-button" [ngClass]="{ 'primary1' :(showFileNameUI.brochure != '')}">
                      <label for="brochurefile" class="button">
                        <input type="file" id="brochurefile" (change)="brochureFileUpload($event)" accept=".pdf"
                          formControlName="broFile" style="display: none" />
                        <div class="upload-inner">
                          <div class="image-box">
                            <div class="icon broucher-icon"></div>
                          </div>
                          <div class="title">
                            <h5>Brochure</h5>
                            <p>Click to upload or drag and drop</p>
                            <p *ngIf="showFileNameUI.brochure?.length > 30">
                              {{ showFileNameUI.brochure.substr(0, 30) }}...
                            </p>
                            <p *ngIf="showFileNameUI.brochure?.length < 30">
                              {{ showFileNameUI.brochure }}
                            </p>
                          </div>
                        </div>

                        <!-- <span class="dds-icon dds-icon_upload__l__stroke"></span><br> -->
                        <div class="upload-note" *ngIf="showFileNameUI.brochure?.length==0 ">
                          PDF file are allowed
                        </div>
                      </label>

                    </div>
                  </form>
                </div>
              </div>
            </div>
          </form>

          <div class="main" *ngIf="tabGenericInfo">
            <div class="row genericSol">
              <div class="col-md-12">
                <form [formGroup]="seniroForm" (ngSubmit)="onSubmit()" *ngIf="selectedProcessType == 'Generic'"
                  #form="ngForm">
                  <!-- <label>Add Multiple Scenario's
                                for the new
                                Solution (* Note:
                                Atleast one scenario is mandatory)</label>
                            <div class="input-group">
                                <label>Scenario<sup>*</sup></label>
                                <input type="text" class="form-control" name="first"
                                    [ngClass]="{ 'is-invalid': submit && seniroForm.controls['aName'].errors }"
                                    formControlName="aName">
                            </div>-->
                  <!-- <div
                                    *ngIf="seniroForm.controls['aName'].invalid && (seniroForm.controls['aName'].touched || submited)">
                                    <div class="error" *ngIf="seniroForm.controls['aName'].errors?.required">
                                        Scenario is required
                                    </div>
                                </div> -->
                  <!--<div class="input-group">
                                <label>Description<sup>*</sup></label>
                                <textarea style="height:100px" name="last"
                                    [ngClass]="{ 'is-invalid': submit && seniroForm.controls['aDescription'].errors }"
                                    formControlName="aDescription" class="form-control"></textarea>
                            </div>
                            <div class="input-group button-block">
                                <button type="submit" mat-button color="primary">Add
                                    Scenario <span class="dds-icon dds-icon_plus__l__stroke"></span></button>
                            </div> -->

                  <div class="input-group button-block">
                    <a href="javascript:void(0);" class="mat-button" color="primary" (click)="Popup()">Add Scenario
                      <span class="dds-icon dds-icon_plus__l__stroke"></span></a>
                  </div>
                  <div *ngIf="selectedProcessType == 'Generic'">
                    <div class="scroll">
                      <table class="table table-striped">
                        <thead>
                          <tr>
                            <th scope="col">Scenario Name</th>
                            <th scope="col">Description</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngIf="seniroList?.length == 0">
                            <td></td>
                            <td>No Scenario(s) Added</td>
                            <td></td>
                          </tr>
                          <!-- <div style=" color:red;">{{errorMsgAP.generic}} -->

                          <!-- <ng-container *ngIf="procData1.length == 0"> -->
                          <tr *ngFor="let item of seniroList; let i = index">
                            <td *ngIf="isAnalyticsRowEdit != i">
                              {{ item.analyticsName }}
                            </td>
                            <td *ngIf="isAnalyticsRowEdit != i">
                              {{ item.analyticsObjective }}
                            </td>
                            <td *ngIf="isAnalyticsRowEdit == i">
                              <input [value]="item.analyticsName" class="form-control" formControlName="aName" />
                            </td>
                            <td *ngIf="isAnalyticsRowEdit == i">
                              <input [value]="item.analyticsObjective" class="form-control"
                                formControlName="aDescription" />
                            </td>

                            <td>
                              <span *ngIf="isAnalyticsRowEdit != i" (click)="analyticsRowEdit(i,item)"
                                class="dds-icon dds-icon_edit__l__stroke"></span>
                              <span *ngIf="isAnalyticsRowEdit == i" class="dds-icon dds-icon_checkmark__l__stroke"
                                (click)="editSeniro(i,item)"></span>
                              <span class="dds-icon dds-icon_delete__l__stroke" (click)="deleteAnalyticsRow(i)"></span>
                            </td>
                          </tr>
                          <!-- </ng-container> -->

                          <!-- <ng-container *ngIf="procData1.length != 0">
                                        <tr *ngFor="let item of procData1">
                                            <td>{{item.analyticsName}}</td>
                                            <td>{{item.analyticsObjective}}</td> -->
                          <!-- <td>
                                    <span *ngIf="isAnalyticsRowEdit != i" (click)="analyticsRowEdit(i)"
                                        class="dds-icon dds-icon_edit__l__stroke"></span>
                                    <span *ngIf="isAnalyticsRowEdit == i" class="dds-icon dds-icon_checkmark__l__stroke"
                                        (click)="editSeniro(i);"></span>
                                    <span class="dds-icon dds-icon_delete__l__stroke"
                                        (click)="deleteAnalyticsRow(i)"></span>
                                </td> -->
                          <!-- </tr>
                                    </ng-container> -->
                          <!-- </tbody>
                            </table> -->
                          <!-- </div> -->

                          <!-- <tr *ngIf="procData.processId != null'">
                                        <ng-container *ngFor="let item of procData" >
                                            <td>{{item.processAnalyticsDTOList.analyticsName}}</td>
                                            <td>{{item.processAnalyticsDTOList.analyticsObjective}}</td>
                                        </ng-container>
                                    </tr> -->
                        </tbody>
                      </table>
                    </div>
                  </div>

                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="button-group">
          <button mat-button class="btnn" type="reset" (click)="clearForm()">
            Reset<span class="dds-icon dds-icon_arrow_back__l__stroke"></span>
          </button>
          <button mat-button class="btnn" (click)="changeTabs({ id: 1 }, 'next')">
            Save and Continue<span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
          </button>
        </div>
      </ng-container>
    </mat-tab>
    <!--apEnd-->

    <!--ustart-->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 1 ? 'completed' : ''">2</span>
        Upload Files
      </ng-template>

      <mat-card *ngIf="tabs[1].id == 1 && tabs[1].isActive == true">
        <div class="inner-container">
          <!-- <form> -->
          <!-- and choose the sheets within it. *ngIf="!showUploadFilesTab"-->
          <div class="upload-files-block">
            <div class="row" *ngIf="fileListt.length == 0">
              <div class="col-md-12">
                <div class="upload-inner-block">
                  <div appFileDragAndDrop (filesChangeEmiter)="saveiputFiles($event,'dragNDrop')">
                    <label for="inputfile" class="button">
                      <input type="file" id="inputfile" (change)="saveiputFiles($event,'click')" style="display: none"
                        multiple />
                      <span class="dds-icon dds-icon_upload__l__stroke"></span>
                      <h5>Drag and drop files, or <span>Browse</span></h5>
                      <p class="note-block">
                        Supported XLS, PDF & CSV files<br />
                        (Max. 500kb)
                      </p>
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- *ngIf="showUploadFilesTab" -->
            <div class="row" *ngIf="fileListt.length != 0">

              <div class="col-md-9">
                <!-- <span class="note required-field">Choose the sheets within the file(s)</span> -->
                <div class="toolbar-block">
                  <h3 class="block-title">Uploaded Files</h3>
                  <div class="search-block">

                    <input type="text" (keyup)="applyFilter($event,'UF')" placeholder="Search" />
                    <button class="mat-button">
                      <span class="dds-icon dds-icon_search"></span>
                    </button>
                  </div>


                </div>

                <!-- <div class="selectCheck">
                                    <input type="checkbox" [(ngModel)]="masterSelected" name="list_name" value="m1"
                                        (change)="checkUncheckAllUploadFiles()" />
                                    <label>Select All</label>
                                </div> -->

                <!-- <table *ngFor="let item of fileListt" class="createNewSoltionsTable">
                                    <thead>
                                        <tr>
                                            <th>
                                                <ng-container *ngIf="item.fileExt == 'xlsx' || item.fileExt == 'xls'">
                                                    <span class="dds-icon dds-icon_file_xls__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'txt'">
                                                    <span class="dds-icon dds-icon_file_txt__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'csv'">
                                                    <span class="dds-icon dds-icon_file_csv__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'pdf'">
                                                    <span class="dds-icon dds-icon_file_pdf__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'jpg'">
                                                    <span class="dds-icon dds-icon_file_jpg__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'png'">
                                                    <span class="dds-icon dds-icon_file_png__l__filled"></span>
                                                </ng-container>
                                                <ng-container *ngIf="item.fileExt == 'json'">
                                                    <img src="../../assets/images/Json.svg" alt="" width="15px" height="15px"
                                                        style="margin:0 5px 0 0;">
                                                </ng-container>
                                                {{item.fileNameWithExt}}
                                                <span (click)="deleteTables($event,item,0,'file')" title="Delete"
                                                    style="float: right;" class="dds-icon dds-icon_delete__l__stroke"></span>
                                            </th>
        
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let sheetObj of item.totalSheetList">
                                            <td>
                                                <input type="checkbox" [(ngModel)]="sheetObj.sheetSelected"
                                                    class="form-check-input" (change)="isAllSelectedUploadFiles()"
                                                    style="margin:0 8px 0 0">
                                                <img src="../../../../assets/images/xls_sheet.png" alt="" width="15px"
                                                    height="15px" style="margin:0 5px 0 0;">
                                                <label>{{sheetObj.sheetName}}</label>
                                                <ng-container *ngIf="sheetObj.fileExt == 'xlsx' || sheetObj.fileExt == 'xls' ||sheetObj.fileExt == 'txt' ||sheetObj.fileExt == 'csv'
                                                ||sheetObj.fileExt == 'json'">
                                                    <span (click)="previewPopup(sheetObj.tableName)" title="preview"
                                                        class="dds-icon dds-icon_eyeopen" style="float: right;"></span>
                                                </ng-container>
                                            </td>
                                        </tr>
                                        <tr *ngIf="item.isProgressBar">
                                            <td>
                                                <img src="../../assets/images/loading.gif" alt="" width="20px" height="20px"
                                                    style="margin-top: -4px;margin-left: 100px;">
                                            </td>
                                        </tr>
                                    </tbody>
                                </table> -->
                <div class="table-container">
                  <table mat-table #outerSort="matSort" [dataSource]="dataSource" multiTemplateDataRows
                    class="mat-elevation-z8 upload-table" matSort>
                    <ng-container matColumnDef="expand">
                      <th mat-header-cell *matHeaderCellDef aria-label="row actions">
                        <input type="checkbox" [(ngModel)]="masterSelected" name="list_name" value="m1"
                          (change)="checkUncheckAllUploadFiles()" />
                      </th>
                      <td mat-cell *matCellDef="let element">
                        <input type="checkbox" class="form-check-input" (change)="isFileSelectedInUF($event, element)"
                          [(ngModel)]="element.isFileSelected" style="margin: 0 8px 0 0" />


                        <ng-container *ngIf=" element.fileExt == 'xlsx' || element.fileExt == 'xls'">

                          <button mat-icon-button aria-label="expand row" (click)="
                              expandedElement =
                                expandedElement === element ? null : element;
                              $event.stopPropagation()
                            ">
                            <ng-container *ngIf="expandedElement !== element">
                              <span class="dds-icon dds-icon_chevron_down__l__stroke"></span>
                            </ng-container>
                            <ng-container *ngIf="expandedElement === element">
                              <span class="dds-icon dds-icon_chevron_up__l__stroke"></span>
                            </ng-container>
                          </button>

                        </ng-container>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="{{ column }}" *ngFor="let column of columnsToDisplay; let i = index">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ column }}
                      </th>
                      <td mat-cell *matCellDef="let element">
                        <ng-container *ngIf="column == 'Action'">
                          <ng-container *ngFor="let icon of element[column]">
                            <ng-container *ngIf="icon.includes('icon_eyeopen')">
                              <span (click)="previewPopup(element)" title="preview" class="{{ icon }}"></span>
                              <span class="dds-icon dds-icon_copy__l__stroke" (click)="copyTableName(element,'parent')"
                                title="copy table name"></span>
                            </ng-container>
                            <ng-container *ngIf="icon.includes('delete__l__stroke')">
                              <span title="delete" (click)="
                                    deleteTables($event, element, 0, 'file')
                                  " class="{{ icon }}"></span></ng-container>
                          </ng-container>
                        </ng-container>
                        <label>
                          <ng-container *ngIf="column == 'File Name'">

                            <ng-container *ngIf=" element[column].includes('csv') || 
                                element[column].includes('png') || 
                                element[column].includes('pdf') ||
                                element[column].includes('jpg') ">
                              <!-- element[column].includes('json') ||
                                  element[column].includes('txt') ||
                                 -->

                              <span class="dds-icon dds-icon_file_{{element[column].split('.')[1]}}__l__filled"
                                [ngClass]="element[column].split('.')[1]"></span>
                            </ng-container>
                            <ng-container *ngIf=" element[column].includes('xls') ">
                              <span class="dds-icon dds-icon_file_xls__l__filled"
                                [ngClass]="{'xls' : element[column].includes('xls')} "></span>
                            </ng-container>

                          </ng-container>
                          <ng-container *ngIf="column != 'Action'">
                            {{ element[column] }}
                          </ng-container>
                        </label>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="expandedDetail">
                      <td mat-cell *matCellDef="let pElement" [attr.colspan]="columnsToDisplayWithExpand.length">
                        <ng-container *ngIf="
                            pElement.fileExt == 'xlsx' ||
                            pElement.fileExt == 'xls'
                          ">
                          <div class="example-element-detail" *ngIf="pElement.totalSheetList?.data.length"
                            [@detailExpand]="
                              pElement == expandedElement
                                ? 'expanded'
                                : 'collapsed'
                            ">
                            <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                              <table #innerTables mat-table #innerSort="matSort" [dataSource]="pElement.totalSheetList"
                                matSort>
                                <ng-container matColumnDef="{{ innerColumn }}" *ngFor="
                                    let innerColumn of innerDisplayedColumns
                                  ">
                                  <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                                  <ng-container mat-cell *matCellDef="let cElement">
                                    <td>
                                      <ng-container *ngIf="cElement[innerColumn].includes('dds-icon_eyeopen')">
                                        <span title="preview" (click)="previewPopup(cElement)"
                                          class="{{ cElement[innerColumn] }}"></span>
                                        <span class="dds-icon dds-icon_copy__l__stroke"
                                          (click)="copyTableName(cElement,'child')" title="copy table name"></span>

                                      </ng-container>
                                      <ng-container *ngIf="
                                          !cElement[innerColumn].includes(
                                            'dds-icon_eyeopen'
                                          )
                                        ">
                                        <label><input type="checkbox" [(ngModel)]="cElement.sheetSelected"
                                            class="form-check-input" (change)="
                                            isAllSelectedUploadFiles(
                                              pElement,
                                              cElement
                                            )
                                          " style="margin: 0 8px 0 0" />
                                          {{ cElement[innerColumn] }}.{{
                                          cElement.fileExt
                                          }}</label>
                                      </ng-container>
                                    </td>
                                  </ng-container>
                                </ng-container>
                                <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                                <tr mat-row *matRowDef="
                                    let row;
                                    columns: innerDisplayedColumns
                                  "></tr>
                              </table>
                            </div>
                          </div>
                        </ng-container>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
                    <tr mat-row *matRowDef="
                        let element;
                        columns: columnsToDisplayWithExpand
                      " [class.example-element-row]="
                        element.totalSheetList?.data.length
                      " [class.example-expanded-row]="expandedElement === element" (click)="toggleRow(element)"></tr>
                    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
                  </table>
                </div>
              </div>
              <div class="col-md-3">
                <div class="toolbar-block">
                  <button mat-button class="info-btn" (click)="userguidepopup1()"><mat-icon>help</mat-icon></button>
                </div>
                <div class="space-evenly">
                  <div class="upload-inner-block" style="height: 28vh">
                    <div appFileDragAndDrop (filesChangeEmiter)="saveiputFiles($event,'dragNDrop')">

                      <label for="inputfile" class="button">
                        <input type="file" id="inputfile" (change)="saveiputFiles($event,'click')" style="display: none"
                          multiple />
                        <span class="dds-icon dds-icon_upload__l__stroke"></span>
                        <!-- <br> -->
                        <h5>Drag and drop files, or <span>Browse</span></h5>
                        <p class="note-block">
                          Supported XLS, PDF & CSV files<br />
                          (Max. 500kb)
                        </p>
                        <!-- <p style="font-size: 9px;color: #707070;">Note: Exclude .JS and .EXE files</p> -->
                      </label>
                    </div>
                  </div>

                  <form [formGroup]="uploadedManualToggleForm">
                    <h3 class="block-title">Select Dataset Creation Type:</h3>
                    <div class="toggle-btn-block">
                      <label>Manual</label>
                      <mat-slide-toggle formControlName="manualOrUploaded"
                        (click)="uploadedManualToggle(uploadedManualToggleForm)"></mat-slide-toggle>
                      <label>Upload Script</label>
                    </div>
                  </form>


                </div>
                <!--<div class="custom-note">
                  <h3>
                    <span class="dds-icon dds-icon_info__l__stroke"></span>NOTE
                  </h3>
                  <p>
                    If you want to take some of these files to the next section
                    'Target Files', select them only, if you do not select any
                    files, all the files will go to the next section 'Target
                    Files'.
                  </p>
                  <p>
                    In the 'Target Files' section you can edit the column type.
                  </p>
                </div>-->
              </div>

            </div>
          </div>
        </div>
        <div class="button-group">
          <!-- <button *ngIf="fileListt.length > 0" mat-button class="btnn"
                        (click)="showUploadFilesTab = false;fileListt = [];masterSelected = false;"
                        style="border:1px solid #0076A8; background: #fff; color: #0076A8;">Prev</button> -->
          <button mat-button class="btnn" (click)="changeTabs({ id: 0 }, 'prev')">
            <span class="dds-icon dds-icon_arrow_left__l__stroke" style="margin-right:10px; margin-left:0px;"></span>
            Prev
          </button>
          <button *ngIf="fileListt.length > 0" mat-button class="btnn" [disabled]="isUploadFilesNextBtnEnable"
            (click)="changeTabs({ id: 2 }, 'next')">
            Next <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
          </button>
        </div>
        <!--intg Chgs-->
      </mat-card>
    </mat-tab>
    <!--uEnd-->

    <!--tfstart-->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 2 ? 'completed' : ''">3</span>
        Target Files
      </ng-template>

      <ng-container *ngIf="tabs[2].id == 2 && tabs[2].isActive == true">
        <div class="row" style="margin:0px !important;" [ngClass]="targetFilesInfoBtn ? '': 'expandTargetFile'">
          <div class="col-md-9" style="padding-left:0px;">
            <div class="inner-container">
              <div class="targetFileRow">
                <!-- <span class="note required-field" style="margin:10px 0 0 0; width:calc(100% - 120px)">Here is the
                                complete
                                list
                                of files
                                that are appended, joined, and other individual
                                files that can be used to build the datasets. </span> -->
                <!-- <button mat-button class="btnn preview" (click)="showTargetFilePopup = true;">Preview</button> -->

                <div class="toolbar-block">
                  <h3 class="block-title">Target Files</h3>
                  <div class="search-block">
                    <input type="text" (keyup)="applyFilter($event,'TF')" placeholder="Search" />
                    <button type="button" class="mat-button">
                      <span class="dds-icon dds-icon_search__s__stroke"></span>
                    </button>
                  </div>
                  <button mat-button class="info-btn" (click)="userguidepopup2()"><mat-icon>help</mat-icon></button>
                </div>
                <div class="table-layer">
                  <div class="table-container targetfiles-table">

                    <!-- <ng-container *ngFor="let tf of targetFileList; let i = index"> -->
                    <!-- <ng-container *ngIf="
                        tf.fileType == 'append' && tf.sheetList.length != 0
                      ">
                      <table class="table table-striped">
                        <thead>
                          <tr class="header">
                            <th (click)="tf.isExpand = !tf.isExpand">
                              <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                              <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span>Append
                              Files
                            </th>
                          </tr>
                        </thead>
                        <tbody *ngIf="!tf.isExpand">
                          
                          <tr *ngFor="let sl of tf.sheetList; let j = index">
                            <td colspan="3">
                              <ng-container class="trrr">
                                <mat-accordion multi is-open="true">
                                  <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                    (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="mat-row">

                                      <label (click)="$event.stopPropagation();" class="dataP"><img
                                          src="../../assets/images/apd-icon.png" alt="" style="margin: 0 10px 0 0" />
                                        {{ sl.appendName }}</label>
                                      <div class="rightIcons1" (click)="$event.stopPropagation();">
                                        <span (click)="fileClickedinTF(j,i, sl,tf.fileType,sl.tableName)"
                                          title="preview" class="dds-icon dds-icon_eyeopen" style="float: right"></span>
                                        <span  title="Delete" class="dds-icon dds-icon_delete__l__stroke"></span>
                                      </div>
                                    </mat-expansion-panel-header>
                                    <div *ngFor="let appendObj of sl.tableAppendFieldsDto" style="cursor: pointer">
                                      <input type="checkbox" [(ngModel)]="appendObj.isChecked">
                                      {{ appendObj.fieldName }}
                                    </div>
                                  </mat-expansion-panel>
                                </mat-accordion>
                              </ng-container>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>
                    <ng-container *ngIf="tf.fileType == 'join' && tf.sheetList.length != 0">
                      <table class="table table-striped">
                        <thead>
                          <tr class="header">
                            <th (click)="tf.isExpand = !tf.isExpand">
                              <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                              <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span>Join
                              Files
                            </th>
                            <th></th>
                          </tr>
                        </thead>
                        <tbody *ngIf="!tf.isExpand">
                        
                          <tr *ngFor="let sl of tf.sheetList; let j = index">
                            <td colspan="3">
                              <ng-container class="trrr">
                                <mat-accordion multi is-open="true">
                                  <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                    (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="mat-row">

                                      <label (click)="$event.stopPropagation();" class="dataP"><img
                                          src="../../assets/images/apd-icon.png" alt="" style="margin: 0 10px 0 0" />
                                        {{ sl.mergeName }}</label>

                                      <div class="rightIcons1" (click)="$event.stopPropagation();">
                                        <span (click)="fileClickedinTF(j,i,sl,tf.fileType,sl.tableName)" title="preview"
                                          class="dds-icon dds-icon_eyeopen" style="float: right"></span>
                                        <span title="Delete"
                                          class="dds-icon dds-icon_delete__l__stroke"></span>
                                      </div>
                                    </mat-expansion-panel-header>
                                    <div *ngFor="let mergeObj of sl.mergeFieldListDTO" style="cursor: pointer">
                                      <input type="checkbox" [(ngModel)]="mergeObj.isChecked">
                                      {{ mergeObj.fieldName }}
                                    </div>
                                  </mat-expansion-panel>
                                </mat-accordion>
                              </ng-container>
                            </td>
                          </tr>

                        </tbody>
                      </table>
                    </ng-container> -->
                    <!-- <ng-container *ngIf="tf.fileType == 'files' && tf.sheetList.length != 0"> -->
                    <table class="table table-striped">
                      <thead>
                        <tr class="header">
                          <!-- (click)="tf.isExpand = !tf.isExpand">
                              <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                              <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span -->
                          <th>
                            <input type="checkbox" [(ngModel)]="masterSelectedInTF"
                              (change)="masterCheckedInTF($event)">
                            Source Files
                          </th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <!-- *ngIf="!tf.isExpand" -->
                      <tbody>

                        <tr *ngFor="let sl of targetFileList ; let j = index">
                          <ng-container *ngIf="sl.sheetSelected">
                            <td colspan="3">
                              <ng-container class="trrr">
                                <mat-accordion multi is-open="true">
                                  <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                    (closed)="panelOpenState = false">
                                    <mat-expansion-panel-header class="mat-row">




                                      <label (click)="$event.stopPropagation();" class="dataP">
                                        <input type="checkbox" [(ngModel)]="sl.isCheckedInTF"
                                          (change)="checkSheetInTF($event, sl)">
                                        <ng-container
                                          *ngIf="sl.fileExt == 'csv' || sl.fileExt == 'json' ||sl.fileExt == 'txt' ||sl.fileExt == 'xls'">
                                          <span class="dds-icon dds-icon_file_{{sl.fileExt}}__l__filled"
                                            [ngClass]="sl.fileExt"></span>
                                        </ng-container>
                                        <ng-container *ngIf="sl.fileExt == 'xlsx'">
                                          <span class="dds-icon dds-icon_file_xls__l__filled xls"></span>
                                        </ng-container>
                                        <!-- <img src="../../assets/images/apd-icon.png" alt="" style="margin: 0 10px 0 0" /> -->


                                        {{ sl.fileName }}
                                      </label>
                                      <div class="rightIcons1" (click)="$event.stopPropagation();">

                                        <!-- (click)="fileClickedinTF(j, i,sl,tf.fileType,sl.tableName)" -->
                                        <span (click)="fileClickedinTF(j, 0,sl, 'files',sl.tableName)" title="Edit"
                                          class="dds-icon dds-icon_edit__l__stroke"></span>
                                        <!-- <span title="Delete" class="dds-icon dds-icon_delete__l__stroke"></span> -->
                                      </div>
                                    </mat-expansion-panel-header>
                                    <input type="text" (keyup)="searchField($event,0,0,j,'tf','')"
                                      [value]="sl.searchValueInTF" placeholder="Search" style="margin-top:15px;" />
                                    <div *ngFor="let sheetObj of sl.sheet | searchFilter
                              : { tableNameUI: targetFileList[j].searchValueInTF }
                              : 'tf'
                              : ''" style="cursor: pointer">
                                      <input type="checkbox" [(ngModel)]="sheetObj.isChecked"
                                        (change)="checkColumnInTF($event, sheetObj, j)">
                                      {{ sheetObj.fieldName }}
                                    </div>
                                  </mat-expansion-panel>
                                </mat-accordion>
                              </ng-container>
                            </td>
                          </ng-container>
                        </tr>
                      </tbody>
                    </table>
                    <!-- </ng-container> -->
                    <!-- </ng-container> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-container *ngIf="targetFilesInfoBtn">
            <div class="col-md-3" style="padding-right:0px;">
              <div class="inner-container">
                <div class="custom-note no-padd no-border">
                  <h3>
                    <span class="dds-icon dds-icon_info__l__stroke"></span>NOTE
                  </h3>
                  <p>
                    Here you change/alter the column name and column type in each
                    file by clicking on edit icon.
                  </p>
                  <h4>How to do it?</h4>
                  <p>
                    If you click on the edit icon in each row, the column details
                    of that file will open in a popup, in which You can change the
                    column type and column name in each column here.
                  </p>
                  <p>Once the change is done it needs to be saved.</p>
                </div>
              </div>
            </div>
          </ng-container>
        </div>

        <!-- clickedRowDataInTF?.length != 0 -->


        <div class="button-group">
          <button mat-button class="btnn" (click)="changeTabs({ id: 1 }, 'prev')">
            <span class="dds-icon dds-icon_arrow_left__l__stroke" style="margin-right:10px; margin-left:0px;"></span>
            Prev
          </button>
          <button mat-button class="btnn" (click)="changeTabs({ id: 3 }, 'next')">
            Next <span class="dds-icon dds-icon_arrow_right__l__stroke"></span>
          </button>
        </div>
      </ng-container>
    </mat-tab>
    <!--tfEnd-->

    <!--Astart-->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 3 ? 'completed' : ''">4</span>
        Append Files
      </ng-template>
      <ng-container *ngIf="tabs[3].id == 3 && tabs[3].isActive == true">
        <div class="inner-container">
          <div class="row append-block">
            <div class="col-md-5">
              <div class="boxed">
                <!-- <ng-container *ngIf="sourceFilesList.length != 0"> -->
                <div class="toolbar-block">
                  <h3 class="block-title">Source Files</h3>
                  <div class="search-block">
                    <input type="text" class="form-control" (keyup)="applyFilter($event,'A')" placeholder="Search" />
                    <button mat-button>
                      <span class="dds-icon dds-icon_search__l__stroke"></span>
                    </button>
                  </div>
                </div>
                <!-- <span class="note required-field">To append the sheets, please choose the ones with identical
                                  columns.
                                  Select atleast two sheets for appending </span> -->
                <!-- <ng-container *ngFor="let table of appendList; let i=index"> -->
                <div class="table-layer2">
                  <div class="table-container">
                    <table class="createNewSoltionsTable appendTable mat-table" style="border:0px;">
                      <thead>
                        <tr matSort (matSortChange)="sortData($event,'append','SF')">
                          <th mat-sort-header="fileName">Files</th>
                          <th></th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngIf="sourceFilesList.length == 0">
                          <td>No Results</td>
                        </tr>
                        <tr class="trrr" *ngFor="let item of sourceFilesList; let j = index">
                          <td>
                            <div class="apd-item">
                              <label>
                                <div class="file-name-title">
                                  <input type="checkbox" [(ngModel)]="item.isCheckedInAppend"
                                    (change)="isCheckedInAppend($event)" />
                                  <!-- (change)="isAllSelected($event,item,i, j)" -->
                                  <ng-container *ngIf=" item.fileExt == 'xlsx' ">
                                    <span class="dds-icon dds-icon_file_xls__l__filled xls"></span>
                                  </ng-container>
                                  <ng-container
                                    *ngIf="item.fileExt == 'txt' || item.fileExt == 'csv' || item.fileExt == 'xls'">
                                    <span class="dds-icon dds-icon_file_{{item.fileExt}}__l__filled"
                                      [ngClass]="item.fileExt"></span>
                                  </ng-container>
                                  <ng-container *ngIf="item.fileExt == 'json'">
                                    <!-- <img src="../../assets/images/Json.svg" alt="" width="15px" height="15px"
                                  style="margin: 0 5px 0 0" /> -->
                                    <span class="dds-icon" [ngClass]="item.fileExt"></span>
                                  </ng-container>
                                  {{ item.fileName }}
                                </div>
                              </label>
                            </div>
                          </td>
                          <td style="width: 50%"></td>
                          <td>
                            <span (click)="previewPopup(item)" title="preview" class="dds-icon dds-icon_eyeopen"></span>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>


                <div *ngIf="submitted" class="error">
                  {{ submittedErrorMsg }}
                </div>

                <!-- </ng-container> -->
                <!-- </ng-container> -->
             </div>
           </div>
            <div class="col-md-2">
              <button mat-button class="btnn" (click)="addAppend()" style="margin: 30px">
                Append
                <span class="dds-icon dds-icon_arrow_right__l__stroke"></span>
              </button>
            </div>
            <div class="col-md-5">
              <div class="boxed">
              <div class="toolbar-block">
                <h3 class="block-title">Append Files</h3>
                <!-- <div class="toolbar-block"> -->
                <button mat-button class="info-btn" (click)="userguidepopup3()"><mat-icon>help</mat-icon></button>
                <!-- </div> -->
              </div>
              <div class="table-layer2">
                <div class="table-container">
                  <!-- <ng-container *ngIf="getAppendFilesList.length != 0"> -->
                  <table class="createNewSoltionsTable appendTable" style="border:0px;">
                    <thead>
                      <tr matSort (matSortChange)="sortData($event,'append','AF')">
                        <th mat-sort-header="appendName">Files</th>
                        <th></th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td colspan="3">
                          <ng-container class="trrr" *ngFor="let item of getAppendFilesList; let j = index">
                            <mat-accordion multi is-open="true">
                              <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                (closed)="panelOpenState = false">

                                <mat-expansion-panel-header class="mat-row">

                                  <label (click)="$event.stopPropagation();" class="dataP"
                                    title={{item.appendName}}><img src="../../assets/images/apd-icon.png" width="25"
                                      alt="" style="margin: 0 10px 0 0" />
                                    Appended - {{ item.appendName }}</label>

                                  <div class="rightIcons1" (click)="$event.stopPropagation();">
                                    <span (click)="previewPopup(item)" title="preview"
                                      class="dds-icon dds-icon_eyeopen"></span>
                                    <span (click)="deleteTables($event, item, j, 'append')" title="Edit"
                                      class="dds-icon dds-icon_delete__l__stroke"></span>
                                  </div>
                                </mat-expansion-panel-header>
                                <div *ngFor="let appendObj of item.appendDtos" style="cursor: pointer">
                                  <!-- <mat-accordion *ngFor="let appendObj of item.appendDtos" style="cursor: pointer"> -->
                                  <ng-container *ngIf="appendObj.fileExt == 'xlsx' || appendObj.fileExt == 'xls'">
                                    <span class="dds-icon dds-icon_file_xls__l__filled" style="color: #75787b"></span>
                                    {{ appendObj.fileName }}-{{appendObj.sheetName}}.{{ appendObj.fileExt }}
                                  </ng-container>
                                  <ng-container *ngIf="appendObj.fileExt == 'txt'">
                                    <span class="dds-icon dds-icon_file_txt__l__filled" style="color: #75787b"></span>
                                    {{ appendObj.fileNameWithExt }}
                                  </ng-container>
                                  <ng-container *ngIf="appendObj.fileExt == 'csv'">
                                    <span class="dds-icon dds-icon_file_csv__l__filled" style="color: #75787b"></span>
                                    {{ appendObj.fileNameWithExt }}
                                  </ng-container>
                                  <ng-container *ngIf="item.fileExt == 'json'">
                                    <!-- <img src="../../assets/images/Json.svg" alt="" width="15px" height="15px"
                                      style="margin: 0 5px 0 0" /> -->
                                    <span class="dds-icon" [ngClass]="item.fileExt"></span>
                                    {{ appendObj.fileNameWithExt }}
                                  </ng-container>
                                  <!-- </mat-accordion> -->
                                </div>
                              </mat-expansion-panel>
                            </mat-accordion>
                          </ng-container>
                        </td>
                      </tr>

                    </tbody>
                  </table>
                  <!-- </ng-container> -->
                </div>
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="button-group">
          <button mat-button class="btnn" (click)="changeTabs({ id: 2 }, 'prev')">
            <span class="dds-icon dds-icon_arrow_left__l__stroke" style="margin-right:10px; margin-left:0px;"></span>
            Prev
          </button>
          <button mat-button class="btnn" (click)="changeTabs({ id: 4 }, 'next')">
            Next <span class="dds-icon dds-icon_arrow_right__l__stroke"></span>
          </button>
        </div>
      </ng-container>
    </mat-tab>
    <!--Aend-->

    <!-- jstart-->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 4 ? 'completed' : ''">5</span>
        Join Files
      </ng-template>
      <ng-container *ngIf="tabs[4].id == 4 && tabs[4].isActive == true">
        <div class="inner-container">
          <!-- <span class="note required-field">Select the files, then join them based on common columns </span> -->
          <!--join form-->
          <!-- combination -->
          <div class="row append-block">
            <!-- <ng-container *ngIf="append_SourceFilesList.length > 0"> -->
            <div class="col-md-5">
              <div class="boxed">
              <div class="toolbar-block">
                <h3 class="block-title">Appended & Source Files</h3>
                <div class="search-block">
                  <input type="text" class="form-control" (keyup)="applyFilter($event,'J')" placeholder="Search" />
                  <button mat-button>
                    <span class="dds-icon dds-icon_search__l__stroke"></span>
                  </button>
                </div>
              </div>
              <div class="table-layer2">
                <div class="table-container">
                  <table class="table table-striped createNewSoltionsTable appendTable">
                    <thead>
                      <tr>
                        <th>Files</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td colspan="2" style="padding:0px !important; height:auto;">
                          <div class="header" (click)="expandCollapseAppendInJoin()" style="margin-bottom:0px;">
                            <h5>
                              <span *ngIf="isAppendExpandInJoin"
                                class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                              <span *ngIf="!isAppendExpandInJoin"
                                class="dds-icon dds-icon_chevron_up__s__stroke"></span>
                              Appended Files
                            </h5>
                          </div>

                        </td>
                      </tr>
                      <tr class="" *ngFor="let obj of append_SourceFilesList;let i = index">
                        <ng-container *ngIf="obj.type == 'Append' && obj.isAppendExpandInJoin">
                          <td>
                            <div class="apd-item">
                              <input type="checkbox" [(ngModel)]="obj.isCheckedInJoin" (change)="checkedInJoin($event)"
                                style="margin-right: 10px" />
                              <label (click)="$event.stopPropagation();"><img src="../../assets/images/apd-icon.png"
                                  alt="" width="25" style="margin: 0 10px 0 0" />
                                {{ obj.tableNameUI }}</label>
                            </div>
                          </td>
                          <td>
                            <div class="rightIcons">
                              <span class="dds-icon dds-icon_eyeopen" title="preview"
                                (click)="previewPopup(obj)"></span>
                            </div>
                          </td>
                        </ng-container>
                      </tr>
                    </tbody>

                    <tbody>
                      <tr>
                        <td colspan="2" style="padding:0px !important; height:auto;">
                          <div class="header" (click)="expandCollapseSourceFilesInJoin()">
                            <h5><span *ngIf="isSourceFilesExpandInJoin"
                                class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                              <span *ngIf="!isSourceFilesExpandInJoin"
                                class="dds-icon dds-icon_chevron_up__s__stroke"></span>
                              Source Files
                            </h5>
                          </div>

                        </td>
                      </tr>
                      <tr class="" *ngFor="let obj of append_SourceFilesList;let i = index">
                        <ng-container *ngIf="obj.type == 'files' && obj.isSourceFilesExpandInJoin">
                          <td>
                            <div class="apd-item">
                              <input type="checkbox" [(ngModel)]="obj.isCheckedInJoin" (change)="checkedInJoin($event)"
                                style="margin-right: 10px" />
                              <label>
                                <div class="file-name-title">
                                  <ng-container *ngIf="obj.isAppend == true"></ng-container>
                                  <ng-container *ngIf=" obj.fileExt == 'xlsx' ">
                                    <span class="dds-icon dds-icon_file_xls__l__filled xls"></span>
                                  </ng-container>
                                  <ng-container
                                    *ngIf="obj.fileExt == 'txt' || obj.fileExt == 'csv'|| obj.fileExt == 'xls'">
                                    <span class="dds-icon dds-icon_file_{{obj.fileExt}}__l__filled"
                                      [ngClass]="obj.fileExt"></span>
                                  </ng-container>
                                  <ng-container *ngIf="obj.fileExt == 'json'">
                                    <!-- <img src="../../assets/images/Json.svg" alt="" width="15px" height="15px"
                                  style="margin: 0 5px 0 0" /> -->
                                    <span class="dds-icon" [ngClass]="obj.fileExt"></span>
                                  </ng-container>
                                  {{ obj.tableNameUI }}
                                </div>
                              </label>
                            </div>
                          </td>
                          <td>
                            <div class="rightIcons">
                              <span class="dds-icon dds-icon_eyeopen" title="preview"
                                (click)="previewPopup(obj)"></span>
                            </div>
                          </td>
                        </ng-container>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div *ngIf="submitted" class="error">
                {{ submittedErrorMsg }}
              </div>
            </div>
            </div>
            <div class="col-md-2">
              <button *ngIf="append_SourceFilesList.length > 0" mat-button class="btnn" (click)="joinSheets()"
                [disabled]="enableAddBtn" [ngClass]="enableAddBtn ? 'disabled' : ''">
                Join
                <span class="dds-icon dds-icon_arrow_right__l__stroke"></span>
              </button>
            </div>
            <div class="col-md-5">
              <div class="boxed">
              <div class="toolbar-block">
                <h3 class="block-title">Joined Files</h3>
                <!-- <div class="toolbar-block"> -->
                <button mat-button class="info-btn" (click)="userguidepopup4()"><mat-icon>help</mat-icon></button>
                <!-- </div> -->
              </div>
              <!-- <div *ngIf="joinCheckedList.length != 0">

                                    <form style="border: 1px #000 solid;" [formGroup]="joinSetForm">
                                        <div class="row"
                                            style="background-color: #0076A8; color: #fff; width: 100%; margin: auto;">
                                            <div class="col-md-2"
                                                style="font-weight: 600;background-color: #0076A8; color: #fff;">
                                                Join
                                                Set
                                            </div>
                                            <div class="col-md-3"
                                                style="font-weight: 600;background-color: #0076A8; color: #fff;">
                                            </div>
                                            <div class="col-md-3"
                                                style="font-weight: 600;background-color: #0076A8; color: #fff;">
                                            </div>
                                            <div class="col-md-3"
                                                style="font-weight: 600;background-color: #0076A8; color: #fff;">
                                            </div>
                                            <div class="col-md-1"
                                                style="font-weight: 600;background-color: #0076A8; color: #fff;">
                                            </div>
                                        </div>
                                        <div formArrayName="Merg">
                                            <div *ngFor="let merg of MergeArr().controls ;let i=index;"
                                                [formGroupName]="i">

                                                <div class="" style="padding: 7px;">Join Table Name :
                                                    {{joinCheckedList[i].joinName}}
                                                </div>
                                                <div formArrayName="tableControl">
                                                    <div class=""
                                                        *ngFor="let table of TableArr(i).controls ;let j=index;"
                                                        [formGroupName]="j">
                                                        <div class="row">

                                                            <div class="col-md-2"></div>

                                                            <div class="col-md-3">


                                                                <mat-form-field appearance="fill">
                                                                    <mat-select class="form-control"
                                                                        [placeholder]="placetable"
                                                                        formControlName="table1"
                                                                        [ngClass]="{ 'is-invalid': submitedJ && table.get('table1')?.errors }"
                                                                        (selectionChange)="selectPrimaryTable($event,j,i)">
                                                                        <ng-container
                                                                            *ngFor="let data of joinCheckedList[i]?.dropDownList[j].primaryTableList">
                                                                            <mat-option [value]="data">

                                                                                {{data.tableNameUI}}
                                                                            </mat-option>
                                                                        </ng-container>
                                                                    </mat-select>
                                                                </mat-form-field>

                                                            </div>
                                                            <div class="col-md-2">



                                                                <mat-form-field appearance="fill">
                                                                    <mat-select class="form-control"
                                                                        placeholder="Select Join"
                                                                        (selectionChange)="selectJoin($event,j,i)"
                                                                        [ngClass]="{ 'is-invalid': submitedJ && table.get('join')?.errors }"
                                                                        formControlName="join">
                                                                        <mat-option *ngFor="let value of joinType"
                                                                            [value]="value">
                                                                            {{value}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>

                                                            </div>
                                                            <div class="col-md-3">

                                                                <mat-form-field appearance="fill">
                                                                    <mat-select class="form-control"
                                                                        placeholder="Select Foreign Table"
                                                                        formControlName="table2"
                                                                        [ngClass]="{ 'is-invalid': submitedJ && table.get('table2')?.errors }"
                                                                        (selectionChange)="selectForeignTable($event,j,i)">
                                                                        <ng-container
                                                                            *ngFor="let dataa of joinCheckedList[i]?.dropDownList[j].foreignTableList">
                                                                            <mat-option
                                                                                [value]="dataa">{{dataa.tableNameUI}}
                                                                            </mat-option>
                                                                        </ng-container>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <button mat-button
                                                                    class="dds-icon dds-icon_plus__l__stroke btnn"
                                                                    style="color: #fff;font-size: 14px;"
                                                                    (click)="addTableJoins(i,j)"
                                                                    [disabled]="joinCheckedList[i]?.allTablesSelected"
                                                                    *ngIf="j==0"
                                                                    style=" line-height:14px;color: #fff;font-size: 14px;"
                                                                    title="Table">
                                                                </button>
                                                                <button mat-button
                                                                    class="dds-icon dds-icon_delete__l__stroke btnn"
                                                                    style="color: #fff;font-size: 14px;" *ngIf="j!=0"
                                                                    (click)="removeTable(i,j)" title="Table Delete"
                                                                    style="width: 50px; font-size:22px; line-height:14px; color: #fff;font-size: 14px;"></button>
                                                            </div>
                                                        </div>


                                                        <div formArrayName="column">
                                                            <div *ngFor="let item of columnArr(i,j).controls ;let k=index;"
                                                                [formGroupName]="k">
                                                                <div class="row">
                                                                    <div class="col-md-2"></div>

                                                                    <div class="col-md-3">
                                                                        <mat-form-field appearance="fill">
                                                                            <mat-select class="form-control"
                                                                                placeholder="Select Column"
                                                                                formControlName="column1"
                                                                                [ngClass]="{ 'is-invalid': submitedJ && item.get('column1')?.errors }"
                                                                                (selectionChange)="selectPrimarykey($event,k,j,i)">
                                                                                <mat-option
                                                                                    *ngFor="let item of joinCheckedList[i]?.dropDownList[j]?.columns[k]?.primaryKeyList"
                                                                                    [value]="item">
                                                                                    {{item.fieldName}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-md-2"></div>
                                                                    <div class="col-md-3">
                                                                        <mat-form-field appearance="fill">
                                                                            <mat-select class="form-control"
                                                                                placeholder="Select Column"
                                                                                formControlName="column2"
                                                                                [ngClass]="{ 'is-invalid': submitedJ && item.get('column2')?.errors }"
                                                                                (selectionChange)="selectForeignKey($event, k,j,i)">
                                                                                <mat-option
                                                                                    *ngFor="let item of joinCheckedList[i]?.dropDownList[j]?.columns[k]?.foreignKeyList"
                                                                                    [value]="item">
                                                                                    {{item.fieldName}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-md-2"
                                                                        style="border-bottom: 1px solid;">
                                                                        <button mat-button
                                                                            class="dds-icon dds-icon_plus__l__stroke btnn"
                                                                            style="color: #fff;font-size: 14px;"
                                                                            (click)="addColumnJoin(i,j)" *ngIf="k==0"
                                                                            style="line-height:14px; color: #fff;font-size: 14px;"
                                                                            title="Column">
                                                                        </button>
                                                                        <button mat-button
                                                                            class="dds-icon dds-icon_delete__l__stroke btnn"
                                                                            style="color: #fff;font-size: 14px;"
                                                                            *ngIf="k!=0" (click)="removeCol(i,j,k)"
                                                                            title="Column Delete"
                                                                            style="width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;"></button>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div> -->

              <!-- <ng-container *ngIf="joinCheckedList.length != 0" style="float: left;">
                                    <button mat-button class="btnn" (click)="resetJoin()">Reset</button>
                                    <button mat-button class="btnn" (click)="MergeSubmit()">Save</button>
                                </ng-container> -->
              <!-- <ng-container *ngIf="getJoinFilesList.length != 0"> -->
              <div class="table-layer2">
                <div class="table-container">
                  <table class="createNewSoltionsTable appendTable">
                    <thead>
                      <tr>
                        <th>Files</th>
                        <th></th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="trrr" *ngFor="let item of getJoinFilesList; let j = index">
                        <td>
                          <label title={{item.mergeName}}><img src="../../assets/images/jnd-icon.png" width="25" alt=""
                              style="margin: 0 10px 0 0" />
                            Joined - {{ item.mergeName }}</label>
                        </td>
                        <td style="width: 50%"></td>
                        <td>
                          <ng-container>
                            <span (click)="previewPopup(item)" title="preview" class="dds-icon dds-icon_eyeopen"></span>
                            <span (click)="deleteTables($event, item, j, 'merge')" title="Delete"
                              class="dds-icon dds-icon_delete__l__stroke"></span>
                          </ng-container>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <!-- </ng-container> -->
            </div>
            <!-- </ng-container> -->
          </div>
        </div>
        </div>

        <div class="button-group">
          <button mat-button class="btnn" (click)="changeTabs({ id: 3 }, 'prev')">
            <span class="dds-icon dds-icon_arrow_left__l__stroke" style="margin-right:10px; margin-left:0px;"></span>
            Prev
          </button>
          <button mat-button class="btnn" (click)="changeTabs({ id: 5 }, 'next')">
            Next <span class="dds-icon dds-icon_arrow_right__l__stroke"></span>
          </button>
        </div>
      </ng-container>
    </mat-tab>
    <!--jEnd-->

    <!-- DMstart -->
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="number" [ngClass]="activeTab > 5 ? 'completed' : ''">6</span>
        Data Modelling
      </ng-template>

      <mat-card *ngIf="tabs[5].id == 5 && tabs[5].isActive == true">
        <div class="inner-container">
          <!-- <span class="note required-field">Use the column names from the files listed below to create the
                        dataset(s),
                        then
                        define the dataset columns using analytical operations or by using the column name directly.</span> -->
          <div class="toobar-block data-toolbar">
            <h3 class="block-title">Data Files</h3>
            <div class="search-block">
              <input type="text" class="form-control" (keyup)="applyFilter($event,'DS')" placeholder="Search" />
              <button mat-button>
                <span class="dds-icon dds-icon_search__l__stroke"></span>
              </button>
            </div>
            <!-- <button mat-button class="btnn"
                            (click)="allExpandState = true">Expand
                            All </button>
                        <button mat-button class="btnn" (click)="allExpandState = false">Collapse All </button> -->


            <!--commented for new changes-->
            <!-- <button mat-button class="btnn" (click)="uploadSQLScriptBtn()"> 
              Upload SQL Script <span class="dds-icon dds-icon_upload"></span>
            </button>
            <button mat-button class="btnn" (click)="uploadPythonScriptBtn()">
              Upload Python Script <span class="dds-icon dds-icon_upload"></span>
            </button> -->
            <button mat-button class="btnn" (click)="createDataSetinDM()">
              Create DataSet <span class="dds-icon dds-icon_plus"></span>
            </button>
            <!-- <div class="toolbar-block"> -->
            <button mat-button class="info-btn" (click)="userguidepopup5()"><mat-icon>help</mat-icon></button>
            <!-- </div> -->
          </div>

          <div class="dataModeling">
            <div class="row">
              <div class="clo-md-12">
                <div class="data-mode-table">
                  <div class="table-header">
                    <h4>DataSet Files</h4>
                    <h4>Actions</h4>
                  </div>
                  <!-- datasetDetailsListShowList -->
                  <div *ngIf="
                  allDatasetDetailsListForSearch?.length == 0  && uploadedScriptTableList?.length == 0 ||
                  allDatasetDetailsListForSearch == null 
                    " class="mat-table empty-records empty-inner">
                    <p>
                      Create Datasets by using <span>Source</span>, <span>Appended</span> and <span>Join Files </span>
                      <!-- <span>SQL</span> or
                      <span>Python script</span> or by selecting the "<span>Create Data File</span>" option. -->
                    </p>
                  </div>
                  <mat-accordion multi class="mat-table" is-open="true"
                    *ngIf="allDatasetDetailsListForSearch?.length != 0">
                    <div *ngIf="allDatasetDetailsList?.length == 0">No Data</div>
                    <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                      (closed)="panelOpenState = false" *ngFor="let item of allDatasetDetailsList; let i = index">
                      <!-- (click)="datasetTableExpand(item,i)" -->
                      <mat-expansion-panel-header class="mat-row">
                        <input type="checkbox" (click)="onCheck(item,'dataset');$event.stopPropagation()"
                          class="form-check-input" style="margin-right: 8px" />
                        <label class="dataP" (click)="$event.stopPropagation();">{{ item.datasetName }}</label>
                        <!-- <input type="checkbox" class="form-check-input" [(ngModel)]="item.isSelectAllParentInDM" (change)="selectAllParentInDM($event,'dataset', item)" style="margin:0 8px 0 0"> -->
                        <!-- <button class="btn" style="width: 18%" (click)="selectAllInDM('dataset', item)">Select All</button> -->
                        <!-- <img src="../../../assets/images/select-all.svg" alt="" title="Select All" (click)="selectAllInDM('dataset', item)"> -->

                        <!-- <div class="rightIcons" (click)="$event.stopPropagation();">
                          <span class="dds-icon dds-icon_eyeopen" title="View Dataset" title="preview"
                            (click)="previewPopup(item)"></span>
                          <span class="dds-icon dds-icon_edit__l__stroke" title="Edit Dataset"
                            (click)="editDatasetFile(item)"></span>
                          <span class="dds-icon dds-icon_file" title="View Script"
                            (click)="callGetViewscript(item)"></span>
                          <span (click)="deleteTables($event, item, i, 'dataset')" title="Delete Dataset"
                            class="dds-icon dds-icon_delete__l__stroke"></span>
                        </div> -->
                        <!-- [matMenuTriggerFor]="datasetMenu" -->
                        <button mat-icon-button aria-label="Example icon-button with a menu" class="action-button"
                          (click)="ellipsisInDM(item,i);$event.stopPropagation()">
                          <mat-icon>more_vert</mat-icon>
                        </button>

                        <div class="actions-menu" *ngIf="item.isSelectedEllipsis">
                          <button mat-menu-item>
                            <span title="View Dataset" title="preview" (click)="previewPopup(item)"><span
                                class="dds-icon dds-icon_eyeopen"></span> Preview</span>
                          </button>
                          <button mat-menu-item *ngIf="!item.append">
                            <span title="Edit Dataset" (click)="editDatasetFile(item)"><span
                                class="dds-icon dds-icon_edit__l__stroke"></span> Edit</span>
                          </button>
                          <button mat-menu-item>
                            <span title="View Script" (click)="callGetViewscript(item)"><span
                                class="dds-icon dds-icon_file"></span> View Script</span>
                          </button>
                          <button mat-menu-item>
                            <span (click)="deleteTables($event, item, i, 'dataset')" title="Delete Dataset"><span
                                class="dds-icon dds-icon_delete__l__stroke"></span> Delete</span>
                          </button>
                        </div>
                        <!-- <button mat-icon-button [matMenuTriggerFor]="datasetMenu"
                          aria-label="Example icon-button with a menu" (click)="$event.stopPropagation()">
                          <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #datasetMenu="matMenu" class="action-pop">
                          <button mat-menu-item>
                            <span class="dds-icon dds-icon_eyeopen" title="View Dataset" title="preview" (click)="previewPopup(item.tableName)">Preview</span>
                          </button>
                          <button mat-menu-item>
                            <span class="dds-icon dds-icon_edit__l__stroke" title="Edit Dataset"
                              (click)="editDatasetFile(item)">
                              Edit Dataset</span>
                          </button>
                          <button mat-menu-item>
                            <span class="dds-icon dds-icon_file" title="View Script"
                              (click)="callGetViewscript(item)">View Script</span>
                          </button>
                          <button mat-menu-item>
                            <span (click)="deleteTables($event, item, i, 'dataset')" title="Delete Dataset"
                              class="dds-icon dds-icon_delete__l__stroke">Delete Dataset</span>
                          </button>
                        </mat-menu> -->


                        <!-- <div class="dropdown">
                           <button id="" (click)="$event.stopPropagation()" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><mat-icon>more_vert</mat-icon></button> 
                          <buttodropdownMenuButtonn class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Dropdown button
                          </button>
                          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="#">Action</a>
                            <a class="dropdown-item" href="#">Another action</a>
                            <a class="dropdown-item" href="#">Something else here</a>
                          </div>
                        </div> -->


                      </mat-expansion-panel-header>
                      <div class="row">
                        <div class="search1 col-md-6 inner-search">
                          <input id="form1" class="form-control" value="" placeholder="Search" (keyup)="
                              applyFilterForDMTables($event, item, i, 'dataset')
                            " />
                        </div>
                      </div>
                      <!--  <div class="inner-check-all">
                         <input type="checkbox" title="Select All" class="form-check-input"
                          [(ngModel)]="item.isSelectAllParentInDM" (change)="
                            selectAllParentInDM($event, 'dataset', item)
                          " style="
                            margin-top: 10px;
                            margin-bottom: 10px;
                            height: 18px;
                            width: 18px;
                          " />&nbsp;
                        <label style="margin-top: 6px">Select All</label>
                      </div> -->
                      <!-- </div> -->
                      <mat-accordion *ngFor="
                            let comp of item.datasetFieldDTOList| searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'dataset';
                            let j = index
                          " style="cursor: pointer">
                        <ng-container *ngIf="!comp.excludeInSelect">
                          <div (click)="accordionFilesRowClicked(item, i, comp, j, 'DS')">
                            <!-- <input type="checkbox" class="form-check-input" [(ngModel)]="comp.isSelectAllChildInDM"
                              (change)="
                                  selectAllChildInDM(
                                    $event,
                                    'dataset',
                                    item,
                                    comp
                                  )
                                " style="margin: 0 8px 0 0" /> -->
                            <label>{{ comp.fieldName }}</label>
                          </div>
                        </ng-container>
                      </mat-accordion>

                    </mat-expansion-panel>
                  </mat-accordion>
                  <div *ngIf="uploadedScriptTableList.length != 0">
                    <mat-accordion multi class="mat-table" is-open="true">
                      <div *ngIf="uploadedScriptTableList?.length == 0">No Data</div>
                      <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                        (closed)="panelOpenState = false" *ngFor="let item of uploadedScriptTableList; let i = index">
                        <mat-expansion-panel-header class="mat-row">
                          <input type="checkbox" (click)="onCheck(item,'scriptGeneratedTable');$event.stopPropagation()"
                            class="form-check-input" style="margin-right: 8px" />
                          <label class="dataP" (click)="$event.stopPropagation();">{{ item.tableName }}</label>

                          <div class="rightIcons" (click)="$event.stopPropagation();">
                            <span class="dds-icon dds-icon_eyeopen" title="View Dataset" title="preview"
                              (click)="previewPopup(item)"></span>
                          </div>

                        </mat-expansion-panel-header>



                      </mat-expansion-panel>
                    </mat-accordion>
                  </div>
                </div>

              </div>
            </div>



            <div *ngIf="showRelationshipModal">
              <div class="taxt_audit-report">
                <div class="taxt-audit-popup" style="min-width:1165px;">
                  <div class="taxt-header popup-header">
                    <h3>Map Tables</h3>
                    <button aria-label="Close" class="close" (click)="closeRelModal()"><span
                        class="report-modal-close dds-icon dds-icon_close__l__stroke"></span></button>
                  </div>
                  <div class="popup-body">
                    <form [formGroup]="addRelationshipForm">
                      <div formArrayName="addRelationshipRows" class="join-name-group" style="padding-bottom:0px;">
                        <div class="join-scroll">
                          <div class="join-new-form" *ngFor="
                          let relation of relationshipArr().controls;
                          let i = index
                        " [formGroupName]="i" style="padding-right:20px;">
                            <!-- <div class="flex-container"
                                                        *ngFor="let relation of relationship; let i=index"> -->
                            <!-- <div class="flex-child">
                                                            <input type="input" class="form-control" id="Name"
                                                            [ngClass]="{ 'is-invalid': submitedRelation && relation.get('name')?.errors }"
                                                                formControlName="name" placeholder="Name">
                                                        </div> -->
                            <div class="row">
                              <div class="col-md-4">
                                <label>Select from Table</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" id="Name" formControlName="fromTable"
                                    placeholder="select from table" [ngClass]="{
                                  'is-invalid':
                                    submitedRelation &&
                                    relation.get('fromTable')?.errors
                                }" (selectionChange)="onChangeTable(i, 'from')">
                                    <mat-option *ngFor="
                                    let item of relationship[i]?.fromTableList
                                  " [value]="item.value">
                                      {{ item.name }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
                              </div>
                              <div class="col-md-3">
                                <label>Select Relationship</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" id="Name" formControlName="crossFilteringBehavior"
                                    [ngClass]="{
                                  'is-invalid':
                                    submitedRelation &&
                                    relation.get('crossFilteringBehavior')?.errors
                                }" placeholder="Select Relationship">
                                    <mat-option *ngFor="let item of relationship[i]?.cfbList" [value]="item.value">
                                      {{ item.name }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>

                              </div>
                              <div class="col-md-4">
                                <label>Select to table</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" id="Name" formControlName="toTable"
                                    placeholder="select to table" [ngClass]="{
                                  'is-invalid':
                                    submitedRelation &&
                                    relation.get('toTable')?.errors
                                }" (selectionChange)="onChangeToTable(i, 'to')">
                                    <mat-option *ngFor="
                                    let item of relationship[i]?.toTableList
                                  " [value]="item.value">
                                      {{ item.name }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
                              </div>
                              <div class="col-md-1">
                                <label></label>
                                <button mat-button class="dds-icon dds-icon_plus__l__stroke btnn" *ngIf="i == 0"
                                  (click)="addNewRelation(i)"></button>
                                <button mat-button class="dds-icon dds-icon_delete__l__stroke btnn" *ngIf="i != 0"
                                  title="Table Delete" (click)="deleteRelationRow(i)"></button>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-md-4">

                                <label>Select table column</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" id="Name" formControlName="fromColumn" [ngClass]="{
                                  'is-invalid':
                                    submitedRelation &&
                                    relation.get('fromColumn')?.errors
                                }" placeholder="select table column">
                                    <mat-option *ngFor="
                                    let item of relationship[i]?.fromColumnList
                                  " [value]="item.value">
                                      {{ item.name }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>

                              </div>
                              <div class="col-md-3"></div>
                              <div class="col-md-4">
                                <label>Select table column</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" id="Name" formControlName="toColumn" [ngClass]="{
                                  'is-invalid':
                                    submitedRelation &&
                                    relation.get('toColumn')?.errors
                                }" placeholder="select table column">
                                    <mat-option *ngFor="
                                    let item of relationship[i]?.toColumnList
                                  " [value]="item.value">
                                      {{ item.name }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
                              </div>



                            </div>
                            <!--  -->

                            <div class="flex-child">

                              <!-- (click)="removeTable(i,j)"  -->

                            </div>

                            <!-- </div> -->
                          </div>
                        </div>
                      </div>
                    </form>
                    <!-- <div class="flex-container" *ngFor="let relation of relationship; let i=index">
                                            <div class="flex-child">
                                                <input type="input" class="form-control" id="Name" [(ngModel)]="relation.name"
                                                    placeholder="Name">
                                                <label *ngIf="relation.validators.name" class="required">Name required</label>
                                            </div>
                                            <div class="flex-child">
                                                <mat-form-field appearance="fill">
                                                    <mat-select class="form-control" id="Name" [(ngModel)]="relation.fromTable"
                                                        placeholder="select from table"
                                                        (selectionChange)="onChangeTable(i, 'from')">
                                                        <mat-option *ngFor="let item of relation.fromTableList"
                                                            [value]="item.value">
                                                            {{item.name}} </mat-option>
                                                    </mat-select>
                                                    <label *ngIf="relation.validators.fromTable" class="required">From table
                                                        required</label>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill">
                                                    <mat-select class="form-control" id="Name" [(ngModel)]="relation.fromColumn"
                                                        placeholder="select table column">
                                                        <mat-option *ngFor="let item of relation.fromColumnList"
                                                            [value]="item.value">
                                                            {{item.name}} </mat-option>
                                                    </mat-select>
                                                    <label *ngIf="relation.validators.fromColumn" class="required">Column
                                                        required</label>
                                                </mat-form-field>
                                            </div>
                                            <div class="flex-child">
                                                <mat-form-field appearance="fill">
                                                    <mat-select class="form-control" id="Name"
                                                        [(ngModel)]="relation.crossFilteringBehavior"
                                                        placeholder="select to table">
                                                        <mat-option *ngFor="let item of relation.cfbList" [value]="item.value">
                                                            {{item.name}} </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                            <div class="flex-child">
                                                <mat-form-field appearance="fill">
                                                    <mat-select class="form-control" id="Name" [(ngModel)]="relation.toTable"
                                                        placeholder="select to table"
                                                        (selectionChange)="onChangeToTable(i, 'to')">
                                                        <mat-option *ngFor="let item of relation.toTableList"
                                                            [value]="item.value">
                                                            {{item.name}} </mat-option>
                                                    </mat-select>
                                                    <label *ngIf="relation.validators.toTable" class="required">To table
                                                        required</label>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill">
                                                    <mat-select class="form-control" id="Name" [(ngModel)]="relation.toColumn"
                                                        placeholder="select table column">
                                                        <mat-option *ngFor="let item of relation.toColumnList"
                                                            [value]="item.value">
                                                            {{item.name}} </mat-option>
                                                    </mat-select>
                                                    <label *ngIf="relation.validators.toColumn" class="required">Column
                                                        required</label>
                                                </mat-form-field>
                                            </div> -->
                    <!-- <div class="flex-child">
                                                <button mat-button class="dds-icon dds-icon_plus__l__stroke btnn"
                                                    style="color: #fff;font-size: 14px;" (click)="addNewRelation(i)"
                                                    style=" line-height:14px;color: #fff;font-size: 14px;">
                                                </button>
                                            </div> -->

                    <!-- <button mat-button
                        Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  style="width: 40%; height:35px; background-color: #0076A8; color: white;border-radius: 0; "
                        Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  routerLink="/user/admin1/dashboard">Ok</button> -->
                    <!-- &nbsp;
                        Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  &nbsp;-->
                    <!-- </div> -->
                  </div>
                  <div class="popup-footer button-group">
                    <button mat-button (click)="closeRelModal()">Cancel <span
                        class="dds-icon dds-icon_close"></span></button>
                    <button mat-button (click)="saveRelationship()" class="primary">Add <span
                        class="dds-icon dds-icon_arrow_right__s__stroke"></span></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- *ngIf="fileListtt.length > 0"   (change)="isOverride= !isOverride" -->
        <!-- enableOverRideConfirmPopup = true -->
        <div class="button-group">
          <!-- <mat-checkbox [checked]="isOverride" (click)="overrideConfirm()">Override</mat-checkbox> -->
          <ng-container *ngIf="process.powerBiDatasetExists">
            <input type="checkbox" [(ngModel)]="isOverride" (click)="overrideConfirm()" style="margin-right: 10px" />
            <label (click)="overrideConfirm()"
              style="width:auto !important; margin-right:20px; margin-bottom:0px;">Override</label>
          </ng-container>
          <button mat-button class="btnn" (click)="appendDataset()">Append Dataset</button>
          <button mat-button class="btnn" [disabled]="disableRelButton" (click)="openRelModal()"
            style="margin-right:auto !important;">Map Tables</button>

          <button mat-button class="btnn" (click)="changeTabs({ id: 4 }, 'prev')">
            <span class="dds-icon dds-icon_arrow_left__l__stroke" style="margin-right:10px; margin-left:0px;"></span>
            Prev
          </button>
          <!-- <button mat-button class="btnn" (click)="executeProject()">Execute</button> -->
          <!-- <button mat-button class="btnn" (click)="generateScript()">
            Generate Script <span class="dds-icon dds-icon_show__s__stroke"></span>
          </button> -->
          <button mat-button class="btnn" (click)="getViewScript()">
            View Final Script <span class="dds-icon dds-icon_show__s__stroke"></span>
          </button>
          <button mat-button class="btnn" (click)="clickContinue()">
            <!--[disabled]="disableContinueBtn()"    Continue to Power BI  -->
            Click to Continue <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
          </button>
        </div>
      </mat-card>
    </mat-tab>
    <!--DMEnd-->
  </mat-tab-group>

  <!--<mat-card class="main genericSpecificSol" *ngIf="tabGeneric">-->
  <!--<div class="procTabbtn">
            <button mat-button [class.active]="tabGenericInfo" (click)="changetab(1)" [disabled]="isDisabled == 'C'">Generic Solution</button>&nbsp;
            <button mat-button [class.active]="tabClientSpec" (click)="changetab(2)" [disabled]="isDisabled == 'G'">Client
                Specific Solution</button>
        </div>-->
  <!-- (ngSubmit)="GenericSubmit()" -->

  <!--</mat-card>-->
  <!-- <div class="row"> -->
  <!-- routerLink="/user/admin1/solution_data_modeling" -->
  <!-- <div style="color:red">{{errorMsgAP.img}} <br> {{errorMsgAP.generic}}</div> -->
  <!-- <div class="col-sm-12 button-group">

            <button mat-button class="button-add" type="reset" (click)="reset()">Reset <span
                    class="dds-icon dds-icon_arrow_back__l__stroke"></span></button>
            <button mat-button color="primary" class="button-add" type="submit"
                [disabled]="Genericform.pristine && fileForm.pristine && senadded" (click)="addProcessSave()">Save &
                Continue <span class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
            <button mat-button class="button-add" routerLink="/user/admin1/solutionboard/upload-files"
                *ngIf="isNextBtnEnable">Next <span class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
        </div>
    </div> -->
</div>
<!-- <mat-form-field>
    <mat-select placeholder="Toppings" [formControl]="toppings" [(value)]="selectedToppings" multiple>
      <mat-option *ngFor="let topping of toppingList" [value]="topping">{{topping}}</mat-option>
    </mat-select>
  </mat-form-field> -->

<!--- Popups -->
<div *ngIf="ScenarioPopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="min-width: 560px">
      <div class="taxt-header popup-header">
        <h3>New Scenario</h3>
        <button type="button" class="close" aria-label="Close" (click)="closePopup()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form [formGroup]="scenarioForm" (ngSubmit)="onSubmit()">
        <div class="popup-body">
          <div class="input-group">
            <label>Scenario Name</label>
            <input type="text" class="form-control reflect-model" formControlName="name"
              [ngClass]="{ 'is-invalid': submited && scenarioForm.controls['name'].errors }" />
          </div>
          <div class="input-group" style="margin-bottom: 0px">
            <label>Description</label>
            <textarea type="text" class="form-control reflect-model" style="height: 200px" formControlName="description"
              [ngClass]="{ 'is-invalid': submited && scenarioForm.controls['description'].errors }"></textarea>
          </div>
        </div>
        <div class="popup-footer button-block">
          <button mat-button type="button" (click)="closePopup()">
            Cancel <span class="dds-icon dds-icon_close"></span>
          </button>
          <button mat-button type="submit" class="primary">
            Submit
            <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div *ngIf="progressBarPopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <ng-container *ngIf="tabs[1].id == 1 && tabs[1].isActive == true">
          <h3>Uploading File(s)</h3>
        </ng-container>

        <ng-container *ngIf="tabs[3].id == 3 && tabs[3].isActive == true">
          <h3>Appending...</h3>
        </ng-container>
        <ng-container *ngIf="tabs[4].id == 4 && tabs[4].isActive == true">
          <h3>Joining...</h3>
        </ng-container>
        <ng-container *ngIf="tabs[5].id == 5 && tabs[5].isActive == true">
          <h3>Creating Dataset...</h3>
        </ng-container>

        <button class="close" (click)="progressBarPopup = false">
          <span aria-hidden="true">&times;</span></button>
      </div>
      <div class="popup-body">
        <div class="upload">
          <ng-container *ngIf="tabs[1].id == 1 && tabs[1].isActive == true">
            <ng-container *ngFor="let pb of progressBar">
              <div class="file-name-block"><img src="../../../assets/images/Group 4899.svg"> {{pb.file}}
              </div>
              <div class="upload-file-info">
                <label *ngIf="pb.isError == false">{{pb.percentage}}% <ng-container *ngIf="pb.icon"> Success
                    !</ng-container></label>
                <ng-container *ngIf="pb.isError">Failed !</ng-container>
                <div *ngIf="pb.isError" class="ico dds-icon dds-icon_alert__l__stroke"
                  style="color: red !important; margin-left: 84%;"></div>
                <div *ngIf="pb.isError == false && pb.icon" class="completedprogress" style="margin-left: 74%;"></div>
              </div>
              <div class="progress">
                <ng-container *ngIf="pb?.percentage != undefined">
                  <div class="failedprogress-bar" *ngIf="pb.isError" role="progressbar"
                    [style.width]="pb.percentage + '%'" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                  <div class="progress-bar" *ngIf="pb.isError == false" role="progressbar"
                    [style.width]="pb.percentage + '%'" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                </ng-container>
              </div>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="
              (tabs[3].id == 3 && tabs[3].isActive == true) ||
              (tabs[4].id == 4 && tabs[4].isActive == true) ||
              (tabs[5].id == 5 && tabs[5].isActive == true)
            ">
            <div class="progress">
              <ng-container *ngIf="progressBar[0]?.percentage != undefined">
                <div class="progress-bar" role="progressbar" [style.width]="progressBar[0]?.percentage + '%'"
                  aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
              </ng-container>
            </div>
          </ng-container>

          <!-- <span class="dds-icon dds-icon_upload__l__stroke">3 Files (250kb)</span> -->
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="enableAppendNamePopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="min-width: 560px">
      <div class="taxt-header popup-header">
        <h3>Append Files</h3>
      </div>
      <div class="popup-body">
        <form [formGroup]="appendForm">
          <div class="row popup">
            <div class="field">
              <label>Name<sup>*</sup></label>
              <input type="text" formControlName="appendNameControl" (keyup)="isTableExistAppend($event)"
                oninput="this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\..*)\./g, '$1');" [ngClass]="{
                  'is-invalid':
                    submited && appendForm.controls['appendNameControl'].errors
                }" />
            </div>
          </div>
          <div *ngIf="submited" class="error">{{ submittedErrorMsg }}</div>
        </form>
      </div>
      <div class="col-sm-12 popup-footer button-group">
        <button mat-button (click)="enableAppendNamePopup = false">
          Cancel <span class="dds-icon dds-icon_close"></span>
        </button>
        <button mat-button type="submit" (click)="addAppendApi()">
          Submit <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
        </button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="enableDatasetAppendPopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header">
        <h4 style="background-color: #0076A8; color: white; padding: 10px;">DataSet</h4>
      </div>
      <form [formGroup]="datasetAppendForm">
        <div class="row popup">
          <div class=" field">
            <label>Enter DataSet Name<sup>*</sup></label> <!-- existDataset shd work-->
            <input type="text" formControlName="appendNameControl" (keyup)="isTableExistAppend($event)"
              oninput="this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\..*)\./g, '$1');"
              [ngClass]="{ 'is-invalid': submitted && datasetAppendForm.controls['appendNameControl'].errors }">
          </div>
        </div>
        <div *ngIf="submited" class="error">{{submittedErrorMsg}}</div>


        <div class="col-sm-12" style="float: right; text-align: right;">
          <button mat-button style="background-color: #0076A8; color: white;" (click)="appendDatasetApi();">Add</button>
          <button mat-button style="color: #0076A8; background: #fff;"
            (click)="enableDatasetAppendPopup = false;">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>



<div *ngIf="enableDataSetPopUp">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" [ngClass]="DataPopUp?'DataPopUp':''"
      style="min-width: calc(100% - 60px); height: calc(100vh - 60px)">
      <div class="taxt-header popup-header">
        <h3>{{createorEditDatasetText}} Data Set</h3>
        <button class="mat-button" class="user-guide-link" (click)="overlayPopUp()">
          User Guide <span class="dds-icon dds-icon_help__l__stroke"></span>
        </button>
        <button type="button" class="close" (click)="enableDataSetPopUp = false">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body" style="display: block; height: calc(100% - 45px); margin-top: 45px">
        <!-- *ngIf="createExpressionList.length != 0" -->
        <div class="dataset-group">
          <div class="row">
            <div class="col-md-3 combination" [ngClass]="(guidindex==0)?'highlight':''">
              <div class="table-layer2 clbg">
                <div class="combinations-sidebar">
                  <div class="toolbar-block">
                    <div class="search-block">
                      <input type="text" (keyup)="applyFilter($event,'parentInCreateDSPopup')"
                        [value]="searchValueInCreateDSPopup" placeholder="Search" />
                      <button type="submit" class="mat-button">
                        <span class="dds-icon dds-icon_search__s__stroke"></span>
                      </button>
                    </div>
                    <label>All Files</label>
                  </div>
                  <ng-container *ngFor="let tf of sourceFilesAppendJoinFileList">
                    <ng-container *ngIf="tf.fileType == 'append'">
                      <div class="header">
                        <h5 (click)="tf.isExpand = !tf.isExpand">
                          <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                          <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span>Append Files
                        </h5>
                      </div>
                      <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                        style="text-align: center; font-size: 13px"><!--inline-->
                        No files found
                      </div>
                      <ng-container *ngIf="!tf.isExpand">
                        <ng-container *ngIf="tf.sheetList.length != 0">
                          <mat-accordion multi class="mat-table" is-open="true">
                            <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                              (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                              <mat-expansion-panel-header class="mat-row">

                                <label (click)="$event.stopPropagation();" class="dataP"><img
                                    src="../../assets/images/apd-icon.png" width="25" alt=""
                                    style="margin: 0 10px 0 0" />
                                  {{ item.appendName }}</label>

                                <div class="rightIcons1">
                                  <span (click)="previewPopup(item);$event.stopPropagation()" title="preview"
                                    class="dds-icon dds-icon_eyeopen"></span>
                                </div>
                              </mat-expansion-panel-header>

                              <div class="row">
                                <div class="search1 col-md-6 inner-search">
                                  <input id="form1" class="form-control" [value]="item.searchValueInCreateDatasetPopup"
                                    placeholder="Search" (keyup)="
                                    applyFilterForDMTables(
                                      $event,
                                      item,
                                      i,
                                      tf.fileType
                                    )
                                  " />
                                </div>
                              </div>
                              <div class="inner-check-all">
                                <input type="checkbox" title="Select All" class="form-check-input"
                                  [(ngModel)]="item.isSelectAllParentInDM" (change)="
                                  selectAllParentInDM($event, tf.fileType, item)
                                " style="
                                  margin-top: 10px;
                                  margin-bottom: 10px;
                                  height: 18px;
                                  width: 18px;
                                " />&nbsp;
                                <label style="margin-top: 6px">Select All</label>
                              </div>

                              <mat-accordion *ngFor="
                                  let comp of item.tableAppendFieldsDto | searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'append';let j = index;
                                
                                " style="cursor: pointer">
                                <div (click)="
                                    accordionFilesRowClicked(
                                      item,
                                      i,
                                      comp,
                                      j,
                                      'AF'
                                    )
                                  ">
                                  <input type="checkbox" class="form-check-input"
                                    [(ngModel)]="comp.isSelectAllChildInDM" (change)="
                                      selectAllChildInDM(
                                        $event,
                                        tf.fileType,
                                        item,
                                        comp
                                      )
                                    " style="margin: 0 8px 0 0" />
                                  <label>{{ comp.fieldName }}</label>
                                </div>
                              </mat-accordion>

                            </mat-expansion-panel>
                          </mat-accordion>
                        </ng-container>
                      </ng-container>
                    </ng-container>

                    <ng-container *ngIf="tf.fileType == 'join'">
                      <div class="header">
                        <h5 (click)="tf.isExpand = !tf.isExpand">
                          <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                          <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span>Join Files
                        </h5>
                      </div>

                      <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                        style="text-align: center; font-size: 13px">
                        No files found
                      </div>
                      <ng-container *ngIf="!tf.isExpand">
                        <ng-container *ngIf="tf.sheetList.length != 0">
                          <mat-accordion multi class="mat-table" is-open="true">
                            <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                              (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                              <mat-expansion-panel-header class="mat-row">
                                <label (click)="$event.stopPropagation();" class="dataP"><img
                                    src="../../assets/images/jnd-icon.png" width="25" alt=""
                                    style="margin: 0 10px 0 0" />
                                  {{ item.mergeName }}</label>

                                <div class="rightIcons1">
                                  <span (click)="previewPopup(item);$event.stopPropagation()" title="preview"
                                    class="dds-icon dds-icon_eyeopen"></span>
                                </div>
                              </mat-expansion-panel-header>
                              <div class="row">
                                <div class="search1 col-md-6 inner-search">
                                  <input id="form1" class="form-control" [value]="item.searchValueInCreateDatasetPopup"
                                    placeholder="Search" (keyup)="
                                    applyFilterForDMTables(
                                      $event,
                                      item,
                                      i,
                                      tf.fileType
                                    )
                                  " />
                                </div>
                              </div>
                              <div class="inner-check-all">
                                <input type="checkbox" title="Select All" class="form-check-input"
                                  [(ngModel)]="item.isSelectAllParentInDM" (change)="
                                  selectAllParentInDM($event, tf.fileType, item)
                                " style="
                                  margin-top: 10px;
                                  margin-bottom: 10px;
                                  height: 18px;
                                  width: 18px;
                                " />&nbsp;
                                <label style="margin-top: 6px">Select All</label>
                              </div>

                              <mat-accordion class="scroll" *ngFor="
                                  let comp of item.mergeFieldListDTO | searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'join';
                                  let j = index
                                " style="cursor: pointer">
                                <div (click)="
                                    accordionFilesRowClicked(
                                      item,
                                      i,
                                      comp,
                                      j,
                                      'JF'
                                    )
                                  ">
                                  <input type="checkbox" class="form-check-input"
                                    [(ngModel)]="comp.isSelectAllChildInDM" (change)="
                                      selectAllChildInDM(
                                        $event,
                                        tf.fileType,
                                        item,
                                        comp
                                      )
                                    " style="margin: 0 8px 0 0" />
                                  {{ comp.fieldName }}
                                </div>
                              </mat-accordion>

                            </mat-expansion-panel>
                          </mat-accordion>
                        </ng-container>
                      </ng-container>
                    </ng-container>

                    <ng-container *ngIf="tf.fileType == 'files'">
                      <div class="header">
                        <h5 (click)="tf.isExpand = !tf.isExpand">
                          <span *ngIf="tf.isExpand" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                          <span *ngIf="!tf.isExpand" class="dds-icon dds-icon_chevron_up__s__stroke"></span>Source Files
                        </h5>
                      </div>
                      <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                        style="text-align: center; font-size: 13px">
                        No files found
                      </div>
                      <ng-container *ngIf="!tf.isExpand">
                        <ng-container *ngIf="tf.sheetList.length != 0">
                          <mat-accordion multi class="mat-table" is-open="true">
                            <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                              (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                              <mat-expansion-panel-header class="mat-row">
                                <label>
                                  <ng-container *ngIf=" item.fileExt == 'xlsx' ">
                                    <span class="dds-icon dds-icon_file_xls__l__filled xls"></span>
                                  </ng-container>
                                  <ng-container
                                    *ngIf="item.fileExt == 'txt' || item.fileExt == 'csv'|| item.fileExt == 'xls'">
                                    <span class="dds-icon dds-icon_file_{{item.fileExt}}__l__filled"
                                      [ngClass]="item.fileExt"></span>
                                  </ng-container>
                                  <ng-container *ngIf="item.fileExt == 'json'">
                                    <!-- <img src="../../assets/images/Json.svg" alt="" width="25" height="15px"
                                    style="margin: 0 5px 0 0" /> -->
                                    <span class="dds-icon" [ngClass]="item.fileExt"></span>
                                  </ng-container>
                                  <span (click)="$event.stopPropagation();" class="dataP">{{ item.fileName
                                    }}</span></label>

                                <div class="rightIcons1">
                                  <span class="dds-icon dds-icon_eyeopen" title="preview"
                                    (click)="previewPopup(item);$event.stopPropagation()"></span>
                                </div>
                              </mat-expansion-panel-header>
                              <div class="row">
                                <div class="search1 col-md-6 inner-search">
                                  <input id="form1" class="form-control" [value]="item.searchValueInCreateDatasetPopup"
                                    placeholder="Search" (keyup)="
                                    applyFilterForDMTables(
                                      $event,
                                      item,
                                      i,
                                      tf.fileType
                                    )
                                  " />
                                </div>
                              </div>
                              <div class="inner-check-all">
                                <input type="checkbox" title="Select All" class="form-check-input"
                                  [(ngModel)]="item.isSelectAllParentInDM" (change)="
                                  selectAllParentInDM($event, tf.fileType, item)
                                " style="
                                  margin-top: 10px;
                                  margin-bottom: 10px;
                                  height: 18px;
                                  width: 18px;
                                " />&nbsp;
                                <label style="margin-top: 6px">Select All</label>
                              </div>
                              <!-- </div> -->

                              <mat-accordion
                                *ngFor="let comp of item.sheet | searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'files'; let j = index"
                                style="cursor: pointer">
                                <div (click)="
                                    accordionFilesRowClicked(
                                      item,
                                      i,
                                      comp,
                                      j,
                                      'SF'
                                    )
                                  ">
                                  <input type="checkbox" class="form-check-input"
                                    [(ngModel)]="comp.isSelectAllChildInDM" (change)="
                                      selectAllChildInDM(
                                        $event,
                                        tf.fileType,
                                        item,
                                        comp
                                      )
                                    " style="margin: 0 8px 0 0" />
                                  {{ comp.fieldName }}
                                </div>
                              </mat-accordion>

                            </mat-expansion-panel>
                          </mat-accordion>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                  </ng-container>
                  <div class="header">
                    <h5 (click)="isDatasetExpandInCreateDSPopup = !isDatasetExpandInCreateDSPopup">
                      <span *ngIf="isDatasetExpandInCreateDSPopup"
                        class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                      <span *ngIf="!isDatasetExpandInCreateDSPopup"
                        class="dds-icon dds-icon_chevron_up__s__stroke"></span>Dataset Files
                    </h5>
                  </div>
                  <div *ngIf="
                      allDatasetDetailsList?.length == 0 ||
                      allDatasetDetailsList == null
                    " class="mat-table" style="text-align: center; font-size: 13px"><!--inline-->
                    No files found
                  </div>
                  <ng-container *ngIf="!isDatasetExpandInCreateDSPopup">
                    <mat-accordion multi class="mat-table" is-open="true" *ngIf="allDatasetDetailsList?.length != 0">
                      <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                        (closed)="panelOpenState = false" *ngFor="let item of allDatasetDetailsList; let i = index">
                        <!-- (click)="datasetTableExpand(item,i)" -->
                        <mat-expansion-panel-header class="mat-row">
                          <!-- <input type="checkbox" (click)="onCheck(item);$event.stopPropagation()" class="form-check-input"
                            style="margin-right: 8px" /> -->
                          <label class="dataP" (click)="$event.stopPropagation();">{{ item.datasetName }}</label>
                          <!-- <input type="checkbox" class="form-check-input" [(ngModel)]="item.isSelectAllParentInDM" (change)="selectAllParentInDM($event,'dataset', item)" style="margin:0 8px 0 0"> -->
                          <!-- <button class="btn" style="width: 18%" (click)="selectAllInDM('dataset', item)">Select All</button> -->
                          <!-- <img src="../../../assets/images/select-all.svg" alt="" title="Select All" (click)="selectAllInDM('dataset', item)"> -->
                          <div class="rightIcons1" (click)="$event.stopPropagation();">
                            <span class="dds-icon dds-icon_eyeopen" title="View Dataset" title="preview"
                              (click)="previewPopup(item)"></span>
                            <!-- <span class="dds-icon dds-icon_edit__l__stroke" title="Edit Dataset"
                              (click)="editDatasetFile(item)"></span>
                            <span class="dds-icon dds-icon_file" title="View Script"
                              (click)="callGetViewscript(item)"></span>
                            <span (click)="deleteTables($event, item, i, 'dataset')" title="Delete Dataset"
                              class="dds-icon dds-icon_delete__l__stroke"></span> -->
                          </div>
                        </mat-expansion-panel-header>
                        <div class="row">
                          <div class="search1 col-md-6 inner-search">
                            <input id="form1" class="form-control" [value]="item.searchValueInCreateDatasetPopup"
                              placeholder="Search" (keyup)="
                              applyFilterForDMTables($event, item, i, 'dataset')
                            " />
                          </div>
                        </div>
                        <div class="inner-check-all">
                          <input type="checkbox" title="Select All" class="form-check-input"
                            [(ngModel)]="item.isSelectAllParentInDM"
                            (change)="selectAllParentInDM($event, 'dataset', item)" style="
                            margin-top: 10px;
                            margin-bottom: 10px;
                            height: 18px;
                            width: 18px;
                          " />&nbsp;
                          <label style="margin-top: 6px">Select All</label>
                        </div>
                        <!-- </div> -->
                        <mat-accordion *ngFor="
                            let comp of item.datasetFieldDTOList  | searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'dataset';
                            let j = index
                          " style="cursor: pointer">
                          <ng-container *ngIf="!comp.excludeInSelect">
                            <div (click)="
                                accordionFilesRowClicked(item, i, comp, j, 'DS')
                              ">
                              <input type="checkbox" class="form-check-input" [(ngModel)]="comp.isSelectAllChildInDM"
                                (change)="
                                  selectAllChildInDM(
                                    $event,
                                    'dataset',
                                    item,
                                    comp
                                  )
                                " style="margin: 0 8px 0 0" />
                              <label>{{ comp.fieldName }}</label>
                            </div>
                          </ng-container>
                        </mat-accordion>

                      </mat-expansion-panel>
                    </mat-accordion>
                  </ng-container>
                </div>
              </div>
            </div>

            <div class="col-md-9 combination expTable">
              <div class="inner-container">
                <div class="row">
                  <form [formGroup]="datasetForm">
                    <div class="row data-file-inputgroup">
                      <div class="col-md-9" style="padding-left:0px">
                        <div class="field">
                          <label>Enter DataSet Name<sup>*</sup></label>
                          <input type="text" formControlName="appendNameControl" (keyup)="isTableExistAppend($event)"
                            oninput="this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\..*)\./g, '$1');"
                            [ngClass]="{
                              'is-invalid':
                                submited &&
                                datasetForm.controls['appendNameControl'].errors
                            }" />
                        </div>
                        <div *ngIf="submited1" class="error">
                          {{ submittedErrorMsg }}
                        </div>
                      </div>
                      <div class="col-md-3">
                        <label></label>
                        <button mat-button class="columns-button" (click)="addCustomColumn()"
                          [ngClass]="(guidindex==1)?'highlight':''">
                          Add Custom Column
                          <span class="dds-icon dds-icon_plus__l__stroke"></span>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
                <ng-container *ngFor="let obj of datasetDetailsList; let i = index">
                  <ng-container *ngIf="obj.isDatasetTableExpand">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="table-layer">
                          <div class="table-container"
                            style="height:auto; max-height:30vh; border-bottom:1px solid #97999B;">
                            <table class="table table-striped">
                              <thead>
                                <!-- <tr style="background-color: #0076A8">
                                                          <th style="margin:auto;">Dataset Name :&nbsp;{{obj.datasetName}}
                                                          </th>
                                                          <th colspan="1"></th>
                                                          <th class="col-md-3" style="text-align:right;"
                                                              (click)="deleteDataSet(i)">
                                                              <span class="dds-icon dds-icon_close__l__stroke"
                                                                  style="color: #fff;"></span>
                                                          </th>
                                                      </tr> -->
                                <tr>
                                  <th>Column Name</th>
                                  <th>Column Type</th>

                                  <th style="text-align: right">Actions</th>
                                </tr>
                              </thead>
                              <tbody>
                                <ng-container>
                                  <tr *ngFor="
                                    let item of obj.datasetFieldDTOList;
                                    let j = index
                                  ">
                                    <ng-container>
                                      <td [class.active]="item.isEdit" style="width: 1%; border: 0">
                                        {{ item.sourceFieldName }}
                                      </td>
                                      <td [class.active]="item.isEdit" style="width: 1%; border: 0">
                                        {{ item.columnType }}
                                      </td>

                                      <td style="
                                        text-align: right;
                                        width: 1%;
                                        border: 0;
                                      " [class.active]="item.isEdit">
                                        <span (click)="editRowInDataSet(i, j, item)"
                                          class="dds-icon dds-icon_edit__l__stroke"></span>
                                        <span (click)="deleteRowInDataset(i, j, item)"
                                          class="dds-icon dds-icon_delete__l__stroke"></span>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </ng-container>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col-md-12">
                        <form [formGroup]="datasetTableForm">
                          <div class="input-group" style="margin-bottom: 0px" [ngClass]="(guidindex==2)?'highlight':''">
                            <label class="border-bottom">Where Criteria:</label>
                            <div formArrayName="where">
                              <div *ngFor="let itemm of whereArrInDS().controls;let j = index;let last =last"
                                [formGroupName]="j">
                                <div class="addRow row">
                                  <!--opearator-->
                                  <ng-container *ngIf="j != 0">
                                    <mat-form-field appearance="fill" class="col-md-3">
                                      <mat-select class="form-control" placeholder="Select AND/OR"
                                        formControlName="operator">
                                        <mat-option *ngFor="
                                            let opearator of opearatorList
                                          " [value]="opearator.value">
                                          {{ opearator.value }}</mat-option>
                                      </mat-select>
                                      <button *ngIf="itemm.get('operator')?.value" matSuffix mat-icon-button
                                        type="button" aria-label="Clear"
                                        (click)="itemm.get('operator')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                      </button>
                                    </mat-form-field>
                                  </ng-container>
                                  <!--column-->
                                  <mat-form-field appearance="fill" class="col-md-3">
                                    <!--[value]="whereObj.signOperator" -->
                                    <mat-select class="form-control" placeholder="Select Column" #matSelect
                                      title="{{ matSelect.triggerValue }}"
                                      (closed)="closeDropdown(0,0, j, 'where', 'column')" (selectionChange)="
                                        changeColumnInDSForWhere(
                                          $event,
                                          j,
                                          i,
                                          itemm
                                        )
                                      " formControlName="column">
                                      <input type="text" placeholder="search" formControlName="columnSearch" />
                                      <mat-option *ngFor="
                                          let columnObj of columnsForWhereInDS 
                                          | searchFilter: { tableNameUI: itemm.get('columnSearch')?.value }
                                          : 'Where'
                                          : 'columnSearch'
                                        " title="{{ columnObj.filefieldName }}" [value]="columnObj">
                                        {{
                                        columnObj.filefieldName
                                        }}</mat-option>
                                    </mat-select>
                                    <button *ngIf="itemm.get('column')?.value" matSuffix mat-icon-button type="button"
                                      aria-label="Clear"
                                      (click)="itemm.get('column')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                    </button>
                                  </mat-form-field>

                                  <!--sign operator-->
                                  <!-- (selectionChange)="changeSignOperator($event,j,'',i,item,'child')"> -->
                                  <mat-form-field appearance="fill" class="col-md-3">
                                    <mat-select class="form-control" placeholder="Select Operator"
                                      (selectionChange)="changeOperatorInDSForWhere($event,j,i, itemm)"
                                      formControlName="signOperator">
                                      <ng-container *ngIf="
                                          signOperatorWhereInDS.length != 0
                                        ">
                                        <mat-option *ngFor="
                                            let signOpearatorObj of signOperatorWhereInDS[j]
                                          " [value]="signOpearatorObj">{{ signOpearatorObj }}
                                        </mat-option>
                                      </ng-container>
                                    </mat-select>
                                    <button *ngIf="itemm.get('signOperator')?.value" matSuffix mat-icon-button
                                      type="button" aria-label="Clear"
                                      (click)="itemm.get('signOperator')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                    </button>
                                  </mat-form-field>
                                  <!--value-->
                                  <ng-container *ngIf="hasValueCOlumnAt(j)">
                                    <div class="col-md-3">
                                      <input placeholder="Value" formControlName="value" class="form-control" />
                                      <!-- <button *ngIf="itemm.get('value')?.value"
                                          matSuffix
                                          mat-icon-button
                                          type="button"
                                          aria-label="Clear"
                                          (click)="itemm.get('value')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                        </button> -->
                                      <!-- (click)="delOpearatorValueFields(j,'',i,item)" -->
                                    </div>
                                  </ng-container>
                                  <div class="col-md-3">
                                    <ng-container *ngIf="last">
                                      <span (click)="
                                          addOpearatorValueFieldsInDS(j, itemm)
                                        " class="dds-icon dds-icon_plus__l__stroke no-height"></span>
                                    </ng-container>
                                    <ng-container *ngIf="!last">
                                      <span (click)="
                                          delOpearatorValueFieldsInDS(j, itemm)
                                        " class="dds-icon dds-icon_delete__l__stroke no-height"></span>
                                    </ng-container>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="row" [ngClass]="(guidindex==3)?'highlight':''">
                            <!--groupby-->
                            <div class="col-md-3">
                              <label>Group By</label>
                              <mat-form-field appearance="fill">
                                <mat-select multiple class="form-control" placeholder="Select groupBy" #matSelect
                                  (closed)="closeDropdown(0,0, 0, 'where', 'groupBy')"
                                  title="{{ matSelect.triggerValue }}" formControlName="groupBy" (selectionChange)="
                                    selectgroupByOrderByInDM(
                                      $event,
                                      obj,
                                      i,
                                      'groupby'
                                    )
                                  ">
                                  <mat-checkbox (change)="toggleAllSelection($event)">Select All</mat-checkbox>

                                  <input type="text" placeholder="search" formControlName="groupBySearch" />
                                  <mat-option *ngFor="let obObj of obj.groupBytoDB 
                                  | searchFilter: { tableNameUI: datasetTableForm.get('groupBySearch')?.value }
                                  : 'Where'
                                  : 'groupBy'" title="{{ obObj.filefieldName }}" [value]="obObj.dbtablefieldName">
                                    {{ obObj.filefieldName }}
                                  </mat-option>
                                </mat-select>
                                <button *ngIf="datasetTableForm.get('groupBy')?.value != ''" matSuffix mat-icon-button
                                  type="button" aria-label="Clear"
                                  (click)="datasetTableForm.get('groupBy')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                </button>
                              </mat-form-field>
                            </div>
                            <!--having-->
                            <div class="col-md-3">
                              <label>Having</label>
                              <input matInput formControlName="having" placeholder="Having" class="form-control" />
                              <!-- <button *ngIf="datasetTableForm.get('having')?.value != ''"
                                          matSuffix
                                          mat-icon-button
                                          type="button"
                                          aria-label="Clear"
                                          (click)="datasetTableForm.get('having')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                        </button> -->
                            </div>
                            <!--orderby-->
                            <div class="col-md-3">
                              <label>Order By</label>
                              <mat-form-field appearance="fill">
                                <mat-select multiple class="form-control" placeholder="Select orderBy" #matSelect
                                  (closed)="closeDropdown(0,0, 0, 'where', 'orderBy')"
                                  title="{{ matSelect.triggerValue }}" formControlName="orderBy" (selectionChange)="
                                    selectgroupByOrderByInDM(
                                      $event,
                                      obj,
                                      i,
                                      'orderby'
                                    )
                                  ">
                                  <input type="text" placeholder="search" formControlName="orderBySearch" />
                                  <mat-option *ngFor="let gbObj of obj.orderBytoDB 
                                  | searchFilter: { tableNameUI: datasetTableForm.get('orderBySearch')?.value }
                                  : 'Where'
                                  : 'orderBy'" title="{{ gbObj.filefieldName }}" [value]="gbObj.dbtablefieldName">
                                    {{ gbObj.filefieldName }}
                                  </mat-option>
                                </mat-select>
                                <button *ngIf="datasetTableForm.get('orderBy')?.value != ''" matSuffix mat-icon-button
                                  type="button" aria-label="Clear"
                                  (click)="datasetTableForm.get('orderBy')?.setValue(''); $event.stopPropagation()"><mat-icon>close</mat-icon>
                                </button>
                              </mat-form-field>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>

                    <!-- <button mat-button class="btnn" (click)="saveDataSet(obj,i)" style="float:right ;">Save Dataset</button> -->
                    <div class="popup-footer button-block">
                      <button mat-button (click)="enableDataSetPopUp = false">
                        Cancel <span class="dds-icon dds-icon_close"></span>
                      </button>
                      <button mat-button (click)="submitDataset(obj, i)" class="primary">
                        Submit
                        <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
                      </button>
                    </div>
                  </ng-container>

                </ng-container>
              </div>
            </div>
          </div>
        </div>
        <!--------Custom Popup-------->
        <div *ngIf="guid">
          <div class="custom-popup"
            [ngClass]="[DataPopUp?'DataModel':'', (guidindex==0)?'step1': (guidindex==1)?'step2': (guidindex==2)?'step3': (guidindex==3)?'step4':'']">
            <div class="custom-popup-container">
              <mat-tab-group [selectedIndex]="guidindex">
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="number" [ngClass]="guidindex>0?'completed':''" (click)="nextguid(0)">1</span>
                  </ng-template>
                  <div>
                    <h3>Select Column/file</h3>
                    <p>To add columns to the Datafile, click on the columns from any table or double click the table to
                      add entire table columns</p>
                    <div class="custom-popup-footer button-group">
                      <button mat-button (click)="nextguid(4)">Skip <mat-icon>last_page</mat-icon></button>
                      <button mat-button class="primary" (click)="nextguid(1)">Next <span
                          class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
                    </div>
                  </div>
                </mat-tab>
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="number" [ngClass]="guidindex>1?'completed':''" (click)="nextguid(1)">1</span>
                  </ng-template>
                  <div>
                    <h3>
                      Add Custom Column
                    </h3>
                    <p>
                      Click on it,to create a new/custom column
                    </p>
                    <div class="custom-popup-footer button-group">
                      <button mat-button (click)="nextguid(4)">Skip <mat-icon>last_page</mat-icon></button>
                      <button mat-button class="primary" (click)="nextguid(2)">Next <span
                          class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
                    </div>
                  </div>

                </mat-tab>
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="number" [ngClass]="guidindex>2?'completed':''" (click)="nextguid(2)">1</span>
                  </ng-template>
                  <div>
                    <h3>
                      Where Criteria
                    </h3>
                    <p>
                      Use Where criteria to filter the data in Datafile, click on plus icon to add more conditions.
                    </p>
                    <div class="custom-popup-footer button-group">
                      <button mat-button (click)="nextguid(4)">Skip <mat-icon>last_page</mat-icon></button>
                      <button mat-button class="primary" (click)="nextguid(3)">Next <span
                          class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
                    </div>
                  </div>
                </mat-tab>
                <mat-tab>
                  <ng-template mat-tab-label>
                    <span class="number" (click)="nextguid(3)">1</span>
                  </ng-template>
                  <div>
                    <h3>
                      Group By & Order By
                    </h3>
                    <p>
                      In the 'Group By' field ,select the columns to apply the group by, To apply any aggregate
                      function, use
                      the 'Having clause' To sort the data, select the columns in the 'Order By' field
                    </p>
                    <div class="custom-popup-footer button-group">
                      <button mat-button (click)="nextguid(0)">Replay <span
                          class="dds-icon dds-icon_arrow_rotate_right__s__stroke"></span></button>
                      <button mat-button class="primary" (click)="nextguid(4)">Done <span
                          class="dds-icon dds-icon_arrow_right__l__stroke"></span></button>
                    </div>
                  </div>
                </mat-tab>
              </mat-tab-group>

            </div>
          </div>
        </div>
      </div>
      <!-- <div class="popup-footer button-block">
                <button mat-button (click)="enableDataSetPopUp = false;">Cancel <span
                        class="dds-icon dds-icon_close"></span></button>
                <button mat-button (click)="submitDataset();" class="primary">Submit <span
                        class="dds-icon dds-icon_arrow_right__s__stroke"></span></button>
            </div> -->
    </div>
  </div>
</div>

<!--save dataset dropdowns popup-->
<div *ngIf="saveDataSetPopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="min-width: 1165px">
      <div class="taxt-header popup-header">
        <h3>Save Dataset</h3>
        <button class="close" (click)="closeDatasetPopup()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>


      <form [formGroup]="dataSetForm">
        <div class="popup-body">
          <div class="popup" formArrayName="DSetRows" style="margin-top: 10px">
            <div class="join-name-group" style="padding-bottom:0px;">
              <ng-container *ngFor="let dataset of DataSetArr().controls; let i = index" [formGroupName]="i">
                <!-- <ng-container *ngFor="let dataset of dataSetForm.get('DSetRows').controls ;let i=index;" [formGroupName]="i"> -->
                <div class="join-new-form" style="padding-right:20px;">
                  <div class="row">
                    <mat-form-field appearance="fill" class="col-md-4">
                      <mat-select class="form-control" [placeholder]="placetable" formControlName="Ptable" [ngClass]="{
                        'is-invalid': submitedDS && dataset.get('Ptable')?.errors
                      }" (closed)="closeDropdown(0,0, i, 'dataset', 'pt')"
                        (selectionChange)="selectPrimaryTableInDS($event, i)">
                        <input type="text" placeholder="search" [value]="dataSetData[i].searchValuePT"
                          (keyup)="searchField($event,0, 0, i, 'dataset', 'pt')" />
                        <ng-container *ngFor="
                          let data of dataSetData[i]?.primaryTableList
                            | searchFilter
                              : { tableNameUI: dataSetData[i].searchValuePT }
                              : 'dataset'
                              : 'pt'
                        ">
                          <mat-option [value]="data">
                            {{ data.tableNameUI }}
                          </mat-option>
                        </ng-container>
                      </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="fill" class="col-md-3">
                      <mat-select class="form-control" placeholder="Join Type" formControlName="join" [ngClass]="{
                        'is-invalid': submitedDS && dataset.get('join')?.errors
                      }" (selectionChange)="selectJoinTypeInDS($event, i)">
                        <ng-container *ngFor="let data of joinType">
                          <mat-option [value]="data">
                            {{ data }}
                          </mat-option>
                        </ng-container>
                      </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="fill" class="col-md-4">
                      <mat-select class="form-control" placeholder="Foreign Table" formControlName="Ftable" [ngClass]="{
                        'is-invalid': submitedDS && dataset.get('Ftable')?.errors
                      }" (selectionChange)="selectForeignTableInDS($event, i)"
                        (closed)="closeDropdown(0, 0, i, 'dataset', 'ft')">
                        <!-- <input type="text" [ngModelOptions]="{standalone: true}" placeholder="search"
                                            [(ngModel)]="ft"  /> -->
                        <input type="text" placeholder="search" [value]="dataSetData[i].searchValueFT"
                          (keyup)="searchField($event, 0,0, i, 'dataset', 'ft')" />
                        <ng-container *ngFor="
                          let data of dataSetData[i]?.foreignTableList
                            | searchFilter
                              : { tableNameUI: dataSetData[i].searchValueFT }
                              : 'dataset'
                              : 'ft'
                        ">
                          <mat-option [value]="data">
                            {{ data.tableNameUI }}
                          </mat-option>
                        </ng-container>
                      </mat-select>
                    </mat-form-field>
                    <div class="col-md-1"></div>

                  </div>
                  <ng-container formArrayName="columns">
                    <ng-container
                      *ngFor="let item of columnArrInDS(i).controls; let j = index; let isFirst=first;let isLast=last"
                      [formGroupName]="j">
                      <div class="row">
                        <!-- //childArray                                 -->
                        <!-- <div class="col-md-2"></div>  -->
                        <div class="col-md-4">
                          <mat-form-field appearance="fill">
                            <mat-select class="form-control" placeholder="Select Column"
                              (selectionChange)="selectPrimaryKeyInDS($event, j, i)" [ngClass]="{
                              'is-invalid':
                                submitedDS && item.get('column1')?.errors
                            }" (closed)="closeDropdown(0,j, i, 'dataset', 'pk')" formControlName="column1">
                              <input type="text" placeholder="search" [value]="
                                dataSetData[i].columns[j].searchValuePK
                              " (keyup)="searchField($event,0, j, i, 'dataset', 'pk')" />

                              <mat-option *ngFor="
                                let item of dataSetData[i]?.columns[j]
                                  ?.primaryKeyList
                                  | searchFilter: { fieldName: dataSetData[i].columns[j].searchValuePK} : 'dataset' : 'pk'
                              " [value]="item">
                                {{ item.fieldName }}
                              </mat-option>
                            </mat-select>
                          </mat-form-field>
                        </div>
                        <div class="col-md-3"></div>
                        <div class="col-md-4">
                          <mat-form-field appearance="fill">
                            <mat-select class="form-control" placeholder="Select Column"
                              (selectionChange)="selectForeignKeyInDS($event, j, i)" [ngClass]="{
                              'is-invalid':
                                submitedDS && item.get('column2')?.errors
                            }" (closed)="closeDropdown(0,j, i, 'dataset', 'fk')" formControlName="column2">
                              <input type="text" placeholder="search" [value]="
                                dataSetData[i].columns[j].searchValueFK
                              " (keyup)="searchField($event,0, j, i, 'dataset', 'fk')" />

                              <ng-container *ngIf="
                                dataSetData[i]?.foreignTableList != undefined
                              ">
                                <mat-option selectForeignKeyInDS *ngFor="
                                  let item of dataSetData[i]?.columns[j]
                                    ?.foreignKeyList
                                    | searchFilter
                                      : {
                                          fieldName:
                                            dataSetData[i].columns[j]
                                              .searchValueFK
                                        }
                                      : 'dataset'
                                      : 'fk'
                                " [value]="item">
                                  {{ item.fieldName }}
                                </mat-option>
                              </ng-container>
                            </mat-select>
                          </mat-form-field>
                        </div>
                        <div class="col-md-1">
                          <button mat-button class="dds-icon dds-icon_plus__l__stroke btnn"
                            (click)="addcolumnRowInDS(j, i)" *ngIf="isLast">
                          </button>
                          <button mat-button class="dds-icon dds-icon_delete__l__stroke btnn" *ngIf="!isLast"
                            (click)="deletecolumnRowInDS(j, i)"></button>
                        </div>
                      </div>
                    </ng-container>
                  </ng-container>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
        <div class="popup-footer button-group">
          <button mat-button class="primary" (click)="saveDataSetDropdowns()">
            Save <mat-icon>save</mat-icon>
          </button>
        </div>
      </form>


    </div>
  </div>
</div>

<div *ngIf="enableMergeNamePopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="width: 1165px !important">
      <div class="taxt-header popup-header">
        <h3>Join Files</h3>
        <button type="button" class="close" aria-label="Close" (click)="joinCancelBtn()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <form [formGroup]="joinForm">
          <div class="row popup">
            <div class="field col-md-6">
              <label>Join Name<sup>*</sup></label>
              <input type="text" formControlName="appendNameControl" (keyup)="isTableExistAppend($event)"
                oninput="this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\..*)\./g, '$1');" [ngClass]="{
                  'is-invalid':
                    submited && joinForm.controls['appendNameControl'].errors
                }" />
            </div>
            <div *ngIf="submited" class="error">{{ submittedErrorMsg }}</div>

          </div>
        </form>

        <div *ngIf="joinCheckedList.length != 0">
          <form [formGroup]="joinSetForm">
            <div formArrayName="Merg">
              <div *ngFor="let merg of MergeArr().controls; let i = index" [formGroupName]="i">
                <!-- <div class="" style="padding: 7px;">Join Table Name :
                                {{joinCheckedList[i].joinName}}
                            </div> -->
                <div class="join-scroll">
                  <div formArrayName="tableControl" class="join-name-group">
                    <div *ngFor="let table of TableArr(i).controls; let j = index" [formGroupName]="j">
                      <div class="join-new-form">
                        <div class="row">
                          <div class="col-md-4">
                            <label>Primary Table</label>

                            <mat-form-field appearance="fill">
                              <mat-select class="form-control" [placeholder]="placetable" formControlName="table1"
                                [ngClass]="{
                                  'is-invalid':
                                    submitedJ && table.get('table1')?.errors
                                }" (selectionChange)="selectPrimaryTable($event, j, i)"
                                (closed)="closeDropdown(0,j, i, 'join', 'pt')">
                                <input type="text" placeholder="search"
                                  [value]="joinCheckedList[i]?.dropDownList[j].searchValuePT"
                                  (keyup)="searchField($event,0, j, i, 'join', 'pt')" />
                                <ng-container *ngFor="
                                    let data of joinCheckedList[i]?.dropDownList[j].primaryTableList | searchFilter : { tableNameUI: joinCheckedList[i]?.dropDownList[j].searchValuePT }: 'join': 'pt'
                                  ">
                                  <mat-option [value]="data">
                                    {{ data.tableNameUI }}
                                  </mat-option>
                                </ng-container>
                              </mat-select>
                            </mat-form-field>
                          </div>
                          <div class="col-md-3">
                            <label>Join Type</label>

                            <mat-form-field appearance="fill">
                              <mat-select class="form-control" placeholder="Select Join"
                                (selectionChange)="selectJoin($event, j, i)" [ngClass]="{
                                  'is-invalid':
                                    submitedJ && table.get('join')?.errors
                                }" formControlName="join">
                                <mat-option *ngFor="let value of joinType" [value]="value">
                                  {{ value }}
                                </mat-option>
                              </mat-select>
                            </mat-form-field>
                          </div>
                          <div class="col-md-4">
                            <label>Secondary Table</label>
                            <mat-form-field appearance="fill">
                              <mat-select class="form-control" placeholder="Select Foreign Table"
                                formControlName="table2" [ngClass]="{
                                  'is-invalid':
                                    submitedJ && table.get('table2')?.errors
                                }" (selectionChange)="
                                  selectForeignTable($event, j, i)" (closed)="closeDropdown(0,j, i, 'join', 'ft')">

                                <input type="text" placeholder="search"
                                  [value]="joinCheckedList[i]?.dropDownList[j].searchValueFT"
                                  (keyup)="searchField($event,0, j, i, 'join', 'ft')" />
                                <ng-container
                                  *ngFor="
                                    let dataa of joinCheckedList[i]?.dropDownList[j].foreignTableList | searchFilter : { tableNameUI: joinCheckedList[i]?.dropDownList[j].searchValueFT }: 'join': 'ft' ">
                                  <mat-option [value]="dataa">{{ dataa.tableNameUI }}
                                  </mat-option>
                                </ng-container>
                              </mat-select>
                            </mat-form-field>
                          </div>
                          <div class="col-md-1">
                            <label></label>

                            <button maformGroupt-button
                              class="dds-icon dds-icon_delete__l__stroke btnn delete-column-block" *ngIf="j != 0"
                              (click)="removeTable(i, j)" title="Table Delete"></button>
                          </div>
                        </div>

                        <div formArrayName="column" class="append-columns">
                          <div *ngFor="
                              let item of columnArr(i, j).controls;
                              let k = index;
                              let isLast=last;
                            " [formGroupName]="k">
                            <div class="row">
                              <div class="col-md-4">
                                <label>Column</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" placeholder="Select Column" formControlName="column1"
                                    [ngClass]="{
                                      'is-invalid':
                                        submitedJ && item.get('column1')?.errors
                                    }" (selectionChange)="
                                      selectPrimarykey($event, k, j, i)"
                                    (closed)="closeDropdown(k,j, i, 'join', 'pk')">
                                    <input type="text" placeholder="search"
                                      [value]="joinCheckedList[i]?.dropDownList[j]?.columns[k]?.searchValuePK"
                                      (keyup)="searchField($event,k, j, i, 'join', 'pk')" />
                                    <mat-option *ngFor="
                                        let item of joinCheckedList[i]?.dropDownList[j]?.columns[k]?.primaryKeyList | searchFilter : { fieldName: joinCheckedList[i]?.dropDownList[j].columns[k].searchValuePK }: 'join': 'pk'
                                      " [value]="item">
                                      {{ item.fieldName }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
                              </div>
                              <div class="col-md-3"></div>
                              <div class="col-md-4">
                                <label>Column</label>
                                <mat-form-field appearance="fill">
                                  <mat-select class="form-control" placeholder="Select Column" formControlName="column2"
                                    [ngClass]="{
                                      'is-invalid':
                                        submitedJ && item.get('column2')?.errors
                                    }" (selectionChange)="
                                      selectForeignKey($event, k, j, i)"
                                    (closed)="closeDropdown(k,j, i, 'join', 'fk')">
                                    <input type="text" placeholder="search"
                                      [value]="joinCheckedList[i]?.dropDownList[j]?.columns[k]?.searchValueFK"
                                      (keyup)="searchField($event,k, j, i, 'join', 'fk')" />
                                    <mat-option *ngFor="
                                        let item of joinCheckedList[i]
                                          ?.dropDownList[j]?.columns[k]
                                          ?.foreignKeyList | searchFilter : { fieldName: joinCheckedList[i]?.dropDownList[j].columns[k].searchValueFK }: 'join': 'fk'
                                      " [value]="item">
                                      {{ item.fieldName }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
                              </div>
                              <div class="col-md-1">
                                <label></label>
                                <button mat-button class="dds-icon dds-icon_plus__l__stroke btnn"
                                  style="color: #fff; font-size: 14px" (click)="addColumnJoin(i, j)" *ngIf="isLast"
                                  title="Column"></button>
                                <button mat-button class="dds-icon dds-icon_delete__l__stroke btnn"
                                  style="color: #fff; font-size: 14px" *ngIf="!isLast" (click)="removeCol(i, j, k)"
                                  title="Column Delete"></button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <button mat-button class="add-table-button" (click)="addTableJoins(i, j)"
                        [disabled]="joinCheckedList[i]?.allTablesSelected" *ngIf="j == 0" title="Table">
                        Add Table
                        <span class="dds-icon dds-icon_plus__l__stroke btnn"></span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>

      <div class="col-sm-12 popup-footer button-group">
        <button mat-button (click)="joinCancelBtn()">
          Cancel <span class="dds-icon dds-icon_close"></span>
        </button>
        <button mat-button (click)="addJoin()" class="primary">
          Submit <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
        </button>
      </div>
    </div>
  </div>
</div>

<!--add custom column-->
<div *ngIf="enableCreateExpression">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup popup" style="min-width: 642px">
      <div class="popup-header">
        <h3>{{add_editCustomColumnNameInPopupInDM}} Custom Column and Expression</h3>
        <button (click)="closeCreateExpressionPopup()" type="button" class="close" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <form [formGroup]="createExpressionForm">
        <div class="createExpressionList-form" *ngFor="let item of createExpressionList; let i = index">
          <div class="popup-body">
            <div class="row">
              <div class="col-md-7">
                <label>Column Name</label>
                <input (select)="inputInCreateExpression($event, i)" (click)="inputInCreateExpression($event, i)"
                  formControlName="sourceFieldName" [ngClass]="{
                    'is-invalid':
                      submited1 &&
                      createExpressionForm.controls['sourceFieldName'].errors
                  }" oninput="this.value = this.value.replace(/[^0-9a-zA-Z_ ]/g, '').replace(/(\..*)\./g, '$1');"
                  (keyup)="inputInCreateExpression($event, i)" [value]="item.sourceFieldName" placeholder="Column Name"
                  class="form-control" />
              </div>
              <div class="col-md-5">
                <label></label>
                <div class="flex-list">
                  <input type="checkbox" formControlName="excludeInSelect" name="where" />
                  <label>Exclude in select</label>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <label>Column Type</label>
                <mat-form-field appearance="fill" class="">
                  <mat-select class="form-control" placeholder="Select DataType" [value]="item.columnType"
                    formControlName="columnType" [ngClass]="{
                      'is-invalid':
                        submited1 &&
                        createExpressionForm.controls['columnType'].errors
                    }" (selectionChange)="changeDTinCreateExpression($event, i)"
                    [disabled]="createExpressionForm.controls.sourceFieldName.value.includes('[')">
                    <mat-option *ngFor="let dt of getOpearatorList" [value]="dt.operatorType">
                      {{ dt.operatorType }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-md-6" *ngIf="item.isColumnType">
                <ng-container>
                  <label>Date</label>
                  <mat-form-field appearance="fill" class="">
                    <mat-select class="form-control" placeholder="Select DateFormat" formControlName="columnFormat">
                      <mat-option *ngFor="let dt of dateTimeFormats" [value]="dt">
                        {{ dt }}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ng-container>
              </div>
            </div>

            <div class="row">
              <div class="col-md-9">
                <label>Expression</label>
                <textarea cols="20" rows="10" placeholder="Expression" formControlName="sourceExpressionName" [ngClass]="{
                    'is-invalid':
                      submited1 &&
                      createExpressionForm.controls['sourceExpressionName']
                        .errors
                  }" (select)="textAreaInCreateExpression($event, i)" (click)="textAreaInCreateExpression($event, i)"
                  (keyup)="textAreaInCreateExpression($event, i)" name="Expression" class="form-control"
                  [value]="item.expression" id="">
                </textarea>
              </div>
              <div class="dropdown col-md-3">
                <label></label>
                <div class="button-set" id="toggleButton" #toggleButton>
                  <button mat-button class="functions-button" (click)="functionClick()">
                    <img src="../../assets/images/fletter.svg" width="18px" alt="" />unctions
                  </button>

                </div>

                <div class="dropdown-content scroll" *ngIf="functionClicked" id="menu" #menu>
                  <!-- <button class="close"><span class="report-modal-close dds-icon dds-icon_close__l__stroke"></span></button> -->
                  <div class="search">
                    <input id="form1" class="form-control" placeholder="Search" (keyup)="applyFilter($event,'fx')" />
                    <span class="dds-icon dds-icon_search__l__stroke icons"></span>
                  </div>
                  <!-- <mat-accordion multi class="mat-table" is-open="true"> -->
                  <!-- <mat-expansion-panel *ngFor="let item of searchfx"> -->
                  <!-- <mat-expansion-panel-header class="mat-row">
                        {{ item.functionName }}
                      </mat-expansion-panel-header> -->
                  <!-- <mat-accordion *ngFor="let comp of item.funcDescritptionsList" style="
                          border-bottom: 1px solid #000;
                          border-radius: 0;
                          padding: 0;
                        "> -->
                  <ul class="functions-list">
                    <ng-container *ngFor="let item of searchfx">
                      <li>
                        <div title="{{item.description}}" (click)="accordionExpValue(item, item.Component)">
                          {{ item.functionName }}
                        </div>
                      </li>
                    </ng-container>
                  </ul>
                  <!-- </mat-accordion> -->
                  <!-- </mat-expansion-panel> -->
                  <!-- </mat-accordion> -->
                </div>
                <!-- </ng-container> -->
                <div class="button-set">
                  <button mat-button type="buttion" (click)="columnClick()">Column</button>
                  <div class="dropdown-content drop-column scroll" *ngIf="columnClicked">
                    <div class="toolbar-block">
                      <div class="search-block">
                        <input type="text" (keyup)="applyFilter($event,'parentInColumnPopup')"
                          [value]="searchValueInColumnPopup" placeholder="Search" />
                        <button type="submit" class="mat-button">
                          <span class="dds-icon dds-icon_search__s__stroke"></span>
                        </button>
                      </div>
                    </div>
                    <ng-container *ngFor="let tf of sourceFilesAppendJoinFileList2 ">
                      <ng-container *ngIf="tf.fileType == 'append'">
                        <div class="header">
                          <h5 (click)="tf.isExpandInColumn = !tf.isExpandInColumn">
                            <span *ngIf="tf.isExpandInColumn" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                            <span *ngIf="!tf.isExpandInColumn"
                              class="dds-icon dds-icon_chevron_up__s__stroke"></span>Append
                            Files
                          </h5>
                        </div>
                        <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                          style="text-align: center; font-size: 13px">
                          No files found
                        </div>
                        <ng-container *ngIf="!tf.isExpandInColumn">
                          <ng-container *ngIf="tf.sheetList.length != 0">
                            <mat-accordion multi class="" is-open="true">
                              <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                                <mat-expansion-panel-header class="">
                                  <label (click)="$event.stopPropagation();" class=""><img
                                      src="../../assets/images/apd-icon.png" alt="" style="margin: 0 10px 0 0" /> {{
                                    item.appendName }}</label>
                                </mat-expansion-panel-header>

                                <div class="row">
                                  <div class="search1 col-md-6 inner-search">
                                    <input id="form1" class="form-control"
                                      (keyup)="applyFilterForDMTables($event,item,i,tf.fileType)"
                                      [value]="item.searchValueInColumnPopup" placeholder="Search" />
                                  </div>
                                </div>
                                <mat-accordion
                                  *ngFor="
                                let comp of item.tableAppendFieldsDto | searchFilter  : { tableNameUI: item.searchValueInColumnPopup } : 'createDSpopup' : 'append';let j = index"
                                  style="cursor: pointer">
                                  <div (click)="accordionFilesRowClicked( item, i,comp, j,'AF') ">
                                    <label>{{ comp.fieldName }}</label>
                                  </div>
                                </mat-accordion>
                              </mat-expansion-panel>
                            </mat-accordion>
                          </ng-container>
                        </ng-container>
                      </ng-container>

                      <ng-container *ngIf="tf.fileType == 'join'">
                        <div class="header">
                          <h5 (click)="tf.isExpandInColumn = !tf.isExpandInColumn">
                            <span *ngIf="tf.isExpandInColumn" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                            <span *ngIf="!tf.isExpandInColumn"
                              class="dds-icon dds-icon_chevron_up__s__stroke"></span>Join Files
                          </h5>
                        </div>

                        <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                          style="text-align: center; font-size: 13px">
                          No files found
                        </div>
                        <ng-container *ngIf="!tf.isExpandInColumn">
                          <ng-container *ngIf="tf.sheetList.length != 0">
                            <mat-accordion multi class="" is-open="true">
                              <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                                <mat-expansion-panel-header class="">
                                  <label (click)="$event.stopPropagation();" class=""><img
                                      src="../../assets/images/jnd-icon.png" alt="" style="margin: 0 10px 0 0" /> {{
                                    item.mergeName }}</label>
                                </mat-expansion-panel-header>
                                <div class="row">
                                  <div class="search1 col-md-6 inner-search">
                                    <input id="form1" class="form-control"
                                      (keyup)="applyFilterForDMTables($event,item,i,tf.fileType)"
                                      [value]="item.searchValueInColumnPopup" value="" placeholder="Search" />
                                  </div>
                                </div>

                                <mat-accordion class=""
                                  *ngFor="
                                let comp of item.mergeFieldListDTO  | searchFilter  : { tableNameUI: item.searchValueInColumnPopup } : 'createDSpopup' : 'join';let j = index"
                                  style="cursor: pointer">
                                  <div (click)="accordionFilesRowClicked( item,i,comp,  j, 'JF' )">
                                    <label>{{ comp.fieldName }}</label>
                                  </div>
                                </mat-accordion>
                              </mat-expansion-panel>
                            </mat-accordion>
                          </ng-container>
                        </ng-container>
                      </ng-container>

                      <ng-container *ngIf="tf.fileType == 'files'">
                        <div class="header">
                          <h5 (click)="tf.isExpandInColumn = !tf.isExpandInColumn">
                            <span *ngIf="tf.isExpandInColumn" class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                            <span *ngIf="!tf.isExpandInColumn"
                              class="dds-icon dds-icon_chevron_up__s__stroke"></span>Source Files
                          </h5>
                        </div>
                        <div *ngIf="tf.sheetList.length == 0" class="mat-table empty-records"
                          style="text-align: center; font-size: 13px">
                          No files found
                        </div>
                        <ng-container *ngIf="!tf.isExpandInColumn">
                          <ng-container *ngIf="tf.sheetList.length != 0">
                            <mat-accordion multi class="" is-open="true">
                              <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                                (closed)="panelOpenState = false" *ngFor="let item of tf.sheetList; let i = index">
                                <mat-expansion-panel-header class="">
                                  <label (click)="$event.stopPropagation();" class=""><span
                                      class="dds-icon dds-icon_file_xls__l__filled" style="margin-right:10px;"></span>
                                    {{
                                    item.fileName }}</label>
                                </mat-expansion-panel-header>
                                <div class="row">
                                  <div class="search1 col-md-6 inner-search">
                                    <input id="form1" class="form-control"
                                      (keyup)="applyFilterForDMTables($event,item,i,tf.fileType)"
                                      [value]="item.searchValueInColumnPopup" placeholder="Search" />
                                  </div>
                                </div>
                                <mat-accordion
                                  *ngFor="let comp of item.sheet| searchFilter  : { tableNameUI: item.searchValueInColumnPopup } : 'createDSpopup' : 'files'; let j = index"
                                  style="cursor: pointer">
                                  <div (click)="accordionFilesRowClicked(item, i,comp, j,'SF')">
                                    <label>{{ comp.fieldName }}</label>
                                  </div>
                                </mat-accordion>
                              </mat-expansion-panel>
                            </mat-accordion>
                          </ng-container>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                    <div class="header">
                      <h5
                        (click)="isDatasetExpandInAddCustomColumnInDSPopup = !isDatasetExpandInAddCustomColumnInDSPopup">
                        <span *ngIf="isDatasetExpandInAddCustomColumnInDSPopup"
                          class="dds-icon dds-icon_chevron_down__s__stroke"></span>
                        <span *ngIf="!isDatasetExpandInAddCustomColumnInDSPopup"
                          class="dds-icon dds-icon_chevron_up__s__stroke"></span>Dataset Files
                      </h5>
                    </div>
                    <div *ngIf="
                    allDatasetDetailsList?.length == 0 ||
                    allDatasetDetailsList == null
                  " class="mat-table" style="text-align: center; font-size: 13px"> <!--inline-->
                      No files found
                    </div>
                    <ng-container *ngIf="!isDatasetExpandInAddCustomColumnInDSPopup">
                      <mat-accordion multi class="" is-open="true" *ngIf="allDatasetDetailsListForSearch?.length != 0">
                        <mat-expansion-panel [expanded]="allExpandState" (opened)="panelOpenState = true"
                          (closed)="panelOpenState = false" *ngFor="let item of allDatasetDetailsList2; let i = index">
                          <mat-expansion-panel-header class="">
                            <label class="" (click)="$event.stopPropagation();"><span
                                class="dds-icon dds-icon_file_xls__l__filled" style="margin-right:10px;"></span> {{
                              item.datasetName }}</label>
                          </mat-expansion-panel-header>
                          <div class="row">
                            <div class="search1 col-md-6 inner-search">
                              <input id="form1" class="form-control" value="" placeholder="Search" (keyup)="
                            applyFilterForDMTables($event, item, i, 'dataset')
                          " />
                            </div>
                          </div>
                          <mat-accordion *ngFor=" let comp of item.datasetFieldDTOList | searchFilter  : { tableNameUI: item.searchValueInCreateDatasetPopup } : 'createDSpopup' : 'dataset';let j = index
                        " style="cursor: pointer">
                            <ng-container *ngIf="!comp.excludeInSelect">
                              <div (click)="accordionFilesRowClicked(item, i, comp, j, 'DS')">
                                <label>{{ comp.fieldName }}</label>
                              </div>
                            </ng-container>
                          </mat-accordion>

                        </mat-expansion-panel>
                      </mat-accordion>
                    </ng-container>
                  </div>
                </div>
              </div>



            </div>
          </div>

          <!-- <ng-container *ngFor="let whereObj of item?.whereList; let j = index">
            <div class="addRow">
              <mat-form-field appearance="fill">
                <mat-select class="form-control" placeholder="Select AND/OR" (selectionChange)="
                      changeOperator($event, j, whereObj, i, item)
                    " [value]="whereObj.operator">
                  <mat-option *ngFor="let opearator of opearatorList" [value]="opearator.value">
                    {{ opearator.value }}</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="fill">
                <mat-select class="form-control" placeholder="Select Operator" (selectionChange)="
                      changeSignOperator($event, j, whereObj, i, item, 'child')
                    " [value]="whereObj.signOperator">
                  <mat-option *ngFor="let signOpearator of signOperatorList" [value]="signOpearator.value">
                    {{ signOpearator.value }}</mat-option>
                </mat-select>
              </mat-form-field>
              <input [(ngModel)]="whereObj.value" placeholder="Value" class="form-control" />
              <span (click)="delOpearatorValueFields(j, whereObj, i, item)"
                class="dds-icon border dds-icon_delete__l__stroke"></span>
            </div>
          </ng-container> -->

          <ng-container>
            <div class="popup-footer button-group">
              <button (click)="closeCreateExpressionPopup()" type="button" class="mat-button">
                Cancel <span class="dds-icon dds-icon_close"></span>
              </button>
              <button mat-button class="btnn" *ngIf="item.isEdit" (click)="add_SaveCreateExpression(item)">
                SAVE
              </button>

              <button mat-button class="primary" *ngIf="item.isEdit == false" (click)="add_SaveCreateExpression(item)">
                Submit
                <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
              </button>
            </div>
          </ng-container>
        </div>

      </form>

    </div>
  </div>
</div>
<!-- </div>
</div> -->

<!--Upload sqlscript      X -->
<div *ngIf="enableUploadSQL">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px;">
      <div class="taxt-header popup-header">
        <h3>Upload SQL Script</h3>
        <button class="close" (click)="enableUploadSQL = false">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body" style="padding-bottom:0px !important;">
        <div *ngIf="uploadSQLBtn">
          <div class="script-upload">
            <label for="sqlTxtFile" class="button">
              <input type="file" id="sqlTxtFile" (change)="uploadSQL_PythonScript($event, isBtnClickedSQL_Python)"
                style="display: none" />
              <span class="dds-icon dds-icon_upload__l__stroke"></span>
              <h3>Drag and drop files, or <span>Browse</span></h3>
              <p>Supported TXT & SQL files</p>
            </label>
          </div>
        </div>
        <div *ngIf="!uploadSQLBtn">
          <form [formGroup]="sqlScriptForm">
            <textarea mat-input type="name" formControlName="sqlScript" class="form-control script-area" [ngClass]="{
                'is-invalid':
                  submited && sqlScriptForm.controls['sqlScript'].errors
              }" name="s"></textarea>
          </form>
          <div class="popup-footer button-group">
            <button mat-button style="color: #0076a8; background: #fff" (click)="enableUploadSQLPopup = false">
              Cancel <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
            </button>
            <button mat-button (click)="saveUploadScript(isBtnClickedSQL_Python, '')" class="primary">
              Save <mat-icon>save</mat-icon>
            </button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!--Upload pythonscript        X-->
<div *ngIf="enableUploadPython">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px;">
      <div class="taxt-header popup-header">
        <h3>Upload Python Script</h3>
        <button class="close" (click)="enableUploadPython = false">
          <span aria-hidden="true">&times;</span></button>
      </div>
      <div class="popup-body" style="padding-bottom: 0px !important;">
        <div *ngIf="uploadSQLBtn">
          <div class="but script-upload">
            <label for="sqlTxtFile" class="button">
              <input type="file" id="sqlTxtFile" (change)="uploadSQL_PythonScript($event,isBtnClickedSQL_Python)"
                style="display: none;" />
              <span class="dds-icon dds-icon_upload__l__stroke"></span>
              <h3>Drag and drop files, or <span>Browse</span></h3>
              <p>Supported TXT & PY files</p>
            </label>
          </div>
        </div>


        <div *ngIf="!uploadSQLBtn">
          <form [formGroup]="sqlScriptForm">
            <textarea mat-input type="name" formControlName="sqlScript" class="form-control script-area"
              [ngClass]="{ 'is-invalid': submited && sqlScriptForm.controls['sqlScript'].errors }" name="s"></textarea>
          </form>
          <div class="popup-footer button-group">
            <button mat-button (click)="enableUploadPython = false">Cancel <span
                class="dds-icon dds-icon_arrow_right__s__stroke"></span></button>
            <button mat-button (click)="saveUploadScript(isBtnClickedSQL_Python,'')" class="primary">Save
              <mat-icon>save</mat-icon></button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--view script of sql/python script-->
<div *ngIf="enableViewscriptPopup">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px">
      <div class="taxt-header popup-header">
        <h3>View Script</h3>
        <div class="button-group">
          <!--   <button mat-button [ngClass]="{ activeBtn: isManualScript }" (click)="isSQL_Python(isManualScript)">
            Manual Script <span class="dds-icon dds-icon_eyeopen"></span>
          </button>
          <button mat-button [ngClass]="{ activeBtn: isUploadScript }" (click)="isSQL_Python(isUploadScript)">
            Uploaded Script <span class="dds-icon dds-icon_eyeopen"></span>
          </button> -->
        </div>
        <button (click)="enableViewscriptPopup = false" class="close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body" style="padding-bottom:0px !important">

        <form [formGroup]="getViewScriptForm">
          <ng-container *ngIf="isManualScript">
            <textarea mat-input type="name" formControlName="gscript" class="form-control"
              style="background-color: #000 !important;" [ngClass]="{
                      'is-invalid':
                        submited && getViewScriptForm.controls['gscript'].errors
                    }" name="m"></textarea>
          </ng-container>
          <!--    temporary
           <ng-container *ngIf="isUploadScript">        
            <textarea mat-input type="name" formControlName="script" class="form-control" [ngClass]="{
                      'is-invalid':
                        submited && getViewScriptForm.controls['script'].errors
                    }" name="sp"></textarea>
          </ng-container> -->
        </form>
      </div>

      <!-- <div class="popup-footer button-group">
         <button mat-button (click)="enableViewscriptPopup = false">
          Cancel <span class="dds-icon dds-icon_close__l__stroke"></span>
        </button>
        <button mat-button (click)="executeViewScript()" class="primary">Save and Execute
          <mat-icon>save</mat-icon>
        </button>
         <button mat-button (click)="updateViewScript()" class="primary">Update <span
            class="dds-icon dds-icon_arrow_right__s__stroke"></span></button> 
      </div> -->
    </div>
  </div>
</div>



<div *ngIf="enableDeletePopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="min-width:475px;">
      <div class="taxt-header popup-header">
        <h3>Confirm Delete</h3>
        <button (click)="enableDeletePopup = false" class="close">
          <span aria-hidden="true">&times;</span></button>
      </div>
      <div class="popup-body">
        <div class="message-inner">
          <p class="delete-message" *ngIf="deleteTableDetails.type == 'file'"><mat-icon>help_outline</mat-icon> Are You
            Sure want to Delete
            {{deleteTableDetails.item.fileNameWithExt}} ?</p>
          <p class="delete-message" *ngIf="deleteTableDetails.type == 'append'"><mat-icon>help_outline</mat-icon> Are
            You Sure want to Delete
            {{deleteTableDetails.item.appendName}} ?</p>
          <p class="delete-message" *ngIf="deleteTableDetails.type == 'merge'"> <mat-icon>help_outline</mat-icon> Are
            You Sure want to Delete
            {{deleteTableDetails.item.mergeName}} ?</p>
          <p class="delete-message" *ngIf="deleteTableDetails.type == 'dataset'"><mat-icon>help_outline</mat-icon> Are
            You Sure want to Delete
            {{deleteTableDetails.item.datasetName}} ?</p>

        </div>
      </div>
      <div class="popup-footer button-group">
        <button mat-button (click)="enableDeletePopup = false">Cancel <span
            class="dds-icon dds-icon_close"></span></button>
        <button mat-button class="primary"
          (click)="deleteTable(deleteTableDetails.item, deleteTableDetails.type)">Delete <span
            class="dds-icon dds-icon_delete__l__stroke"></span></button>

      </div>
    </div>
  </div>
</div>



<!--create append DataSet popup-->
<div *ngIf="enableDatasetAppendPopup">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup" style="min-width: 560px">
      <div class="taxt-header popup-header">
        <h3>DataSet</h3>
      </div>
      <div class="popup-body">
        <form [formGroup]="datasetAppendForm">
          <div class="row popup">
            <div class="field">
              <label>Enter DataSet Name<sup>*</sup></label>
              <input type="text" formControlName="appendNameControl" (keyup)="isTableExistAppend($event)"
                oninput="this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\..*)\./g, '$1');"
                [ngClass]="{ 'is-invalid': submitted && datasetAppendForm.controls['appendNameControl'].errors }">
            </div>
          </div>
          <div *ngIf="submited" class="error">{{ submittedErrorMsg }}</div>
        </form>
      </div>
      <div class="col-sm-12 popup-footer button-group">
        <button mat-button (click)="enableDatasetAppendPopup = false">
          Cancel <span class="dds-icon dds-icon_close"></span>
        </button>
        <button mat-button type="submit" (click)="appendDatasetApi();">
          Add <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
        </button>
      </div>
    </div>
  </div>
</div>




<!--preview popup-->
<!-- <div *ngIf="showTargetFilePopup"> -->
<div class="taxt_audit-report" *ngIf="showTargetFilePopup">
  <div class="taxt-audit-popup" style="min-width: 960px">
    <div class="popup-header">
      <h3> {{clickedRowDataInTF}}
        <!-- <span class="spacer">|</span>  -->
      </h3>
      <button class="close" (click)="showTargetFilePopup = false" mat-button>
        &times;
      </button>
    </div>
    <div class="popup-body">
      <div class="table-container spreadsheet-table">
        <form [formGroup]="targetFilePopupForm">
          <table class="table table-striped">
            <thead>
              <ng-container *ngIf="tabs[2].id == 2 && tabs[2].isActive == true">

                <!-- <tr style="background-color: #0076A8; z-index: 1;"> -->
                <!-- <th scope="col" style="margin:auto; color: #fff; width: 10%">#</th>
                            <th scope="col" style="margin:auto; color: #fff; width: 25%">Column Name</th> -->
                <!-- <th scope="col">Data Type</th>
                        </tr> -->
                <ng-container formArrayName="targetFileList">
                  <tr>

                    <!-- <th *ngFor="let rowObj of clickedRowDataInTF; let k = index"> -->
                    <th *ngFor="let rowObj of TargetFileArr().controls; let k = index" [formGroupName]="k">
                      <!-- <ng-container
                        *ngIf="fileTypeInTF == 'files' || fileTypeInTF == 'append' || fileTypeInTF == 'join' "> -->
                      <input type="text" name="first" formControlName="newColumnName" [ngClass]="{
                            'is-invalid':
                            submittedTFPopup &&
                              rowObj.get('newColumnName')?.errors
                          }">
                      <!-- </ng-container> -->
                    </th>
                  </tr>

                  <tr>
                    <!-- <td *ngFor="let rowObj of clickedRowDataInTF; let k = index">
                      <mat-form-field appearance="fill">
                        <mat-select class="form-control" placeholder="Select DataType"
                          [ngModelOptions]="{standalone: true}" [(ngModel)]="rowObj.columnType"
                          (selectionChange)="selectDropDownInTF($event, rowObj)">
                          <mat-option *ngFor="let dt of rowObj.filteredColumnTypeList" [value]="dt">
                            {{ dt }}</mat-option>
                        </mat-select>
                      </mat-form-field>

                      <ng-container *ngIf="rowObj.isDataTypeIsDate">
                        <mat-form-field appearance="fill">
                          <mat-select class="form-control" placeholder="Select DataType"
                            [ngModelOptions]="{standalone: true}" [(ngModel)]="rowObj.selectedDateFormat"
                            (selectionChange)="selectDateFormatDropDownInTF($event, rowObj)">
                            <mat-option *ngFor="let dt of rowObj.dateFormatList" [value]="dt">
                              {{ dt }}</mat-option>
                          </mat-select>
                        </mat-form-field>
                      </ng-container>
                    </td> -->
                    <ng-container *ngFor="let rowObj of TargetFileArr().controls; let l = index" [formGroupName]="l">
                      <td>
                        <mat-form-field appearance="fill">
                          <mat-select class="form-control" placeholder="Select DataType" formControlName="columnType"
                            (selectionChange)="selectDropDownInTF($event, rowObj, l)">
                            <mat-option *ngFor="let dt of filteredColumnTypeListInTF[l]" [value]="dt">
                              {{ dt }}</mat-option>
                          </mat-select>
                        </mat-form-field>

                        <ng-container *ngIf="hasDateFormatAt(l)">
                          <mat-form-field appearance="fill">
                            <mat-select class="form-control" placeholder="Select Data Format"
                              formControlName="dateFormat"
                              (selectionChange)="selectDateFormatDropDownInTF($event, rowObj, l)">
                              <mat-option *ngFor="let dt of dateFormatInTF" [value]="dt">
                                {{ dt }}</mat-option>
                            </mat-select>
                          </mat-form-field>
                        </ng-container>
                      </td>
                    </ng-container>
                  </tr>
                </ng-container>
              </ng-container>
              <ng-container
                *ngIf="(tabs[1].id == 1 && tabs[1].isActive == true) || (tabs[3].id == 3 && tabs[3].isActive == true) || (tabs[4].id == 4 && tabs[4].isActive == true) || (tabs[5].id == 5 && tabs[5].isActive == true)">
                <tr>
                  <ng-container *ngFor="let header of columnsArr; let i = index;">
                    <th (click)="onSortClick(header,i)">{{header}}
                      <span class="sort-btn">
                        <span class="dds-icon" [ngClass]="{'dds-icon_chevron_down__l__stroke': sortColumn == i && sortOrder == 'asc',
                  'dds-icon_chevron_up__l__stroke': sortColumn == i && sortOrder == 'desc'}"></span>
                        <ng-container *ngIf="sortColumn != i">
                          <span class="sort-default">
                            <span class="dds-icon dds-icon_chevron_up__l__stroke"></span>
                            <span class="dds-icon dds-icon_chevron_down__l__stroke"></span>
                          </span>
                        </ng-container>
                      </span>
                  </ng-container>
                </tr>
              </ng-container>
            </thead>

            <tbody>
              <tr *ngFor="let data of selectedM_A_S; let j = index">
                <td *ngFor="let val of columnsArr; let j = index"
                  style="width: 120px; word-break: break-all; text-align:left !important;">
                  {{ data[val] }}
                </td>
                <!-- </ng-container> -->
              </tr>

              <!-- <tr> -->
              <!-- <td scope="row" style="width:10%">
                                  <input type="checkbox" [(ngModel)]="rowObj.isChecked">
                              </td> -->
              <!-- <td *ngFor="let rowObj of clickedRowDataInTF; let k = index">-->
              <!--make it column name-->
              <!--<ng-container
                                      *ngIf="fileTypeInTF == 'files' || fileTypeInTF == 'append'|| fileTypeInTF == 'join'">
                                      <span>
                                          <div>{{rowObj.fieldName}}</div>
                                      </span>
                                  </ng-container>
                              </td> -->
              <!-- <td style="width:20%;">
                                  <mat-form-field appearance="fill">
                                      <mat-select class="form-control" placeholder="Select DataType"
                                          [(ngModel)]="rowObj.columnType"
                                          (selectionChange)="selectDropDownInTF($event,rowObj)">
                                          <mat-option *ngFor="let dt of dataTypee" [value]="dt.value">
                                              {{dt.value}}</mat-option>
                                      </mat-select>
                                  </mat-form-field>
                              </td> -->
              <!-- </tr> -->
            </tbody>
          </table>
        </form>
      </div>
    </div>

    <div class="popup-footer">
      <h3><span>Row Count: {{rowCount}}</span> <span class="spacer">|</span>
        Column Count: {{columnsArr.length}}</h3>
      <ng-container *ngIf="tabs[2].id == 2 && tabs[2].isActive == true">
        <button mat-button (click)="closeESSPopup()" type="button">
          Cancel <span class="dds-icon dds-icon_close"></span>
        </button>
        <button mat-button type="submit" class="primary" (click)="updateInPopupTF()">
          Update
          <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
        </button>
      </ng-container>
      <ng-container
        *ngIf="(tabs[1].id == 1 && tabs[1].isActive == true) || (tabs[3].id == 3 && tabs[3].isActive == true) || (tabs[4].id == 4 && tabs[4].isActive == true) || (tabs[5].id == 5 && tabs[5].isActive == true)">
        <!-- <h3><span>Row Count: {{rowCount}}</span> <span class="spacer">|</span>
          Column Count: {{columnsArr.length}}</h3> -->
        <button mat-button (click)="showTargetFilePopup = false" type="button">
          Cancel <span class="dds-icon dds-icon_close"></span>
        </button>
      </ng-container>
    </div>
  </div>
</div>
<!-- </div> -->


<!--view script every dataset-->
<div *ngIf="enableViewScriptDSPopup">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px;">
      <div class="taxt-header popup-header">
        <h3>View Script</h3>
        <button mat-button class="close" (click)="enableViewScriptDSPopup = false">&times;</button>
      </div>
      <div class="popup-body">
        <form [formGroup]="viewscriptForm">
          <textarea mat-input type="name" cols="50"
            style="min-height: 60vh;width: 100%; margin-bottom:0px; background:#000 !important;"
            class="form-control script-area" [ngClass]="{ 'is-invalid': viewscriptForm.controls['sqlScript'].errors }"
            formControlName="sqlScript" name="s"></textarea>
        </form>
      </div><!--commented temporary-->
      <!-- <div class="popup-footer button-group">
        <button mat-button (click)="enableViewScriptDSPopup = false">Cancel <span
            class="dds-icon dds-icon_close"></span></button>
        <button mat-button (click)="updateScriptByDatasetId(viewscriptForm)" class="primary">Save
          <mat-icon>save</mat-icon></button>
      </div> -->
    </div>
  </div>
</div>



<div *ngIf="enableAppendDatasetError">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px;">
      <div class="taxt-header popup-header">
        <h3>Error: Files Append Failed due to the datatype mismatch in the following columns</h3>
        <button class="close" (click)="enableAppendDatasetError = false">
          <span aria-hidden="true">&times;</span></button>
      </div>
      <div class="popup-body" style="padding-bottom: 0px !important;">
        <textarea type="name" [disabled]="true" name="s" style="color:red">{{unique}}</textarea>
        <div class="popup-footer button-group">
          <button mat-button class="primary" (click)="enableAppendDatasetError = false">OK</button>
        </div>
      </div>
    </div>
  </div>
</div>





<!--Upload sql or pythonscript (UF) -->
<div *ngIf="enableUploadSQLPython">
  <div class="taxt_audit-report enableUploadSQLPopup">
    <div class="taxt-audit-popup" style="min-width:1165px;">
      <div class="taxt-header popup-header">
        <h3>Upload</h3>
        <mat-form-field appearance="fill" style="margin-left:auto; margin-right:20px;">

          <mat-select class="form-control reflect-model" placeholder="Select Script Type"
            [value]="selectedScriptTypeInUF" (selectionChange)="selectScriptTypeInUF($event)">

            <mat-option *ngFor="let item of scriptList" [value]="item">{{ item }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <button class="close" (click)="closeUploadSQLPythonPopup()">
          <span aria-hidden="true">&times;</span></button>
      </div>
      <div class="popup-body" style="padding-bottom: 0px !important;">
        <div *ngIf="uploadSQLBtn">
          <div class="but script-upload">
            <label for="sqlTxtFile" class="button">
              <input type="file" id="sqlTxtFile" (change)="uploadSQL_PythonScript($event,selectedScriptTypeInUF)"
                style="display: none;" />
              <span class="dds-icon dds-icon_upload__l__stroke"></span>
              <h3>Drag and drop files, or <span>Browse</span></h3>
              <ng-container *ngIf="selectedScriptTypeInUF == 'SQL script'">
                <p>Supported TXT & SQL files</p>
              </ng-container>
              <!-- <ng-container *ngIf="selectedScriptTypeInUF == 'Python Script'">
                <p>Supported TXT & PY files</p>
              </ng-container> -->
            </label>
          </div>
        </div>


        <div *ngIf="!uploadSQLBtn">
          <form [formGroup]="sqlScriptForm">
            <div class="find-block">
              <div class="input-group">
                <label>Find All</label>
                <input type="text" formControlName="findAll" class="form-control reflect-model" />
              </div>
              <div class="input-group">
                <label>Replace All</label>
                <input type="text" formControlName="replaceAll" class="form-control reflect-model" />
              </div>
              <button mat-button (click)="findReplaceAll(sqlScriptForm)" class="primary">Ok
              </button>
            </div>
            <textarea mat-input type="name" formControlName="sqlScript" class="form-control script-area"
              [ngClass]="{ 'is-invalid': submited && sqlScriptForm.controls['sqlScript'].errors }" name="s"></textarea>

          </form>

          <div class="popup-footer button-group">
            <!-- <button mat-button (click)="closeUploadSQLPythonPopup()">Cancel <span
              class="dds-icon dds-icon_arrow_right__s__stroke"></span></button> -->
            <input type="file" #uploadSqlPythonfile (change)="uploadSQL_PythonScript($event,selectedScriptTypeInUF)"
              style="display: none;" />
            <button mat-button (click)="uploadSqlPythonfile.click()" >Reupload </button>
            <button mat-button (click)="oneNext({id :2 }, 'uploadedScript')">Save and Execute
              <mat-icon>save</mat-icon></button>
            <ng-container *ngIf="nextBtnInUploadScriptInUF"> <!--click need to implement-->
              <button mat-button (click)="changeTabs({id:5},'prev');enableUploadSQLPython = false" class="primary">Next
                <span class="dds-icon dds-icon_arrow_right__s__stroke"></span>
              </button>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!--click and continue in DM-->
<div *ngIf="clickContinueInDM">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Selection Type</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeClickContinueInDMPopup()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <ul class="select-items-group">
          <li *ngFor="let obj of desktopServicesArray">
            <div class="select-item">
              <input type="checkbox" id="pBiDesktop" name="genericitem" [checked]="obj.isChecked"
                (click)="selectDesktopOrServices($event, obj)" />
              <label for="pBiDesktop">
                <span>{{obj.value}}</span>
              </label>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<div *ngIf="deleteAnalytics">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup ">
      <div class="taxt-header popup-header">
        <h3>Do You want to delete Scenario ? </h3>
        <button type="button" class="close" aria-label="Close" (click)="scenarioCancel()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="report-container popup-body" style="margin-bottom: 0px !important;">
        
      </div>
      <div class=" button-group">
        <button mat-button (click)="scenarioCancel()">Cancel</button>
        <button mat-button class="primary" (click)="deleteAnalyticsApproved()">Delete</button>
      </div>
    </div>
  </div>
</div>
<!-- user-guide of add-process -->
<div *ngIf="userguideaddprocess">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Add Process User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>Enter the Process Name and Description.</span></p>
          <p><strong>2</strong> <span>Select the Industry and sector.</span></p>
          <p><strong>3</strong> <span>To view the solution in carousel in landing page, select add to feature
              list.</span></p>
          <p><strong>4</strong> <span>Select either New or Upcoming to display solution under the platform and solutions
              & Explore solution.</span></p>
          <p><strong>5</strong> <span>Upload process related image, video and brochure.</span></p>
          <p><strong>6</strong> <span>Add scenario name and description.</span></p>
          <p><strong>7</strong> <span>To continue further, click on the Save and Continue.</span></p>
          <p><strong>8</strong> <span>To change or else to remove all the entered fields, click on the Reset
              Button.</span></p>
          <p>Note: Fields marked (*) are mandatory.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- user-guide of upload files -->
<div *ngIf="userguideupload">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Upload Files User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup1()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>Upload the files either by Drag and drop or from local.</span></p>
          <p><strong>2</strong> <span>Select Dataset Creation Type either Manual or Upload script.</span></p>
          <p><strong>3</strong> <span>Select the file(s) or sheet(s) within the files.</span></p>
          <p><strong>4</strong> <span>Click on View to preview the file data.</span></p>
          <p><strong>5</strong> <span>Click on the copy icon to copy the file name.</span></p>
          <p><strong>6</strong> <span>Click on the Next button to Go to the next step.</span></p>
          <p><strong>7</strong> <span>To edit/change the details in the Add Process, click on the Prev button.</span>
          </p>

        </div>
      </div>
    </div>
  </div>
</div>

<!-- user-guide of target files -->
<div *ngIf="userguidetarget">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Target Files User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup2()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>Click on the Edit to rename the column name, change the column data type and
              format.</span></p>
          <p><strong>2</strong> <span>View and edit data, like column rename and data type by click on edit icon.</span>
          </p>
          <p><strong>3</strong> <span>Click on the Select All option to select all the columns within the file(s) or
              select the check box against each column by expanding the files.
              Only those columns from the file(s) will be moved to the next step.</span></p>
          <p><strong>4</strong> <span>To continue further, click on the Next button or to make any changes or upload
              more files, click on the Prev button.</span></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- user-guide of append files -->
<div *ngIf="userguideappend">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Append Files User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup3()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>Select the files that has identical columns, datatypes and equal no of
              columns.</span></p>
          <p><strong>2</strong> <span>After selecting the files, click on Append button and enter the Append
              name.</span></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- user-guide of join files -->
<div *ngIf="userguidejoin">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Join Files User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup4()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>Select two or more files either from appended files or else from source files or
              from both appended & source files, click on Join button.</span></p>
          <p><strong>2</strong> <span>Enter the join name Select the Primary and secondary table and select the join
              type and the columns to join.</span></p>
          <p><strong>3</strong> <span>Click on Pulse (+) icon, if required to add columns and join the tables based on
              more than one column match.</span></p>
          <p><strong>4</strong> <span>To add more tables click on the Add table button.</span></p>
        </div>
      </div>
    </div>
  </div>block
</div>

<!-- user-guide of data-modelling -->
<div *ngIf="userguidedatamodeling">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup">
      <div class="taxt-header popup-header">
        <h3>Data Modelling User Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closeuserguidepopup5()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body">
        <div class="user-guide-block">
          <p><strong>1</strong> <span>To Create Dataset, click on Create dataset button and enter the dataset
              name.</span></p>
          <p><strong>2</strong> <span>Add columns to the dataset from left side files (append file/ join files /source
              files).</span></p>
          <p><strong>3</strong> <span>To create a new column, click on the Add Custom Column button. Enter the column
              name, Select data type</span></p>
          <p><strong>4</strong> <span>To apply functions on the column in the expression box, select the column from the
              file by clicking on the column button then select the function by clicking on the Function button and
              select the function.</span></p>
          <p><strong>5</strong> <span>To exclude column in the table view list, click on check box against the exclude
              in select.</span></p>
          <p><strong>6</strong> <span>Click on the edit icon adjacent to the column to edit the values in the expression
              or delete the column</span></p>
          <p><strong>7</strong> <span>To view the dataset script click on the icon.</span></p>
          <p><strong>8</strong> <span>Click on Append button to append the datasets.</span></p>
          <p><strong>9</strong> <span>To generate the solution script click on the Generate Script Icon and view it
              under the View final script button.</span></p>
          <p><strong>10</strong> <span>Select the dataset and push the dataset to Power Bi by clicking on the Click to
              Continue button.</span></p>
          <p><strong>11</strong> <span>To push more than one dataset to Power Bi, select the datasets and provide the
              relation between tables by clicking on the Map Tables button</span></p>
        </div>
      </div>
    </div>
  </div>
</div>
<div *ngIf="PBIDesktop">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup min-max-width90" style="height:calc(100vh - 100px);">
      <div class="taxt-header popup-header">
        <h3>PowerBI Desktop Guide</h3>
        <button type="button" class="close" aria-label="Close" (click)="closePbidesktop()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="popup-body" style="height:calc(100vh - 190px); padding-bottom:0px !important;">
        <div class="row" style="margin:0px !important;">
          <div class="col-md-4">
            <div class="user-guide-block" style="max-height:inherit !important; height:calc(100vh - 240px);">
              <p><strong>1</strong> <span>Download the Power Bi Desktop.</span></p>
              <p><strong>2</strong> <span>Login to the desktop using the credentials.</span></p>
              <p><strong>3</strong> <span>Search for the workspace (workspacename will be the process name).</span></p>
              <p><strong>4</strong> <span>Create the report and publish in desktop.</span></p>
              <p><strong>5</strong> <span>Select a report from the list of the reports published.</span></p>
              <p><strong>6</strong> <span>Report selected will be the final report and no changes are allowed in the
                  desktop at the later point of time.</span></p>
              <p><strong>7</strong> <span>Edit the report in Power BI service.</span></p>
            </div>
          </div>
          <div class="col-md-8">
            <h3>Measures</h3>
            <form [formGroup]="ReportForm">
              <div class="table-container" style="height:calc(100vh - 430px); overflow-x:hidden;">
                <div class="row" style="margin:0px !important;">
                  <div class="col-md-12" style="padding-left:0px !important;">
                    <div formArrayName="measures" style="width:100%;">
                      <div *ngFor="let element of measuresArr().controls,let i=index">
                        <div [formGroupName]="i" class="row mesure-item">
                          <div class="col-md-4">
                            <div class="input-group">
                              <input type="text" placeholder="Name" class="form-control reflect-model"
                                formControlName="name" />
                            </div><br />
                            <div class="input-group">
                              <input type="text" placeholder="Formate String" class="form-control reflect-model"
                                formControlName="formateString" />
                            </div>

                          </div>
                          <div class="col-md-6">
                            <div class="input-group">
                              <textarea rows="4" cols="50" placeholder="expression" type="text"
                                formControlName="expression" class="form-control reflect-model"
                                style="height:90px;"></textarea>
                            </div>
                          </div>
                          <div class="col-md-2">
                            <div class="button-group">
                              <button mat-button (click)="removeMeasure(i)">Delete</button>
                              <button mat-button class="primary" (click)="addMeasure()">ADD</button>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="button-group">
                <button mat-button class="primary" (click)="measureSubmit()">
                  Submit Measures
                </button>
              </div>
            </form>
            <h3>Reports</h3>
            <div class="input-group flex-list " *ngFor="let item of Reports,let i=index">
              <input type="checkbox" id="pBiDesktop" name="genericitem" [checked]="item.isChecked"
                (click)="selectDesktopReport(item,i)" />
              {{item.reportName}}
              <span (click)="ViewReport(item,i)" title="preview" class="dds-icon dds-icon_eyeopen"
                style="float: right;"></span>
            </div>
            <div class="button-group">
              <button mat-button class="primary" (click)="SubmitReport()">
                Submit Report
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div [ngClass]="AddEventProceeding?'':'displ'">
  <div class="taxt_audit-report">
    <div class="taxt-audit-popup pbi-min-max-width90">
      <div class="taxt-header popup-header">
        <h3>PowerBI Report </h3>
        <div class="button-group">
          <a mat-button class="primary" target="_blank" [routerLink]="['/powerbireport']" (click)="openWindow()">
            Open Report in new Window
          </a>
          <a mat-button class="primary" (click)="PrintReport()">Print</a>
        </div>
        <button mat-button class="close report-modal-close" (click)="hideViewReport()"><span
            class="dds-icon dds-icon_close__l__stroke"></span></button>

      </div>
      <div class="report-container popup-body" style="margin-bottom: 0px !important;">
        <powerbi-report id="embedView" [embedConfig]="reportViewConfig">
        </powerbi-report>
      </div>
      <div class="popup-footer button-group">
        <!-- <a mat-button class="primary" target="_blank" [routerLink]="['/powerbireport']"
                  (click)="openWindow()">
                  Open Report in new Window
              </a> -->
      </div>
    </div>
  </div>
</div>