(self.webpackChunkRIA=self.webpackChunkRIA||[]).push([[864],{2864:(As,$r,ce)=>{"use strict";ce.r($r),ce.d($r,{Admin1Module:()=>W7});var be=ce(9808),w=ce(3075),fe=ce(8555),Ie=ce(4176),e=ce(5e3),Se=ce(9224),gt=ce(2368),Ze=ce(7423);function xe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"div",30)(2,"div",31)(3,"div",32)(4,"h4",33),e._uU(5,"Edit Admin Information"),e.qZA()(),e.TgZ(6,"form")(7,"div",34)(8,"div",35)(9,"label"),e._uU(10,"Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e._UZ(13,"input",36),e.qZA(),e.TgZ(14,"div",35)(15,"label"),e._uU(16,"Designation"),e.TgZ(17,"sup"),e._uU(18,"*"),e.qZA()(),e._UZ(19,"input",37),e.qZA()(),e.TgZ(20,"div",34)(21,"div",35)(22,"label"),e._uU(23,"Contact Number"),e.TgZ(24,"sup"),e._uU(25,"*"),e.qZA()(),e.TgZ(26,"div",38)(27,"span",39),e._uU(28,"+91"),e.qZA(),e._UZ(29,"input",40),e.qZA()(),e.TgZ(30,"div",35)(31,"label"),e._uU(32,"Email_id"),e.TgZ(33,"sup"),e._uU(34,"*"),e.qZA()(),e._UZ(35,"input",41),e.qZA()(),e.TgZ(36,"div",34)(37,"div",35)(38,"label",42),e._uU(39,"User Role"),e.TgZ(40,"sup"),e._uU(41,"*"),e.qZA()(),e._UZ(42,"br")(43,"input",43),e._uU(44,"\xa0 "),e.TgZ(45,"label",44),e._uU(46,"Level-1 Admin"),e.qZA(),e._UZ(47,"input",45),e._uU(48,"\xa0 "),e.TgZ(49,"label",46),e._uU(50,"Level-2 Admin"),e.qZA()()(),e.TgZ(51,"div",47)(52,"button",48),e.NdJ("click",function(){return e.CHM(t),e.oxw().CloseModal()}),e._uU(53,"Cancel"),e.qZA(),e._uU(54," \xa0 \xa0 "),e.TgZ(55,"button",49),e._uU(56,"Update"),e.qZA()()()()()()}}const Ce=function(){return["/dashboard"]};let Ge=(()=>{class n{constructor(){this.checked=!0}ngOnInit(){}Eventproceedings(){var t;null===(t=this.addEventForm)||void 0===t||t.reset(),this.AddEventProceeding=!0}addEventFormSubmit(){}edit(t){this.AddEventProceeding=!0,this.addEventIndex=t}CloseModal(){this.AddEventProceeding=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-management"]],decls:152,vars:7,consts:[[1,"heading"],[3,"routerLink"],[1,"consen"],[1,"row","no-gutters"],[1,"col-md-3"],[1,"cards"],[1,"part1"],[1,"part2",2,"background-color","#0076A8"],["routerLink","/user/admin1/add-user",1,"dds-icon","dds-icon_plus__l__stroke"],[2,"border-color","#3391B9"],[1,"part2",2,"background-color","#3391B9"],[1,"dds-icon","dds-icon_users__l__stroke"],[1,""],[2,"border-color","#66ACCB"],[1,"part2",2,"background-color","#66ACCB"],[2,"border-color","#51A03D"],[1,"part2",2,"background-color","#51A03D"],[2,"border-color","#C2DD91"],[1,"part2",2,"background-color","#C2DD91"],[1,"middle"],["type","button","routerLink","/user/admin1/add-user",1,"btnn",2,"margin","20px"],[1,"table","table-striped"],[2,"background-color","#041E42","color","white"],["scope","col"],[3,"ngModel","ngModelChange"],["data-toggle","modal","data-target","#exampleModal",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke"],[1,"dds-icon","dds-icon_edit__l__stroke"],["style","padding: 0;",4,"ngIf"],[2,"padding","0"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px","margin-bottom","20px"],[1,"row"],[1,"col-sm-6"],["type","name",1,"form-control"],["type","designation",1,"form-control"],[1,"input-group","prefix"],[1,"input-group-addon"],["type","contactnumber",1,"form-control"],["type","email",1,"form-control"],[2,"margin-bottom","20px"],["type","radio","value","level1"],[2,"margin-right","50px"],["type","radio","value","level2"],["for","css"],[1,"col-sm-4",2,"float","right","margin","5% 0 5% 0"],["mat-button","",2,"width","40%","height","35px","color","#0076A8","border-color","#0076A8",3,"click"],["mat-button","","routerLink","/user/admin1/user-management",2,"width","40%","height","35px","background-color","#0076A8","color","white"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"User Management"),e.qZA(),e.TgZ(3,"ul")(4,"li")(5,"a",1),e._uU(6,"Dashboard "),e.qZA(),e._uU(7,"/"),e.qZA(),e.TgZ(8,"li"),e._uU(9,"User Management"),e.qZA()()(),e.TgZ(10,"div",2)(11,"div",3)(12,"div",4)(13,"mat-card")(14,"div",5)(15,"div",6)(16,"h3"),e._uU(17,"Total Users"),e.qZA(),e.TgZ(18,"h2"),e._uU(19,"501"),e.qZA()(),e.TgZ(20,"div",7),e._UZ(21,"span",8),e.qZA()()()(),e.TgZ(22,"div",4)(23,"mat-card")(24,"div",5)(25,"div",6)(26,"h3",9),e._uU(27,"Level 1 Admins"),e.qZA(),e.TgZ(28,"h2"),e._uU(29,"55"),e.qZA()(),e.TgZ(30,"div",10),e._UZ(31,"span",11),e.qZA()()()(),e.TgZ(32,"div",4)(33,"mat-card",12)(34,"div",5)(35,"div",6)(36,"h3",13),e._uU(37,"Level 2 Admins"),e.qZA(),e.TgZ(38,"h2"),e._uU(39,"150"),e.qZA()(),e.TgZ(40,"div",14),e._UZ(41,"span",11),e.qZA()()()(),e.TgZ(42,"div",4)(43,"mat-card",12)(44,"div",5)(45,"div",6)(46,"h3",15),e._uU(47,"Internal Users"),e.qZA(),e.TgZ(48,"h2"),e._uU(49,"15"),e.qZA()(),e.TgZ(50,"div",16),e._UZ(51,"span",11),e.qZA()()()(),e.TgZ(52,"div",4)(53,"mat-card",12)(54,"div",5)(55,"div",6)(56,"h3",17),e._uU(57,"External Users"),e.qZA(),e.TgZ(58,"h2"),e._uU(59,"400"),e.qZA()(),e.TgZ(60,"div",18),e._UZ(61,"span",11),e.qZA()()()()(),e.TgZ(62,"div")(63,"mat-card",19)(64,"button",20),e._uU(65,"Add User"),e.qZA(),e.TgZ(66,"div")(67,"table",21)(68,"thead")(69,"tr",22)(70,"th",23),e._uU(71,"User Name"),e.qZA(),e.TgZ(72,"th",23),e._uU(73,"User Role"),e.qZA(),e.TgZ(74,"th",23),e._uU(75,"Designation"),e.qZA(),e.TgZ(76,"th",23),e._uU(77,"Organization"),e.qZA(),e.TgZ(78,"th",23),e._uU(79,"Contact Number"),e.qZA(),e.TgZ(80,"th",23),e._uU(81,"Action"),e.qZA()()(),e.TgZ(82,"tbody")(83,"tr")(84,"td"),e._uU(85,"John"),e.qZA(),e.TgZ(86,"td"),e._uU(87,"Level 1 Admin"),e.qZA(),e.TgZ(88,"td"),e._uU(89,"Manager"),e.qZA(),e.TgZ(90,"td"),e._uU(91,"iBridge"),e.qZA(),e.TgZ(92,"td"),e._uU(93,"+91 1234567890"),e.qZA(),e.TgZ(94,"td")(95,"mat-slide-toggle",24),e.NdJ("ngModelChange",function(a){return o.checked=a}),e.qZA(),e._uU(96,"\xa0 "),e.TgZ(97,"span",25),e.NdJ("click",function(a){return o.edit(a)}),e.qZA(),e._uU(98,"\xa0 \xa0 "),e._UZ(99,"span",26),e.qZA()(),e.TgZ(100,"tr")(101,"td"),e._uU(102,"Smith"),e.qZA(),e.TgZ(103,"td"),e._uU(104,"Level 1 Admin"),e.qZA(),e.TgZ(105,"td"),e._uU(106,"Manager"),e.qZA(),e.TgZ(107,"td"),e._uU(108,"iBridge"),e.qZA(),e.TgZ(109,"td"),e._uU(110,"+91 1234567890"),e.qZA(),e.TgZ(111,"td")(112,"mat-slide-toggle",24),e.NdJ("ngModelChange",function(a){return o.checked=a}),e.qZA(),e._uU(113,"\xa0 "),e._UZ(114,"span",27),e._uU(115,"\xa0 \xa0 "),e._UZ(116,"span",26),e.qZA()(),e.TgZ(117,"tr")(118,"td"),e._uU(119,"Sumit"),e.qZA(),e.TgZ(120,"td"),e._uU(121,"Level 1 Admin"),e.qZA(),e.TgZ(122,"td"),e._uU(123,"Manager"),e.qZA(),e.TgZ(124,"td"),e._uU(125,"iBridge"),e.qZA(),e.TgZ(126,"td"),e._uU(127,"+91 1234567890"),e.qZA(),e.TgZ(128,"td")(129,"mat-slide-toggle",24),e.NdJ("ngModelChange",function(a){return o.checked=a}),e.qZA(),e._uU(130,"\xa0 "),e._UZ(131,"span",27),e._uU(132,"\xa0 \xa0 "),e._UZ(133,"span",26),e.qZA()(),e.TgZ(134,"tr")(135,"td"),e._uU(136,"Suman"),e.qZA(),e.TgZ(137,"td"),e._uU(138,"Level 1 Admin"),e.qZA(),e.TgZ(139,"td"),e._uU(140,"Manager"),e.qZA(),e.TgZ(141,"td"),e._uU(142,"iBridge"),e.qZA(),e.TgZ(143,"td"),e._uU(144,"+91 1234567890"),e.qZA(),e.TgZ(145,"td")(146,"mat-slide-toggle",24),e.NdJ("ngModelChange",function(a){return o.checked=a}),e.qZA(),e._uU(147,"\xa0 "),e._UZ(148,"span",27),e._uU(149,"\xa0 \xa0 "),e._UZ(150,"span",26),e.qZA()()()()()()(),e.YNc(151,xe,57,0,"div",28),e.qZA()),2&t&&(e.xp6(5),e.Q6J("routerLink",e.DdM(6,Ce)),e.xp6(90),e.Q6J("ngModel",o.checked),e.xp6(17),e.Q6J("ngModel",o.checked),e.xp6(17),e.Q6J("ngModel",o.checked),e.xp6(17),e.Q6J("ngModel",o.checked),e.xp6(5),e.Q6J("ngIf",o.AddEventProceeding))},directives:[fe.yS,Se.a8,fe.rH,gt.Rr,w.JJ,w.On,be.O5,w._Y,w.JL,w.F,Ze.lW],styles:[".mat-card[_ngcontent-%COMP%]{border-radius:0;margin-bottom:10px;padding:0}.container[_ngcontent-%COMP%]{margin-top:5%}.col[_ngcontent-%COMP%]{padding:0 5px}.col[_ngcontent-%COMP%]:first-child{padding-left:0}.col[_ngcontent-%COMP%]:last-child{padding-right:0}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}h5[_ngcontent-%COMP%]{font-size:15px}.btnn[_ngcontent-%COMP%]{border-radius:0;margin-bottom:10px;margin-left:0;border:1px solid #0076A8;background-color:#0076a8;color:#fff;width:100px;height:40px}.cards[_ngcontent-%COMP%]{display:flex;box-shadow:inset 0 1.2px 4px #00000029,0 1.2px 4px #0000001a;background:#fff}.middle[_ngcontent-%COMP%]{height:550px}.consen[_ngcontent-%COMP%]{padding:20px;width:calc(100% - 40px);float:left;width:100%;margin:0}.no-gutters[_ngcontent-%COMP%]   .col-md-3[_ngcontent-%COMP%]{width:190px}th[_ngcontent-%COMP%]:last-child{width:150px}.part1[_ngcontent-%COMP%]{width:calc(100% - 40px);padding:10px 0 0;float:left}.part1[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#0076a8;float:left;width:100%;padding:0 0 0 14px;margin:0;font-size:20px;line-height:30px;font-family:open_sans-medium}.part1[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{border-left:5px solid #0076A8;margin:0 0 1px;padding:2px 0 .3px 9px;font-size:13px;font-family:open_sans-semiBold;line-height:19px;float:left;width:100%}.part2[_ngcontent-%COMP%]{width:40px;height:65px;text-align:center;padding:18px 0;float:left}.part2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:26px;color:#fff!important}form[_ngcontent-%COMP%]{padding:35px}.row[_ngcontent-%COMP%]{padding-bottom:20px;margin:0}.row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}.input-group-addon[_ngcontent-%COMP%]{font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;width:12%;white-space:nowrap;vertical-align:middle;display:table-cell;padding-top:12px}.taxt-audit-popup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #ccc}.mat-button[_ngcontent-%COMP%]{border-radius:0}"]}),n})(),ot=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-user"]],decls:65,vars:0,consts:[[1,"heading"],[2,"color","#0076A8"],[1,"consen"],[1,"header"],[1,"row"],[1,"col-sm-4"],["type","name",1,"form-control"],["type","designation",1,"form-control"],[1,"input-group","prefix"],[1,"input-group-addon"],["type","contactnumber",1,"form-control"],["type","email",1,"form-control"],[2,"margin-bottom","20px"],["type","radio","name","processtype","value","admin1"],[2,"margin-right","50px"],["type","radio","name","processtype","value","admin2"],["for","css"],[1,"col-sm-4",2,"margin-top","26%","float","right"],["mat-button","","color","primary","routerLink","/user/admin1/user-management",1,"btn",2,"width","100px","height","35px","background-color","#fff","color","black","left","50%","border","1px solid #0076A8"],["mat-button","","color","primary","routerLink","/user/admin1/user-management",1,"btn",2,"width","100px","height","35px","margin-left","55%"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"User Management"),e.qZA(),e.TgZ(3,"h5")(4,"span",1),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6,"User Management"),e.qZA()(),e.TgZ(7,"div",2)(8,"div")(9,"mat-card")(10,"h4"),e._uU(11,"Add User"),e.qZA(),e.TgZ(12,"form")(13,"div",3)(14,"h3"),e._uU(15,"User Information"),e.qZA()(),e.TgZ(16,"div",4)(17,"div",5)(18,"label"),e._uU(19,"Name"),e.TgZ(20,"sup"),e._uU(21,"*"),e.qZA()(),e._UZ(22,"input",6),e.qZA(),e.TgZ(23,"div",5)(24,"label"),e._uU(25,"Designation"),e.TgZ(26,"sup"),e._uU(27,"*"),e.qZA()(),e._UZ(28,"input",7),e.qZA(),e.TgZ(29,"div",5)(30,"label"),e._uU(31,"Contact Number"),e.TgZ(32,"sup"),e._uU(33,"*"),e.qZA()(),e.TgZ(34,"div",8)(35,"span",9),e._uU(36,"+91"),e.qZA(),e._UZ(37,"input",10),e.qZA()()(),e._UZ(38,"br"),e.TgZ(39,"div",4)(40,"div",5)(41,"label"),e._uU(42,"Email_id"),e.TgZ(43,"sup"),e._uU(44,"*"),e.qZA()(),e._UZ(45,"input",11),e.qZA(),e.TgZ(46,"div",5)(47,"label",12),e._uU(48,"User Role"),e.TgZ(49,"sup"),e._uU(50,"*"),e.qZA()(),e._UZ(51,"br")(52,"input",13),e._uU(53,"\xa0 "),e.TgZ(54,"label",14),e._uU(55,"Level-1 Admin"),e.qZA(),e._UZ(56,"input",15),e._uU(57,"\xa0 "),e.TgZ(58,"label",16),e._uU(59,"Level-2 Admin"),e.qZA()()(),e.TgZ(60,"div",17)(61,"button",18),e._uU(62,"Cancel"),e.qZA(),e.TgZ(63,"button",19),e._uU(64,"Submit"),e.qZA()()()()()())},directives:[Se.a8,w._Y,w.JL,w.F,Ze.lW,fe.rH],styles:[".container[_ngcontent-%COMP%]{margin-top:1%}.mat-card[_ngcontent-%COMP%]{box-shadow:0 0 6px 1px #cccaca;border-radius:0;margin-top:2%;height:750px}.mat-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:20px;font-weight:600;margin:10px 0 30px 5px}.header[_ngcontent-%COMP%]{width:100%;background-color:#041e42}.heading[_ngcontent-%COMP%]{background-color:#fff;color:#000;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:25px;font-weight:600}h5[_ngcontent-%COMP%]{font-size:15px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff;height:35px;padding-left:15px;font-size:20px;padding-top:5px}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;border-radius:0;border:1px solid #ccc;transition:all .5s cubic-bezier(.77,0,.175,1)}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{box-shadow:inset 6.5em 0 #041e42;color:#fff!important;border:1px solid #041E42}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0;background-color:#eee}.row[_ngcontent-%COMP%]{margin-top:20px}.row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:10px}.input-group-addon[_ngcontent-%COMP%]{font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;width:12%;white-space:nowrap;vertical-align:middle;display:table-cell;padding-top:12px}"]}),n})();var Sn=ce(7389),nn=ce(7284),Bt=ce(1206),$e=ce(5861),Qn=ce(1777),Dt=ce(520),Ne=ce(2075),xt=ce(1086),Ji=ce(567),ys=ce(2868),Kr=ce(7221),Fn=ce(9536),qi=ce(2313),Nn=ce(4487),Hn=ce(330),Jt=ce(5979),co=ce(8966),_o=ce(3251),Yn=ce(1159),Et=ce(508),rt=ce(3191),M_=ce(6360),vt=ce(8929),po=ce(6787),L_=ce(2986),nr=ce(7625),Mn=(ce(1059),ce(925)),Wr=ce(5664),Ln=(ce(449),ce(7322));ce(226);const Ds=new e.OlP("MatChipRemove"),ks=new e.OlP("MatChipAvatar"),Fs=new e.OlP("MatChipTrailingIcon");class O_{constructor(r){this._elementRef=r}}const U_=(0,Et.sb)((0,Et.pj)((0,Et.Kr)(O_),"primary"),-1);let ir=(()=>{class n extends U_{constructor(t,o,i,a,s,l,c,d){super(t),this._ngZone=o,this._changeDetectorRef=s,this._hasFocus=!1,this.chipListSelectable=!0,this._chipListMultiple=!1,this._chipListDisabled=!1,this._selected=!1,this._selectable=!0,this._disabled=!1,this._removable=!0,this._onFocus=new vt.xQ,this._onBlur=new vt.xQ,this.selectionChange=new e.vpe,this.destroyed=new e.vpe,this.removed=new e.vpe,this._addHostClassName(),this._chipRippleTarget=l.createElement("div"),this._chipRippleTarget.classList.add("mat-chip-ripple"),this._elementRef.nativeElement.appendChild(this._chipRippleTarget),this._chipRipple=new Et.IR(this,o,this._chipRippleTarget,i),this._chipRipple.setupTriggerEvents(t),this.rippleConfig=a||{},this._animationsDisabled="NoopAnimations"===c,this.tabIndex=null!=d&&parseInt(d)||-1}get rippleDisabled(){return this.disabled||this.disableRipple||this._animationsDisabled||!!this.rippleConfig.disabled}get selected(){return this._selected}set selected(t){const o=(0,rt.Ig)(t);o!==this._selected&&(this._selected=o,this._dispatchSelectionChange())}get value(){return void 0!==this._value?this._value:this._elementRef.nativeElement.textContent}set value(t){this._value=t}get selectable(){return this._selectable&&this.chipListSelectable}set selectable(t){this._selectable=(0,rt.Ig)(t)}get disabled(){return this._chipListDisabled||this._disabled}set disabled(t){this._disabled=(0,rt.Ig)(t)}get removable(){return this._removable}set removable(t){this._removable=(0,rt.Ig)(t)}get ariaSelected(){return this.selectable&&(this._chipListMultiple||this.selected)?this.selected.toString():null}_addHostClassName(){const t="mat-basic-chip",o=this._elementRef.nativeElement;o.hasAttribute(t)||o.tagName.toLowerCase()===t?o.classList.add(t):o.classList.add("mat-standard-chip")}ngOnDestroy(){this.destroyed.emit({chip:this}),this._chipRipple._removeTriggerEvents()}select(){this._selected||(this._selected=!0,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}deselect(){this._selected&&(this._selected=!1,this._dispatchSelectionChange(),this._changeDetectorRef.markForCheck())}selectViaInteraction(){this._selected||(this._selected=!0,this._dispatchSelectionChange(!0),this._changeDetectorRef.markForCheck())}toggleSelected(t=!1){return this._selected=!this.selected,this._dispatchSelectionChange(t),this._changeDetectorRef.markForCheck(),this.selected}focus(){this._hasFocus||(this._elementRef.nativeElement.focus(),this._onFocus.next({chip:this})),this._hasFocus=!0}remove(){this.removable&&this.removed.emit({chip:this})}_handleClick(t){this.disabled&&t.preventDefault()}_handleKeydown(t){if(!this.disabled)switch(t.keyCode){case Yn.yY:case Yn.ZH:this.remove(),t.preventDefault();break;case Yn.L_:this.selectable&&this.toggleSelected(!0),t.preventDefault()}}_blur(){this._ngZone.onStable.pipe((0,L_.q)(1)).subscribe(()=>{this._ngZone.run(()=>{this._hasFocus=!1,this._onBlur.next({chip:this})})})}_dispatchSelectionChange(t=!1){this.selectionChange.emit({source:this,isUserInput:t,selected:this._selected})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(Mn.t4),e.Y36(Et.Y2,8),e.Y36(e.sBO),e.Y36(be.K0),e.Y36(M_.Qb,8),e.$8M("tabindex"))},n.\u0275dir=e.lG2({type:n,selectors:[["mat-basic-chip"],["","mat-basic-chip",""],["mat-chip"],["","mat-chip",""]],contentQueries:function(t,o,i){if(1&t&&(e.Suo(i,ks,5),e.Suo(i,Fs,5),e.Suo(i,Ds,5)),2&t){let a;e.iGM(a=e.CRH())&&(o.avatar=a.first),e.iGM(a=e.CRH())&&(o.trailingIcon=a.first),e.iGM(a=e.CRH())&&(o.removeIcon=a.first)}},hostAttrs:["role","option",1,"mat-chip","mat-focus-indicator"],hostVars:14,hostBindings:function(t,o){1&t&&e.NdJ("click",function(a){return o._handleClick(a)})("keydown",function(a){return o._handleKeydown(a)})("focus",function(){return o.focus()})("blur",function(){return o._blur()}),2&t&&(e.uIk("tabindex",o.disabled?null:o.tabIndex)("disabled",o.disabled||null)("aria-disabled",o.disabled.toString())("aria-selected",o.ariaSelected),e.ekj("mat-chip-selected",o.selected)("mat-chip-with-avatar",o.avatar)("mat-chip-with-trailing-icon",o.trailingIcon||o.removeIcon)("mat-chip-disabled",o.disabled)("_mat-animation-noopable",o._animationsDisabled))},inputs:{color:"color",disableRipple:"disableRipple",tabIndex:"tabIndex",selected:"selected",value:"value",selectable:"selectable",disabled:"disabled",removable:"removable"},outputs:{selectionChange:"selectionChange",destroyed:"destroyed",removed:"removed"},exportAs:["matChip"],features:[e.qOj]}),n})();const Ms=new e.OlP("mat-chips-default-options");let K_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[Et.rD,{provide:Ms,useValue:{separatorKeyCodes:[Yn.K5]}}],imports:[[Et.BQ]]}),n})();var hi=ce(4107),lt=ce(1125);let W_=(()=>{class n{constructor(t){this.sanitizer=t,this.filesChangeEmiter=new e.vpe}onDragOver(t){t.preventDefault(),t.stopPropagation()}onDragLeave(t){t.preventDefault(),t.stopPropagation()}onDrop(t){t.preventDefault(),t.stopPropagation(),this.filesChangeEmiter.emit(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(qi.H7))},n.\u0275dir=e.lG2({type:n,selectors:[["","appFileDragAndDrop",""]],hostBindings:function(t,o){1&t&&e.NdJ("dragover",function(a){return o.onDragOver(a)})("dragleave",function(a){return o.onDragLeave(a)})("drop",function(a){return o.onDrop(a)})},outputs:{filesChangeEmiter:"filesChangeEmiter"}}),n})();var Ri=ce(4847),zr=ce(5245),z_=ce(5867),Ls=ce(7446),Qi=ce(7531);let Is=(()=>{class n{transform(t,o,i,a){if(console.log("value",t,"args",o,"type",i,"subtype",a),"join"==i){if("pt"==a||"ft"==a)return o.tableNameUI?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.tableNameUI)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.tableNameUI)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t;if("pk"==a||"fk"==a)return o.fieldName?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.fieldName)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.fieldName)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t}else{if("tf"==i)return o.tableNameUI?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.fieldName)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.tableNameUI)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t;if("dataset"==i){if(console.log(t,"right"),"pt"==a||"ft"==a)return o.tableNameUI?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.tableNameUI)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.tableNameUI)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t;if("pk"==a||"fk"==a)return o.fieldName?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.fieldName)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.fieldName)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t}else if("createDSpopup"==i){if(console.log(t,"left"),"append"==a||"join"==a||"files"==a||"dataset"==a)return o.tableNameUI?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.fieldName)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.tableNameUI)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t}else if("Where"==i&&("columnSearch"==a||"groupBy"==a||"orderBy"==a))return o.tableNameUI?t.filter(s=>{var l,c,d,_;return null===(c=null===(l=s.filefieldName)||void 0===l?void 0:l.toLocaleLowerCase())||void 0===c?void 0:c.trim().includes(null===(_=null===(d=o.tableNameUI)||void 0===d?void 0:d.toLocaleLowerCase())||void 0===_?void 0:_.trim())}):t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"searchFilter",type:n,pure:!0}),n})();const G_=["form"],X_=["outerSort"],j_=["toggleButton"],ep=["menu"],tp=["innerTables"],np=["innerSort"];function ip(n,r){1&n&&(e.ynx(0),e.TgZ(1,"li"),e._uU(2,"Edit Solution"),e.qZA(),e.BQk())}function op(n,r){1&n&&(e.ynx(0),e.TgZ(1,"li"),e._uU(2,"Create New Solution"),e.qZA(),e.BQk())}function rp(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"1"),e.qZA(),e._uU(2," Add Process ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>0?"completed":"")}}function ap(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t.organizationName," ")}}const qe=function(n){return{"is-invalid":n}};function sp(n,r){if(1&n&&(e.TgZ(0,"mat-chip",34)(1,"div",15)(2,"label"),e._uU(3,"Choose Client"),e.TgZ(4,"sup"),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"mat-form-field",35)(7,"mat-select",36),e.YNc(8,ap,2,2,"mat-option",37),e.qZA()()()()),2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("ngClass",e.VKq(2,qe,t.submited&&t.Genericform.controls.chooseclient.errors)),e.xp6(1),e.Q6J("ngForOf",t.clients)}}function lp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",43)(1,"input",44),e.NdJ("change",function(){const a=e.CHM(t).$implicit,s=e.oxw(2).$implicit;return e.oxw(2).isAllSelectedIS(a,s)}),e.qZA(),e.TgZ(2,"label",45),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("checked",t.isSelected),e.xp6(2),e.Oqu(t.sectorName)}}function cp(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,lp,4,2,"div",42),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.sectorList)}}function dp(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel",null,39)(2,"mat-expansion-panel-header",40)(3,"mat-panel-title")(4,"span"),e._uU(5),e.qZA()(),e.TgZ(6,"mat-panel-description"),e._UZ(7,"div"),e.qZA()(),e.YNc(8,cp,2,1,"ng-template",41),e.qZA()),2&n){const t=r.$implicit;e.xp6(5),e.hij(" ",t.industryName," ")}}function _p(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",53)(1,"input",54),e.NdJ("change",function(){const a=e.CHM(t).$implicit;return e.oxw(3).isAllSelected(a)}),e.qZA(),e.TgZ(2,"label",55),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("checked",t.isSelected),e.xp6(2),e.Oqu(t.value)}}function pp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip")(1,"div",10)(2,"div",46)(3,"label",47),e._uU(4,"Add to Feature List"),e.qZA(),e.TgZ(5,"div",48)(6,"input",49),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).onChangeAddFeatureList(i)}),e.qZA(),e.TgZ(7,"label"),e._uU(8,"Yes"),e.qZA()()(),e.TgZ(9,"div",50)(10,"div",51)(11,"label"),e._uU(12,"Display Solution"),e.qZA(),e.TgZ(13,"div",48),e.YNc(14,_p,4,2,"div",52),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.xp6(14),e.Q6J("ngForOf",t.selectedCheckBox)}}function up(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.img.substr(0,30),"... ")}}function fp(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.img," ")}}function mp(n,r){1&n&&(e.TgZ(0,"div",73),e._uU(1," PNG, JPG, SVG & JPEG files are allowed "),e.qZA())}function hp(n,r){1&n&&(e.TgZ(0,"div",73),e._uU(1," MP4 & WMV files are allowed "),e.qZA())}function gp(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.vid.substr(0,30),"... ")}}function xp(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.vid," ")}}function vp(n,r){1&n&&(e.TgZ(0,"div",73),e._uU(1," PDF file are allowed "),e.qZA())}function Cp(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.brochure.substr(0,30),"... ")}}function Tp(n,r){if(1&n&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.showFileNameUI.brochure," ")}}const bp=function(n){return{primary1:n}},Es=function(n){return{primary:n}};function wp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",56)(1,"form",9)(2,"h6")(3,"sup"),e._uU(4,"*"),e.qZA(),e._uU(5,"Note: Upload image is mandatory."),e.qZA(),e.TgZ(6,"div",57)(7,"label",58)(8,"input",59),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).imgFileUpload(i)}),e.qZA(),e.TgZ(9,"div",60)(10,"div",61),e._UZ(11,"div",62),e.qZA(),e.TgZ(12,"div",63)(13,"h5"),e._uU(14,"Image"),e.qZA(),e.TgZ(15,"p"),e._uU(16,"Click to upload or drag and drop"),e.qZA(),e.YNc(17,up,2,1,"p",2),e.YNc(18,fp,2,1,"p",2),e.qZA()(),e.YNc(19,mp,2,0,"div",64),e.qZA(),e.TgZ(20,"div",65),e._uU(21),e.qZA()(),e.TgZ(22,"div",66)(23,"label",67)(24,"input",68),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).vidFileUpload(i)}),e.qZA(),e.TgZ(25,"div",60)(26,"div",61),e._UZ(27,"div",69),e.qZA(),e.TgZ(28,"div",63)(29,"h5"),e._uU(30,"Video"),e.qZA(),e.TgZ(31,"p"),e._uU(32,"Click to upload or drag and drop"),e.qZA()()(),e.YNc(33,hp,2,0,"div",64),e.qZA(),e.YNc(34,gp,2,1,"p",2),e.YNc(35,xp,2,1,"p",2),e.qZA(),e.TgZ(36,"div",66)(37,"label",70)(38,"input",71),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).brochureFileUpload(i)}),e.qZA(),e.TgZ(39,"div",60)(40,"div",61),e._UZ(41,"div",72),e.qZA(),e.TgZ(42,"div",63)(43,"h5"),e._uU(44,"Brochure"),e.qZA(),e.TgZ(45,"p"),e._uU(46,"Click to upload or drag and drop"),e.qZA()()(),e.YNc(47,vp,2,0,"div",64),e.qZA(),e.YNc(48,Cp,2,1,"p",2),e.YNc(49,Tp,2,1,"p",2),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.fileForm),e.xp6(5),e.Q6J("ngClass",e.VKq(15,bp,""!=t.showFileNameUI.img)),e.xp6(1),e.Q6J("ngClass",e.VKq(17,qe,t.submited&&t.fileForm.controls.imgFile.errors)),e.xp6(10),e.Q6J("ngIf",(null==t.showFileNameUI.img?null:t.showFileNameUI.img.length)>30),e.xp6(1),e.Q6J("ngIf",(null==t.showFileNameUI.img?null:t.showFileNameUI.img.length)<30),e.xp6(1),e.Q6J("ngIf",0==(null==t.showFileNameUI||null==t.showFileNameUI.img?null:t.showFileNameUI.img.length)),e.xp6(2),e.Oqu(t.errorMsgAP.img),e.xp6(2),e.Q6J("ngClass",e.VKq(19,Es,null!=t.imgFile)),e.xp6(10),e.Q6J("ngIf",0==(null==t.showFileNameUI||null==t.showFileNameUI.vid?null:t.showFileNameUI.vid.length)),e.xp6(1),e.Q6J("ngIf",(null==t.showFileNameUI.vid?null:t.showFileNameUI.vid.length)>30),e.xp6(1),e.Q6J("ngIf",(null==t.showFileNameUI.vid?null:t.showFileNameUI.vid.length)<30),e.xp6(2),e.Q6J("ngClass",e.VKq(21,Es,null!=t.brochureFile)),e.xp6(10),e.Q6J("ngIf",0==(null==t.showFileNameUI.brochure?null:t.showFileNameUI.brochure.length)),e.xp6(1),e.Q6J("ngIf",(null==t.showFileNameUI.brochure?null:t.showFileNameUI.brochure.length)>30),e.xp6(1),e.Q6J("ngIf",(null==t.showFileNameUI.brochure?null:t.showFileNameUI.brochure.length)<30)}}function Sp(n,r){1&n&&(e.TgZ(0,"tr"),e._UZ(1,"td"),e.TgZ(2,"td"),e._uU(3,"No Scenario(s) Added"),e.qZA(),e._UZ(4,"td"),e.qZA())}function Np(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.analyticsName," ")}}function Ap(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.analyticsObjective," ")}}function yp(n,r){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"input",86),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.analyticsName)}}function Dp(n,r){if(1&n&&(e.TgZ(0,"td"),e._UZ(1,"input",87),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.analyticsObjective)}}function kp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",88),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).analyticsRowEdit(a,s)}),e.qZA()}}function Fp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",89),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).editSeniro(a,s)}),e.qZA()}}function Mp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.YNc(1,Np,2,1,"td",2),e.YNc(2,Ap,2,1,"td",2),e.YNc(3,yp,2,1,"td",2),e.YNc(4,Dp,2,1,"td",2),e.TgZ(5,"td"),e.YNc(6,kp,1,0,"span",83),e.YNc(7,Fp,1,0,"span",84),e.TgZ(8,"span",85),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(5).deleteAnalyticsRow(a)}),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw(5);e.xp6(1),e.Q6J("ngIf",o.isAnalyticsRowEdit!=t),e.xp6(1),e.Q6J("ngIf",o.isAnalyticsRowEdit!=t),e.xp6(1),e.Q6J("ngIf",o.isAnalyticsRowEdit==t),e.xp6(1),e.Q6J("ngIf",o.isAnalyticsRowEdit==t),e.xp6(2),e.Q6J("ngIf",o.isAnalyticsRowEdit!=t),e.xp6(1),e.Q6J("ngIf",o.isAnalyticsRowEdit==t)}}function Lp(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",80)(2,"table",81)(3,"thead")(4,"tr")(5,"th",82),e._uU(6,"Scenario Name"),e.qZA(),e.TgZ(7,"th",82),e._uU(8,"Description"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Action"),e.qZA()()(),e.TgZ(11,"tbody"),e.YNc(12,Sp,5,0,"tr",2),e.YNc(13,Mp,9,6,"tr",26),e.qZA()()()()),2&n){const t=e.oxw(4);e.xp6(12),e.Q6J("ngIf",0==(null==t.seniroList?null:t.seniroList.length)),e.xp6(1),e.Q6J("ngForOf",t.seniroList)}}function Ip(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"form",75,76),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(3).onSubmit()}),e.TgZ(2,"div",77)(3,"a",78),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).Popup()}),e._uU(4,"Add Scenario "),e._UZ(5,"span",79),e.qZA()(),e.YNc(6,Lp,14,2,"div",2),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("formGroup",t.seniroForm),e.xp6(6),e.Q6J("ngIf","Generic"==t.selectedProcessType)}}function Ep(n,r){if(1&n&&(e.TgZ(0,"div",34)(1,"div",14)(2,"div",12),e.YNc(3,Ip,7,2,"form",74),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf","Generic"==t.selectedProcessType)}}function Zp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8)(2,"form",9)(3,"div",10)(4,"div",11)(5,"div",10)(6,"div",12),e.YNc(7,sp,9,4,"mat-chip",13),e.qZA()(),e.TgZ(8,"div",14)(9,"div",12)(10,"div",15)(11,"label"),e._uU(12,"Process Name"),e.TgZ(13,"sup"),e._uU(14,"*"),e.qZA()(),e._UZ(15,"input",16),e.qZA()()(),e.TgZ(16,"div",10)(17,"div",17)(18,"div",15)(19,"label"),e._uU(20,"Process Description"),e.TgZ(21,"sup"),e._uU(22,"*"),e.qZA()(),e._UZ(23,"textarea",18),e.qZA()(),e.TgZ(24,"div",17)(25,"div",15)(26,"label"),e._uU(27,"Select Industry / Sector"),e.TgZ(28,"sup"),e._uU(29,"*"),e.qZA()(),e.TgZ(30,"div",19)(31,"div",20)(32,"input",21),e.NdJ("change",function(i){return e.CHM(t),e.oxw().checkUncheckISAll(i)}),e.qZA(),e.TgZ(33,"label",22),e._uU(34,"All"),e.qZA(),e.TgZ(35,"input",23),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().searchFilter(i)}),e.qZA(),e.TgZ(36,"button",24),e._UZ(37,"span",25),e.qZA()(),e.TgZ(38,"mat-accordion")(39,"div"),e.YNc(40,dp,9,1,"mat-expansion-panel",26),e.qZA()()()()()()(),e.TgZ(41,"div",27),e.YNc(42,pp,15,1,"mat-chip",2),e.YNc(43,wp,50,23,"div",28),e.qZA()()(),e.YNc(44,Ep,4,1,"div",13),e.qZA(),e.TgZ(45,"div",29)(46,"button",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().reset()}),e._uU(47," Reset"),e._UZ(48,"span",31),e.qZA(),e.TgZ(49,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:1},"next")}),e._uU(50," Save and Continue"),e._UZ(51,"span",33),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.Genericform),e.xp6(5),e.Q6J("ngIf",t.tabClientSpec),e.xp6(8),e.Q6J("ngClass",e.VKq(9,qe,t.submited&&t.Genericform.controls.processNameControl.errors)),e.xp6(8),e.Q6J("ngClass",e.VKq(11,qe,t.submited&&t.Genericform.controls.processDescriptionControl.errors)),e.xp6(9),e.Q6J("checked",t.selectunall),e.xp6(8),e.Q6J("ngForOf",t.searchindusData),e.xp6(2),e.Q6J("ngIf",t.tabSolDisplay),e.xp6(1),e.Q6J("ngIf","Generic"==t.selectedProcessType),e.xp6(1),e.Q6J("ngIf",t.tabGenericInfo)}}function Pp(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"2"),e.qZA(),e._uU(2," Upload Files ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>1?"completed":"")}}function Op(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",12)(2,"div",94)(3,"div",95),e.NdJ("filesChangeEmiter",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i,"dragNDrop")}),e.TgZ(4,"label",96)(5,"input",97),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i,"click")}),e.qZA(),e._UZ(6,"span",98),e.TgZ(7,"h5"),e._uU(8,"Drag and drop files, or "),e.TgZ(9,"span"),e._uU(10,"Browse"),e.qZA()(),e.TgZ(11,"p",99),e._uU(12," Supported XLS, PDF & CSV files"),e._UZ(13,"br"),e._uU(14," (Max. 500kb) "),e.qZA()()()()()()}}function Up(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"th",125)(1,"input",126),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(3).masterSelected=i})("change",function(){return e.CHM(t),e.oxw(3).checkUncheckAllUploadFiles()}),e.qZA(),e._uU(2," \xa0 "),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.masterSelected)}}function Bp(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",130),e.BQk())}function Jp(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",131),e.BQk())}function qp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",129),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(3);return s.expandedElement=s.expandedElement===a?null:a,i.stopPropagation()}),e.YNc(2,Bp,2,0,"ng-container",2),e.YNc(3,Jp,2,0,"ng-container",2),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngIf",o.expandedElement!==t),e.xp6(1),e.Q6J("ngIf",o.expandedElement===t)}}function Rp(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",127)(1,"input",128),e.NdJ("change",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).isFileSelectedInUF(i,s)})("ngModelChange",function(i){return e.CHM(t).$implicit.isFileSelected=i}),e.qZA(),e.YNc(2,qp,4,2,"ng-container",2),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngModel",t.isFileSelected),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt)}}function Qp(n,r){if(1&n&&(e.TgZ(0,"th",134),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t," ")}}function Hp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",135),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3).$implicit;return e.oxw(4).previewPopup(i)}),e.qZA(),e.TgZ(2,"span",136),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3).$implicit;return e.oxw(4).copyTableName(i,"parent")}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Tol(t)}}function Yp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",137),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(3).$implicit;return e.oxw(4).deleteTables(i,a,0,"file")}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Tol(t)}}function Vp(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Hp,3,3,"ng-container",2),e.YNc(2,Yp,2,3,"ng-container",2),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.includes("icon_eyeopen")),e.xp6(1),e.Q6J("ngIf",t.includes("delete__l__stroke"))}}function $p(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Vp,3,2,"ng-container",26),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t[o])}}function Kp(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"label"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(2),e.Oqu(t[o])}}function Wp(n,r){if(1&n&&(e.TgZ(0,"td",127),e.YNc(1,$p,2,1,"ng-container",2),e.YNc(2,Kp,3,1,"ng-container",2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","Action"==t),e.xp6(1),e.Q6J("ngIf","Action"!=t)}}function zp(n,r){1&n&&(e.ynx(0,132),e.YNc(1,Qp,2,1,"th",133),e.YNc(2,Wp,3,2,"td",112),e.BQk()),2&n&&e.s9C("matColumnDef",r.$implicit)}function Gp(n,r){1&n&&e._UZ(0,"th",134)}function Xp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",135),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(8).previewPopup(i)}),e.qZA(),e.TgZ(2,"span",136),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(8).copyTableName(i,"child")}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Tol(t[o])}}function jp(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",145),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.sheetSelected=i})("change",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw(5).$implicit;return e.oxw(3).isAllSelectedUploadFiles(a,i)}),e.qZA(),e._uU(2),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngModel",t.sheetSelected),e.xp6(1),e.AsE(" ",t[o],".",t.fileExt," ")}}function eu(n,r){if(1&n&&(e.ynx(0,127),e.TgZ(1,"td"),e.YNc(2,Xp,3,3,"ng-container",2),e.YNc(3,jp,3,3,"ng-container",2),e.qZA(),e.BQk()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(2),e.Q6J("ngIf",t[o].includes("dds-icon_eyeopen")),e.xp6(1),e.Q6J("ngIf",!t[o].includes("dds-icon_eyeopen"))}}function tu(n,r){1&n&&(e.ynx(0,132),e.YNc(1,Gp,1,0,"th",133),e.YNc(2,eu,4,2,"ng-container",112),e.BQk()),2&n&&e.s9C("matColumnDef",r.$implicit)}function nu(n,r){1&n&&e._UZ(0,"tr",146)}function iu(n,r){1&n&&e._UZ(0,"tr",147)}function ou(n,r){if(1&n&&(e.TgZ(0,"div",141)(1,"table",142,143),e.YNc(4,tu,3,1,"ng-container",113),e.YNc(5,nu,1,0,"tr",115),e.YNc(6,iu,1,0,"tr",144),e.qZA()()),2&n){const t=e.oxw(3).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("dataSource",t.totalSheetList),e.xp6(3),e.Q6J("ngForOf",o.innerDisplayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",o.innerDisplayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.innerDisplayedColumns)}}function ru(n,r){if(1&n&&(e.TgZ(0,"div",139),e.YNc(1,ou,7,4,"div",140),e.qZA()),2&n){const t=e.oxw(2).$implicit,o=e.oxw(3);e.Q6J("@detailExpand",t==o.expandedElement?"expanded":"collapsed"),e.xp6(1),e.Q6J("ngIf",o.expandedElement)}}function au(n,r){if(1&n&&(e.ynx(0),e.YNc(1,ru,2,2,"div",138),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==t.totalSheetList?null:t.totalSheetList.data.length)}}function su(n,r){if(1&n&&(e.TgZ(0,"td",127),e.YNc(1,au,2,1,"ng-container",2),e.qZA()),2&n){const t=r.$implicit,o=e.oxw(3);e.uIk("colspan",o.columnsToDisplayWithExpand.length),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt)}}function lu(n,r){1&n&&e._UZ(0,"tr",146)}function cu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",148),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).toggleRow(a)}),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.ekj("example-element-row",null==t.totalSheetList?null:t.totalSheetList.data.length)("example-expanded-row",o.expandedElement===t)}}function du(n,r){1&n&&e._UZ(0,"tr",149)}const _u=function(){return["expandedDetail"]};function pu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",100)(2,"div",101)(3,"h3",102),e._uU(4,"Uploaded Files"),e.qZA(),e.TgZ(5,"div",103)(6,"input",104),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(2).applyFilter(i,"UF")}),e.qZA(),e.TgZ(7,"button",105),e._UZ(8,"span",106),e.qZA()()(),e.TgZ(9,"div",107)(10,"table",108,109),e.ynx(12,110),e.YNc(13,Up,3,1,"th",111),e.YNc(14,Rp,3,2,"td",112),e.BQk(),e.YNc(15,zp,3,1,"ng-container",113),e.ynx(16,114),e.YNc(17,su,2,2,"td",112),e.BQk(),e.YNc(18,lu,1,0,"tr",115),e.YNc(19,cu,1,4,"tr",116),e.YNc(20,du,1,0,"tr",117),e.qZA()()(),e.TgZ(21,"div",118)(22,"div",101)(23,"button",119),e._UZ(24,"span",120),e.qZA()(),e.TgZ(25,"div",121)(26,"div",122)(27,"div",95),e.NdJ("filesChangeEmiter",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i,"dragNDrop")}),e.TgZ(28,"label",96)(29,"input",97),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i,"click")}),e.qZA(),e._UZ(30,"span",98),e.TgZ(31,"h5"),e._uU(32,"Drag and drop files, or "),e.TgZ(33,"span"),e._uU(34,"Browse"),e.qZA()(),e.TgZ(35,"p",99),e._uU(36," Supported XLS, PDF & CSV files"),e._UZ(37,"br"),e._uU(38," (Max. 500kb) "),e.qZA()()()(),e.TgZ(39,"form",9)(40,"h3",102),e._uU(41,"Select Dataset Creation Type:"),e.qZA(),e.TgZ(42,"div",123)(43,"label"),e._uU(44,"Manual"),e.qZA(),e.TgZ(45,"mat-slide-toggle",124),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.uploadedManualToggle(i.uploadedManualToggleForm)}),e.qZA(),e.TgZ(46,"label"),e._uU(47,"Upload Script"),e.qZA()()()()()()}if(2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("dataSource",t.dataSource),e.xp6(5),e.Q6J("ngForOf",t.columnsToDisplay),e.xp6(3),e.Q6J("matHeaderRowDef",t.columnsToDisplayWithExpand),e.xp6(1),e.Q6J("matRowDefColumns",t.columnsToDisplayWithExpand),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(6,_u)),e.xp6(19),e.Q6J("formGroup",t.uploadedManualToggleForm)}}function uu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",150),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:2},"next")}),e._uU(1," Next "),e._UZ(2,"span",33),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isUploadFilesNextBtnEnable)}}function fu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card")(1,"div",8)(2,"div",90),e.YNc(3,Op,15,0,"div",91),e.YNc(4,pu,48,7,"div",91),e.qZA()(),e.TgZ(5,"div",29)(6,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:0},"prev")}),e._UZ(7,"span",92),e._uU(8," Prev "),e.qZA(),e.YNc(9,uu,3,1,"button",93),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",0==t.fileListt.length),e.xp6(1),e.Q6J("ngIf",0!=t.fileListt.length),e.xp6(5),e.Q6J("ngIf",t.fileListt.length>0)}}function mu(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"3"),e.qZA(),e._uU(2," Target Files ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>2?"completed":"")}}function hu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",171)(1,"input",158),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isChecked=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).index;return e.oxw(2).checkColumnInTF(i,s,l)}),e.qZA(),e._uU(2),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngModel",t.isChecked),e.xp6(1),e.hij(" ",t.fieldName," ")}}const Zt=function(n){return{tableNameUI:n}};function gu(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"td",160),e.ynx(2,161),e.TgZ(3,"mat-accordion",162)(4,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(5,"mat-expansion-panel-header",164)(6,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(7,"img",166),e.TgZ(8,"input",158),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isCheckedInTF=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).checkSheetInTF(i,a)}),e.qZA(),e._uU(9),e.qZA(),e.TgZ(10,"div",167),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(11,"span",168),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(2).fileClickedinTF(a,0,s,"files",s.tableName)}),e.qZA()()(),e.TgZ(12,"input",169),e.NdJ("keyup",function(i){e.CHM(t);const a=e.oxw().index;return e.oxw(2).searchField(i,0,0,a,"tf","")}),e.qZA(),e.YNc(13,hu,3,2,"div",170),e.ALo(14,"searchFilter"),e.qZA()(),e.BQk(),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(),o=t.$implicit,i=t.index,a=e.oxw(2);e.xp6(4),e.Q6J("expanded",a.allExpandState),e.xp6(4),e.Q6J("ngModel",o.isCheckedInTF),e.xp6(1),e.hij(" ",o.fileName,""),e.xp6(3),e.Q6J("value",o.searchValueInTF),e.xp6(1),e.Q6J("ngForOf",e.gM2(14,5,o.sheet,e.VKq(10,Zt,a.targetFileList[i].searchValueInTF),"tf",""))}}function xu(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,gu,15,12,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.sheetSelected)}}function vu(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",172)(2,"div",8)(3,"div",173)(4,"h3"),e._UZ(5,"span",174),e._uU(6,"NOTE "),e.qZA(),e.TgZ(7,"p"),e._uU(8," Here you change/alter the column name and column type in each file by clicking on edit icon. "),e.qZA(),e.TgZ(9,"h4"),e._uU(10,"How to do it?"),e.qZA(),e.TgZ(11,"p"),e._uU(12," If you click on the edit icon in each row, the column details of that file will open in a popup, in which You can change the column type and column name in each column here. "),e.qZA(),e.TgZ(13,"p"),e._uU(14,"Once the change is done it needs to be saved."),e.qZA()()()(),e.BQk())}function Cu(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",151)(2,"div",152)(3,"div",8)(4,"div",153)(5,"div",101)(6,"h3",102),e._uU(7,"Target Files"),e.qZA(),e.TgZ(8,"div",103)(9,"input",104),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i,"TF")}),e.qZA(),e.TgZ(10,"button",154),e._UZ(11,"span",155),e.qZA()(),e.TgZ(12,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.targetFilesInfoBtn=!i.targetFilesInfoBtn}),e._UZ(13,"span",120),e.qZA()(),e.TgZ(14,"div",157)(15,"table",81)(16,"thead")(17,"tr",20)(18,"th")(19,"input",158),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().masterSelectedInTF=i})("change",function(i){return e.CHM(t),e.oxw().masterCheckedInTF(i)}),e.qZA(),e._uU(20," Source Files "),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Action"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,xu,2,1,"tr",26),e.qZA()()()()()(),e.YNc(25,vu,15,0,"ng-container",2),e.qZA(),e.TgZ(26,"div",29)(27,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:1},"prev")}),e._UZ(28,"span",92),e._uU(29," Prev "),e.qZA(),e.TgZ(30,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3},"next")}),e._uU(31," Next "),e._UZ(32,"span",159),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngClass",t.targetFilesInfoBtn?"":"expandTargetFile"),e.xp6(18),e.Q6J("ngModel",t.masterSelectedInTF),e.xp6(5),e.Q6J("ngForOf",t.targetFileList),e.xp6(1),e.Q6J("ngIf",t.targetFilesInfoBtn)}}function Tu(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"4"),e.qZA(),e._uU(2," Append Files ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>3?"completed":"")}}function bu(n,r){1&n&&(e.TgZ(0,"tr"),e._uU(1," No Results "),e.qZA())}function wu(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",189),e.BQk())}function Su(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",190),e.BQk())}function Nu(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",191),e.BQk())}function Au(n,r){1&n&&(e.ynx(0),e._UZ(1,"img",192),e.BQk())}function yu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",161)(1,"td")(2,"div",186)(3,"input",158),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isCheckedInAppend=i})("change",function(i){return e.CHM(t),e.oxw(2).isCheckedInAppend(i)}),e.qZA(),e.YNc(4,wu,2,0,"ng-container",2),e.YNc(5,Su,2,0,"ng-container",2),e.YNc(6,Nu,2,0,"ng-container",2),e.YNc(7,Au,2,0,"ng-container",2),e.TgZ(8,"label"),e._uU(9),e.qZA()()(),e._UZ(10,"td",187),e.TgZ(11,"td")(12,"span",188),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).previewPopup(a)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(3),e.Q6J("ngModel",t.isCheckedInAppend),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==t.fileExt),e.xp6(2),e.Oqu(t.fileName)}}function Du(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.submittedErrorMsg," ")}}function ku(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",189),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.lnq(" ",t.fileName,"-",t.sheetName,".",t.fileExt," ")}}function Fu(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",190),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function Mu(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",191),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function Lu(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",192),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function Iu(n,r){if(1&n&&(e.TgZ(0,"div",171),e.YNc(1,ku,3,3,"ng-container",2),e.YNc(2,Fu,3,1,"ng-container",2),e.YNc(3,Mu,3,1,"ng-container",2),e.YNc(4,Lu,3,1,"ng-container",2),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==o.fileExt)}}function Eu(n,r){if(1&n){const t=e.EpF();e.ynx(0,161),e.TgZ(1,"mat-accordion",162)(2,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(2).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(2).panelOpenState=!1}),e.TgZ(3,"mat-expansion-panel-header",164)(4,"label",193),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(5,"img",166),e._uU(6),e.qZA(),e.TgZ(7,"div",167),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(8,"span",188),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).previewPopup(a)}),e.qZA(),e.TgZ(9,"span",194),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(2).deleteTables(i,s,l,"append")}),e.qZA()()(),e.YNc(10,Iu,5,4,"div",170),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("expanded",o.allExpandState),e.xp6(2),e.s9C("title",t.appendName),e.xp6(2),e.hij(" Appended - ",t.appendName,""),e.xp6(4),e.Q6J("ngForOf",t.appendDtos)}}function Zu(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8)(2,"div",175)(3,"div",46)(4,"div",101)(5,"h3",102),e._uU(6,"Source Files"),e.qZA(),e.TgZ(7,"div",103)(8,"input",176),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i,"A")}),e.qZA(),e.TgZ(9,"button",24),e._UZ(10,"span",25),e.qZA()()(),e.TgZ(11,"div",107)(12,"table",177)(13,"thead")(14,"tr",178),e.NdJ("matSortChange",function(i){return e.CHM(t),e.oxw().sortData(i,"append","SF")}),e.TgZ(15,"th",179),e._uU(16,"Files"),e.qZA(),e._UZ(17,"th"),e.TgZ(18,"th"),e._uU(19,"Actions"),e.qZA()()(),e.TgZ(20,"tbody"),e.YNc(21,bu,2,0,"tr",2),e.YNc(22,yu,13,6,"tr",180),e.qZA()()(),e.YNc(23,Du,2,1,"div",181),e.qZA(),e.TgZ(24,"div",182)(25,"button",183),e.NdJ("click",function(){return e.CHM(t),e.oxw().addAppend()}),e._uU(26," Append "),e._UZ(27,"span",159),e.qZA()(),e.TgZ(28,"div",46)(29,"div",101)(30,"h3",102),e._uU(31,"Append Files"),e.qZA()(),e.TgZ(32,"div",107)(33,"table",184)(34,"thead")(35,"tr",178),e.NdJ("matSortChange",function(i){return e.CHM(t),e.oxw().sortData(i,"append","AF")}),e.TgZ(36,"th",185),e._uU(37,"Files"),e.qZA(),e._UZ(38,"th"),e.TgZ(39,"th"),e._uU(40,"Actions"),e.qZA()()(),e.TgZ(41,"tbody")(42,"tr")(43,"td",160),e.YNc(44,Eu,11,4,"ng-container",180),e.qZA()()()()()()()(),e.TgZ(45,"div",29)(46,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:2},"prev")}),e._UZ(47,"span",92),e._uU(48," Prev "),e.qZA(),e.TgZ(49,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:4},"next")}),e._uU(50," Next "),e._UZ(51,"span",159),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(21),e.Q6J("ngIf",0==t.sourceFilesList.length),e.xp6(1),e.Q6J("ngForOf",t.sourceFilesList),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(21),e.Q6J("ngForOf",t.getAppendFilesList)}}function Pu(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"5"),e.qZA(),e._uU(2," Join Files ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>4?"completed":"")}}function Ou(n,r){1&n&&e._UZ(0,"span",203)}function Uu(n,r){1&n&&e._UZ(0,"span",204)}function Bu(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"td")(2,"div",186)(3,"input",206),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isCheckedInJoin=i})("change",function(i){return e.CHM(t),e.oxw(3).checkedInJoin(i)}),e.qZA(),e.TgZ(4,"label"),e._uU(5),e.qZA()()(),e.TgZ(6,"td")(7,"div",207)(8,"span",188),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).previewPopup(i)}),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngModel",t.isCheckedInJoin),e.xp6(2),e.Oqu(t.tableNameUI)}}function Ju(n,r){if(1&n&&(e.TgZ(0,"tr",205),e.YNc(1,Bu,9,2,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Append"==t.type&&t.isAppendExpandInJoin)}}function qu(n,r){1&n&&e._UZ(0,"span",203)}function Ru(n,r){1&n&&e._UZ(0,"span",204)}function Qu(n,r){1&n&&e.GkF(0)}function Hu(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",189),e.BQk())}function Yu(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",190),e.BQk())}function Vu(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",191),e.BQk())}function $u(n,r){1&n&&(e.ynx(0),e._UZ(1,"img",192),e.BQk())}function Ku(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"td")(2,"div",186)(3,"input",206),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isCheckedInJoin=i})("change",function(i){return e.CHM(t),e.oxw(3).checkedInJoin(i)}),e.qZA(),e.YNc(4,Qu,1,0,"ng-container",2),e.YNc(5,Hu,2,0,"ng-container",2),e.YNc(6,Yu,2,0,"ng-container",2),e.YNc(7,Vu,2,0,"ng-container",2),e.YNc(8,$u,2,0,"ng-container",2),e.TgZ(9,"label"),e._uU(10),e.qZA()()(),e.TgZ(11,"td")(12,"div",207)(13,"span",188),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).previewPopup(i)}),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngModel",t.isCheckedInJoin),e.xp6(1),e.Q6J("ngIf",1==t.isAppend),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==t.fileExt),e.xp6(2),e.Oqu(t.tableNameUI)}}function Wu(n,r){if(1&n&&(e.TgZ(0,"tr",205),e.YNc(1,Ku,14,7,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","files"==t.type&&t.isSourceFilesExpandInJoin)}}function zu(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.submittedErrorMsg," ")}}function Gu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",208),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).joinSheets()}),e._uU(1," Join "),e._UZ(2,"span",159),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.enableAddBtn)("ngClass",t.enableAddBtn?"disabled":"")}}function Xu(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",161)(1,"td")(2,"label",209),e._UZ(3,"img",210),e._uU(4),e.qZA()(),e._UZ(5,"td",187),e.TgZ(6,"td"),e.ynx(7),e.TgZ(8,"span",188),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).previewPopup(a)}),e.qZA(),e.TgZ(9,"span",211),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(2).deleteTables(i,s,l,"merge")}),e.qZA(),e.BQk(),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.s9C("title",t.mergeName),e.xp6(2),e.hij(" Joined - ",t.mergeName,"")}}function ju(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8)(2,"div",175)(3,"div",46)(4,"div",101)(5,"h3",102),e._uU(6,"Appended & Source Files"),e.qZA(),e.TgZ(7,"div",103)(8,"input",176),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i,"J")}),e.qZA(),e.TgZ(9,"button",24),e._UZ(10,"span",25),e.qZA()()(),e.TgZ(11,"div",107)(12,"table",195)(13,"thead")(14,"tr")(15,"th"),e._uU(16,"Files"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Actions"),e.qZA()()(),e.TgZ(19,"tbody")(20,"tr")(21,"td",196)(22,"div",197),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapseAppendInJoin()}),e.TgZ(23,"h5"),e.YNc(24,Ou,1,0,"span",198),e.YNc(25,Uu,1,0,"span",199),e._uU(26," Appended Files "),e.qZA()()()(),e.YNc(27,Ju,2,1,"tr",200),e.qZA(),e.TgZ(28,"tbody")(29,"tr")(30,"td",196)(31,"div",201),e.NdJ("click",function(){return e.CHM(t),e.oxw().expandCollapseSourceFilesInJoin()}),e.TgZ(32,"h5"),e.YNc(33,qu,1,0,"span",198),e.YNc(34,Ru,1,0,"span",199),e._uU(35," Source Files "),e.qZA()()()(),e.YNc(36,Wu,2,1,"tr",200),e.qZA()()(),e.YNc(37,zu,2,1,"div",181),e.qZA(),e.TgZ(38,"div",182),e.YNc(39,Gu,3,2,"button",202),e.qZA(),e.TgZ(40,"div",46)(41,"div",101)(42,"h3",102),e._uU(43,"Joined Files"),e.qZA()(),e.TgZ(44,"div",107)(45,"table",184)(46,"thead")(47,"tr")(48,"th"),e._uU(49,"Files"),e.qZA(),e._UZ(50,"th"),e.TgZ(51,"th"),e._uU(52,"Actions"),e.qZA()()(),e.TgZ(53,"tbody"),e.YNc(54,Xu,10,2,"tr",180),e.qZA()()()()()(),e.TgZ(55,"div",29)(56,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3},"prev")}),e._UZ(57,"span",92),e._uU(58," Prev "),e.qZA(),e.TgZ(59,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:5},"next")}),e._uU(60," Next "),e._UZ(61,"span",159),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(24),e.Q6J("ngIf",t.isAppendExpandInJoin),e.xp6(1),e.Q6J("ngIf",!t.isAppendExpandInJoin),e.xp6(2),e.Q6J("ngForOf",t.append_SourceFilesList),e.xp6(6),e.Q6J("ngIf",t.isSourceFilesExpandInJoin),e.xp6(1),e.Q6J("ngIf",!t.isSourceFilesExpandInJoin),e.xp6(2),e.Q6J("ngForOf",t.append_SourceFilesList),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(2),e.Q6J("ngIf",t.append_SourceFilesList.length>0),e.xp6(15),e.Q6J("ngForOf",t.getJoinFilesList)}}function ef(n,r){if(1&n&&(e.TgZ(0,"span",7),e._uU(1,"6"),e.qZA(),e._uU(2," Data Modelling ")),2&n){const t=e.oxw();e.Q6J("ngClass",t.activeTab>5?"completed":"")}}function tf(n,r){1&n&&(e.TgZ(0,"div",222)(1,"p"),e._uU(2," Create Datasets by using "),e.TgZ(3,"span"),e._uU(4,"Source"),e.qZA(),e._uU(5,", "),e.TgZ(6,"span"),e._uU(7,"Appended"),e.qZA(),e._uU(8," and "),e.TgZ(9,"span"),e._uU(10,"Join Files "),e.qZA()()())}function nf(n,r){1&n&&(e.TgZ(0,"div"),e._uU(1,"No Data"),e.qZA())}function of(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",231)(1,"span",236),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(3).editDatasetFile(i)}),e._uU(2,"Edit"),e.qZA()()}}function rf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",230)(1,"button",231)(2,"span",232),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).previewPopup(i)}),e._uU(3,"Preview"),e.qZA()(),e.YNc(4,of,3,0,"button",233),e.TgZ(5,"button",231)(6,"span",234),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).callGetViewscript(i)}),e._uU(7,"View Script"),e.qZA()(),e.TgZ(8,"button",231)(9,"span",235),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"dataset")}),e._uU(10,"Delete"),e.qZA()()()}if(2&n){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("ngIf",!t.append)}}function af(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"label"),e._uU(3),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function sf(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",171),e.YNc(1,af,4,1,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function lf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"input",225),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).onCheck(s,"dataset"),i.stopPropagation()}),e.qZA(),e.TgZ(3,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(4),e.qZA(),e.TgZ(5,"button",226),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).ellipsisInDM(s,l),i.stopPropagation()}),e.TgZ(6,"mat-icon"),e._uU(7,"more_vert"),e.qZA()(),e.YNc(8,rf,11,1,"div",227),e.qZA(),e.TgZ(9,"div",10)(10,"div",228)(11,"input",229),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).applyFilterForDMTables(i,s,l,"dataset")}),e.qZA()()(),e.YNc(12,sf,2,1,"mat-accordion",170),e.ALo(13,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.Oqu(t.datasetName),e.xp6(4),e.Q6J("ngIf",t.isSelectedEllipsis),e.xp6(4),e.Q6J("ngForOf",e.gM2(13,4,t.datasetFieldDTOList,e.VKq(9,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","dataset"))}}function cf(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",223),e.YNc(1,nf,2,0,"div",2),e.YNc(2,lf,14,11,"mat-expansion-panel",224),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)),e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function df(n,r){1&n&&(e.TgZ(0,"div"),e._uU(1,"No Data"),e.qZA())}function _f(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"input",225),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).onCheck(s,"scriptGeneratedTable"),i.stopPropagation()}),e.qZA(),e.TgZ(3,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(4),e.qZA(),e.TgZ(5,"div",238),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(6,"span",232),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a)}),e.qZA()()()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.Oqu(t.tableName)}}function pf(n,r){if(1&n&&(e.TgZ(0,"div")(1,"mat-accordion",223),e.YNc(2,df,2,0,"div",2),e.YNc(3,_f,7,2,"mat-expansion-panel",224),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",0==(null==t.uploadedScriptTableList?null:t.uploadedScriptTableList.length)),e.xp6(1),e.Q6J("ngForOf",t.uploadedScriptTableList)}}function uf(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function ff(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function mf(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function hf(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function gf(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function xf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",260),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).addNewRelation(i)}),e.qZA()}}function vf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",261),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteRelationRow(i)}),e.qZA()}}function Cf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",250)(1,"div",10)(2,"div",27)(3,"label"),e._uU(4,"Select from Table"),e.qZA(),e.TgZ(5,"mat-form-field",35)(6,"mat-select",251),e.NdJ("selectionChange",function(){const a=e.CHM(t).index;return e.oxw(3).onChangeTable(a,"from")}),e.YNc(7,uf,2,2,"mat-option",37),e.qZA()()(),e.TgZ(8,"div",118)(9,"label"),e._uU(10,"Select Relationship"),e.qZA(),e.TgZ(11,"mat-form-field",35)(12,"mat-select",252),e.YNc(13,ff,2,2,"mat-option",37),e.qZA()()(),e.TgZ(14,"div",27)(15,"label"),e._uU(16,"Select to table"),e.qZA(),e.TgZ(17,"mat-form-field",35)(18,"mat-select",253),e.NdJ("selectionChange",function(){const a=e.CHM(t).index;return e.oxw(3).onChangeToTable(a,"to")}),e.YNc(19,mf,2,2,"mat-option",37),e.qZA()()()(),e.TgZ(20,"div",10)(21,"div",27)(22,"label"),e._uU(23,"Select table column"),e.qZA(),e.TgZ(24,"mat-form-field",35)(25,"mat-select",254),e.YNc(26,hf,2,2,"mat-option",37),e.qZA()()(),e._UZ(27,"div",118),e.TgZ(28,"div",27)(29,"label"),e._uU(30,"Select table column"),e.qZA(),e.TgZ(31,"mat-form-field",35)(32,"mat-select",255),e.YNc(33,gf,2,2,"mat-option",37),e.qZA()()(),e.TgZ(34,"div",256),e._UZ(35,"label"),e.YNc(36,xf,1,0,"button",257),e.YNc(37,vf,1,0,"button",258),e.qZA()(),e._UZ(38,"div",259),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);let a,s,l,c,d;e.Q6J("formGroupName",o),e.xp6(6),e.Q6J("ngClass",e.VKq(13,qe,i.submitedRelation&&(null==(a=t.get("fromTable"))?null:a.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].fromTableList),e.xp6(5),e.Q6J("ngClass",e.VKq(15,qe,i.submitedRelation&&(null==(s=t.get("crossFilteringBehavior"))?null:s.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].cfbList),e.xp6(5),e.Q6J("ngClass",e.VKq(17,qe,i.submitedRelation&&(null==(l=t.get("toTable"))?null:l.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].toTableList),e.xp6(6),e.Q6J("ngClass",e.VKq(19,qe,i.submitedRelation&&(null==(c=t.get("fromColumn"))?null:c.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].fromColumnList),e.xp6(6),e.Q6J("ngClass",e.VKq(21,qe,i.submitedRelation&&(null==(d=t.get("toColumn"))?null:d.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].toColumnList),e.xp6(3),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function Tf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Map Tables"),e.qZA(),e.TgZ(6,"button",242),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeRelModal()}),e._UZ(7,"span",243),e.qZA()(),e.TgZ(8,"div",244)(9,"form",9)(10,"div",245),e.YNc(11,Cf,39,23,"div",246),e.qZA()()(),e.TgZ(12,"div",247)(13,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeRelModal()}),e._uU(14,"Cancel "),e._UZ(15,"span",249),e.qZA(),e.TgZ(16,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).saveRelationship()}),e._uU(17,"Add "),e._UZ(18,"span",33),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.xp6(9),e.Q6J("formGroup",t.addRelationshipForm),e.xp6(2),e.Q6J("ngForOf",t.relationshipArr().controls)}}function bf(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",262),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(2).isOverride=i})("click",function(){return e.CHM(t),e.oxw(2).overrideConfirm()}),e.qZA(),e.TgZ(2,"label",263),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).overrideConfirm()}),e._uU(3,"Override"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.isOverride)}}function wf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-card")(1,"div",8)(2,"div",212)(3,"h3",102),e._uU(4,"Data Files"),e.qZA(),e.TgZ(5,"div",103)(6,"input",176),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i,"DS")}),e.qZA(),e.TgZ(7,"button",24),e._UZ(8,"span",25),e.qZA()(),e.TgZ(9,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().createDataSetinDM()}),e._uU(10," Create DataSet "),e._UZ(11,"span",213),e.qZA()(),e.TgZ(12,"div",214)(13,"div",10)(14,"div",215)(15,"div",216)(16,"div",217)(17,"h4"),e._uU(18,"DataSet Files"),e.qZA(),e.TgZ(19,"h4"),e._uU(20,"Actions"),e.qZA()(),e.YNc(21,tf,11,0,"div",218),e.YNc(22,cf,3,2,"mat-accordion",219),e.YNc(23,pf,4,2,"div",2),e.qZA()()(),e.YNc(24,Tf,19,2,"div",2),e.qZA()(),e.TgZ(25,"div",29),e.YNc(26,bf,4,1,"ng-container",2),e.TgZ(27,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDataset()}),e._uU(28,"Append Dataset"),e.qZA(),e.TgZ(29,"button",220),e.NdJ("click",function(){return e.CHM(t),e.oxw().openRelModal()}),e._uU(30,"Map Tables"),e.qZA(),e.TgZ(31,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:4},"prev")}),e._UZ(32,"span",92),e._uU(33," Prev "),e.qZA(),e.TgZ(34,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().getViewScript()}),e._uU(35," View Final Script "),e._UZ(36,"span",221),e.qZA(),e.TgZ(37,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().clickContinue()}),e._uU(38," Click to Continue "),e._UZ(39,"span",33),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(21),e.Q6J("ngIf",0==(null==t.allDatasetDetailsListForSearch?null:t.allDatasetDetailsListForSearch.length)&&0==(null==t.uploadedScriptTableList?null:t.uploadedScriptTableList.length)||null==t.allDatasetDetailsListForSearch),e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsListForSearch?null:t.allDatasetDetailsListForSearch.length)),e.xp6(1),e.Q6J("ngIf",0!=t.uploadedScriptTableList.length),e.xp6(1),e.Q6J("ngIf",t.showRelationshipModal),e.xp6(2),e.Q6J("ngIf",t.process.powerBiDatasetExists),e.xp6(3),e.Q6J("disabled",t.disableRelButton)}}function Sf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",264)(3,"div",241)(4,"h3"),e._uU(5,"New Scenario"),e.qZA(),e.TgZ(6,"button",265),e.NdJ("click",function(){return e.CHM(t),e.oxw().closePopup()}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"form",75),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().onSubmit()}),e.TgZ(10,"div",244)(11,"div",15)(12,"label"),e._uU(13,"Scenario Name"),e.qZA(),e._UZ(14,"input",267),e.qZA(),e.TgZ(15,"div",268)(16,"label"),e._uU(17,"Description"),e.qZA(),e._UZ(18,"textarea",269),e.qZA()(),e.TgZ(19,"div",270)(20,"button",271),e.NdJ("click",function(){return e.CHM(t),e.oxw().closePopup()}),e._uU(21," Cancel "),e._UZ(22,"span",249),e.qZA(),e.TgZ(23,"button",272),e._uU(24," Submit "),e._UZ(25,"span",33),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.scenarioForm),e.xp6(5),e.Q6J("ngClass",e.VKq(3,qe,t.submited&&t.scenarioForm.controls.name.errors)),e.xp6(4),e.Q6J("ngClass",e.VKq(5,qe,t.submited&&t.scenarioForm.controls.description.errors))}}function Nf(n,r){1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Uploading File(s)"),e.qZA(),e.BQk())}function Af(n,r){1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Appending..."),e.qZA(),e.BQk())}function yf(n,r){1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Joining..."),e.qZA(),e.BQk())}function Df(n,r){1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Creating Dataset..."),e.qZA(),e.BQk())}function kf(n,r){1&n&&(e.ynx(0),e._uU(1," Success !"),e.BQk())}function Ff(n,r){if(1&n&&(e.TgZ(0,"label"),e._uU(1),e.YNc(2,kf,2,0,"ng-container",2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.percentage,"% "),e.xp6(1),e.Q6J("ngIf",t.icon)}}function Mf(n,r){1&n&&(e.ynx(0),e._uU(1,"Failed !"),e.BQk())}function Lf(n,r){1&n&&e._UZ(0,"div",282)}function If(n,r){1&n&&e._UZ(0,"div",283)}function Ef(n,r){if(1&n&&e._UZ(0,"div",286),2&n){const t=e.oxw(2).$implicit;e.Udp("width",t.percentage+"%")}}function Zf(n,r){if(1&n&&e._UZ(0,"div",287),2&n){const t=e.oxw(2).$implicit;e.Udp("width",t.percentage+"%")}}function Pf(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Ef,1,2,"div",284),e.YNc(2,Zf,1,2,"div",285),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",0==t.isError)}}function Of(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",276),e._UZ(2,"img",277),e._uU(3),e.qZA(),e.TgZ(4,"div",278),e.YNc(5,Ff,3,2,"label",2),e.YNc(6,Mf,2,0,"ng-container",2),e.YNc(7,Lf,1,0,"div",279),e.YNc(8,If,1,0,"div",280),e.qZA(),e.TgZ(9,"div",281),e.YNc(10,Pf,3,2,"ng-container",2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(3),e.hij(" ",t.file," "),e.xp6(2),e.Q6J("ngIf",0==t.isError),e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",0==t.isError&&t.icon),e.xp6(2),e.Q6J("ngIf",null!=(null==t?null:t.percentage))}}function Uf(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Of,11,6,"ng-container",26),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.progressBar)}}function Bf(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"div",287),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Udp("width",(null==t.progressBar[0]?null:t.progressBar[0].percentage)+"%")}}function Jf(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",281),e.YNc(2,Bf,2,2,"ng-container",2),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",null!=(null==t.progressBar[0]?null:t.progressBar[0].percentage))}}function qf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",273)(3,"div",241),e.YNc(4,Nf,3,0,"ng-container",2),e.YNc(5,Af,3,0,"ng-container",2),e.YNc(6,yf,3,0,"ng-container",2),e.YNc(7,Df,3,0,"ng-container",2),e.TgZ(8,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().progressBarPopup=!1}),e.TgZ(9,"span",266),e._uU(10,"\xd7"),e.qZA()()(),e.TgZ(11,"div",244)(12,"div",275),e.YNc(13,Uf,2,1,"ng-container",2),e.YNc(14,Jf,3,1,"ng-container",2),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",1==t.tabs[1].id&&1==t.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",3==t.tabs[3].id&&1==t.tabs[3].isActive),e.xp6(1),e.Q6J("ngIf",4==t.tabs[4].id&&1==t.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",5==t.tabs[5].id&&1==t.tabs[5].isActive),e.xp6(6),e.Q6J("ngIf",1==t.tabs[1].id&&1==t.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",3==t.tabs[3].id&&1==t.tabs[3].isActive||4==t.tabs[4].id&&1==t.tabs[4].isActive||5==t.tabs[5].id&&1==t.tabs[5].isActive)}}function Rf(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function Qf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",264)(3,"div",241)(4,"h3"),e._uU(5,"Append Files"),e.qZA()(),e.TgZ(6,"div",244)(7,"form",9)(8,"div",288)(9,"div",289)(10,"label"),e._uU(11,"Name"),e.TgZ(12,"sup"),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"input",290),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(15,Rf,2,1,"div",181),e.qZA()(),e.TgZ(16,"div",291)(17,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendNamePopup=!1}),e._uU(18," Cancel "),e._UZ(19,"span",249),e.qZA(),e.TgZ(20,"button",292),e.NdJ("click",function(){return e.CHM(t),e.oxw().addAppendApi()}),e._uU(21," Submit "),e._UZ(22,"span",33),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("formGroup",t.appendForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,qe,t.submited&&t.appendForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function Hf(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function Yf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",273)(3,"div",293)(4,"h4",294),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",9)(7,"div",288)(8,"div",289)(9,"label"),e._uU(10,"Enter DataSet Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",290),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(14,Hf,2,1,"div",181),e.TgZ(15,"div",295)(16,"button",296),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDatasetApi()}),e._uU(17,"Add"),e.qZA(),e.TgZ(18,"button",297),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetAppendPopup=!1}),e._uU(19,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetAppendForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,qe,t.submitted&&t.datasetAppendForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function Vf(n,r){1&n&&e._UZ(0,"span",203)}function $f(n,r){1&n&&e._UZ(0,"span",204)}function Kf(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function Wf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",171)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(6).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"input",145),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw().$implicit,c=e.oxw(4).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(2),e.Oqu(t.fieldName)}}function zf(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(6).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(6).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(3),e.qZA(),e.TgZ(4,"div",313)(5,"span",188),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(6).previewPopup(s),i.stopPropagation()}),e.qZA()()(),e.TgZ(6,"div",10)(7,"div",228)(8,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",315)(10,"input",316),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(4).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",317),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,Wf,5,2,"mat-accordion",170),e.ALo(15,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(6);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.appendName),e.xp6(5),e.Q6J("value",t.searchValueInCreateDatasetPopup),e.xp6(2),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngForOf",e.gM2(15,5,t.tableAppendFieldsDto,e.VKq(10,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","append"))}}function Gf(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",223),e.YNc(2,zf,16,12,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function Xf(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Gf,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function jf(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpand=!i.isExpand}),e.YNc(3,Vf,1,0,"span",198),e.YNc(4,$f,1,0,"span",199),e._uU(5,"Append Files "),e.qZA()(),e.YNc(6,Kf,2,0,"div",311),e.YNc(7,Xf,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpand),e.xp6(1),e.Q6J("ngIf",!t.isExpand),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpand)}}function em(n,r){1&n&&e._UZ(0,"span",203)}function tm(n,r){1&n&&e._UZ(0,"span",204)}function nm(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function im(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",319)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(6).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"input",145),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw().$implicit,c=e.oxw(4).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function om(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(6).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(6).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(3),e.qZA(),e.TgZ(4,"div",313)(5,"span",188),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(6).previewPopup(s),i.stopPropagation()}),e.qZA()()(),e.TgZ(6,"div",10)(7,"div",228)(8,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",315)(10,"input",316),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(4).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",317),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,im,4,2,"mat-accordion",318),e.ALo(15,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(6);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.mergeName),e.xp6(5),e.Q6J("value",t.searchValueInCreateDatasetPopup),e.xp6(2),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngForOf",e.gM2(15,5,t.mergeFieldListDTO,e.VKq(10,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","join"))}}function rm(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",223),e.YNc(2,om,16,12,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function am(n,r){if(1&n&&(e.ynx(0),e.YNc(1,rm,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function sm(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpand=!i.isExpand}),e.YNc(3,em,1,0,"span",198),e.YNc(4,tm,1,0,"span",199),e._uU(5,"Join Files "),e.qZA()(),e.YNc(6,nm,2,0,"div",311),e.YNc(7,am,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpand),e.xp6(1),e.Q6J("ngIf",!t.isExpand),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpand)}}function lm(n,r){1&n&&e._UZ(0,"span",203)}function cm(n,r){1&n&&e._UZ(0,"span",204)}function dm(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function _m(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",171)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(6).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"input",145),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw().$implicit,c=e.oxw(4).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function pm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(6).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(6).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(3),e.qZA(),e.TgZ(4,"div",313)(5,"span",188),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(6).previewPopup(s),i.stopPropagation()}),e.qZA()()(),e.TgZ(6,"div",10)(7,"div",228)(8,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",315)(10,"input",316),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(4).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",317),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,_m,4,2,"mat-accordion",170),e.ALo(15,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(6);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.fileName),e.xp6(5),e.Q6J("value",t.searchValueInCreateDatasetPopup),e.xp6(2),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngForOf",e.gM2(15,5,t.sheet,e.VKq(10,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","files"))}}function um(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",223),e.YNc(2,pm,16,12,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function fm(n,r){if(1&n&&(e.ynx(0),e.YNc(1,um,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function mm(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpand=!i.isExpand}),e.YNc(3,lm,1,0,"span",198),e.YNc(4,cm,1,0,"span",199),e._uU(5,"Source Files "),e.qZA()(),e.YNc(6,dm,2,0,"div",311),e.YNc(7,fm,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpand),e.xp6(1),e.Q6J("ngIf",!t.isExpand),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpand)}}function hm(n,r){if(1&n&&(e.ynx(0),e.YNc(1,jf,8,4,"ng-container",2),e.YNc(2,sm,8,4,"ng-container",2),e.YNc(3,mm,8,4,"ng-container",2),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","append"==t.fileType),e.xp6(1),e.Q6J("ngIf","join"==t.fileType),e.xp6(1),e.Q6J("ngIf","files"==t.fileType)}}function gm(n,r){1&n&&e._UZ(0,"span",203)}function xm(n,r){1&n&&e._UZ(0,"span",204)}function vm(n,r){1&n&&(e.TgZ(0,"div",320),e._uU(1," No files found "),e.qZA())}function Cm(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"input",145),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isSelectAllChildInDM=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw().$implicit;return e.oxw(4).selectAllChildInDM(i,"dataset",s,a)}),e.qZA(),e.TgZ(3,"label"),e._uU(4),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(2),e.Oqu(t.fieldName)}}function Tm(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",171),e.YNc(1,Cm,5,2,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function bm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",164)(2,"label",165),e.NdJ("click",function(i){return i.stopPropagation()}),e._uU(3),e.qZA(),e.TgZ(4,"div",167),e.NdJ("click",function(i){return i.stopPropagation()}),e.TgZ(5,"span",232),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup(a)}),e.qZA()()(),e.TgZ(6,"div",10)(7,"div",228)(8,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(4).applyFilterForDMTables(i,s,l,"dataset")}),e.qZA()()(),e.TgZ(9,"div",315)(10,"input",316),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit;return e.oxw(4).selectAllParentInDM(i,"dataset",s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",317),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,Tm,2,1,"mat-accordion",170),e.ALo(15,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.datasetName),e.xp6(5),e.Q6J("value",t.searchValueInCreateDatasetPopup),e.xp6(2),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngForOf",e.gM2(15,5,t.datasetFieldDTOList,e.VKq(10,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","dataset"))}}function wm(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",223),e.YNc(1,bm,16,12,"mat-expansion-panel",224),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function Sm(n,r){if(1&n&&(e.ynx(0),e.YNc(1,wm,2,1,"mat-accordion",219),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length))}}function Nm(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.submittedErrorMsg," ")}}function Am(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.ynx(1),e.TgZ(2,"td",337),e._uU(3),e.qZA(),e.TgZ(4,"td",337),e._uU(5),e.qZA(),e.TgZ(6,"td",338)(7,"span",88),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(2).editRowInDataSet(l,a,s)}),e.qZA(),e.TgZ(8,"span",85),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(2).deleteRowInDataset(l,a,s)}),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.sourceFieldName," "),e.xp6(1),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.columnType," "),e.xp6(1),e.ekj("active",t.isEdit)}}function ym(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function Dm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",346),e.NdJ("click",function(i){let s;return e.CHM(t),null==(s=e.oxw(2).$implicit.get("operator"))||s.setValue(""),i.stopPropagation()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function km(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",341)(2,"mat-select",345),e.YNc(3,ym,2,2,"mat-option",37),e.qZA(),e.YNc(4,Dm,3,0,"button",333),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw(4);let i;e.xp6(3),e.Q6J("ngForOf",o.opearatorList),e.xp6(1),e.Q6J("ngIf",null==(i=t.get("operator"))?null:i.value)}}function Fm(n,r){if(1&n&&(e.TgZ(0,"mat-option",347),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("title",t.filefieldName),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.filefieldName,"")}}function Mm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",346),e.NdJ("click",function(i){let s;return e.CHM(t),null==(s=e.oxw().$implicit.get("column"))||s.setValue(""),i.stopPropagation()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Lm(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t," ")}}function Im(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Lm,2,2,"mat-option",37),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",o.signOperatorWhereInDS[t])}}function Em(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",346),e.NdJ("click",function(i){let s;return e.CHM(t),null==(s=e.oxw().$implicit.get("signOperator"))||s.setValue(""),i.stopPropagation()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Zm(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",118),e._UZ(2,"input",348),e.qZA(),e.BQk())}function Pm(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",349),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(4).addOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function Om(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",85),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(4).delOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function Um(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",339)(1,"div",340),e.YNc(2,km,5,2,"ng-container",2),e.TgZ(3,"mat-form-field",341)(4,"mat-select",342,329),e.NdJ("closed",function(){const a=e.CHM(t).index;return e.oxw(4).closeDropdown(0,0,a,"where","column")})("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(2).index;return e.oxw(2).changeColumnInDSForWhere(i,s,c,l)}),e._UZ(6,"input",343),e.YNc(7,Fm,2,3,"mat-option",332),e.ALo(8,"searchFilter"),e.qZA(),e.YNc(9,Mm,3,0,"button",333),e.qZA(),e.TgZ(10,"mat-form-field",341)(11,"mat-select",344),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(2).index;return e.oxw(2).changeOperatorInDSForWhere(i,s,c,l)}),e.YNc(12,Im,2,1,"ng-container",2),e.qZA(),e.YNc(13,Em,3,0,"button",333),e.qZA(),e.YNc(14,Zm,3,0,"ng-container",2),e.TgZ(15,"div",118),e.YNc(16,Pm,2,0,"ng-container",2),e.YNc(17,Om,2,0,"ng-container",2),e.qZA()()()}if(2&n){const t=r.$implicit,o=r.index,i=e.MAs(5),a=e.oxw(4);let s,l,c;e.Q6J("formGroupName",o),e.xp6(2),e.Q6J("ngIf",0!=o),e.xp6(2),e.s9C("title",i.triggerValue),e.xp6(3),e.Q6J("ngForOf",e.gM2(8,10,a.columnsForWhereInDS,e.VKq(15,Zt,null==(s=t.get("columnSearch"))?null:s.value),"Where","columnSearch")),e.xp6(2),e.Q6J("ngIf",null==(l=t.get("column"))?null:l.value),e.xp6(3),e.Q6J("ngIf",0!=a.signOperatorWhereInDS.length),e.xp6(1),e.Q6J("ngIf",null==(c=t.get("signOperator"))?null:c.value),e.xp6(1),e.Q6J("ngIf",a.hasValueCOlumnAt(o)),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function Bm(n,r){if(1&n&&(e.TgZ(0,"mat-option",347),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("title",t.filefieldName),e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function Jm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",346),e.NdJ("click",function(i){let s;return e.CHM(t),null==(s=e.oxw(4).datasetTableForm.get("groupBy"))||s.setValue(""),i.stopPropagation()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function qm(n,r){if(1&n&&(e.TgZ(0,"mat-option",347),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("title",t.filefieldName),e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function Rm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",346),e.NdJ("click",function(i){let s;return e.CHM(t),null==(s=e.oxw(4).datasetTableForm.get("orderBy"))||s.setValue(""),i.stopPropagation()}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Qm(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",10)(2,"div",12)(3,"div",321)(4,"table",81)(5,"thead")(6,"tr")(7,"th"),e._uU(8,"Column Name"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Column Type"),e.qZA(),e.TgZ(11,"th",322),e._uU(12,"Actions"),e.qZA()()(),e.TgZ(13,"tbody"),e.ynx(14),e.YNc(15,Am,9,8,"tr",26),e.BQk(),e.qZA()()()()(),e.TgZ(16,"div",10)(17,"div",12)(18,"form",9)(19,"div",323)(20,"label",324),e._uU(21,"Where Criteria:"),e.qZA(),e.TgZ(22,"div",325),e.YNc(23,Um,18,17,"div",326),e.qZA()(),e.TgZ(24,"div",327)(25,"div",118)(26,"label"),e._uU(27,"Group By"),e.qZA(),e.TgZ(28,"mat-form-field",35)(29,"mat-select",328,329),e.NdJ("closed",function(){return e.CHM(t),e.oxw(3).closeDropdown(0,0,0,"where","groupBy")})("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(2).selectgroupByOrderByInDM(i,s,l,"groupby")}),e.TgZ(31,"mat-checkbox",330),e.NdJ("change",function(i){return e.CHM(t),e.oxw(3).toggleAllSelection(i)}),e._uU(32,"Select All"),e.qZA(),e._UZ(33,"input",331),e.YNc(34,Bm,2,3,"mat-option",332),e.ALo(35,"searchFilter"),e.qZA(),e.YNc(36,Jm,3,0,"button",333),e.qZA()(),e.TgZ(37,"div",118)(38,"label"),e._uU(39,"Having"),e.qZA(),e._UZ(40,"input",334),e.qZA(),e.TgZ(41,"div",118)(42,"label"),e._uU(43,"Order By"),e.qZA(),e.TgZ(44,"mat-form-field",35)(45,"mat-select",335,329),e.NdJ("closed",function(){return e.CHM(t),e.oxw(3).closeDropdown(0,0,0,"where","orderBy")})("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(2).selectgroupByOrderByInDM(i,s,l,"orderby")}),e._UZ(47,"input",336),e.YNc(48,qm,2,3,"mat-option",332),e.ALo(49,"searchFilter"),e.qZA(),e.YNc(50,Rm,3,0,"button",333),e.qZA()()()()()(),e.TgZ(51,"div",270)(52,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).enableDataSetPopUp=!1}),e._uU(53," Cancel "),e._UZ(54,"span",249),e.qZA(),e.TgZ(55,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index;return e.oxw(2).submitDataset(a,s)}),e._uU(56," Submit "),e._UZ(57,"span",33),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(30),o=e.oxw().$implicit,i=e.oxw(2);let a,s,l,c;e.xp6(15),e.Q6J("ngForOf",o.datasetFieldDTOList),e.xp6(3),e.Q6J("formGroup",i.datasetTableForm),e.xp6(1),e.Q6J("ngClass",2==i.guidindex?"highlight":""),e.xp6(4),e.Q6J("ngForOf",i.whereArrInDS().controls),e.xp6(1),e.Q6J("ngClass",3==i.guidindex?"highlight":""),e.xp6(5),e.s9C("title",t.triggerValue),e.xp6(5),e.Q6J("ngForOf",e.gM2(35,11,o.groupBytoDB,e.VKq(21,Zt,null==(a=i.datasetTableForm.get("groupBySearch"))?null:a.value),"Where","groupBy")),e.xp6(2),e.Q6J("ngIf",""!=(null==(s=i.datasetTableForm.get("groupBy"))?null:s.value)),e.xp6(9),e.s9C("title",t.triggerValue),e.xp6(3),e.Q6J("ngForOf",e.gM2(49,16,o.orderBytoDB,e.VKq(23,Zt,null==(l=i.datasetTableForm.get("orderBySearch"))?null:l.value),"Where","orderBy")),e.xp6(2),e.Q6J("ngIf",""!=(null==(c=i.datasetTableForm.get("orderBy"))?null:c.value))}}function Hm(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Qm,58,25,"ng-container",2),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isDatasetTableExpand)}}function Ym(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",355),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).nextguid(0)}),e._uU(1,"1"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("ngClass",t.guidindex>0?"completed":"")}}function Vm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",355),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).nextguid(1)}),e._uU(1,"1"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("ngClass",t.guidindex>1?"completed":"")}}function $m(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",355),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).nextguid(2)}),e._uU(1,"1"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("ngClass",t.guidindex>2?"completed":"")}}function Km(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",356),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).nextguid(3)}),e._uU(1,"1"),e.qZA()}}const Wm=function(n,r){return[n,r]};function zm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",350)(2,"div",351)(3,"mat-tab-group",352)(4,"mat-tab"),e.YNc(5,Ym,2,1,"ng-template",5),e.TgZ(6,"div")(7,"h3"),e._uU(8,"Select Column/file"),e.qZA(),e.TgZ(9,"p"),e._uU(10,"To add columns to the Datafile, click on the columns from any table or double click the table to add entire table columns"),e.qZA(),e.TgZ(11,"div",353)(12,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(4)}),e._uU(13,"Skip "),e.TgZ(14,"mat-icon"),e._uU(15,"last_page"),e.qZA()(),e.TgZ(16,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(1)}),e._uU(17,"Next "),e._UZ(18,"span",159),e.qZA()()()(),e.TgZ(19,"mat-tab"),e.YNc(20,Vm,2,1,"ng-template",5),e.TgZ(21,"div")(22,"h3"),e._uU(23," Add Custom Column "),e.qZA(),e.TgZ(24,"p"),e._uU(25," Click on it,to create a new/custom column "),e.qZA(),e.TgZ(26,"div",353)(27,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(4)}),e._uU(28,"Skip "),e.TgZ(29,"mat-icon"),e._uU(30,"last_page"),e.qZA()(),e.TgZ(31,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(2)}),e._uU(32,"Next "),e._UZ(33,"span",159),e.qZA()()()(),e.TgZ(34,"mat-tab"),e.YNc(35,$m,2,1,"ng-template",5),e.TgZ(36,"div")(37,"h3"),e._uU(38," Where Criteria "),e.qZA(),e.TgZ(39,"p"),e._uU(40," Use Where criteria to filter the data in Datafile, click on plus icon to add more conditions. "),e.qZA(),e.TgZ(41,"div",353)(42,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(4)}),e._uU(43,"Skip "),e.TgZ(44,"mat-icon"),e._uU(45,"last_page"),e.qZA()(),e.TgZ(46,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(3)}),e._uU(47,"Next "),e._UZ(48,"span",159),e.qZA()()()(),e.TgZ(49,"mat-tab"),e.YNc(50,Km,2,0,"ng-template",5),e.TgZ(51,"div")(52,"h3"),e._uU(53," Group By & Order By "),e.qZA(),e.TgZ(54,"p"),e._uU(55," In the 'Group By' field ,select the columns to apply the group by, To apply any aggregate function, use the 'Having clause' To sort the data, select the columns in the 'Order By' field "),e.qZA(),e.TgZ(56,"div",353)(57,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(0)}),e._uU(58,"Replay "),e._UZ(59,"span",354),e.qZA(),e.TgZ(60,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).nextguid(4)}),e._uU(61,"Done "),e._UZ(62,"span",159),e.qZA()()()()()()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(2,Wm,t.DataPopUp?"DataModel":"",0==t.guidindex?"step1":1==t.guidindex?"step2":2==t.guidindex?"step3":3==t.guidindex?"step4":"")),e.xp6(2),e.Q6J("selectedIndex",t.guidindex)}}function Gm(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",298)(3,"div",241)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"button",299),e.NdJ("click",function(){return e.CHM(t),e.oxw().overlayPopUp()}),e._uU(7," User Guide "),e._UZ(8,"span",300),e.qZA(),e.TgZ(9,"button",301),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopUp=!1}),e.TgZ(10,"span",266),e._uU(11,"\xd7"),e.qZA()()(),e.TgZ(12,"div",302)(13,"div",303)(14,"div",10)(15,"div",304)(16,"div",305)(17,"div",101)(18,"div",103)(19,"input",169),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i,"parentInCreateDSPopup")}),e.qZA(),e.TgZ(20,"button",306),e._UZ(21,"span",155),e.qZA()(),e.TgZ(22,"label"),e._uU(23,"All Files"),e.qZA()(),e.YNc(24,hm,4,3,"ng-container",26),e.TgZ(25,"div",20)(26,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.isDatasetExpandInCreateDSPopup=!i.isDatasetExpandInCreateDSPopup}),e.YNc(27,gm,1,0,"span",198),e.YNc(28,xm,1,0,"span",199),e._uU(29,"Dataset Files "),e.qZA()(),e.YNc(30,vm,2,0,"div",307),e.YNc(31,Sm,2,1,"ng-container",2),e.qZA()(),e.TgZ(32,"div",308)(33,"div",8)(34,"div",10)(35,"form",9)(36,"div",309)(37,"div",152)(38,"div",289)(39,"label"),e._uU(40,"Enter DataSet Name"),e.TgZ(41,"sup"),e._uU(42,"*"),e.qZA()(),e.TgZ(43,"input",290),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()(),e.YNc(44,Nm,2,1,"div",181),e.qZA(),e.TgZ(45,"div",118),e._UZ(46,"label"),e.TgZ(47,"button",310),e.NdJ("click",function(){return e.CHM(t),e.oxw().addCustomColumn()}),e._uU(48," Add Custom Column "),e._UZ(49,"span",79),e.qZA()()()()(),e.YNc(50,Hm,2,1,"ng-container",26),e.qZA()()()(),e.YNc(51,zm,63,5,"div",2),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",t.DataPopUp?"DataPopUp":""),e.xp6(3),e.hij("",t.createorEditDatasetText," Data Set"),e.xp6(10),e.Q6J("ngClass",0==t.guidindex?"highlight":""),e.xp6(4),e.Q6J("value",t.searchValueInCreateDSPopup),e.xp6(5),e.Q6J("ngForOf",t.sourceFilesAppendJoinFileList),e.xp6(3),e.Q6J("ngIf",t.isDatasetExpandInCreateDSPopup),e.xp6(1),e.Q6J("ngIf",!t.isDatasetExpandInCreateDSPopup),e.xp6(2),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",!t.isDatasetExpandInCreateDSPopup),e.xp6(4),e.Q6J("formGroup",t.datasetForm),e.xp6(8),e.Q6J("ngClass",e.VKq(15,qe,t.submited&&t.datasetForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited1),e.xp6(3),e.Q6J("ngClass",1==t.guidindex?"highlight":""),e.xp6(3),e.Q6J("ngForOf",t.datasetDetailsList),e.xp6(1),e.Q6J("ngIf",t.guid)}}function Xm(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",38),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function jm(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",38),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function eh(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",38),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function th(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function nh(n,r){if(1&n&&(e.TgZ(0,"mat-option",370),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}const or=function(n){return{fieldName:n}};function ih(n,r){if(1&n&&(e.ynx(0),e.YNc(1,nh,2,2,"mat-option",369),e.ALo(2,"searchFilter"),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw().index,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.gM2(2,1,null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].foreignKeyList,e.VKq(6,or,i.dataSetData[o].columns[t].searchValueFK),"dataset","fk"))}}function oh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",260),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).addcolumnRowInDS(i,a)}),e.qZA()}}function rh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",371),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).deletecolumnRowInDS(i,a)}),e.qZA()}}function ah(n,r){if(1&n){const t=e.EpF();e.ynx(0,339),e.TgZ(1,"div",10)(2,"div",27)(3,"mat-form-field",35)(4,"mat-select",366),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectPrimaryKeyInDS(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(2).closeDropdown(0,a,s,"dataset","pk")}),e.TgZ(5,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).searchField(i,0,s,l,"dataset","pk")}),e.qZA(),e.YNc(6,th,2,2,"mat-option",37),e.ALo(7,"searchFilter"),e.qZA()()(),e._UZ(8,"div",118),e.TgZ(9,"div",27)(10,"mat-form-field",35)(11,"mat-select",367),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectForeignKeyInDS(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(2).closeDropdown(0,a,s,"dataset","fk")}),e.TgZ(12,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).searchField(i,0,s,l,"dataset","fk")}),e.qZA(),e.YNc(13,ih,3,8,"ng-container",2),e.qZA()()(),e.TgZ(14,"div",256),e.YNc(15,oh,1,0,"button",257),e.YNc(16,rh,1,0,"button",368),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw(2);let s,l;e.Q6J("formGroupName",o),e.xp6(4),e.Q6J("ngClass",e.VKq(14,qe,a.submitedDS&&(null==(s=t.get("column1"))?null:s.errors))),e.xp6(1),e.Q6J("value",a.dataSetData[i].columns[o].searchValuePK),e.xp6(1),e.Q6J("ngForOf",e.gM2(7,9,null==a.dataSetData[i]||null==a.dataSetData[i].columns[o]?null:a.dataSetData[i].columns[o].primaryKeyList,e.VKq(16,or,a.dataSetData[i].columns[o].searchValuePK),"dataset","pk")),e.xp6(5),e.Q6J("ngClass",e.VKq(18,qe,a.submitedDS&&(null==(l=t.get("column2"))?null:l.errors))),e.xp6(1),e.Q6J("value",a.dataSetData[i].columns[o].searchValueFK),e.xp6(1),e.Q6J("ngIf",null!=(null==a.dataSetData[i]?null:a.dataSetData[i].foreignTableList)),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function sh(n,r){if(1&n){const t=e.EpF();e.ynx(0,339),e.TgZ(1,"div",359)(2,"div",10)(3,"mat-form-field",360)(4,"mat-select",361),e.NdJ("closed",function(){const a=e.CHM(t).index;return e.oxw(2).closeDropdown(0,0,a,"dataset","pt")})("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectPrimaryTableInDS(i,s)}),e.TgZ(5,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).searchField(i,0,0,s,"dataset","pt")}),e.qZA(),e.YNc(6,Xm,3,2,"ng-container",26),e.ALo(7,"searchFilter"),e.qZA()(),e.TgZ(8,"mat-form-field",341)(9,"mat-select",363),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectJoinTypeInDS(i,s)}),e.YNc(10,jm,3,2,"ng-container",26),e.qZA()(),e.TgZ(11,"mat-form-field",360)(12,"mat-select",364),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectForeignTableInDS(i,s)})("closed",function(){const a=e.CHM(t).index;return e.oxw(2).closeDropdown(0,0,a,"dataset","ft")}),e.TgZ(13,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).searchField(i,0,0,s,"dataset","ft")}),e.qZA(),e.YNc(14,eh,3,2,"ng-container",26),e.ALo(15,"searchFilter"),e.qZA()(),e._UZ(16,"div",256),e.qZA(),e.ynx(17,365),e.YNc(18,ah,17,20,"ng-container",326),e.BQk(),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(2);let a,s,l;e.Q6J("formGroupName",o),e.xp6(4),e.Q6J("placeholder",i.placetable)("ngClass",e.VKq(21,qe,i.submitedDS&&(null==(a=t.get("Ptable"))?null:a.errors))),e.xp6(1),e.Q6J("value",i.dataSetData[o].searchValuePT),e.xp6(1),e.Q6J("ngForOf",e.gM2(7,11,null==i.dataSetData[o]?null:i.dataSetData[o].primaryTableList,e.VKq(23,Zt,i.dataSetData[o].searchValuePT),"dataset","pt")),e.xp6(3),e.Q6J("ngClass",e.VKq(25,qe,i.submitedDS&&(null==(s=t.get("join"))?null:s.errors))),e.xp6(1),e.Q6J("ngForOf",i.joinType),e.xp6(2),e.Q6J("ngClass",e.VKq(27,qe,i.submitedDS&&(null==(l=t.get("Ftable"))?null:l.errors))),e.xp6(1),e.Q6J("value",i.dataSetData[o].searchValueFT),e.xp6(1),e.Q6J("ngForOf",e.gM2(15,16,null==i.dataSetData[o]?null:i.dataSetData[o].foreignTableList,e.VKq(29,Zt,i.dataSetData[o].searchValueFT),"dataset","ft")),e.xp6(4),e.Q6J("ngForOf",i.columnArrInDS(o).controls)}}function lh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Save Dataset"),e.qZA(),e.TgZ(6,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeDatasetPopup()}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"form",9)(10,"div",244)(11,"div",357)(12,"div",358),e.YNc(13,sh,19,31,"ng-container",326),e.qZA()()(),e.TgZ(14,"div",247)(15,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetDropdowns()}),e._uU(16," Save "),e.TgZ(17,"mat-icon"),e._uU(18,"save"),e.qZA()()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.dataSetForm),e.xp6(4),e.Q6J("ngForOf",t.DataSetArr().controls)}}function ch(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function dh(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",38),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function _h(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function ph(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",38),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij("",t.tableNameUI," ")}}function uh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",384),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).removeTable(a,i)}),e.qZA()}}function fh(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function mh(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function hh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",387),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index,a=e.oxw().index;return e.oxw(3).addColumnJoin(a,i)}),e.qZA()}}function gh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",388),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index,s=e.oxw().index;return e.oxw(3).removeCol(s,a,i)}),e.qZA()}}function xh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",339)(1,"div",10)(2,"div",27)(3,"label"),e._uU(4,"Column"),e.qZA(),e.TgZ(5,"mat-form-field",35)(6,"mat-select",366),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectPrimarykey(i,s,l,c)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index,l=e.oxw().index;return e.oxw(3).closeDropdown(a,s,l,"join","pk")}),e.TgZ(7,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).searchField(i,s,l,c,"join","pk")}),e.qZA(),e.YNc(8,fh,2,2,"mat-option",37),e.ALo(9,"searchFilter"),e.qZA()()(),e._UZ(10,"div",118),e.TgZ(11,"div",27)(12,"label"),e._uU(13,"Column"),e.qZA(),e.TgZ(14,"mat-form-field",35)(15,"mat-select",367),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectForeignKey(i,s,l,c)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index,l=e.oxw().index;return e.oxw(3).closeDropdown(a,s,l,"join","fk")}),e.TgZ(16,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).searchField(i,s,l,c,"join","fk")}),e.qZA(),e.YNc(17,mh,2,2,"mat-option",37),e.ALo(18,"searchFilter"),e.qZA()()(),e.TgZ(19,"div",256),e._UZ(20,"label"),e.YNc(21,hh,1,0,"button",385),e.YNc(22,gh,1,0,"button",386),e.qZA()()()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw().index,s=e.oxw(3);let l,c;e.Q6J("formGroupName",o),e.xp6(6),e.Q6J("ngClass",e.VKq(19,qe,s.submitedJ&&(null==(l=t.get("column1"))?null:l.errors))),e.xp6(1),e.Q6J("value",null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].searchValuePK),e.xp6(1),e.Q6J("ngForOf",e.gM2(9,9,null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].primaryKeyList,e.VKq(21,or,null==s.joinCheckedList[a]?null:s.joinCheckedList[a].dropDownList[i].columns[o].searchValuePK),"join","pk")),e.xp6(7),e.Q6J("ngClass",e.VKq(23,qe,s.submitedJ&&(null==(c=t.get("column2"))?null:c.errors))),e.xp6(1),e.Q6J("value",null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].searchValueFK),e.xp6(1),e.Q6J("ngForOf",e.gM2(18,14,null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].foreignKeyList,e.VKq(25,or,null==s.joinCheckedList[a]?null:s.joinCheckedList[a].dropDownList[i].columns[o].searchValueFK),"join","fk")),e.xp6(4),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function vh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",389),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).addTableJoins(a,i)}),e._uU(1," Add Table "),e._UZ(2,"span",390),e.qZA()}if(2&n){const t=e.oxw(2).index,o=e.oxw(3);e.Q6J("disabled",null==o.joinCheckedList[t]?null:o.joinCheckedList[t].allTablesSelected)}}function Ch(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",339)(1,"div",377)(2,"div",10)(3,"div",27)(4,"label"),e._uU(5,"Primary Table"),e.qZA(),e.TgZ(6,"mat-form-field",35)(7,"mat-select",378),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectPrimaryTable(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(3).closeDropdown(0,a,s,"join","pt")}),e.TgZ(8,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).searchField(i,0,s,l,"join","pt")}),e.qZA(),e.YNc(9,dh,3,2,"ng-container",26),e.ALo(10,"searchFilter"),e.qZA()()(),e.TgZ(11,"div",118)(12,"label"),e._uU(13,"Join Type"),e.qZA(),e.TgZ(14,"mat-form-field",35)(15,"mat-select",379),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectJoin(i,s,l)}),e.YNc(16,_h,2,2,"mat-option",37),e.qZA()()(),e.TgZ(17,"div",27)(18,"label"),e._uU(19,"Secondary Table"),e.qZA(),e.TgZ(20,"mat-form-field",35)(21,"mat-select",380),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectForeignTable(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(3).closeDropdown(0,a,s,"join","ft")}),e.TgZ(22,"input",362),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).searchField(i,0,s,l,"join","ft")}),e.qZA(),e.YNc(23,ph,3,2,"ng-container",26),e.ALo(24,"searchFilter"),e.qZA()()(),e.TgZ(25,"div",256),e._UZ(26,"label"),e.YNc(27,uh,1,0,"button",381),e.qZA()(),e.TgZ(28,"div",382),e.YNc(29,xh,23,27,"div",326),e.qZA()(),e.YNc(30,vh,3,1,"button",383),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw(3);let s,l,c;e.Q6J("formGroupName",o),e.xp6(7),e.Q6J("placeholder",a.placetable)("ngClass",e.VKq(23,qe,a.submitedJ&&(null==(s=t.get("table1"))?null:s.errors))),e.xp6(1),e.Q6J("value",null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].searchValuePT),e.xp6(1),e.Q6J("ngForOf",e.gM2(10,13,null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].primaryTableList,e.VKq(25,Zt,null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].searchValuePT),"join","pt")),e.xp6(6),e.Q6J("ngClass",e.VKq(27,qe,a.submitedJ&&(null==(l=t.get("join"))?null:l.errors))),e.xp6(1),e.Q6J("ngForOf",a.joinType),e.xp6(5),e.Q6J("ngClass",e.VKq(29,qe,a.submitedJ&&(null==(c=t.get("table2"))?null:c.errors))),e.xp6(1),e.Q6J("value",null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].searchValueFT),e.xp6(1),e.Q6J("ngForOf",e.gM2(24,18,null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].foreignTableList,e.VKq(31,Zt,null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].searchValueFT),"join","ft")),e.xp6(4),e.Q6J("ngIf",0!=o),e.xp6(2),e.Q6J("ngForOf",a.columnArr(i,o).controls),e.xp6(1),e.Q6J("ngIf",0==o)}}function Th(n,r){if(1&n&&(e.TgZ(0,"div",339)(1,"div",375)(2,"div",376),e.YNc(3,Ch,31,33,"div",326),e.qZA()()()),2&n){const t=r.index,o=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("ngForOf",o.TableArr(t).controls)}}function bh(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",9)(2,"div",374),e.YNc(3,Th,4,2,"div",326),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.joinSetForm),e.xp6(2),e.Q6J("ngForOf",t.MergeArr().controls)}}function wh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",372)(3,"div",241)(4,"h3"),e._uU(5,"Join Files"),e.qZA(),e.TgZ(6,"button",265),e.NdJ("click",function(){return e.CHM(t),e.oxw().joinCancelBtn()}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",244)(10,"form",9)(11,"div",288)(12,"div",373)(13,"label"),e._uU(14,"Join Name"),e.TgZ(15,"sup"),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"input",290),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()(),e.YNc(18,ch,2,1,"div",181),e.qZA()(),e.YNc(19,bh,4,2,"div",2),e.qZA(),e.TgZ(20,"div",291)(21,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw().joinCancelBtn()}),e._uU(22," Cancel "),e._UZ(23,"span",249),e.qZA(),e.TgZ(24,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw().addJoin()}),e._uU(25," Submit "),e._UZ(26,"span",33),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("formGroup",t.joinForm),e.xp6(7),e.Q6J("ngClass",e.VKq(4,qe,t.submited&&t.joinForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited),e.xp6(1),e.Q6J("ngIf",0!=t.joinCheckedList.length)}}function Sh(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.operatorType),e.xp6(1),e.hij(" ",t.operatorType,"")}}function Nh(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t,"")}}function Ah(n,r){if(1&n&&(e.TgZ(0,"div",17),e.ynx(1),e.TgZ(2,"label"),e._uU(3,"Date"),e.qZA(),e.TgZ(4,"mat-form-field",398)(5,"mat-select",414),e.YNc(6,Nh,2,2,"mat-option",37),e.qZA()(),e.BQk(),e.qZA()),2&n){const t=e.oxw(3);e.xp6(6),e.Q6J("ngForOf",t.dateTimeFormats)}}function yh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",421)(1,"div",237),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).accordionExpValue(a,a.Component)}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionType," ")}}function Dh(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",164),e._uU(2),e.qZA(),e.YNc(3,yh,3,1,"mat-accordion",420),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionName," "),e.xp6(1),e.Q6J("ngForOf",t.funcDescritptionsList)}}function kh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",415,416)(2,"div",417)(3,"input",418),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i,"fx")}),e.qZA(),e._UZ(4,"span",419),e.qZA(),e.TgZ(5,"mat-accordion",223),e.YNc(6,Dh,4,2,"mat-expansion-panel",26),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(6),e.Q6J("ngForOf",t.searchfx)}}function Fh(n,r){1&n&&e._UZ(0,"span",203)}function Mh(n,r){1&n&&e._UZ(0,"span",204)}function Lh(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function Ih(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",171)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(8).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"label"),e._uU(3),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function Eh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(8).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(8).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",205)(2,"label",424),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(3,"img",166),e._uU(4),e.qZA()(),e.TgZ(5,"div",10)(6,"div",228)(7,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(4).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.YNc(8,Ih,4,1,"mat-accordion",170),e.ALo(9,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(8);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.hij(" ",t.appendName,""),e.xp6(3),e.Q6J("value",t.searchValueInColumnPopup),e.xp6(1),e.Q6J("ngForOf",e.gM2(9,4,t.tableAppendFieldsDto,e.VKq(9,Zt,t.searchValueInColumnPopup),"createDSpopup","append"))}}function Zh(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",423),e.YNc(2,Eh,10,11,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function Ph(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Zh,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function Oh(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpandInColumn=!i.isExpandInColumn}),e.YNc(3,Fh,1,0,"span",198),e.YNc(4,Mh,1,0,"span",199),e._uU(5,"Append Files "),e.qZA()(),e.YNc(6,Lh,2,0,"div",311),e.YNc(7,Ph,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpandInColumn),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn)}}function Uh(n,r){1&n&&e._UZ(0,"span",203)}function Bh(n,r){1&n&&e._UZ(0,"span",204)}function Jh(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function qh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",427)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(8).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"label"),e._uU(3),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function Rh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(8).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(8).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",205)(2,"label",424),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(3,"img",210),e._uU(4),e.qZA()(),e.TgZ(5,"div",10)(6,"div",228)(7,"input",425),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(4).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.YNc(8,qh,4,1,"mat-accordion",426),e.ALo(9,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(8);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.hij(" ",t.mergeName,""),e.xp6(3),e.Q6J("value",t.searchValueInColumnPopup),e.xp6(1),e.Q6J("ngForOf",e.gM2(9,4,t.mergeFieldListDTO,e.VKq(9,Zt,t.searchValueInColumnPopup),"createDSpopup","join"))}}function Qh(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",423),e.YNc(2,Rh,10,11,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function Hh(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Qh,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function Yh(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpandInColumn=!i.isExpandInColumn}),e.YNc(3,Uh,1,0,"span",198),e.YNc(4,Bh,1,0,"span",199),e._uU(5,"Join Files "),e.qZA()(),e.YNc(6,Jh,2,0,"div",311),e.YNc(7,Hh,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpandInColumn),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn)}}function Vh(n,r){1&n&&e._UZ(0,"span",203)}function $h(n,r){1&n&&e._UZ(0,"span",204)}function Kh(n,r){1&n&&(e.TgZ(0,"div",312),e._uU(1," No files found "),e.qZA())}function Wh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",171)(1,"div",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(8).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"label"),e._uU(3),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function zh(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(8).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(8).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",205)(2,"label",424),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(3,"span",428),e._uU(4),e.qZA()(),e.TgZ(5,"div",10)(6,"div",228)(7,"input",314),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(4).$implicit;return e.oxw(4).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.YNc(8,Wh,4,1,"mat-accordion",170),e.ALo(9,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(8);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.hij(" ",t.fileName,""),e.xp6(3),e.Q6J("value",t.searchValueInColumnPopup),e.xp6(1),e.Q6J("ngForOf",e.gM2(9,4,t.sheet,e.VKq(9,Zt,t.searchValueInColumnPopup),"createDSpopup","files"))}}function Gh(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",423),e.YNc(2,zh,10,11,"mat-expansion-panel",224),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function Xh(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Gh,3,1,"ng-container",2),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function jh(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return i.isExpandInColumn=!i.isExpandInColumn}),e.YNc(3,Vh,1,0,"span",198),e.YNc(4,$h,1,0,"span",199),e._uU(5,"Source Files "),e.qZA()(),e.YNc(6,Kh,2,0,"div",311),e.YNc(7,Xh,2,1,"ng-container",2),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngIf",t.isExpandInColumn),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn),e.xp6(2),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",!t.isExpandInColumn)}}function e0(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Oh,8,4,"ng-container",2),e.YNc(2,Yh,8,4,"ng-container",2),e.YNc(3,jh,8,4,"ng-container",2),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","append"==t.fileType),e.xp6(1),e.Q6J("ngIf","join"==t.fileType),e.xp6(1),e.Q6J("ngIf","files"==t.fileType)}}function t0(n,r){1&n&&e._UZ(0,"span",203)}function n0(n,r){1&n&&e._UZ(0,"span",204)}function o0(n,r){1&n&&(e.TgZ(0,"div",320),e._uU(1," No files found "),e.qZA())}function r0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(6).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"label"),e._uU(3),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function a0(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",171),e.YNc(1,r0,4,1,"ng-container",2),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function s0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",163),e.NdJ("opened",function(){return e.CHM(t),e.oxw(6).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(6).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",205)(2,"label",424),e.NdJ("click",function(i){return i.stopPropagation()}),e._UZ(3,"span",428),e._uU(4),e.qZA()(),e.TgZ(5,"div",10)(6,"div",228)(7,"input",229),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(6).applyFilterForDMTables(i,s,l,"dataset")}),e.qZA()()(),e.YNc(8,a0,2,1,"mat-accordion",170),e.ALo(9,"searchFilter"),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(6);e.Q6J("expanded",o.allExpandState),e.xp6(4),e.hij(" ",t.datasetName,""),e.xp6(4),e.Q6J("ngForOf",e.gM2(9,3,t.datasetFieldDTOList,e.VKq(8,Zt,t.searchValueInCreateDatasetPopup),"createDSpopup","dataset"))}}function l0(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",423),e.YNc(1,s0,10,10,"mat-expansion-panel",224),e.qZA()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList2)}}function c0(n,r){if(1&n&&(e.ynx(0),e.YNc(1,l0,2,1,"mat-accordion",429),e.BQk()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsListForSearch?null:t.allDatasetDetailsListForSearch.length))}}function d0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",422)(1,"div",101)(2,"div",103)(3,"input",169),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i,"parentInColumnPopup")}),e.qZA(),e.TgZ(4,"button",306),e._UZ(5,"span",155),e.qZA()()(),e.YNc(6,e0,4,3,"ng-container",26),e.TgZ(7,"div",20)(8,"h5",237),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.isDatasetExpandInAddCustomColumnInDSPopup=!i.isDatasetExpandInAddCustomColumnInDSPopup}),e.YNc(9,t0,1,0,"span",198),e.YNc(10,n0,1,0,"span",199),e._uU(11,"Dataset Files "),e.qZA()(),e.YNc(12,o0,2,0,"div",307),e.YNc(13,c0,2,1,"ng-container",2),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(3),e.Q6J("value",t.searchValueInColumnPopup),e.xp6(3),e.Q6J("ngForOf",t.sourceFilesAppendJoinFileList2),e.xp6(3),e.Q6J("ngIf",t.isDatasetExpandInAddCustomColumnInDSPopup),e.xp6(1),e.Q6J("ngIf",!t.isDatasetExpandInAddCustomColumnInDSPopup),e.xp6(2),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",!t.isDatasetExpandInAddCustomColumnInDSPopup)}}function _0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).add_SaveCreateExpression(i)}),e._uU(1," SAVE "),e.qZA()}}function p0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).add_SaveCreateExpression(i)}),e._uU(1," Submit "),e._UZ(2,"span",33),e.qZA()}}function u0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",394)(1,"div",244)(2,"div",10)(3,"div",50)(4,"label"),e._uU(5,"Column Name"),e.qZA(),e.TgZ(6,"input",395),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(2).inputInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(2).inputInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).inputInCreateExpression(i,s)}),e.qZA()(),e.TgZ(7,"div",46),e._UZ(8,"label"),e.TgZ(9,"div",396),e._UZ(10,"input",397),e.TgZ(11,"label"),e._uU(12,"Exclude in select"),e.qZA()()()(),e.TgZ(13,"div",10)(14,"div",17)(15,"label"),e._uU(16,"Column Type"),e.qZA(),e.TgZ(17,"mat-form-field",398)(18,"mat-select",399),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).changeDTinCreateExpression(i,s)}),e.YNc(19,Sh,2,2,"mat-option",37),e.qZA()()(),e.YNc(20,Ah,7,1,"div",400),e.qZA(),e.TgZ(21,"div",10)(22,"div",100)(23,"label"),e._uU(24,"Expression"),e.qZA(),e.TgZ(25,"textarea",401),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(2).textAreaInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(2).textAreaInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).textAreaInCreateExpression(i,s)}),e._uU(26,"                "),e.qZA()(),e.TgZ(27,"div",402),e._UZ(28,"label"),e.TgZ(29,"div",403,404)(31,"button",405),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).functionClick()}),e._UZ(32,"img",406),e._uU(33,"unctions "),e.qZA()(),e.YNc(34,kh,7,1,"div",407),e.TgZ(35,"div",408)(36,"button",409),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).columnClick()}),e._uU(37,"Column"),e.qZA(),e.YNc(38,d0,14,6,"div",410),e.qZA()()()(),e.ynx(39),e.TgZ(40,"div",247)(41,"button",411),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeCreateExpressionPopup()}),e._uU(42," Cancel "),e._UZ(43,"span",249),e.qZA(),e.YNc(44,_0,2,0,"button",412),e.YNc(45,p0,3,0,"button",413),e.qZA(),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(2);e.xp6(6),e.Q6J("ngClass",e.VKq(13,qe,o.submited1&&o.createExpressionForm.controls.sourceFieldName.errors))("value",t.sourceFieldName),e.xp6(12),e.Q6J("value",t.columnType)("ngClass",e.VKq(15,qe,o.submited1&&o.createExpressionForm.controls.columnType.errors))("disabled",o.createExpressionForm.controls.sourceFieldName.value.includes("[")),e.xp6(1),e.Q6J("ngForOf",o.getOpearatorList),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(5),e.Q6J("ngClass",e.VKq(17,qe,o.submited1&&o.createExpressionForm.controls.sourceExpressionName.errors))("value",t.expression),e.xp6(9),e.Q6J("ngIf",o.functionClicked),e.xp6(4),e.Q6J("ngIf",o.columnClicked),e.xp6(6),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",0==t.isEdit)}}function f0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",391)(3,"div",392)(4,"h3"),e._uU(5),e.qZA(),e.TgZ(6,"button",265),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeCreateExpressionPopup()}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"form",9),e.YNc(10,u0,46,19,"div",393),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(5),e.hij("",t.add_editCustomColumnNameInPopupInDM," Custom Column and Expression"),e.xp6(4),e.Q6J("formGroup",t.createExpressionForm),e.xp6(1),e.Q6J("ngForOf",t.createExpressionList)}}function m0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",432)(2,"label",433)(3,"input",434),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQL_PythonScript(i,a.isBtnClickedSQL_Python)}),e.qZA(),e._UZ(4,"span",98),e.TgZ(5,"h3"),e._uU(6,"Drag and drop files, or "),e.TgZ(7,"span"),e._uU(8,"Browse"),e.qZA()(),e.TgZ(9,"p"),e._uU(10,"Supported TXT & SQL files"),e.qZA()()()()}}function h0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",9),e._UZ(2,"textarea",435),e.qZA(),e.TgZ(3,"div",247)(4,"button",436),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).enableUploadSQLPopup=!1}),e._uU(5," Cancel "),e._UZ(6,"span",33),e.qZA(),e.TgZ(7,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.saveUploadScript(i.isBtnClickedSQL_Python,"")}),e._uU(8," Save "),e.TgZ(9,"mat-icon"),e._uU(10,"save"),e.qZA()()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,qe,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function g0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Upload SQL Script"),e.qZA(),e.TgZ(6,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQL=!1}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",431),e.YNc(10,m0,11,0,"div",2),e.YNc(11,h0,11,4,"div",2),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function x0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",437)(2,"label",433)(3,"input",434),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQL_PythonScript(i,a.isBtnClickedSQL_Python)}),e.qZA(),e._UZ(4,"span",98),e.TgZ(5,"h3"),e._uU(6,"Drag and drop files, or "),e.TgZ(7,"span"),e._uU(8,"Browse"),e.qZA()(),e.TgZ(9,"p"),e._uU(10,"Supported TXT & PY files"),e.qZA()()()()}}function v0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",9),e._UZ(2,"textarea",435),e.qZA(),e.TgZ(3,"div",247)(4,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).enableUploadPython=!1}),e._uU(5,"Cancel "),e._UZ(6,"span",33),e.qZA(),e.TgZ(7,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.saveUploadScript(i.isBtnClickedSQL_Python,"")}),e._uU(8,"Save "),e.TgZ(9,"mat-icon"),e._uU(10,"save"),e.qZA()()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,qe,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function C0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Upload Python Script"),e.qZA(),e.TgZ(6,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadPython=!1}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",431),e.YNc(10,x0,11,0,"div",2),e.YNc(11,v0,11,4,"div",2),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function T0(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"textarea",438),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(1,qe,t.submited&&t.getViewScriptForm.controls.gscript.errors))}}function b0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"View Script"),e.qZA(),e._UZ(6,"div",29),e.TgZ(7,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewscriptPopup=!1}),e.TgZ(8,"span",266),e._uU(9,"\xd7"),e.qZA()()(),e.TgZ(10,"div",431)(11,"form",9),e.YNc(12,T0,2,3,"ng-container",2),e.qZA()(),e.TgZ(13,"div",247)(14,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeViewScript()}),e._uU(15,"Save and Execute "),e.TgZ(16,"mat-icon"),e._uU(17,"save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("formGroup",t.getViewScriptForm),e.xp6(1),e.Q6J("ngIf",t.isManualScript)}}function w0(n,r){if(1&n&&(e.TgZ(0,"p",443)(1,"mat-icon"),e._uU(2,"help_outline"),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" Are You Sure want to Delete ",t.deleteTableDetails.item.fileNameWithExt," ?")}}function S0(n,r){if(1&n&&(e.TgZ(0,"p",443)(1,"mat-icon"),e._uU(2,"help_outline"),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" Are You Sure want to Delete ",t.deleteTableDetails.item.appendName," ?")}}function N0(n,r){if(1&n&&(e.TgZ(0,"p",443)(1,"mat-icon"),e._uU(2,"help_outline"),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" Are You Sure want to Delete ",t.deleteTableDetails.item.mergeName," ?")}}function A0(n,r){if(1&n&&(e.TgZ(0,"p",443)(1,"mat-icon"),e._uU(2,"help_outline"),e.qZA(),e._uU(3),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.hij(" Are You Sure want to Delete ",t.deleteTableDetails.item.datasetName," ?")}}function y0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",439)(3,"div",241)(4,"h3"),e._uU(5,"Confirm Delete"),e.qZA(),e.TgZ(6,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDeletePopup=!1}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",244)(10,"div",440),e.YNc(11,w0,4,1,"p",441),e.YNc(12,S0,4,1,"p",441),e.YNc(13,N0,4,1,"p",441),e.YNc(14,A0,4,1,"p",441),e.qZA()(),e.TgZ(15,"div",247)(16,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDeletePopup=!1}),e._uU(17,"Cancel "),e._UZ(18,"span",249),e.qZA(),e.TgZ(19,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.deleteTable(i.deleteTableDetails.item,i.deleteTableDetails.type)}),e._uU(20,"Delete "),e._UZ(21,"span",442),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngIf","file"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","append"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","merge"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","dataset"==t.deleteTableDetails.type)}}function D0(n,r){if(1&n&&(e.TgZ(0,"div",65),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function k0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",264)(3,"div",241)(4,"h3"),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"div",244)(7,"form",9)(8,"div",288)(9,"div",289)(10,"label"),e._uU(11,"Enter DataSet Name"),e.TgZ(12,"sup"),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"input",290),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(15,D0,2,1,"div",181),e.qZA()(),e.TgZ(16,"div",291)(17,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetAppendPopup=!1}),e._uU(18," Cancel "),e._UZ(19,"span",249),e.qZA(),e.TgZ(20,"button",292),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDatasetApi()}),e._uU(21," Add "),e._UZ(22,"span",33),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("formGroup",t.datasetAppendForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,qe,t.submitted&&t.datasetAppendForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function F0(n,r){if(1&n&&(e.TgZ(0,"th",339),e._UZ(1,"input",450),e.qZA()),2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);let a;e.Q6J("formGroupName",o),e.xp6(1),e.Q6J("ngClass",e.VKq(2,qe,i.submittedTFPopup&&(null==(a=t.get("newColumnName"))?null:a.errors)))}}function M0(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t,"")}}function L0(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t,"")}}function I0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",35)(2,"mat-select",452),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectDateFormatDropDownInTF(i,s,l)}),e.YNc(3,L0,2,2,"mat-option",37),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("ngForOf",t.dateFormatInTF)}}function E0(n,r){if(1&n){const t=e.EpF();e.ynx(0,339),e.TgZ(1,"td")(2,"mat-form-field",35)(3,"mat-select",451),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).selectDropDownInTF(i,s,l)}),e.YNc(4,M0,2,2,"mat-option",37),e.qZA()(),e.YNc(5,I0,4,1,"ng-container",2),e.qZA(),e.BQk()}if(2&n){const t=r.index,o=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(4),e.Q6J("ngForOf",o.filteredColumnTypeListInTF[t]),e.xp6(1),e.Q6J("ngIf",o.hasDateFormatAt(t))}}function Z0(n,r){if(1&n&&(e.ynx(0)(1,449),e.TgZ(2,"tr"),e.YNc(3,F0,2,4,"th",326),e.qZA(),e.TgZ(4,"tr"),e.YNc(5,E0,6,3,"ng-container",326),e.qZA(),e.BQk()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.TargetFileArr().controls),e.xp6(2),e.Q6J("ngForOf",t.TargetFileArr().controls)}}function P0(n,r){1&n&&(e.ynx(0),e.TgZ(1,"span",455),e._UZ(2,"span",131)(3,"span",130),e.qZA(),e.BQk())}const O0=function(n,r){return{"dds-icon_chevron_down__l__stroke":n,"dds-icon_chevron_up__l__stroke":r}};function U0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"th",237),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index;return e.oxw(3).onSortClick(a,s)}),e._uU(2),e.TgZ(3,"span",453),e._UZ(4,"span",454),e.YNc(5,P0,4,0,"ng-container",2),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);e.xp6(2),e.hij("",t," "),e.xp6(2),e.Q6J("ngClass",e.WLB(3,O0,i.sortColumn==o&&"asc"==i.sortOrder,i.sortColumn==o&&"desc"==i.sortOrder)),e.xp6(1),e.Q6J("ngIf",i.sortColumn!=o)}}function B0(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"tr"),e.YNc(2,U0,6,6,"ng-container",26),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.columnsArr)}}function J0(n,r){if(1&n&&(e.TgZ(0,"td",457),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t]," ")}}function q0(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,J0,2,1,"td",456),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.columnsArr)}}function R0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",271),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeESSPopup()}),e._uU(2," Cancel "),e._UZ(3,"span",249),e.qZA(),e.TgZ(4,"button",458),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).updateInPopupTF()}),e._uU(5," Update "),e._UZ(6,"span",33),e.qZA(),e.BQk()}}function Q0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",271),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).showTargetFilePopup=!1}),e._uU(2," Cancel "),e._UZ(3,"span",249),e.qZA(),e.BQk()}}function H0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",239)(1,"div",444)(2,"div",392)(3,"h3"),e._uU(4),e.qZA(),e.TgZ(5,"button",445),e.NdJ("click",function(){return e.CHM(t),e.oxw().showTargetFilePopup=!1}),e._uU(6," \xd7 "),e.qZA()(),e.TgZ(7,"div",244)(8,"div",446)(9,"form",9)(10,"table",81)(11,"thead"),e.YNc(12,Z0,6,2,"ng-container",2),e.YNc(13,B0,3,1,"ng-container",2),e.qZA(),e.TgZ(14,"tbody"),e.YNc(15,q0,2,1,"tr",26),e.qZA()()()()(),e.TgZ(16,"div",447)(17,"span"),e._uU(18),e.qZA(),e.TgZ(19,"span",448),e._uU(20,"|"),e.qZA(),e._uU(21),e.YNc(22,R0,7,0,"ng-container",2),e.YNc(23,Q0,4,0,"ng-container",2),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(4),e.hij(" ",t.clickedRowDataInTF," "),e.xp6(5),e.Q6J("formGroup",t.targetFilePopupForm),e.xp6(3),e.Q6J("ngIf",2==t.tabs[2].id&&1==t.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",1==t.tabs[1].id&&1==t.tabs[1].isActive||3==t.tabs[3].id&&1==t.tabs[3].isActive||4==t.tabs[4].id&&1==t.tabs[4].isActive||5==t.tabs[5].id&&1==t.tabs[5].isActive),e.xp6(2),e.Q6J("ngForOf",t.selectedM_A_S),e.xp6(3),e.hij("Row Count: ",t.rowCount,""),e.xp6(3),e.hij(" Column Count: ",t.columnsArr.length," "),e.xp6(1),e.Q6J("ngIf",2==t.tabs[2].id&&1==t.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",1==t.tabs[1].id&&1==t.tabs[1].isActive||3==t.tabs[3].id&&1==t.tabs[3].isActive||4==t.tabs[4].id&&1==t.tabs[4].isActive||5==t.tabs[5].id&&1==t.tabs[5].isActive)}}function Y0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"View Script"),e.qZA(),e.TgZ(6,"button",445),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptDSPopup=!1}),e._uU(7,"\xd7"),e.qZA()(),e.TgZ(8,"div",244)(9,"form",9),e._UZ(10,"textarea",459),e.qZA()(),e.TgZ(11,"div",247)(12,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptDSPopup=!1}),e._uU(13,"Cancel "),e._UZ(14,"span",249),e.qZA(),e.TgZ(15,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.updateScriptByDatasetId(i.viewscriptForm)}),e._uU(16,"Save "),e.TgZ(17,"mat-icon"),e._uU(18,"save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.viewscriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,qe,t.viewscriptForm.controls.sqlScript.errors))}}function V0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Error: Files Append Failed due to the datatype mismatch in the following columns"),e.qZA(),e.TgZ(6,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendDatasetError=!1}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",431)(10,"textarea",460),e._uU(11),e.qZA(),e.TgZ(12,"div",247)(13,"button",156),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendDatasetError=!1}),e._uU(14,"OK"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("disabled",!0),e.xp6(1),e.Oqu(t.unique)}}function $0(n,r){if(1&n&&(e.TgZ(0,"mat-option",38),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t," ")}}function K0(n,r){1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Supported TXT & SQL files"),e.qZA(),e.BQk())}function W0(n,r){1&n&&(e.ynx(0),e.TgZ(1,"p"),e._uU(2,"Supported TXT & PY files"),e.qZA(),e.BQk())}function z0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",437)(2,"label",433)(3,"input",434),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQL_PythonScript(i,a.selectedScriptTypeInUF)}),e.qZA(),e._UZ(4,"span",98),e.TgZ(5,"h3"),e._uU(6,"Drag and drop files, or "),e.TgZ(7,"span"),e._uU(8,"Browse"),e.qZA()(),e.YNc(9,K0,3,0,"ng-container",2),e.YNc(10,W0,3,0,"ng-container",2),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(9),e.Q6J("ngIf","SQL script"==t.selectedScriptTypeInUF),e.xp6(1),e.Q6J("ngIf","Python Script"==t.selectedScriptTypeInUF)}}function G0(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.changeTabs({id:5},"prev"),i.enableUploadSQLPython=!1}),e._uU(2,"Next "),e._UZ(3,"span",33),e.qZA(),e.BQk()}}function X0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",9)(2,"div",463)(3,"div",15)(4,"label"),e._uU(5,"Find All"),e.qZA(),e._UZ(6,"input",464),e.qZA(),e.TgZ(7,"div",15)(8,"label"),e._uU(9,"Replace All"),e.qZA(),e._UZ(10,"input",465),e.qZA(),e.TgZ(11,"button",156),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.findReplaceAll(i.sqlScriptForm)}),e._uU(12,"Ok "),e.qZA()(),e._UZ(13,"textarea",435),e.qZA(),e.TgZ(14,"div",247)(15,"button",248),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).oneNext({id:2},"uploadedScript")}),e._uU(16,"Save and Execute "),e.TgZ(17,"mat-icon"),e._uU(18,"save"),e.qZA()(),e.YNc(19,G0,4,0,"ng-container",2),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(12),e.Q6J("ngClass",e.VKq(3,qe,t.submited&&t.sqlScriptForm.controls.sqlScript.errors)),e.xp6(6),e.Q6J("ngIf",t.nextBtnInUploadScriptInUF)}}function j0(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",430)(2,"div",240)(3,"div",241)(4,"h3"),e._uU(5,"Upload"),e.qZA(),e.TgZ(6,"mat-form-field",461)(7,"mat-select",462),e.NdJ("selectionChange",function(i){return e.CHM(t),e.oxw().selectScriptTypeInUF(i)}),e.YNc(8,$0,2,2,"mat-option",37),e.qZA()(),e.TgZ(9,"button",274),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeUploadSQLPythonPopup()}),e.TgZ(10,"span",266),e._uU(11,"\xd7"),e.qZA()()(),e.TgZ(12,"div",431),e.YNc(13,z0,11,2,"div",2),e.YNc(14,X0,20,5,"div",2),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("value",t.selectedScriptTypeInUF),e.xp6(1),e.Q6J("ngForOf",t.scriptList),e.xp6(5),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function e1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"li")(1,"div",467)(2,"input",468),e.NdJ("click",function(i){const s=e.CHM(t).$implicit;return e.oxw(2).selectDesktopOrServices(i,s)}),e.qZA(),e.TgZ(3,"label",469)(4,"span"),e._uU(5),e.qZA()()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("checked",t.isChecked),e.xp6(3),e.Oqu(t.value)}}function t1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",239)(2,"div",273)(3,"div",241)(4,"h3"),e._uU(5,"Selection Type"),e.qZA(),e.TgZ(6,"button",265),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeClickContinueInDMPopup()}),e.TgZ(7,"span",266),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",244)(10,"ul",466),e.YNc(11,e1,6,2,"li",26),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.desktopServicesArray)}}let n1=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u,f,m,h,p,g,v){this.popup=t,this._sanitizer=o,this.route=i,this.loader=a,this.formBuilder=s,this.Master=l,this.solution_services=c,this.fb=d,this._route=_,this._router=u,this.router=f,this.changeDetectorRef=m,this.renderer=h,this.solService=p,this.dialog=g,this.activatedRoute=v,this.rbnProcessType=0,this.tabGeneric=!0,this.tabSolDisplay=!0,this.tabGenericInfo=!0,this.tabClientSpec=!1,this.targetFilesInfoBtn=!1,this.processNameControl=new w.NI(null),this.processDescriptionControl=new w.NI(null),this.isAnalyticsRowEdit=-1,this.showFileNameUI={img:"",vid:"",brochure:""},this.masterSelected=!1,this.errorMsgAP={},this.names=[],this.selectedProcessType="Generic",this.addFeatureList=!1,this.seniroList=[],this.submited=!1,this.submit=!1,this.selectunall=!1,this.demoimg=!1,this.isNextBtnEnable=!1,this.senadded=!0,this.enableAddBtn=!1,this.submited1=!1,this.submit1=!1,this.isOverride=!1,this.fileListt=[],this.sortedList=[],this.sortedCheckedList=[],this.mergeCheckedList=[],this.appendUnchechedList=[],this.disableContinue=!1,this.disableRelButton=!0,this.progressBarPopup=!1,this.enableDataSetPopUp=!1,this.datasetDetailsList=[],this.createExpressionList=[],this.filesList=[],this.columnsArr=[],this.showUploadFilesTab=!1,this.masterSelected1=!1,this.tabs=[{id:0,value:"Add Process",isActive:!0,routeValue:"add-process"},{id:1,value:"Upload Files",isActive:!1,routeValue:"upload-files"},{id:2,value:"Target FIles",isActive:!1,routeValue:"target-files"},{id:3,value:"Append",isActive:!1,routeValue:"append"},{id:4,value:"Join",isActive:!1,routeValue:"join"},{id:5,value:"Data Modelling",isActive:!1,routeValue:"data-modeling"}],this.enableAppendNamePopup=!1,this.enableMergeNamePopup=!1,this.submitted=!1,this.targetFileRowEdit=-1,this.selectedM_A_S=[],this.showTargetFilePopup=!1,this.enableOverRideConfirmPopup=!1,this.cursorPosition=0,this.appendNameControl=new w.NI(null),this.opearatorList=[{id:1,value:"AND"},{id:2,value:"OR"}],this.signOperatorList=[],this.isOpenAccordion=!1,this.fx=[],this.allExpandState=!1,this.panelOpenState=!1,this.dataType=["int","float","char","varchar","dateTime","money","text","decimal","datetime2","decimal","nvarchar","bigint"],this.dataTypee=[{id:0,value:"int"},{id:1,value:"float"},{id:2,value:"char"},{id:3,value:"varchar"},{id:4,value:"text"},{id:5,value:"money"},{id:6,value:"dateTime"},{id:7,value:"date"},{id:8,value:"datetime2"},{id:9,value:"decimal"},{id:10,value:"nvarchar"},{id:11,value:"bigint"}],this.dateTimeFormats=["MM/dd/yyyy","MM-dd-yyyy","dd/MM/yyyy","dd-MM-yyyy","yyyy/MM/dd","yyyy-MM-dd","yyyy/dd/MM","yyyy-dd-MM","MMddyyyy","ddMMyyyy","yyyyMMdd","yyyyddMM"],this.joinType=["Inner Join","Left Join","Outer Join","Right Join","Full Join","Cross Join"],this.unCheckedListAddToMergeList=[],this.userInfo={},this.relationShipPayload=[],this.selectedDateList=[],this.relationship=[],this.enableUploadSQLPopup=!1,this.placetable="Select Primary Table",this.dataSetData=[],this.showRelationshipModal=!1,this.hideCreateIdenticalBtnWithLength=!0,this.columnsToDisplay=["File Name","Uploaded On","Action"],this.innerDisplayedColumns=["sheetName","previewIcon"],this.columnsToDisplayWithExpand=["expand",...this.columnsToDisplay],this.selectedScriptTypeInUF="SQL script",this.masterSelectedInTF=!1,this.targetFileList=[],this.tartargetFileListForSearch=[],this.scriptList=["SQL script","Python Script"],this.dateFormatInTF=["dd/mm/yyyy","yyyy/mm/dd","dd-mm-yyyy","dd-mm-yy","dd Mon yyyy","dd.mm.yy"],this.sourceFilesListForSearch=[],this.isAppendExpandInJoin=!1,this.isSourceFilesExpandInJoin=!1,this.append_SourceFilesListForSearch=[],this.columnsForWhereInDS=[],this.isManualScript=!0,this.isUploadScript=!1,this.isDatasetExpandInCreateDSPopup=!1,this.isDatasetExpandInAddCustomColumnInDSPopup=!1,this.sourceFilesAppendJoinFileList2=[],this.sourceFilesAppendJoinFileListForSearch=[],this.allDatasetDetailsList=[],this.allDatasetDetailsList2=[],this.allDatasetDetailsListForSearch=[],this.searchValueInCreateDSPopup="",this.searchValueInColumnPopup="",this.enableUploadSQLPython=!1,this.desktopServicesArray=[{value:"Power BI Desktop",isChecked:!1},{value:"Power BI Services",isChecked:!1}],this.activeTab=0,this.DataPopUp=!1,this.guid=!1,this.guidindex=0,this.processType="Generic",this.submittedTFPopup=!1,this.filteredColumnTypeListInTF=[],this.allDataTypeByDatatypeName=[],this.clickedRowDataInTF=[],this.fileTypeInTF="",this.append_SourceFilesList=[],this.sourceFilesAppendJoinFileListForJoin=[],this.appendList=[],this.sourceFilesList=[],this.progressBar=[],this.enableViewScriptPopup=!1,this.joinCheckedList=[],this.submitedJ=!1,this.uploadedScriptTableList=[],this.functionClicked=!1,this.columnClicked=!1,this.enableCreateExpression=!1,this.textAreaIndexInDM={},this.textAreaIndexinCE={},this.tablecolNameList=[],this.singleTableDatasetsave=!1,this.viewScriptFromApi="",this.submitedDS=!1,this.enableViewScriptDSPopup=!1,this.searchfx=[],this.allTableListInDM=[],this.allTableListWithoutDSInDM=[],this.selectedColumnsOfDS=[],this.saveDataSetPopup=!1,this.dropDownsInDS=[],this.enableDeletePopup=!1,this.sortDir=-1,this.sortOrder="desc",this.signOperatorWhereInDS=[],this.unique=[],this.enableAppendDatasetError=!1,this.enableDatasetAppendPopup=!1,this.enableUploadSQL=!1,this.enableUploadPython=!1,this.uploadSQLBtn=!0,this.enableViewscriptPopup=!1,this.nextBtnInUploadScriptInUF=!1,this.clickContinueInDM=!1,this.submitedRelation=!1,this.getAppendFilesList=[],this.getJoinFilesList=[],this.getOpearatorList=[],this.fileListtt=[],this.isUploadFilesNextBtnEnable=!1,this.sourceFilesAppendJoinFileList=[],this.selectedCheckBox=[{id:1,data:"N",value:"New",isSelected:!1},{id:2,data:"U",value:"Upcoming",isSelected:!1}]}ngOnInit(){this.process=JSON.parse(localStorage.getItem("process")||"{}"),this.userInfo=JSON.parse(localStorage.getItem("userInfo")||"{}"),console.log("this.process",this.process),console.log("this.userInfo",this.userInfo),this.Genericform=this.formBuilder.group({chooseclient:[""],processNameControl:["",w.kI.required],processDescriptionControl:["",w.kI.required],addfeaturelist:[""],display:[""]}),this.seniroForm=this.formBuilder.group({aName:["",w.kI.required],aDescription:["",w.kI.required]}),this.fileForm=this.formBuilder.group({imgFile:[""],vidFile:[""],broFile:[""]}),this.scenarioForm=this.fb.group({name:["",w.kI.required],description:["",w.kI.required]}),this.fileForm.controls.imgFile.setValidators(w.kI.required),this.dataSource=new Ne.by(this.fileListt),this.dataSource.sort=this.sort,this.uploadedManualToggleForm=this.formBuilder.group({manualOrUploaded:[!1]}),null!=this.process.solutionType&&this.uploadedManualToggleForm.controls.manualOrUploaded.patchValue("U"==this.process.solutionType),this.getViewScriptForm=this.formBuilder.group({script:["",w.kI.required],solutionScriptId:[""],type:[""],gscript:[""]}),this.sqlScriptForm=this.fb.group({datasetName:[""],sqlScript:["",w.kI.required],type:[""],findAll:[""],replaceAll:[""]}),this.targetFilePopupForm=this.formBuilder.group({targetFileList:this.formBuilder.array([])}),this.appendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.joinSetForm=this.formBuilder.group({Merg:this.formBuilder.array([])}),this.joinForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionList=[],this.dataSetForm=this.fb.group({DSetRows:this.fb.array([])}),this.datasetAppendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionForm=this.fb.group({sourceFieldName:["",w.kI.required],columnType:[[],w.kI.required],columnFormat:[[]],excludeInSelect:[!1],sourceExpressionName:[""]}),this.datasetForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.viewscriptForm=this.fb.group({sqlScript:[""],datasetId:[""]}),this.addRelationshipForm=this.fb.group({addRelationshipRows:this.fb.array([this.addRelationshipRow()])}),this.datasetTableForm=this.fb.group({groupBy:[""],groupBySearch:[""],having:[""],orderBy:[""],orderBySearch:[""],where:this.fb.array([this.whereFirstRow()])}),this.solService.getSolutionType().subscribe(o=>{o.id&&this.changetab(o.id)});let t=this.activatedRoute.snapshot.paramMap.get("id");"add-process"==t||null!=this.process.processId?this.tabs.forEach(o=>{o.routeValue==t&&this.changeTabs(o,"prev")}):this.changeTabs({id:0},"prev")}changetab(t){this.processType="",1==t?(this.processType="Generic",this.tabGeneric=!0,this.tabSolDisplay=!0,this.tabGenericInfo=!0,this.tabClientSpec=!1):2==t&&(this.tabGeneric=!0,this.tabSolDisplay=!1,this.tabGenericInfo=!1,this.tabClientSpec=!0,this.fileForm.controls.imgFile.setValidators(null),this.fileForm.controls.imgFile.updateValueAndValidity(),console.log(this.fileForm))}isAllSelected(t){this.selectedCheckBox.forEach(o=>{o.isSelected=o.id==t.id&&!o.isSelected,console.log(t.value)})}onSubmit(){this.submit=!0,this.scenarioForm.invalid?this.popup.open(!1,"Enter All the Required Fields"):(console.log(this.scenarioForm),this.seniroList.push({analyticsName:this.scenarioForm.value.name,analyticsObjective:this.scenarioForm.value.description}),this.senadded=!1,this.scenarioForm.reset(),this.submit=!1,console.log("formmmm",this.scenarioForm),this.closePopup())}tabtab(t){this.tabsChange(t),this.selectedTab=t.id}getAllIndustry(){this.Master.getAllIndustry().subscribe(t=>{t.responseData.forEach(o=>{o.sectorList.forEach(i=>{i.isSelected=!1})}),this.indusData=t.responseData,this.searchindusData=t.responseData,this.lengthIndus=t.responseData.length,null!=this.process.processId&&this.getProcessByID()})}onChangeAddFeatureList(t){this.addFeatureList=t.target.checked}onChangeNew_Upc(t){this.selectedCheckBox=t}analyticsRowEdit(t,o){this.isAnalyticsRowEdit=t,this.seniroForm.patchValue({aName:o.analyticsName,aDescription:o.analyticsObjective})}getAnalyticsControls(){return this.Genericform.get("analytics").controls}deleteAnalyticsRow(t){this.seniroList.splice(t,1)}imgFileUpload(t){this.errorMsgAP={},this.imgFile=t.target.files[0],this.imgFile.size<1e5&&("image/jpeg"===this.imgFile.type||"image/png"===this.imgFile.type||"image/jpg"===this.imgFile.type)&&(console.log(this.imgFile.type),this.showFileNameUI.img=this.imgFile.name)}vidFileUpload(t){this.vidFile=t.target.files[0],("video/mp4"===this.vidFile.type||"video/3gpp"===this.vidFile.type||"video/quicktime"===this.vidFile.type||"video/x-ms-wmv"===this.vidFile.type||"video/x-msvideo"===this.vidFile.type||"video/mpeg"===this.vidFile.type||"video/dvd"===this.vidFile.type||"video/xvid"===this.vidFile.type||"video/x-flv"===this.vidFile.type||"video/x-f4v"===this.vidFile.type||"video/divx"===this.vidFile.type)&&(this.showFileNameUI.vid=this.vidFile.name)}brochureFileUpload(t){this.brochureFile=t.target.files[0],"application/pdf"===this.brochureFile.type&&(this.showFileNameUI.brochure=this.brochureFile.name)}checkUncheckISAll(t){var o;console.log(t.target.checked),this.indusData.forEach(i=>{i.sectorList.forEach(a=>{a.isSelected=t.target.checked})}),0==t.target.checked&&(null===(o=this.procData)||void 0===o||o.industrySectorResponse.forEach(i=>{this.indusData.forEach(a=>{a.industryId==i.industryResponse.industryId&&a.sectorList.forEach(s=>{s.sectorId==i.sectorResponse.sectorId&&(s.isSelected=!0)})})})),this.selectunall=t.target.checked,console.log(this.indusData)}uncheckUncheckISAll(){this.indusData.forEach(t=>{t.sectorList.forEach(o=>{o.isSelected=!1})}),this.selectunall=!1,console.log(this.indusData)}isAllSelectedIS(t,o){this.indusData.forEach(i=>{i.industryId==o.industryId&&i.sectorList.forEach(a=>{a.sectorId!=t.sectorId||(a.isSelected=!a.isSelected)})})}editSeniro(t,o){this.isAnalyticsRowEdit=-1,this.seniroList[t].analyticsName=this.seniroForm.value.aName,this.seniroList[t].analyticsObjective=this.seniroForm.value.aDescription}getAllOrganizations(t){this.solution_services.getAllOrganizations().subscribe(o=>{this.clients=o.responseData,this.tabtab(t)})}addProcessSave(t){var o,i,a,s,l;if(this.submited=!0,console.log(this.Genericform),this.Genericform.invalid)this.popup.open(!1,"Enter All the Required Fields");else{if(0==this.seniroList.length&&"Generic"==this.processType)return this.errorMsgAP.generic="Atleast 1 Scenario required",void this.popup.open(!1,"Atleast 1 Scenario required");if(this.fileForm.invalid)return console.log(this.fileForm),void this.popup.open(!1,"Upload All the Required Files");{let c=[];this.indusData.forEach(m=>{m.sectorList.forEach(h=>{h.isSelected?c.push({sectorId:h.sectorId,industryId:m.industryId,flag:null!=h.flag?h.flag:null}):h.flag&&(console.log("hi"),c.push({sectorId:h.sectorId,industryId:m.industryId,flag:null==h.flag&&null}))})}),console.log(c,this.indusData);let d={};d.processName=null===(o=this.Genericform.get("processNameControl"))||void 0===o?void 0:o.value,d.processDescription=null===(i=this.Genericform.get("processDescriptionControl"))||void 0===i?void 0:i.value,d.processType=this.processType||"Client Specific",console.log(this.processType,null===(a=this.Genericform.get("chooseclient"))||void 0===a?void 0:a.value.organizationName),d.analytics=this.seniroList,d.industrySectorMapDto=c,d.display="Generic"==this.processType?0==this.selectedCheckBox.filter(m=>m.isSelected).length?null:null===(s=this.selectedCheckBox.filter(m=>m.isSelected)[0])||void 0===s?void 0:s.data:null,d.type=this.proid?2:1;let _=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(_,_.userId),d.userId=_.userId,d.addFeatureList=this.addFeatureList,this.proid&&(d.processId=this.proid),"Generic"!=this.processType&&(d.clientList={organizationId:null===(l=this.Genericform.get("chooseclient"))||void 0===l?void 0:l.value.organizationId}),console.log(d);let u=new FormData;u.append("ProcessRequest",JSON.stringify(d)),this.imgFile&&u.append("imageFile",this.imgFile),this.brochureFile&&u.append("brochureFile",this.brochureFile),this.vidFile&&u.append("videoFile",this.vidFile),console.log(u);let f=this.process.statusName;this.Master.PostaddorEditProcess(u).subscribe(m=>{m.responseData.statusName=f,console.log(m),localStorage.setItem("process",JSON.stringify(m.responseData)),this.router.navigate(["/user/admin1/solutionboard/upload-files"]),this.process=JSON.parse(localStorage.getItem("process")||"{}"),this.getAllFileTemplateListByProcessID({id:1})},m=>{console.log(m.statusMessage),this.popup.open(!1,m)})}}}reset(){this.seniroForm.reset(),this.Genericform.reset(),this.showFileNameUI.img="",this.showFileNameUI.vid="",this.showFileNameUI.brochure="",this.uncheckUncheckISAll(),this.seniroList=[]}getProcessByID(){this.loader.show(),this.proid=this.process.processId,this.isNextBtnEnable=!0,this.Master.getProcessByID(this.proid).subscribe(o=>{var i,a,s,l,c,d;this.procData=o.responseData,"Generic"==(null===(i=o.responseData)||void 0===i?void 0:i.processType)?(this.changetab(1),this.isDisabled="G"):(this.changetab(2),this.isDisabled="C"),this.seniroList=null===(a=o.responseData)||void 0===a?void 0:a.processAnalyticsDTOList,this.loader.hide(),null===(s=this.clients)||void 0===s||s.forEach(u=>{"Client Specific"==this.procData.processType&&this.procData.clientName==u.organizationName&&this.Genericform.patchValue({chooseclient:u})}),this.Genericform.patchValue({processNameControl:this.procData.processName,processDescriptionControl:this.procData.processDescription,addfeaturelist:this.procData.addFeatureList}),"Published"==this.process.statusName&&this.Genericform.controls.processNameControl.disable();let _=0;null===(c=null===(l=this.procData)||void 0===l?void 0:l.industrySectorResponse)||void 0===c||c.forEach(u=>{var f;null===(f=this.indusData)||void 0===f||f.forEach(m=>{m.industryId==u.industryResponse.industryId&&m.sectorList.forEach(h=>{h.sectorId==u.sectorResponse.sectorId&&(h.isSelected=!0,h.flag=u.flag)})})}),null===(d=this.indusData)||void 0===d||d.forEach(u=>{u.sectorList.forEach(f=>{0==f.isSelected&&(_=1)})}),this.selectunall=1!=_,this.selectedCheckBox.forEach(u=>{this.procData.display==u.data&&(u.isSelected=!0)}),null===this.procData.imageUrl?this.demoimg=!1:(this.demo=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/png;base64,"+this.procData.imageUrl),this.demoimg=!0,this.fileForm.controls.imgFile.setValidators(null),this.fileForm.controls.imgFile.updateValueAndValidity()),this.showFileNameUI.img=this.procData.imageName,this.showFileNameUI.vid=this.procData.videoName,this.showFileNameUI.brochure=this.procData.brochureName})}ngAfterViewInit(){}validateDatasetname(){return t=>{var o;const s=null===(o=this.datasetForm.get("appendNameControl"))||void 0===o?void 0:o.value;return this.solService.getExistDataset(s,"").subscribe(c=>{this.submitted=!1,this.submittedErrorMsg=""},c=>{this.submitted=!0,this.submittedErrorMsg="Dataset Name Already Exists"}),(0,xt.of)(null)}}previewPopup(t){var o;console.log(t);let a,s,i="";this.tabs[1].isActive?(a="table","csv"==t.fileExt||"txt"==t.fileExt||"pdf"==t.fileExt||"json"==t.fileExt?(s=t["File Name"],i=t.totalSheetList.filteredData[0].tableName):("xlsx"==t.fileExt||"xls"==t.fileExt)&&(s=null===(o=t.sheet[0])||void 0===o?void 0:o.showTabColName.split("[")[0],i=t.tableName)):this.tabs[3].isActive?(a="Append"==t.type?"append":"files"==t.type?"table":"",i=t.tableName,s="Append"==t.type?t.appendName:t.tableNameUI):this.tabs[4].isActive?(a="Append"==t.type?"append":"files"==t.type?"table":"Merge"==t.type?"join":"",i=t.tableName,s="Merge"==t.type?t.mergeName:t.tableNameUI):this.tabs[5].isActive&&(a="dataset"==t.type?"dataset":"Append"==t.type?"append":"files"==t.type?"table":"Merge"==t.type?"join":"",i=t.tableName,s="dataset"==t.type?t.datasetName:"Append"==t.type?t.appendName:"Merge"==t.type?t.mergeName:"files"==t.type?t.tableNameUI:""),console.log(a),this.viewTableDetails(i,"",{fileName:s},a)}targetFileClickedRowX_DateFormat(){return this.formBuilder.group({newColumnName:["",w.kI.required],fieldName:[""],columnId:[""],templateId:[""],tableName:[""],columnType:[""]})}targetFileClickedRow_DateFormat(){return this.formBuilder.group({newColumnName:["",w.kI.required],fieldName:[""],columnId:[""],templateId:[""],tableName:[""],columnType:[""],dateFormat:["",w.kI.required]})}updateInPopupTF(){if(console.log(this.targetFilePopupForm.controls),this.TargetFileArr().controls.map(i=>i.invalid).includes(!0))return void(this.submittedTFPopup=!0);let o={userID:this.userInfo.userId,tableColumnChangeDetailsList:[],dataTypeChangeDetails:[]};this.TargetFileArr().controls.forEach(i=>{i.controls.newColumnName.pristine||o.tableColumnChangeDetailsList.push({templateFieldId:i.controls.columnId.value,tableName:i.controls.tableName.value,templateId:i.controls.templateId.value,newColumnName:i.controls.newColumnName.value,previousColumnName:i.controls.fieldName.value});let a={templateFieldId:i.controls.columnId.value,tableName:i.controls.tableName.value,templateId:i.controls.templateId.value,columnName:i.controls.fieldName.value,newDataTypeName:i.controls.columnType.value};i.controls.columnType.pristine||(a.dateFormat=Object.keys(i.controls).includes("dateFormat")?i.controls.dateFormat.value:null,o.dataTypeChangeDetails.push(a)),null!=i.controls.dateFormat&&(a.dateFormat=i.controls.dateFormat.value,o.dataTypeChangeDetails.push(a))}),o.dataTypeChangeDetails=[...new Set(o.dataTypeChangeDetails)],console.log(o),0!=o.tableColumnChangeDetailsList.length||0!=o.dataTypeChangeDetails.length?this.solService.updateColumnAndDataType(o).subscribe(i=>{this.popup.open(!0,i.responseData),this.showTargetFilePopup=!1},i=>{this.popup.open(!1,"update failed")}):this.showTargetFilePopup=!1}viewTableDetails(t,o,i,a){if(this.clickedRowDataInTF=i.fileName,this.filteredColumnTypeListInTF=[],this.rowCount="",""!=t){this.loader.show();let s={name:t,processId:this.process.processId};this.tabs[2].isActive&&(s.targetFileEdit="S"),this.solService.viewTableDetails(s).subscribe(l=>{var c,d;let _=[],u=[];if(null!=l.responseData){if(this.selectedM_A_S=l.responseData.tableDetails,this.preview(),this.tabs[2].isActive){i.sheet.forEach(h=>h.isDropdownDirtyInTF=!1);let f=null===(c=l.responseData)||void 0===c?void 0:c.columnTypeDetails,m=null===(d=l.responseData)||void 0===d?void 0:d.columnFormatDetails;this.columnsArr.forEach(h=>{var p;_.push(f[h]),u.push(m[h]);let g=this.allDataTypeByDatatypeName.filter(v=>v.dataTypeName==f[h]);this.filteredColumnTypeListInTF.push(null===(p=g[0])||void 0===p?void 0:p.dataTypeList)}),i.sheet.forEach((h,p)=>{let g={newColumnName:this.columnsArr[p],fieldName:this.columnsArr[p],columnId:h.columnId,templateId:h.templateId,tableName:h.tableName,columnType:_[p]};"date"==_[p]||"datetime2"==_[p]?(this.TargetFileArr().controls.push(this.targetFileClickedRow_DateFormat()),g.dateFormat=u[p],this.TargetFileArr().controls[p].patchValue(g)):(this.TargetFileArr().controls.push(this.targetFileClickedRowX_DateFormat()),this.TargetFileArr().controls[p].patchValue(g))})}console.log(this.filteredColumnTypeListInTF,"this.filteredColumnTypeListInTF"),console.log("this.clickedRowDataInTF",this.clickedRowDataInTF),console.log(this.targetFilePopupForm.controls),this.rowCount=l.responseData.count,this.showTargetFilePopup=!0}else this.popup.open(!1,l.statusMessage);this.loader.hide()},l=>{this.popup.open(!1,l.error.statusMessage),this.loader.hide()})}}hasDateFormatAt(t){return!!this.TargetFileArr().controls[t].get("dateFormat")}addDateFormatAt(t){this.TargetFileArr().controls[t].addControl("dateFormat",this.fb.control(null))}removeDateFormatAt(t){this.TargetFileArr().controls[t].removeControl("dateFormat")}preview(){for(var t in this.columnsArr=[],this.selectedM_A_S[0])this.selectedM_A_S[0].hasOwnProperty(t)&&this.columnsArr.push(t)}searchField(t,o,i,a,s,l){let c=t.target.value;"dataset"==s?"pt"==l?this.dataSetData[a].searchValuePT=c:"ft"==l?this.dataSetData[a].searchValueFT=c:"pk"==l?this.dataSetData[a].columns[i].searchValuePK=c:"fk"==l&&(this.dataSetData[a].columns[i].searchValueFK=c):"join"==s?"pt"==l?this.joinCheckedList[a].dropDownList[i].searchValuePT=c:"ft"==l?this.joinCheckedList[a].dropDownList[i].searchValueFT=c:"pk"==l?this.joinCheckedList[a].dropDownList[i].columns[o].searchValuePK=c:"fk"==l&&(this.joinCheckedList[a].dropDownList[i].columns[o].searchValueFK=c):"tf"==s&&(this.targetFileList[a].searchValueInTF=c)}closeDropdown(t,o,i,a,s){var l;"dataset"==a?"pt"==s?this.dataSetData[i].searchValuePT="":"ft"==s?this.dataSetData[i].searchValueFT="":"pk"==s?this.dataSetData[i].columns[o].searchValuePK="":"fk"==s&&(this.dataSetData[i].columns[o].searchValueFK=""):"join"==a?"pt"==s?this.joinCheckedList[i].dropDownList[o].searchValuePT="":"ft"==s?this.joinCheckedList[i].dropDownList[o].searchValueFT="":"pk"==s?this.joinCheckedList[i].dropDownList[o].columns[t].searchValuePK="":"fk"==s&&(this.joinCheckedList[i].dropDownList[o].columns[t].searchValueFK=""):"where"==a&&("column"==s?null===(l=this.whereArrInDS().controls[i].get("columnSearch"))||void 0===l||l.patchValue(""):"groupBy"==s?this.datasetTableForm.controls.groupBySearch.patchValue(""):"orderBy"==s&&this.datasetTableForm.controls.orderBySearch.patchValue(""))}getAllDataTypeByDatatypeName(){this.solService.getAllDataTypeByDatatypeName().subscribe(t=>{console.log(t),this.allDataTypeByDatatypeName=t.responseData,console.log("this.allDataTypeByDatatypeName",this.allDataTypeByDatatypeName)})}isFileSelectedInUF(t,o){let i=t.target.checked;o.isFileSelected=i,o.totalSheetList.filteredData.forEach(a=>{a.sheetSelected=i}),o.totalSheetList.filteredData.map(a=>a.isCheckedDirtyInUF=!0),console.log(o),this.masterSelectedinUploadFiles()}toggleRow(t){this.changeDetectorRef.detectChanges(),this.innerTables.forEach((o,i)=>o.dataSource.sort=this.innerSort.toArray()[i])}findReplaceAll(t){console.log(t);let i=t.controls.replaceAll.value,s=t.controls.sqlScript.value.split(t.controls.findAll.value).join(i);t.controls.sqlScript.patchValue(s)}getAllFileTemplateListByProcessID(t){this.loader.show(),this.fileListt=[],this.dataSource=new Ne.by,this.solService.getAllFileTemplateListByProcessID(this.process.processId).subscribe(o=>{this.showUploadFilesTab=!0;const i=o.responseData.totalfileDetails;if(0==i.length)this.showUploadFilesTab=!1;else{i.forEach(l=>{l.isFileSelected=!l.totalSheetList.map(d=>d.sheetSelected).includes(!1),"xlsx"==l.fileExt||"xls"==l.fileExt?(l["File Name"]=l.fileNameWithExt,l.Action=["dds-icon dds-icon_delete__l__stroke"]):(l["File Name"]=l.fileNameWithExt,l.Action=["dds-icon dds-icon_eyeopen","dds-icon dds-icon_delete__l__stroke"]),l["Uploaded On"]=l.uploadedOn,l.totalSheetList.forEach(d=>{var _;d.previewIcon="dds-icon dds-icon_eyeopen",d.isCheckedDirtyInUF=!1;const u=d.sheetName;null===(_=d.sheet)||void 0===_||_.forEach(f=>{f.isChecked=!1,f.tableName=d.tableName,"xlsx"==l.fileExt||"xls"==l.fileExt?f.showTabColName=l.fileName+"-"+u+"."+l.fileExt+"["+f.fieldName+"]":("txt"==l.fileExt||"csv"==l.fileExt)&&(f.showTabColName=l.fileNameWithExt+"["+f.fieldName+"]"),f.fileExt=l.fileExt})})});let s=[];i.forEach(l=>{l.totalSheetList&&Array.isArray(l.totalSheetList)&&l.totalSheetList.length&&(this.fileListt=[...this.fileListt,Object.assign(Object.assign({},l),{totalSheetList:new Ne.by(l.totalSheetList)})],s=[...s,Object.assign(Object.assign({},l),{totalSheetList:new Ne.by(l.totalSheetList)})])}),this.dataSource=new Ne.by(this.fileListt),console.log("this.dataSource",this.dataSource),this.fileListtForSearch=new Ne.by(s),this.masterSelectedinUploadFiles()}this.loader.hide(),this.tabtab(t),this.progressBar.map(s=>s.isError).includes(!0)||(this.progressBarPopup=!1)},o=>{this.showUploadFilesTab=!1,this.popup.open(!1,o.statusText+"!"),this.loader.hide()})}searchFilter(t){this.searchindusData=this.indusData.filter(o=>this.containsValueindustry(o,t.target.value.trim().toLowerCase()))}containsValueindustry(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}saveiputFiles(t,o){this.showUploadFilesTab=!0,this.progressBar=[];let s,i=this.process.processId,a=["xlsx","xls","txt","csv","json","jpeg","png","jpg","pdf"];"click"==o?s=t.target.files:"dragNDrop"==o&&(s=t.dataTransfer.files);for(let c=0;c<s.length;c++){const d=s[c];a.includes(d.name.split(".")[1])&&this.fileListt.push({fileNameWithExt:d.name.split(".")[0],isProgressBar:!0,fileExt:d.name.split(".")[1]})}let l=[];for(let c=0;c<s.length;c++)if(a.includes(s[c].name.split(".")[1])){const _=new FormData;_.append("processId",i),_.append("file",s[c]),_.append("userId",this.userInfo.userId),l.push(this.solService.postInputFiles(_).pipe((0,ys.b)(u=>{console.log(u),u.type===Dt.dt.UploadProgress&&(this.progressBar[c]={percentage:Math.round(95/u.total*u.loaded),file:s[c].name,isError:!1,icon:!1},console.log(this.progressBar))}),(0,Kr.K)(u=>(0,xt.of)({error:u,isError:!0}))))}this.progressBarPopup=!0,(0,Ji.D)(l).subscribe(c=>{console.log(c),this.progressBar.forEach(d=>d.percentage=100),c.forEach((d,_)=>{this.progressBar[_].icon=!0,this.progressBar[_].isError=!!d.isError&&d.isError}),console.log(this.progressBar),this.getAllFileTemplateListByProcessID({id:1})})}closeUploadSQLPythonPopup(){this.enableUploadSQLPython=!1,this.uploadSQLBtn=!0}uploadedManualToggle(t){}selectScriptTypeInUF(t){let o=t.value;this.selectedScriptTypeInUF=o;let i=this.sqlScriptForm.controls.type.value;this.uploadSQLBtn=!("SQL script"==o&&"S"==i||"Python Script"==o&&"P"==i)}copyTableName(t,o){"child"==o?navigator.clipboard.writeText(t.tableName):"parent"==o&&navigator.clipboard.writeText(t.totalSheetList.filteredData[0].tableName)}isAllSelectedUploadFiles(t,o){o.isCheckedDirtyInUF=!0,t.isFileSelected=!t.totalSheetList.filteredData.map(a=>a.sheetSelected).includes(!1),console.log(t,o),this.masterSelectedinUploadFiles()}masterSelectedinUploadFiles(){let t=1;this.fileListt.forEach(o=>{o.totalSheetList.filteredData.forEach(i=>{0!=i.sheetSelected||(t=0)})}),this.masterSelected=0!=t,console.log(this.fileListt),this.nextBtnEnableInUF()}checkUncheckAllUploadFiles(){this.dataSource.filteredData.forEach(t=>{var o;null===(o=null==t?void 0:t.totalSheetList.filteredData)||void 0===o||o.forEach(a=>{a.sheetSelected=this.masterSelected,a.isCheckedDirtyInUF=!0}),t.isFileSelected=!t.totalSheetList.filteredData.map(a=>a.sheetSelected).includes(!1)})}nextBtnEnableInUF(){return 0==this.fileListt.filter(o=>{var i,a;return null===(a=null===(i=o.totalSheetList)||void 0===i?void 0:i.filteredData)||void 0===a?void 0:a.some(s=>1==s.sheetSelected)}).map(o=>Object.assign({},o,{totalSheetList:o.totalSheetList.filteredData.filter(i=>1==i.sheetSelected)})).length}TargetFileArr(){return this.targetFilePopupForm.get("targetFileList")}masterCheckedInTF(t){t.target.checked?(this.masterSelectedInTF=!0,this.targetFileList.forEach(o=>{o.isCheckedInTF=!0,o.sheet.forEach(i=>{i.isChecked||(i.isCheckedChildDirtyInTF=!0,i.isChecked=!0)})})):this.masterCheckedFalseInTF()}masterCheckedFalseInTF(){this.masterSelectedInTF=!1,this.targetFileList.forEach(t=>{t.isCheckedInTF=!1,t.sheet.forEach(o=>{o.isChecked&&(o.isCheckedChildDirtyInTF=!0,o.isChecked=!1)})})}checkSheetInTF(t,o){o.sheet.forEach(t.target.checked?i=>{i.isChecked||(i.isCheckedChildDirtyInTF=!0,i.isChecked=!0)}:i=>{i.isChecked&&(i.isCheckedChildDirtyInTF=!0,i.isChecked=!1)}),this.masterChkInTF()}checkColumnInTF(t,o,i){console.log(t,o),o.isCheckedChildDirtyInTF=!0;let a=this.targetFileList[i].sheet.map(s=>s.isChecked);this.targetFileList[i].isCheckedInTF=!a.includes(!1),this.masterChkInTF()}masterChkInTF(){let t=this.targetFileList.map(o=>o.isCheckedInTF);this.masterSelectedInTF=!t.includes(!1)}fileClickedinTF(t,o,i,a,s){console.log(i,a,s),this.sourceFilesAppendJoinFileList.forEach(l=>{l.sheetList.forEach(c=>{c.isRowTabAvtive=!1})}),i.isRowTabAvtive=!0,this.fileTypeInTF=a,this.targetFilePopupForm.controls.targetFileList=this.formBuilder.array([]),this.viewTableDetails(s,o,i,"table")}closeESSPopup(){this.showTargetFilePopup=!1}editColumnInTargetFiles(t){t.isColumnEditInTF=!t.isColumnEditInTF,t.isColumnEditInTFDirty=!0,console.log(t)}getTargetFileList(t){this.createExpressionList=[],this.datasetDetailsList=[],this.sourceFilesAppendJoinFileList=[],this.sourceFilesAppendJoinFileListForJoin=[],this.loader.show(),this.solService.getTargetFileList(this.process.processId).subscribe(o=>{var i,a,s,l,c,d,_,u;let f=this.appendResponse(null===(i=null==o?void 0:o.responseData.appendSheetListDto)||void 0===i?void 0:i.appendSheetList);null===(a=o.responseData.templateMergeListDTO)||void 0===a||a.templatesMergeDetailsList.forEach(p=>{p.tableNameUI=p.mergeName,p.searchValueInCreateDatasetPopup="",p.searchValueInColumnPopup="",p.isSelectAllParentInDM=!1,p.mergeFieldListDTO.forEach(g=>{g.isSelectAllChildInDM=!1,g.showTabColName=p.mergeName+"["+g.fieldName+"]",g.isDropdownDirtyInTF=!1})});let m=this.totalfileDetails(null===(l=null===(s=null==o?void 0:o.responseData)||void 0===s?void 0:s.templateFileDetailsListDto)||void 0===l?void 0:l.totalfileDetails,t),h=this.totalfileDetails(null===(d=null===(c=null==o?void 0:o.responseData)||void 0===c?void 0:c.templateFileDetailsListDto)||void 0===d?void 0:d.totalfileDetails,{id:4});this.sourceFilesAppendJoinFileList=[{fileType:"append",sheetList:f},{fileType:"join",sheetList:null===(_=o.responseData.templateMergeListDTO)||void 0===_?void 0:_.templatesMergeDetailsList},{fileType:"files",sheetList:m}],this.sourceFilesAppendJoinFileListForJoin=[{fileType:"append",sheetList:f},{fileType:"join",sheetList:null===(u=o.responseData.templateMergeListDTO)||void 0===u?void 0:u.templatesMergeDetailsList},{fileType:"files",sheetList:h}],console.log(this.sourceFilesAppendJoinFileList,"this.sourceFilesAppendJoinFileList"),this.sourceFilesAppendJoinFileList2=JSON.parse(JSON.stringify(this.sourceFilesAppendJoinFileList)),this.sourceFilesAppendJoinFileListForSearch=JSON.parse(JSON.stringify(this.sourceFilesAppendJoinFileList)),this.allList(t),this.loader.hide()},o=>{this.loader.hide()})}selectDropDownInTF(t,o,i){if("date"==t.value||"datetime2"==t.value){this.addDateFormatAt(i);let s=this.TargetFileArr().controls.filter(l=>l.controls.dateFormat).map(l=>l.controls.dateFormat.value).filter(l=>!!l);o.controls.dateFormat.patchValue(null==s?void 0:s[0])}else this.removeDateFormatAt(i);console.log(o)}selectDateFormatDropDownInTF(t,o,i){this.TargetFileArr().controls.forEach(a=>{a.controls.dateFormat&&a.controls.dateFormat.patchValue(t.value)})}sortDataFilter(t,o,i){t.sort(function(a,s){return a[i]<s[i]?-1*o:a[i]>s[i]?1*o:0})}sortData(t,o,i){console.log(t,o,i);let a="asc"==t.direction?1:-1,s=t.active;"append"==o&&("AF"==i?this.sortDataFilter(this.getAppendFilesList,a,s):"SF"==i&&this.sortDataFilter(this.sourceFilesList,a,s))}isCheckedInAppend(t){this.submitted=!1,this.submittedErrorMsg=""}addAppend(){console.log("this.sourceFilesList",this.sourceFilesList);let t=this.sourceFilesList.filter(l=>l.isCheckedInAppend);if(console.log(t),t.length<2)return void this.popup.open(!1,"Please select atleast two tables for appending !");let o=this.sourceFilesList.filter(l=>l.isCheckedInAppend);o.forEach(l=>{l.sheet.forEach(c=>{c.fieldNameColumnType=c.fieldName.trim()+"."+c.columnType})});let i=[];i=o.map(l=>l.sheet.map(c=>c.fieldName.trim()+"."+c.columnType));let a=o.map(l=>l.sheet.map(c=>c.fieldName.trim()+"."+c.columnType));console.log(i),console.log(this.findCommon(a));let s=this.findCommon(a);this.unique=[],o.forEach((l,c)=>{let d=[];l.sheet.forEach((_,u)=>{(null==s?void 0:s.includes(_.fieldNameColumnType))||d.push(_.fieldNameColumnType)}),0!=d.length&&this.unique.push(l.tableNameUI+":"+d+"\n")}),console.log("Mismatch ",o),console.log(this.unique),0!=this.unique.length?this.enableAppendDatasetError=!0:this.enableAppendNamePopup=!0,this.appendForm.reset()}isTableExistAppend(t){this.submited1=!1,this.submited=!1,this.submittedErrorMsg=""}isTableExist(t,o){this.loader.show(),this.solService.getExistDataset(t,o).subscribe(i=>{this.loader.hide(),this.enableAddBtn=!1,this.submited1=!1,this.submittedErrorMsg="",this.appendForm.controls.appendNameControl.setValidators([]),this.appendForm.controls.appendNameControl.updateValueAndValidity(),this.enableAppendNamePopup=!1,this.postAddAppendFiles(t),console.log(i)},i=>{this.loader.hide(),this.progressBarPopup=!1,this.enableAddBtn=!1,this.submited1=!0,this.submittedErrorMsg="Append Name Already Exist!!!",this.appendForm.controls.appendNameControl.setValidators([w.kI.required]),this.appendForm.controls.appendNameControl.updateValueAndValidity()})}addAppendApi(){var t;this.enableAddBtn=!0;let o=null===(t=this.appendForm.get("appendNameControl"))||void 0===t?void 0:t.value;this.submited1=!0,console.log(this.appendForm),!this.appendForm.invalid&&this.isTableExist(o,"append")}postAddAppendFiles(t){this.progressBarPopup=!0,this.progressBar=[];let o=[];this.sourceFilesList.forEach(a=>{a.isCheckedInAppend&&o.push({sheetId:a.templateId,fileName:a.fileName})}),this.solService.addAppendFiles({processId:this.process.processId,userId:this.userInfo.userId,appendSheetList:[{appendDtos:o,appendName:t}]}).subscribe(a=>{a.type==Dt.dt.UploadProgress?(this.progressBar=[{percentage:Math.round(100/a.total*a.loaded)}],this.progressBarPopup=!1):a.type==Dt.dt.Response&&(this.progressBar=[],this.getAppendFilesApi(),this.appendForm.reset(),this.sourceFilesList.forEach(s=>s.isCheckedInAppend=!1),this.popup.open(!0,"Saved Successfully !")),this.loader.hide()},a=>{this.progressBarPopup=!1,this.popup.open(!1,a.error.responseData+"!"),this.loader.hide()})}Merg(){return this.formBuilder.group({tableControl:this.formBuilder.array([])})}addTable(){return this.formBuilder.group({table1:["",w.kI.required],join:["",w.kI.required],table2:["",w.kI.required],column:this.formBuilder.array([])})}addColumn(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}MergeArr(){return this.joinSetForm.get("Merg")}TableArr(t){return this.MergeArr().controls[t].get("tableControl")}columnArr(t,o){return this.TableArr(t).controls[o].get("column")}addMergeJoin(){this.MergeArr().push(this.Merg());let t=this.MergeArr().length;this.TableArr(t-1).push(this.addTable());let o=this.TableArr(t-1).length;this.columnArr(t-1,o-1).push(this.addColumn())}addTableJoins(t,o){var i,a,s;let l=this.joinCheckedList[t].dropDownList.length,c=this.TableArr(t).length;if(0==this.joinCheckedList[t].dropDownList[l-1].foreignTableList.length||""==(null===(i=this.TableArr(t).controls[c-1].get("table1"))||void 0===i?void 0:i.value)||""==(null===(a=this.TableArr(t).controls[c-1].get("table2"))||void 0===a?void 0:a.value))return;this.TableArr(t).push(this.addTable());let d=this.TableArr(t).length;this.columnArr(t,d-1).push(this.addColumn()),console.log(null===(s=this.joinCheckedList[t])||void 0===s?void 0:s.dropDownList)}addColumnJoin(t,o){var i,a;let s=this.columnArr(t,o).controls.length;""==(null===(i=this.columnArr(t,o).controls[s-1].get("column1"))||void 0===i?void 0:i.value)||""==(null===(a=this.columnArr(t,o).controls[s-1].get("column2"))||void 0===a?void 0:a.value)||0==this.joinCheckedList[t].dropDownList[o].columns[s].primaryKeyList.length||0==this.joinCheckedList[t].dropDownList[o].columns[s].foreignKeyList.length||this.columnArr(t,o).push(this.addColumn())}removeCol(t,o,i){for(let a=i;a<=this.joinCheckedList[t].dropDownList[o].columns.length;a++)this.columnArr(t,o).removeAt(a);this.joinCheckedList[t].dropDownList[o].columns.splice(i+1,this.joinCheckedList[t].dropDownList[o].columns.length)}removeTable(t,o){console.log("removeTable()",t,o);for(let i=o;i<=this.joinCheckedList[t].dropDownList.length;i++)this.TableArr(t).removeAt(o);this.joinCheckedList[t].dropDownList.splice(o+1,this.joinCheckedList[t].dropDownList.length),console.log(this.joinCheckedList[t].dropDownList)}resetJoin(){this.joinCheckedList=[],this.append_SourceFilesList.forEach(t=>t.isCheckedInJoin=!1)}saveJoin(){}MergeSubmit(){this.progressBarPopup=!0,this.progressBar=[],this.submitedJ=!0;let t=0;if(this.MergeArr().controls.forEach((a,s)=>{this.TableArr(s).controls.forEach(l=>{l.invalid&&(t=1)})}),1==t)return void this.popup.open(!1,"Enter all the required fields");console.log(this.joinSetForm.value,this.process.processId);let o={};o.processId=this.process.processId,o.userId=this.userInfo.userId,o.templatesMergeDetailsList=[];let i=[];this.MergeArr().controls.forEach((a,s)=>{var l;o.templatesMergeDetailsList[s]={},o.templatesMergeDetailsList[s].mergeName=null===(l=this.joinForm.get("appendNameControl"))||void 0===l?void 0:l.value,o.templatesMergeDetailsList[s].templatesMergeList=[],o.templatesMergeDetailsList[s].mergeTableDetails=[],i=[],a.controls.tableControl.controls.forEach((c,d)=>{c.controls.table1&&i.push(c.controls.table1.value),c.controls.table2&&i.push(c.controls.table2.value)}),i=[...new Set(i)],i.forEach((c,d)=>{o.templatesMergeDetailsList[s].mergeTableDetails[d]={},"template"==c.type?(o.templatesMergeDetailsList[s].mergeTableDetails[d].id=c.templateId,o.templatesMergeDetailsList[s].mergeTableDetails[d].type="T"):"Append"==c.type&&(o.templatesMergeDetailsList[s].mergeTableDetails[d].id=c.appendID,o.templatesMergeDetailsList[s].mergeTableDetails[d].type="A")}),this.TableArr(s).controls.forEach((c,d)=>{o.templatesMergeDetailsList[s].templatesMergeList[d]={},"Append"==c.value.table1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].primaryTemplateId=c.value.table1.appendID),"Append"==c.value.table2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].secondaryTemplateId=c.value.table2.appendID),"template"==c.value.table1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].primaryTemplateId=c.value.table1.templateId),"template"==c.value.table2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].secondaryTemplateId=c.value.table2.templateId),o.templatesMergeDetailsList[s].templatesMergeList[d].primaryTableName=c.value.table1.tableNameDB,o.templatesMergeDetailsList[s].templatesMergeList[d].secondaryTableName=c.value.table2.tableNameDB,o.templatesMergeDetailsList[s].templatesMergeList[d].joinType=c.value.join[0],o.templatesMergeDetailsList[s].templatesMergeList[d].order=0==d?1:2,o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList=[],this.columnArr(s,d).controls.forEach((_,u)=>{o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u]={},"append"==_.value.column1.fileType&&(o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].primaryKeyId=_.value.column1.fieldID),"append"==_.value.column2.fileType&&(o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].secondaryKeyId=_.value.column2.fieldID),"template"==_.value.column1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].primaryKeyId=_.value.column1.columnId),"template"==_.value.column2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].secondaryKeyId=_.value.column2.columnId),o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].primaryFieldName=_.value.column1.columnName,o.templatesMergeDetailsList[s].templatesMergeList[d].columnArrayList[u].secondaryFieldName=_.value.column2.columnName})})}),console.log(o),this.progressBarPopup=!0,this.solService.addJoinFiles(o).subscribe(a=>{a.type==Dt.dt.UploadProgress?this.progressBar=[{percentage:Math.round(100/a.total*a.loaded)}]:a.type==Dt.dt.Response&&(this.progressBar=[],this.getJoinFilesListApi(),this.popup.open(!0,"Saved Successfully !")),console.log(a),this.joinCancelBtn(),this.loader.hide(),this.progressBarPopup=!1},a=>{this.popup.open(!1,"Join Save failed !"),this.progressBarPopup=!1,this.loader.hide()})}join2Sheets(){var t;if(this.submitedJ=!1,this.append_SourceFilesList.filter(i=>i.isCheckedInJoin).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Please select atleast two sheets");this.enableMergeNamePopup=!0,null===(t=this.joinForm.get("appendNameControl"))||void 0===t||t.reset()}joinSheets(){let t=this.append_SourceFilesList.filter(s=>s.isCheckedInJoin);if(t.length<2)return void this.popup.open(!1,"Please select atleast 2 tables for join");this.addMergeJoin();const o=[];t.forEach(s=>{"Append"==s.type?o.push({tableNameUI:s.tableNameUI,tableNameDB:s.tableName,sheet:s.tableAppendFieldsDto,isSelected:!1,type:"Append",appendID:s.appendID}):"files"==s.type&&o.push({tableNameUI:s.tableNameUI,tableNameDB:s.tableName,sheet:s.sheet,isSelected:!1,fileExt:s.fileExt,type:"template",templateId:s.templateId})}),this.joinCheckedList.push({dropDownList:[{searchValuePT:"",searchValueFT:"",primaryTableList:o,foreignTableList:[],columns:[{primaryKeyList:[],foreignKeyList:[]}]}]}),console.log(this.joinCheckedList),this.append_SourceFilesList.forEach(s=>s.isCheckedInJoin=!1),this.enableMergeNamePopup=!0}joinCancelBtn(){this.joinForm.reset(),this.submitedJ=!1,this.enableMergeNamePopup=!1,this.joinCheckedList=[],this.joinSetForm.controls.Merg=this.formBuilder.array([])}addJoin(){var t;let o=null===(t=this.joinForm.get("appendNameControl"))||void 0===t?void 0:t.value;if(console.log(this.joinForm),this.joinForm.invalid)return this.submited=!0,void(this.submittedErrorMsg="Join Name should not be empty !!");this.loader.show(),this.solService.getExistDataset(o,"merge").subscribe(i=>{this.loader.hide(),this.submited=!1,this.submittedErrorMsg="",this.enableMergeNamePopup=!1,this.MergeSubmit(),console.log(i)},i=>{this.loader.hide(),this.submited=!0,this.submittedErrorMsg="Join Name Already Exist!!!"})}addJoinCreate(t){this.addMergeJoin();let o=this.append_SourceFilesList.filter(l=>l.isCheckedInJoin);const i=[];o.forEach(l=>{"Append"==l.type?i.push({tableNameUI:l.tableNameUI,tableNameDB:l.tableName,sheet:l.tableAppendFieldsDto,isSelected:!1,type:"Append",appendID:l.appendID}):"files"==l.type&&i.push({tableNameUI:l.tableNameUI,tableNameDB:l.tableName,sheet:l.sheet,isSelected:!1,fileExt:l.fileExt,type:"template",templateId:l.templateId})}),this.joinCheckedList.push({dropDownList:[{primaryTableList:i,foreignTableList:[],columns:[{primaryKeyList:[],foreignKeyList:[]}]}],joinName:t}),console.log(this.joinCheckedList),this.append_SourceFilesList.forEach(l=>l.isCheckedInJoin=!1),this.enableMergeNamePopup=!1}checkedInJoin(t){this.submitted=!1,this.submittedErrorMsg=""}selectPrimaryTable(t,o,i){var a,s,l,c;let _=this.joinCheckedList[i].dropDownList[o];if(_.columns[0].primaryKeyList=t.value.sheet,this.removeTable(i,o+1),this.joinCheckedList[i].dropDownList.splice(o+1,this.joinCheckedList[i].dropDownList.length),this.removeCol(i,o,1),this.joinCheckedList[i].dropDownList[o].columns.splice(2,this.joinCheckedList[i].dropDownList[o].columns.length),null===(a=this.TableArr(i).controls[o].get("table2"))||void 0===a||a.reset(),null===(s=this.TableArr(i).controls[o].get("column"))||void 0===s||s.reset(),this.joinCheckedList[i].dropDownList[o].columns.forEach(u=>{u.searchValuePK="",u.searchValueFK=""}),0==o){let u=null===(l=this.TableArr(i).controls[o].get("table1"))||void 0===l?void 0:l.value.tableNameDB;_.foreignTableList=[],this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.foreignTableList.push(f)})}console.log(null===(c=this.joinCheckedList[i])||void 0===c?void 0:c.dropDownList[o])}selectForeignTable(t,o,i){var a,s,l;let c=this.joinCheckedList[i].dropDownList[o];console.log("selectForeignTable()",i,o),this.removeTable(i,o+1),this.joinCheckedList[i].dropDownList.splice(o+1,this.joinCheckedList[i].dropDownList.length),this.removeCol(i,o,1),this.joinCheckedList[i].dropDownList[o].columns.splice(2,this.joinCheckedList[i].dropDownList[o].columns.length),c.columns[0].foreignKeyList=t.value.sheet;let d=[],_=[];if(0==o){d.push(null===(a=this.TableArr(i).controls[o].get("table1"))||void 0===a?void 0:a.value),d.push(null===(s=this.TableArr(i).controls[o].get("table2"))||void 0===s?void 0:s.value);let u=d.map(f=>f.tableNameDB);this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.push(f)}),this.joinCheckedList[i].dropDownList[o+1]={searchValuePT:"",searchValueFT:"",primaryTableList:d,foreignTableList:_,columns:[{primaryKeyList:[],foreignKeyList:[]}]}}else{c.primaryTableList.forEach(f=>{d.push(f)}),d.push(null===(l=this.TableArr(i).controls[o].get("table2"))||void 0===l?void 0:l.value);let u=d.map(f=>f.tableNameDB);this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.push(f)}),this.joinCheckedList[i].dropDownList[o+1]={searchValuePT:"",searchValueFT:"",primaryTableList:d,foreignTableList:_,columns:[{primaryKeyList:[],foreignKeyList:[]}]}}console.log(this.joinCheckedList[i].dropDownList[o+1])}selectPrimarykey(t,o,i,a){this.joinCheckedList[a].dropDownList[i].columns.splice(o+2,this.joinCheckedList[a].dropDownList[i].columns.length),this.removeCol(a,i,o+1);let l=JSON.parse(JSON.stringify(this.joinCheckedList[a].dropDownList[i].columns[o].primaryKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.joinCheckedList[a].dropDownList[i].columns[o+1]?this.joinCheckedList[a].dropDownList[i].columns.push({primaryKeyList:l,searchValuePK:"",searchValueFK:""}):this.joinCheckedList[a].dropDownList[i].columns[o+1].primaryKeyList=l}selectForeignKey(t,o,i,a){this.joinCheckedList[a].dropDownList[i].columns.splice(o+2,this.joinCheckedList[a].dropDownList[i].columns.length),this.removeCol(a,i,o+1);let l=JSON.parse(JSON.stringify(this.joinCheckedList[a].dropDownList[i].columns[o].foreignKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.joinCheckedList[a].dropDownList[i].columns[o+1]?this.joinCheckedList[a].dropDownList[i].columns.push({foreignKeyList:l,searchValuePK:"",searchValueFK:""}):this.joinCheckedList[a].dropDownList[i].columns[o+1].foreignKeyList=l}selectJoin(t,o,i){this.joinCheckedList[i].dropDownList[o].joinType=t.value,console.log(this.joinCheckedList[i].dropDownList)}expandCollapseAppendInJoin(){this.isAppendExpandInJoin=1!=this.isAppendExpandInJoin,this.append_SourceFilesList.filter(o=>"Append"==o.type).forEach(o=>o.isAppendExpandInJoin=!this.isAppendExpandInJoin)}expandCollapseSourceFilesInJoin(){this.isSourceFilesExpandInJoin=1!=this.isSourceFilesExpandInJoin,this.append_SourceFilesList.filter(o=>"files"==o.type).forEach(o=>o.isSourceFilesExpandInJoin=!this.isSourceFilesExpandInJoin)}getUploadedScriptTableList(){this.solService.getUploadedScriptTableList(this.process.processId).subscribe(t=>{var o;if(console.log(t),t){let i=[];null===(o=t.responseData)||void 0===o||o.tableList.forEach(a=>{i.push({tableName:a.trim(),isChecked:!1})}),this.uploadedScriptTableList=i,console.log("uploadedScriptTableList",this.uploadedScriptTableList)}})}functionClick(){this.columnClicked=!1,this.functionClicked=0==this.functionClicked}columnClick(){this.sourceFilesAppendJoinFileList2=JSON.parse(JSON.stringify(this.sourceFilesAppendJoinFileListForSearch)),this.allDatasetDetailsList2=JSON.parse(JSON.stringify(this.allDatasetDetailsListForSearch)),this.functionClicked=!1,this.columnClicked=0==this.columnClicked}DataSetArr(){return this.dataSetForm.get("DSetRows")}DataSetRow(){return this.formBuilder.group({Ptable:["",w.kI.required],join:["",w.kI.required],Ftable:["",w.kI.required],columns:this.formBuilder.array([this.addColumnInDS()])})}addColumnInDS(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}columnArrInDS(t){return this.DataSetArr().controls[t].get("columns")}isValidName(){return t=>{var o;let i=!0;return""==(null===(o=this.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value)&&(i=!1),(0,xt.of)(i?null:{invalid:!0})}}getAllFunctions(){this.solService.getAllFunctions().subscribe(t=>{this.fx=t.responseData,this.searchfx=t.responseData,console.log(t),this.loader.hide()},t=>{this.loader.hide()})}addOpearatorValueFields(t,o){o.whereList.push({signOperatorList:o.signOperatorList,opearatorList:this.opearatorList,value:""})}delOpearatorValueFields(t,o,i,a){this.createExpressionList[i].whereList.splice(t,1)}changeSignOperator(t,o,i,a,s,l){const c=t.value;"parent"==l?this.createExpressionList[a].signOperator=c:i.signOperator=c}addCustomColumn(){this.add_editCustomColumnNameInPopupInDM="Add",this.searchValueInColumnPopup="",this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.createExpressionForm.reset(),this.enableCreateExpression=!0,this.createExpressionForm.controls.sourceFieldName.patchValue(""),this.createExpressionForm.controls.sourceFieldName.enable(),this.columnClicked=!1,this.functionClicked=!1}closeCreateExpressionPopup(){this.enableCreateExpression=!1}changeOperator(t,o,i,a,s){i.operator=t.value}rowClickedDataModeling(t,o,i,a){this.textAreaSlice("["+o.fieldName+"]")}textAreaSlice(t){var o;const i=this.textAreaIndexinCE.value,a=this.textAreaIndexinCE.cursorPosition,s=[i.slice(0,a),t,i.slice(a)].join("");this.createExpressionList[this.textAreaIndexinCE.index].sourceExpressionName=s,null===(o=this.createExpressionForm.get("sourceExpressionName"))||void 0===o||o.patchValue(s)}textAreaInDataModeling(t,o){const i=t.target.selectionStart;t.target.value.substr(i,t.target.selectionEnd-i),this.textAreaIndexInDM={index:o,cursorPosition:i,value:t.target.value}}toggleAllSelection(t){var o;const i=this.datasetDetailsList.filter(a=>a.isDatasetTableExpand);t.checked?null===(o=this.datasetTableForm.get("groupBy"))||void 0===o||o.patchValue([...i[0].groupBytoDB.map(a=>a.dbtablefieldName)]):this.datasetTableForm.controls.groupBy.patchValue([])}submitDataset(t,o){var i;let a=null===(i=this.datasetForm.get("appendNameControl"))||void 0===i?void 0:i.value.trim();if(this.datasetForm.invalid)return this.submited1=!0,void(this.submittedErrorMsg="Dataset Name should now be empty!!!");t.datasetName==a?this.saveDataSet(t,o):(this.loader.show(),this.solService.getExistDataset(a,"dataset").subscribe(s=>{this.loader.hide(),this.submited1=!1,this.submittedErrorMsg="",this.saveDataSet(t,o),console.log(s)},s=>{this.loader.hide(),this.submited1=!0,this.submittedErrorMsg="Dataset Name Already Exist!!!"}))}createNewDataSet(){var t;let o=null===(t=this.datasetForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim();this.loader.show(),this.solService.getExistDataset(o,"dataset").subscribe(i=>{this.loader.hide(),this.submited1=!1,this.submittedErrorMsg="",this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.enableDataSetPopUp=!1,this.datasetDetailsList.push({isDatasetTableExpand:!0,having:"",groupBytoDB:[],orderBytoDB:[],datasetName:o,datasetFieldDTOList:[],orderBy:"",groupBy:""}),console.log(i)},i=>{this.loader.hide(),this.submited1=!0,this.submittedErrorMsg="Dataset Name Already Exist!!!"})}saveDataSetDropdowns(){this.saveDataSetApi()}accordionFilesRowClicked(t,o,i,a,s){var l,c;const d=i.showTabColName,_=i.columnType;"textArea"==this.textAreaIndexinCE.tagType&&this.textAreaSlice(d),"input"==this.textAreaIndexinCE.tagType&&(this.createExpressionList[this.textAreaIndexinCE.index].fileType=s,null===(l=this.createExpressionForm.get("sourceFieldName"))||void 0===l||l.patchValue(d),null===(c=this.createExpressionForm.get("columnType"))||void 0===c||c.patchValue(_),this.createExpressionList[this.textAreaIndexinCE.index].sqlColumn=i.sqlColumn,this.createExpressionList[0].isColumnType="date"==_||"datetime2"==_||"dateTime"==_)}inputInCreateExpression(t,o){this.createExpressionList[o].sourceFieldName=t.target.value.trim(),this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"input"}}textAreaInCreateExpression(t,o){console.log("baloon"),this.createExpressionList[o].sourceExpressionName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"textArea"}}createDataSetinDM(){this.createorEditDatasetText="Create",this.searchValueInCreateDSPopup="",this.sourceFilesAppendJoinFileList=JSON.parse(JSON.stringify(this.sourceFilesAppendJoinFileListForSearch)),this.allDatasetDetailsList=JSON.parse(JSON.stringify(this.allDatasetDetailsListForSearch)),console.log("this.datasetDetailsList",this.datasetDetailsList),console.log("this.allDatasetDetailsList",this.allDatasetDetailsList),this.clearWhereInDS(),this.createExpressionForm.controls.sourceFieldName.enable(),this.unChecksAllInDM(!1),this.enableDataSetPopUp=!0,this.datasetForm.patchValue({appendNameControl:""}),this.createExpressionForm.controls.sourceFieldName.enable(),this.createExpressionForm.controls.columnFormat.enable(),this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.datasetDetailsList=[{isDatasetTableExpand:!0,having:"",groupBytoDB:[],orderBytoDB:[],datasetName:"",datasetFieldDTOList:[],orderBy:"",groupBy:""}]}accordionExpValue(t,o){this.textAreaSlice(t.functionType),this.isOpenAccordion=!1}changeDTinCreateExpression(t,o){this.createExpressionList[o].columnType=t.value,"date"==t.value||"datetime2"==t.value||"datetime"==t.value?(this.createExpressionList[o].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]):this.createExpressionList[o].isColumnType=!1,("char"==t.value||"varchar"==t.value||"text"==t.value||"nvarchar"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]),("int"==t.value||"float"==t.value||"money"==t.value||"decimal"==t.value||"bigint"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]),this.createExpressionList[o].whereList=[]}changeDateTimeinCreateExpression(t,o){this.createExpressionList[o].columnFormat=t.value.value}datasetTableExpand(t,o){this.datasetDetailsList[o].isDatasetTableExpand=!0,t.isDatasetTableExpand=t.isDatasetTableExpand=!0}editRowInDataSet(t,o,i){this.add_editCustomColumnNameInPopupInDM="Edit",i.sourceFieldName.includes("[")?this.createExpressionForm.controls.sourceFieldName.disable():this.createExpressionForm.controls.sourceFieldName.enable(),this.enableCreateExpression=!0,this.functionClicked=!1,this.columnClicked=!1,this.datasetDetailsList[t].datasetFieldDTOList.forEach(a=>a.isEdit=!1),i.isEdit=!0,this.createExpressionList=[],this.createExpressionForm.patchValue(1==i.isColumnType?{sourceFieldName:i.sourceFieldName,excludeInSelect:i.excludeInSelect,columnType:i.columnType,columnFormat:i.columnFormat,sourceExpressionName:i.sourceExpressionName}:{sourceFieldName:i.sourceFieldName,excludeInSelect:i.excludeInSelect,columnType:i.columnType,sourceExpressionName:i.sourceExpressionName}),this.createExpressionList.push(JSON.parse(JSON.stringify(i)))}deleteRowInDataset(t,o,i){var a,s,l;1==this.datasetDetailsList[t].datasetFieldDTOList[o].isEdit&&(this.createExpressionList=[{sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}]),null===(a=this.datasetDetailsList[t])||void 0===a||a.datasetFieldDTOList.splice(o,1),null===(s=this.datasetDetailsList[t])||void 0===s||s.orderBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.orderBytoDB.splice(d,1))}),null===(l=this.datasetDetailsList[t])||void 0===l||l.groupBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.groupBytoDB.splice(d,1))}),this.columnsForWhereInDS.forEach((c,d)=>{i.sourceFieldName==c.filefieldName&&this.columnsForWhereInDS.splice(d,1)}),this.datasetTableForm.controls.groupBy.value.splice(o,1),this.datasetTableForm.controls.orderBy.value.splice(o,1),this.UpdatechecksInDM(i,!1),console.log("this.columnsForWhereInDS",this.columnsForWhereInDS),console.log("this.datasetDetailsList",this.datasetDetailsList)}getAllDataSetNameAPI(t){this.allDatasetDetailsList=[],this.allDatasetDetailsList2=[],this.allDatasetDetailsListForSearch=[],this.solService.getAllDatasetName(this.process.processId).subscribe(o=>{null!=o&&(o.responseData.forEach(i=>{i.isSelectAllParentInDM=!1,i.searchValueInCreateDatasetPopup="",i.searchValueInColumnPopup="";const a=[],s=[];i.datasetFieldDTOList.forEach(l=>{l.isSelectAllChildInDM=!1,l.showTabColName=i.datasetName+"["+l.fieldName+"]",l.isColumnType="date"==l.columnType||"datetime2"==l.columnType||"datetime"==l.columnType,l.isEdit=!1,l.or="";const d=l.tableName+"."+l.columnName;""==l.where.split(" ").join().split(d).join().split(",").join()&&s.push({filefieldName:l.sourceFieldName,dbtablefieldName:l.tableName+"."+l.columnName}),a.push({filefieldName:l.sourceFieldName,dbtablefieldName:l.tableName+"."+l.columnName})}),i.isDatasetTableExpand=!1,i.orderBytoDB=a,i.groupBytoDB=s,i.type="dataset"}),this.allDatasetDetailsList=o.responseData,this.allDatasetDetailsList2=o.responseData,this.allDatasetDetailsListForSearch=o.responseData,o.responseData.forEach(i=>{i.datasetFieldDTOList.forEach(a=>{a.fileType="dataset",a.fieldIDforExpn=a.datasetFieldId}),this.allTableListInDM.push({fileType:"dataset",tableNameUI:i.datasetName,tableNameDB:i.tableName,idName:"datasetId",ID:i.datasetId,columnList:i.datasetFieldDTOList,isSelecteddl:!1})}),console.log("getalldsapi",this.allTableListInDM)),this.tablecolNameList=[],this.tablecolNameList=this.allTableListInDM.map(i=>i.columnList.map(a=>({tableNameUI:i.tableNameUI,tableNameDB:i.tableNameDB,fileType:i.fileType,fieldID:i.fieldID,showTabColName:a.showTabColName,fieldIDforExpn:a.fieldIDforExpn,tableColumnName:a.tableColumnName,columnName:a.columnName}))).reduce((i,a)=>i.concat(a),[]),this.loader.hide(),this.tabsChange(t),this.selectedTab=t.id},o=>{this.loader.hide()})}deleteDataSet(t){this.datasetDetailsList.splice(t,1),this.createExpressionList=[],this.datasetDetailsList=[],this.clearWhereInDS()}saveDataSetApi(){var o,i,a,t=this;let s={};if(s.processId=this.process.processId,s.userId=this.userInfo.userId,this.enableUploadSQLPopup){if(this.loader.show(),this.submited1=!0,this.sqlScriptForm.invalid)return;s.datasetName=this.sqlScriptForm.value.datasetName,s.sqlScript=this.sqlScriptForm.value.sqlScript,this.solService.addDataset(s).subscribe(function(){var l=(0,$e.Z)(function*(c){yield t.getAllDataSetNameAPI({id:5}),t.enableUploadSQLPopup=!1,t.loader.hide()});return function(c){return l.apply(this,arguments)}}(),l=>{this.loader.hide()})}else{this.submitedDS=!0;let l=0;if(this.DataSetArr().controls.forEach(p=>{p.invalid&&(l=1)}),1==l)return void this.popup.open(!1,"Enter all the required fields");this.loader.show(),s.dataSetMergeListDTOs=[],this.DataSetArr().controls.forEach((p,g)=>{s.dataSetMergeListDTOs[g]={},("append"==p.value.Ptable.fileType||"join"==p.value.Ptable.fileType||"files"==p.value.Ptable.fileType||"dataset"==p.value.Ptable.fileType)&&(s.dataSetMergeListDTOs[g].primaryTemplateId=p.value.Ptable.ID),("append"==p.value.Ftable.fileType||"join"==p.value.Ftable.fileType||"files"==p.value.Ftable.fileType||"dataset"==p.value.Ftable.fileType)&&(s.dataSetMergeListDTOs[g].secondaryTemplateId=p.value.Ftable.ID),s.dataSetMergeListDTOs[g].primaryTableName=p.value.Ptable.tableNameDB,s.dataSetMergeListDTOs[g].secondaryTableName=p.value.Ftable.tableNameDB,s.dataSetMergeListDTOs[g].columnArrayList=[],this.columnArrInDS(g).controls.forEach((v,x)=>{s.dataSetMergeListDTOs[g].columnArrayList[x]={},"append"==v.value.column1.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.fieldID:"join"==v.value.column1.fileType||"files"==v.value.column1.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.columnId:"dataset"==v.value.column1.fileType&&(s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.datasetFieldId),"append"==v.value.column2.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.fieldID:"join"==v.value.column2.fileType||"files"==v.value.column2.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.columnId:"dataset"==v.value.column2.fileType&&(s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.datasetFieldId),s.dataSetMergeListDTOs[g].columnArrayList[x].primaryFieldName=v.value.column1.columnName,s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryFieldName=v.value.column2.columnName}),s.dataSetMergeListDTOs[g].joinType=p.value.join.slice(0,1),s.dataSetMergeListDTOs[g].order=g,console.log(p.value,p),console.log(p.controls.Ptable.value)});const c=[],d=this.datasetDetailsList.filter(p=>p.isDatasetTableExpand);d[0].datasetFieldDTOList.forEach(p=>{null!=p.sourceExpressionName&&(""==p.sourceExpressionName.trim()||0==p.sourceExpressionName.trim().length)&&(p.sourceExpressionName=null);let v,g=p.sourceExpressionName;null!=g&&this.tablecolNameList.forEach(x=>{g.includes(x.showTabColName)&&(g=JSON.parse(JSON.stringify(g.split(x.showTabColName).join(x.tableColumnName))),v=x.tableNameDB)}),null==p.tableName&&(p.tableName=v),p.isColumnType||(p.columnFormat="yyyy/mm/dd"),c.push({tableName:p.tableName,columnFormat:p.columnFormat,excludeInSelect:p.excludeInSelect,columnName:p.columnName,fieldName:p.fieldName,expression:g,columnType:p.columnType,where:p.where,or:p.or,groupBy:"",sourceFieldName:p.sourceFieldName,sourceExpressionName:p.sourceExpressionName})}),s.datasetFieldDTOList=c,s.datasetName=this.datasetForm.controls.appendNameControl.value;let _=null===(o=this.datasetTableForm.get("groupBy"))||void 0===o?void 0:o.value,u=null===(i=this.datasetTableForm.get("having"))||void 0===i?void 0:i.value,f=null===(a=this.datasetTableForm.get("orderBy"))||void 0===a?void 0:a.value;s.groupBy=""==_?null:_.join(),s.orderBy=""==f?null:f.join(),null!=u&&(s.having=""==u.trim()?null:u),s.calender="";let m=[],h=[];this.whereArrInDS().controls.forEach((p,g)=>{console.log(p.controls.column.value),console.log(p.controls.signOperator.value);let C,v=p.controls.column.value.dbtablefieldName,x=p.controls.signOperator.value;if(null!=p.controls.value&&(C=p.controls.value.value),0==g)""!=x&&(m="IS NULL"==x||"IS NOT NULL"==x?[v+" "+x]:[v+" "+x+" "+C]),h.push("IS NULL"==x||"IS NOT NULL"==x?{fieName:p.controls.column.value.filefieldName,signOperator:x,value:""}:{fieName:p.controls.column.value.filefieldName,signOperator:x,value:C});else{console.log(p.controls.operator.value);let y,b=p.controls.operator.value;""!=x&&(y="IS NULL"==x||"IS NOT NULL"==x?b+" "+v+" "+x:b+" "+v+" "+x+" "+C),m.push(y),h.push("IS NULL"==x||"IS NOT NULL"==x?{operator:b,fieName:p.controls.column.value.filefieldName,signOperator:x,value:""}:{operator:b,fieName:p.controls.column.value.filefieldName,signOperator:x,value:C})}}),s.where=m.join(" "),s.uiWhere=JSON.stringify(h),s.calender="",this.progressBar=[],this.progressBarPopup=!0,d[0].datasetId&&(s.datasetId=d[0].datasetId),this.solService.addDataset(s).subscribe(function(){var p=(0,$e.Z)(function*(g){g.type==Dt.dt.UploadProgress?t.progressBar=[{percentage:Math.round(100/g.total*g.loaded)}]:g.type==Dt.dt.Response&&(t.progressBar=[],t.progressBarPopup=!1,t.allTableListInDM.forEach((v,x)=>{"dataset"==v.fileType&&t.allTableListInDM.splice(x,1)}),t.tablecolNameList.forEach((v,x)=>{"dataset"==v.fileType&&t.tablecolNameList.splice(x,1)}),yield t.getAllDataSetNameAPI({id:5}),t.unChecksAllInDM(!1),t.enableDataSetPopUp=!1,t.loader.hide(),t.saveDataSetPopup=!1,t.createExpressionList=[],t.datasetDetailsList=[],t.popup.open(!0,"Dataset saved successfully !"))});return function(g){return p.apply(this,arguments)}}(),p=>{this.progressBarPopup=!1,this.popup.open(!1,"Dataset save failed !"),this.loader.hide()})}}clearWhereInDS(){this.columnsForWhereInDS=[],this.datasetTableForm.controls.where=this.fb.array([this.whereFirstRow()]),this.datasetTableForm.patchValue({having:"",groupBy:"",orderBy:""})}callGetViewscript(t){this.loader.show(),this.solService.getViewScript(t.datasetId).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.sqlScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptDSPopup=!0,this.loader.hide()},i=>{this.loader.hide()})}updateScriptByDatasetId(t){if(this.viewscriptForm.invalid||""==this.viewscriptForm.controls.sqlScript.value.trim())return void this.popup.open(!1,"Script shouldn't be empty");this.loader.show();const o={datasetId:t.value.datasetId,newScript:t.value.sqlScript.trim()};this.solService.updateScriptByDatasetId(o).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.newScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptDSPopup=!1,this.popup.open(!0,"update Script Successfully"),this.loader.hide()},i=>{this.popup.open(!1,"update Script Failed! (Syntax Error)"),this.loader.hide()})}editDatasetFile(t){var o,i,a;this.createorEditDatasetText="Edit",this.enableDataSetPopUp=!0,this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],t.isDatasetTableExpand=!0,this.datasetDetailsList[0]=t;let s=[],l=[];null!=t.orderBy&&(s=t.orderBy.split(",")),null!=t.groupBy&&(l=t.groupBy.split(",")),null===(o=this.datasetTableForm.get("orderBy"))||void 0===o||o.patchValue(s),null===(i=this.datasetTableForm.get("groupBy"))||void 0===i||i.patchValue(l),null===(a=this.datasetTableForm.get("having"))||void 0===a||a.patchValue(t.having),this.columnsForWhereInDS=[],t.datasetFieldDTOList.forEach(u=>{u.sourceFieldName.includes("[")?this.columnsForWhereInDS.push({filefieldName:u.sourceFieldName,dbtablefieldName:u.tableName+"."+u.columnName,dataType:u.columnType}):this.columnsForWhereInDS.push({filefieldName:u.sourceFieldName,dbtablefieldName:u.expression,dataType:u.columnType})});let c=JSON.parse(t.uiWhere);this.datasetTableForm.controls.where=this.fb.array([this.whereFirstRow()]),c.forEach((u,f)=>{0==f?this.columnsForWhereInDS.forEach(m=>{if(m.filefieldName==u.fieName){let h={column:m,signOperator:u.signOperator};"IS NULL"==u.signOperator||"IS NOT NULL"==u.signOperator||(this.addValueAtInDM(f),h.value=u.value),this.whereArrInDS().controls[f].patchValue(h),this.changeColumnInDSForWhere(0,f,0,0)}}):(this.whereArrInDS().push(this.whereRemainingRows()),this.columnsForWhereInDS.forEach(m=>{if(m.filefieldName==u.fieName){let h={operator:u.operator,column:m,signOperator:u.signOperator,value:u.value};"IS NULL"==u.signOperator||"IS NOT NULL"==u.signOperator||(this.addValueAtInDM(f),h.value=u.value),this.whereArrInDS().controls[f].patchValue(h),this.changeColumnInDSForWhere(0,f,0,0)}}))}),this.datasetForm.patchValue({appendNameControl:t.datasetName});let _,d=t.datasetFieldDTOList.map(u=>u.sourceFieldName);this.sourceFilesAppendJoinFileList.forEach(u=>{"append"==u.fileType?u.sheetList.forEach(f=>{f.tableAppendFieldsDto.forEach(m=>{d.includes(m.showTabColName)&&(m.isSelectAllChildInDM=!0)}),_=f.tableAppendFieldsDto.map(m=>m.isSelectAllChildInDM),f.isSelectAllParentInDM=!_.includes(!1)}):"join"==u.fileType?u.sheetList.forEach(f=>{f.mergeFieldListDTO.forEach(m=>{d.includes(m.showTabColName)&&(m.isSelectAllChildInDM=!0)}),_=f.mergeFieldListDTO.map(m=>m.isSelectAllChildInDM),f.isSelectAllParentInDM=!_.includes(!1)}):"files"==u.fileType&&u.sheetList.forEach(f=>{f.sheet.forEach(m=>{d.includes(m.showTabColName)&&(m.isSelectAllChildInDM=!0)}),_=f.sheet.map(m=>m.isSelectAllChildInDM),f.isSelectAllParentInDM=!_.includes(!1)})}),this.allDatasetDetailsList.forEach(u=>{u.datasetFieldDTOList.forEach(f=>{d.includes(f.sourceFieldName)&&(f.isSelectAllChildInDM=!0)}),_=u.datasetFieldDTOList.map(f=>f.isSelectAllChildInDM),u.isSelectAllParentInDM=!_.includes(!1)})}applyFilter(t,o){console.log("this.allDatasetDetailsListForSearch",this.allDatasetDetailsListForSearch),console.log("this.sourceFilesAppendJoinFileListForSearch",this.sourceFilesAppendJoinFileListForSearch),"UF"==o?this.dataSource=this.search(this.fileListtForSearch.filteredData,t.target.value,"UF"):"TF"==o?(this.masterCheckedFalseInTF(),this.targetFileList=this.search(this.tartargetFileListForSearch,t.target.value,"TF")):"A"==o?this.sourceFilesList=this.search(this.sourceFilesListForSearch,t.target.value,"A"):"J"==o?this.append_SourceFilesList=this.search(this.append_SourceFilesListForSearch,t.target.value,"J"):"DS"==o?this.allDatasetDetailsList=this.search(this.allDatasetDetailsListForSearch,t.target.value,"DS"):"parentInCreateDSPopup"==o?(this.searchValueInCreateDSPopup=t.target.value,this.sourceFilesAppendJoinFileList=this.search(this.sourceFilesAppendJoinFileListForSearch,this.searchValueInCreateDSPopup,"parentInCreateDSPopup"),this.allDatasetDetailsList=this.search(this.allDatasetDetailsListForSearch,this.searchValueInCreateDSPopup,"DS")):"parentInColumnPopup"==o?(this.searchValueInColumnPopup=t.target.value,this.sourceFilesAppendJoinFileList2=this.search(this.sourceFilesAppendJoinFileListForSearch,this.searchValueInColumnPopup,"parentInCreateDSPopup"),this.allDatasetDetailsList2=this.search(this.allDatasetDetailsListForSearch,this.searchValueInColumnPopup,"DS")):"fx"==o&&(this.searchfx=this.search(this.fx,t.target.value,"fx"))}search(t,o,i){return"UF"==i?t.filter(a=>{var s,l,c;return null===(l=null===(s=a.fileNameWithExt)||void 0===s?void 0:s.toLocaleLowerCase())||void 0===l?void 0:l.trim().includes(null===(c=null==o?void 0:o.toLocaleLowerCase())||void 0===c?void 0:c.trim())}):"TF"==i||"A"==i?t.filter(a=>{var s,l,c;return null===(l=null===(s=a.fileName)||void 0===s?void 0:s.toLocaleLowerCase())||void 0===l?void 0:l.trim().includes(null===(c=null==o?void 0:o.toLocaleLowerCase())||void 0===c?void 0:c.trim())}):"J"==i?t.filter(a=>{var s,l,c;return null===(l=null===(s=a.tableNameUI)||void 0===s?void 0:s.toLocaleLowerCase())||void 0===l?void 0:l.trim().includes(null===(c=null==o?void 0:o.toLocaleLowerCase())||void 0===c?void 0:c.trim())}):"DS"==i?t.filter(a=>{var s,l,c;return null===(l=null===(s=a.datasetName)||void 0===s?void 0:s.toLocaleLowerCase())||void 0===l?void 0:l.trim().includes(null===(c=null==o?void 0:o.toLocaleLowerCase())||void 0===c?void 0:c.trim())}):"parentInCreateDSPopup"==i?t.map(s=>Object.assign(Object.assign({},s),{sheetList:s.sheetList.filter(l=>{var c,d,_;return null===(d=null===(c=l.tableNameUI)||void 0===c?void 0:c.toLocaleLowerCase())||void 0===d?void 0:d.trim().includes(null===(_=null==o?void 0:o.toLocaleLowerCase())||void 0===_?void 0:_.trim())})})):"fx"==i?t.filter(a=>a).map(a=>{let s=a.funcDescritptionsList.filter(l=>l.functionType.toLowerCase().includes(o.toLowerCase()));return a.functionName.toLowerCase().includes(o.toLowerCase())||s.length>0?Object.assign(Object.assign({},a),{funcDescritptionsList:s}):{}}).filter(a=>0!==Object.keys(a).length):void 0}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}selectuser(t,o){}selectgroupByOrderByInDM(t,o,i,a){let l=t.value.map(c=>c.dbtablefieldName).join();"groupby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].groupBy=l),"orderby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].orderBy=l)}allList(t){this.allTableListInDM=[],this.sourceFilesAppendJoinFileListForJoin.forEach((o,i)=>{"append"==o.fileType?o.sheetList.forEach(a=>{a.tableAppendFieldsDto.forEach(s=>{s.fileType=o.fileType,s.fieldIDforExpn=s.fieldID}),this.allTableListInDM.push({fileType:o.fileType,tableNameUI:a.appendName,tableNameDB:a.tableName,idName:"appendID",ID:a.appendID,appendID:a.appendID,columnList:a.tableAppendFieldsDto,isSelecteddl:!1})}):"join"==o.fileType?o.sheetList.forEach(a=>{a.mergeFieldListDTO.forEach(s=>{s.fileType=o.fileType,s.fieldIDforExpn=s.columnId}),this.allTableListInDM.push({fileType:o.fileType,tableNameUI:a.mergeName,tableNameDB:a.tableName,idName:"mergeId",ID:a.mergeId,mergeId:a.mergeId,columnList:a.mergeFieldListDTO,isSelecteddl:!1})}):"files"==o.fileType&&o.sheetList.forEach(a=>{null!=a.sheet&&a.sheet.forEach(s=>{s.fileType=o.fileType,s.fieldIDforExpn=s.columnId}),this.allTableListInDM.push({fileType:o.fileType,tableNameUI:a.fileName,tableNameDB:a.tableName,idName:"templateId",ID:a.templateId,templateId:a.templateId,columnList:a.sheet,isSelecteddl:!1})})}),this.allTableListWithoutDSInDM=[],this.allTableListWithoutDSInDM=JSON.parse(JSON.stringify(this.allTableListInDM)),console.log("getall()",this.allTableListInDM),this.getAllDataSetNameAPI(t)}closeDatasetPopup(){this.dataSetForm.controls.DSetRows=this.fb.array([]),this.saveDataSetPopup=!1}saveDataSet(t,o){var a,s,l,i=this;const c=this.datasetDetailsList.filter(_=>_.isDatasetTableExpand);if(0==c[0].datasetFieldDTOList.length)return;if(c[0].datasetFieldDTOList.length>75)return void this.popup.open(!1,"Current Dataset has "+c[0].datasetFieldDTOList.length+"columns. It shouldn't exceed 75 columns");let d=[];if(this.submitedDS=!1,this.selectedColumnsOfDS=[],null==t||t.datasetFieldDTOList.forEach(_=>{let u;u=_.sourceFieldName.includes("[")?_.sourceFieldName.split("[")[0]:_.tableName,this.allTableListInDM.forEach(m=>{c[0].datasetFieldDTOList.forEach(h=>{let p=h.sourceExpressionName;null!=p&&this.tablecolNameList.forEach(g=>{p.includes(g.showTabColName)&&d.push(g.tableNameUI)})}),m.tableNameUI==u&&0==this.selectedColumnsOfDS.filter(p=>p.tableNameUI==m.tableNameUI).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},m),{isSelecteddl:!1}))})}),d=[...new Set(d)],d.forEach(_=>{this.allTableListInDM.forEach(u=>{_.includes(u.tableNameUI)&&0==this.selectedColumnsOfDS.filter(m=>m.tableNameUI==_).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},u),{isSelecteddl:!1}))})}),console.log("this.selectedColumnsOfDS",this.selectedColumnsOfDS),this.selectedColumnsOfDS.length<2){let _={};_.processId=this.process.processId,_.userId=this.userInfo.userId,1==this.selectedColumnsOfDS.length?("append"==this.selectedColumnsOfDS[0].fileType||"join"==this.selectedColumnsOfDS[0].fileType||"files"==this.selectedColumnsOfDS[0].fileType||"dataset"==this.selectedColumnsOfDS[0].fileType)&&(_.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableNameDB}]):0==this.selectedColumnsOfDS.length&&(_.dataSetMergeListDTOs=[]);const u=[],f=this.datasetDetailsList.filter(x=>x.isDatasetTableExpand);f[0].datasetFieldDTOList.forEach(x=>{null!=x.sourceExpressionName&&(""==x.sourceExpressionName.trim()||0==x.sourceExpressionName.trim().length)&&(x.sourceExpressionName=null);let b,C=x.sourceExpressionName;null!=C&&this.tablecolNameList.forEach(y=>{C.includes(y.showTabColName)&&(C=JSON.parse(JSON.stringify(C.split(y.showTabColName).join(y.tableColumnName))),b=y.tableNameDB)}),null==x.tableName&&(x.tableName=b),x.isColumnType||(x.columnFormat="yyyy/mm/dd"),u.push({tableName:x.tableName,excludeInSelect:x.excludeInSelect,columnFormat:x.columnFormat,columnName:x.columnName,fieldName:x.fieldName,expression:C,columnType:x.columnType,where:x.where,or:x.or,groupBy:"",sourceFieldName:x.sourceFieldName,sourceExpressionName:x.sourceExpressionName})}),_.datasetFieldDTOList=u,_.datasetName=this.datasetForm.controls.appendNameControl.value;let m=null===(a=this.datasetTableForm.get("groupBy"))||void 0===a?void 0:a.value,h=null===(s=this.datasetTableForm.get("having"))||void 0===s?void 0:s.value,p=null===(l=this.datasetTableForm.get("orderBy"))||void 0===l?void 0:l.value;_.groupBy=""==m?null:m.join(),_.orderBy=""==p?null:p.join(),null!=h&&(_.having=""==h.trim()?null:h),_.calender="";let g=[],v=[];this.whereArrInDS().controls.forEach((x,C)=>{console.log(x.controls.column.value),console.log(x.controls.signOperator.value);let M,b=x.controls.column.value.dbtablefieldName,y=x.controls.signOperator.value;if(null!=x.controls.value&&(M=x.controls.value.value),0==C)""!=y&&(g="IS NULL"==y||"IS NOT NULL"==y?[b+" "+y]:[b+" "+y+" "+M]),v.push("IS NULL"==y||"IS NOT NULL"==y?{fieName:x.controls.column.value.filefieldName,signOperator:y,value:""}:{fieName:x.controls.column.value.filefieldName,signOperator:y,value:M});else{console.log(x.controls.operator.value);let U,A=x.controls.operator.value;""!=y&&(U="IS NULL"==y||"IS NOT NULL"==y?A+" "+b+" "+y:A+" "+b+" "+y+" "+M),g.push(U),v.push("IS NULL"==y||"IS NOT NULL"==y?{operator:A,fieName:x.controls.column.value.filefieldName,signOperator:y,value:""}:{operator:A,fieName:x.controls.column.value.filefieldName,signOperator:y,value:M})}}),_.where=g.join(" "),_.uiWhere=JSON.stringify(v),_.calender="",this.progressBar=[],this.progressBarPopup=!0,f[0].datasetId&&(_.datasetId=f[0].datasetId),this.solService.addDataset(_).subscribe(function(){var x=(0,$e.Z)(function*(C){console.log("call addDS"),console.log(C),C.type==Dt.dt.UploadProgress?(i.progressBar=[{percentage:Math.round(100/C.total*C.loaded)}],console.log("this.progressBar ",i.progressBar)):C.type==Dt.dt.Response&&(i.progressBar=[],i.progressBarPopup=!1,yield i.getAllDataSetNameAPI({id:5}),i.loader.hide(),i.unChecksAllInDM(!1),i.enableDataSetPopUp=!1,i.createExpressionList=[],i.datasetDetailsList=[],i.popup.open(!0,"Dataset saved successfully !"))});return function(C){return x.apply(this,arguments)}}(),x=>{this.popup.open(!1,"Dataset save failed !"),this.progressBarPopup=!1,this.loader.hide()})}else{this.dataSetForm.controls.DSetRows=this.fb.array([]),this.dataSetData=[];let _=[],u=[];this.selectedColumnsOfDS.forEach(m=>{_.push(m)});let f={searchValuePT:"",searchValueFT:"",primaryTableList:_,foreignTableList:u,order:1,columns:[{primaryKeyList:[],foreignKeyList:[]}]};for(let m=0;m<this.selectedColumnsOfDS.length-1;m++)0==m?this.dataSetData.push(f):(_=[],_.primaryKeyList=[],this.dataSetData.push({searchValuePT:"",searchValueFT:"",primaryTableList:_,foreignTableList:u,columns:[{primaryKeyList:[],foreignKeyList:[]}],order:m+2})),this.DataSetArr().controls.push(this.DataSetRow());this.saveDataSetPopup=!0}this.DataSetArr().controls.forEach(_=>{console.log(_.value,_),console.log(_.controls.Ptable.value)})}selectPrimaryTableInDS(t,o){if(this.dataSetData.forEach((i,a)=>{var s,l,c;a>o&&(this.dataSetData[a].Join="",this.dataSetData[a].primaryTableList=[],this.dataSetData[a].foreignTableList=[],null===(s=this.DataSetArr().controls[o].get("join"))||void 0===s||s.reset()),a==o&&(this.dataSetData[a].foreignTableList=[],null===(l=this.DataSetArr().controls[o].get("Ftable"))||void 0===l||l.reset(),null===(c=this.DataSetArr().controls[o].get("join"))||void 0===c||c.reset()),a>=o&&(this.columnArrInDS(a).clear(),this.columnArrInDS(a).push(this.addColumnInDS()),this.dataSetData[a].columns=[{primaryKeyList:[],foreignKeyList:[]}])}),this.dataSetData[o].columns.forEach(i=>{i.searchValuePK="",i.searchValueFK=""}),this.dataSetData[o].columns[0].primaryKeyList=t.value.columnList,0==o)this.dataSetData[0].primaryTableList.forEach(i=>{this.DataSetArr().controls[o].value.Ptable.ID!=i.ID&&this.dataSetData[o].foreignTableList.push(i)});else{let i=this.dataSetData[o].primaryTableList.map(a=>a.ID);this.dataSetData[0].primaryTableList.forEach(a=>{i.includes(a.ID)||this.dataSetData[o].foreignTableList.push(a)})}}selectJoinTypeInDS(t,o){this.dataSetData[o].Join=t.value,console.log(this.dataSetData)}selectForeignTableInDS(t,o){if(this.dataSetData.forEach((i,a)=>{var s,l;a>o&&(null===(s=this.DataSetArr().controls[a].get("join"))||void 0===s||s.reset(),this.dataSetData[a].primaryTableList=[],this.dataSetData[a].foreignTableList=[],this.dataSetData[a].columns=[{primaryKeyList:[],foreignKeyList:[]}]),a==o&&(this.dataSetData[a].columns[0].foreignKeyList=[],this.dataSetData[a].columns.splice(1,this.dataSetData[a].columns.length),null!=this.DataSetArr().controls[a+1]&&(null===(l=this.DataSetArr().controls[a+1].get("Ptable"))||void 0===l||l.reset())),a>=o&&(this.columnArrInDS(a).clear(),this.columnArrInDS(a).push(this.addColumnInDS()))}),this.dataSetData[o].columns[0].foreignKeyList=t.value.columnList,0==o){let i=[];i.push(this.DataSetArr().controls[o].value.Ptable),i.push(this.DataSetArr().controls[o].value.Ftable),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=i)}else{let i=[];this.dataSetData[o].primaryTableList.forEach(a=>{i.push(a)}),i.push(this.DataSetArr().controls[o].value.Ftable),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=i)}}selectPrimaryKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].primaryKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({primaryKeyList:a,searchValuePK:"",searchValueFK:""}):this.dataSetData[i].columns[o+1].primaryKeyList=a}selectForeignKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].foreignKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({foreignKeyList:a,searchValuePK:"",searchValueFK:""}):this.dataSetData[i].columns[o+1].foreignKeyList=a}addcolumnRowInDS(t,o){var i,a;let s=this.columnArrInDS(o).length;if(""==(null===(i=this.columnArrInDS(o).controls[s-1].get("column1"))||void 0===i?void 0:i.value)||""==(null===(a=this.columnArrInDS(o).controls[s-1].get("column2"))||void 0===a?void 0:a.value))return;let l=0;this.dataSetData[o].columns.forEach(c=>{(0==(null==c?void 0:c.primaryKeyList.length)||0==(null==c?void 0:c.foreignKeyList.length))&&(l=1)}),1!=l&&this.columnArrInDS(o).push(this.addColumnInDS())}deletecolumnRowInDS(t,o){this.columnArrInDS(o).removeAt(t),this.dataSetData[o].columns.splice(t+1,this.dataSetData[o].columns.length)}add_SaveCreateExpression(t){var o,i,a,s,l,c;if(console.log("this.createExpressionForm",this.createExpressionForm),t.sourceFieldName=null===(o=this.createExpressionForm.get("sourceFieldName"))||void 0===o?void 0:o.value,t.excludeInSelect=null===(i=this.createExpressionForm.get("excludeInSelect"))||void 0===i?void 0:i.value,t.columnType=null===(a=this.createExpressionForm.get("columnType"))||void 0===a?void 0:a.value,1==t.isColumnType&&(t.columnFormat=null===(s=this.createExpressionForm.get("columnFormat"))||void 0===s?void 0:s.value),t.sourceExpressionName=null===(l=this.createExpressionForm.get("sourceExpressionName"))||void 0===l?void 0:l.value,this.submited1=!0,""==t.sourceFieldName.trim()||""==t.columnType)return void this.popup.open(!1,"Enter All the Required Fields");if(t.sourceFieldName.includes("[")?this.createExpressionForm.controls.sourceFieldName.disable():this.createExpressionForm.controls.sourceFieldName.enable(),""==t.sourceFieldName.trim())return;const d=this.datasetDetailsList.filter(C=>1==C.isDatasetTableExpand),_=null===(c=d[0])||void 0===c?void 0:c.datasetFieldDTOList;let f,m,h,p,u=0;if(0!=_.length&&_.forEach(C=>{t.isEdit&&C.isEdit||C.sourceFieldName==t.sourceFieldName.trim()&&(u=1)}),1==u)return;f=this.allTableListInDM.filter(C=>C.columnList.some(b=>b.showTabColName==t.sourceFieldName)).map(C=>Object.assign({},C,{columnList:C.columnList.filter(b=>b.showTabColName==t.sourceFieldName)})),0!=f.length&&(t.tableName=f[0].tableNameDB),0!=f.length&&(m=f[0].columnList[0].columnName,p=f[0].columnList[0].fieldName,h=f[0].tableNameDB);let g=h+"."+m,v={},x={};if(0==f.length){let C=null;this.tablecolNameList.forEach(b=>{t.sourceExpressionName==b.showTabColName&&(C=b.tableNameDB+"."+b.columnName)}),v={filefieldName:t.sourceFieldName,dbtablefieldName:C},x={filefieldName:t.sourceFieldName,dbtablefieldName:C,dataType:t.columnType},t.columnName=t.sourceFieldName,t.fieldName=t.sourceFieldName}else v={filefieldName:t.sourceFieldName,dbtablefieldName:g},x={filefieldName:t.sourceFieldName,dbtablefieldName:g,dataType:f[0].columnList[0].columnType},t.columnName=m,t.fieldName=p;t.isEdit||(d[0].orderBytoDB.push(v),d[0].groupBytoDB.push(v),this.columnsForWhereInDS.push(x)),0==(null==_?void 0:_.length)?_.push(t):t.isEdit?_.forEach((C,b)=>{C.isEdit&&(t.isEdit=!1,_.splice(b,1,t))}):_.push(t),this.UpdatechecksInDM(t,!0),this.submited1=!1,this.enableCreateExpression=!1}deleteTables(t,o,i,a){console.log("e: ",t),console.log("item: ",o),this.deleteTableDetails={item:o,type:a},this.enableDeletePopup=!0}deleteTable(t,o){let i={type:o,operation:"delete"};"file"==o?i.id=t.fileId:"append"==o?i.id=t.appendID:"merge"==o?i.id=t.mergeId:"dataset"==o&&(i.id=t.datasetId),this.solService.deleteTables(i).subscribe(a=>{console.log(a),this.enableDeletePopup=!1,"file"==o?this.getAllFileTemplateListByProcessID({id:1}):"append"==o?this.getAppendFilesApi():"merge"==o?this.getJoinFilesListApi():"dataset"==o&&(this.getAllDataSetNameAPI({id:5}),0==this.datasetDetailsList.length&&(this.createExpressionList=[])),"file"==o?this.popup.open(!0,t.fileNameWithExt+" Deleted Successfully !"):"append"==o?this.popup.open(!0,t.appendName+" Deleted Successfully !"):"merge"==o?this.popup.open(!0,t.mergeName+" Deleted Successfully !"):"dataset"==o&&this.popup.open(!0,t.datasetName+" Deleted Successfully !")},a=>{this.enableDeletePopup=!1,this.popup.open(!1,t.datasetName+"Delete Failed !")})}existDataset(){console.log(this.sqlScriptForm.value.datasetName)}applyFilterForDMTables(t,o,i,a){console.log("e",t),console.log(a),console.log("item",o),("append"==a||"join"==a||"files"==a||"dataset"==a)&&(o.searchValueInCreateDatasetPopup=t.target.value,o.searchValueInColumnPopup=t.target.value)}selectAllInDM(t,o){console.log(t,o);let i=[];0!=this.datasetDetailsList.length&&(i=this.datasetDetailsList[0].datasetFieldDTOList.map(s=>s.sourceFieldName));let a=[];"append"==t?a=o.tableAppendFieldsDto:"join"==t?a=o.mergeFieldListDTO:"files"==t?a=o.sheet:"dataset"==t&&(a=o.datasetFieldDTOList),a.forEach(s=>{i.includes(s.showTabColName)||this.add_SaveCreateExpression({excludeInSelect:!1,sourceFieldName:s.showTabColName,columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:s.columnType,where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]})})}onSortClick(t,o){this.sortColumn==o?"desc"==this.sortOrder?(this.sortOrder="asc",this.sortDir=1):(this.sortOrder="desc",this.sortDir=-1):(this.sortColumn=o,this.sortOrder="desc"),this.selectedM_A_S.sort((i,a)=>(i=i[t].toLowerCase(),a=a[t].toLowerCase(),i.localeCompare(a)*this.sortDir))}previewPopupClose(){this.sortColumn=-1,this.showTargetFilePopup=!1}UpdatechecksInDM(t,o){let i=[];this.sourceFilesAppendJoinFileList.forEach(a=>{a.sheetList.forEach(s=>{"Append"==s.type?s.tableAppendFieldsDto.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.tableAppendFieldsDto,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):"Merge"==s.type?s.mergeFieldListDTO.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.mergeFieldListDTO,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):s.sheet.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.sheet,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}),0==i.length&&this.allDatasetDetailsList.forEach(a=>{a.datasetFieldDTOList.forEach(s=>{s.showTabColName==t.sourceFieldName&&(i=a.datasetFieldDTOList,s.isSelectAllChildInDM=o,i.map(c=>c.isSelectAllChildInDM).includes(!1)?a.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}selectAllParentInDM(t,o,i){console.log(t,o,i);let a=t.target.checked,s=[];0!=this.datasetDetailsList.length&&(s=this.datasetDetailsList[0].datasetFieldDTOList.map(d=>d.sourceFieldName));let l=[];"append"==o&&a?(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!0),l=i.tableAppendFieldsDto):"join"==o&&a?(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!0),l=i.mergeFieldListDTO):"files"==o&&a?(i.sheet.forEach(d=>d.isSelectAllChildInDM=!0),l=i.sheet):"dataset"==o&&a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!0),l=i.datasetFieldDTOList);let c=[];"append"!=o||a?"join"!=o||a?"files"!=o||a?"dataset"==o&&!a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!1),l=i.datasetFieldDTOList,c=i.datasetFieldDTOList.map(d=>d.showTabColName)):(i.sheet.forEach(d=>d.isSelectAllChildInDM=!1),l=i.sheet,c=i.sheet.map(d=>d.showTabColName)):(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!1),l=i.mergeFieldListDTO,c=i.mergeFieldListDTO.map(d=>d.showTabColName)):(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!1),l=i.tableAppendFieldsDto,c=i.tableAppendFieldsDto.map(d=>d.showTabColName)),0!=this.datasetDetailsList.length&&(a?l.forEach(d=>{if(!s.includes(d.showTabColName)){let _={excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]};this.createExpressionForm.controls.sourceFieldName.patchValue(d.showTabColName),this.createExpressionForm.controls.columnType.patchValue(d.columnType),this.createExpressionForm.controls.sourceExpressionName.patchValue(""),this.createExpressionForm.controls.excludeInSelect.patchValue(""),this.add_SaveCreateExpression(_)}}):a||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(d=>-1==c.indexOf(d.sourceFieldName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),this.columnsForWhereInDS=this.columnsForWhereInDS.filter(d=>-1==c.indexOf(d.filefieldName)),console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList),console.log("this.datasetDetailsList[0].groupBytoDB",this.datasetDetailsList[0].groupBytoDB),console.log("this.datasetDetailsList[0].orderBytoDB",this.datasetDetailsList[0].orderBytoDB),this.UpdatechecksInDM(i,!1)),console.log("this.datasetDetailsList",this.datasetDetailsList))}selectAllChildInDM(t,o,i,a){this.createExpressionForm.controls.sourceExpressionName.patchValue(""),this.createExpressionForm.controls.excludeInSelect.patchValue("");let s=t.target.checked,l=[];0!=this.datasetDetailsList.length&&(l=this.datasetDetailsList[0].datasetFieldDTOList.map(_=>_.sourceFieldName));let c=[];if("append"==o?c=i.tableAppendFieldsDto:"join"==o?c=i.mergeFieldListDTO:"files"==o?c=i.sheet:"dataset"==o&&(c=i.datasetFieldDTOList),i.isSelectAllParentInDM=!c.map(_=>_.isSelectAllChildInDM).includes(!1),console.log(i),0!=this.datasetDetailsList.length){if(s){if(!l.includes(a.showTabColName)){let _={excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]};this.createExpressionForm.controls.sourceFieldName.patchValue(a.showTabColName),this.createExpressionForm.controls.columnType.patchValue(a.columnType),this.add_SaveCreateExpression(_)}}else s||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(_=>-1==a.showTabColName.indexOf(_.sourceFieldName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)),this.columnsForWhereInDS=this.columnsForWhereInDS.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)));console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList)}}unChecksAllInDM(t){var o;this.sourceFilesAppendJoinFileList.forEach(i=>{i.sheetList.forEach(a=>{a.isSelectAllParentInDM=!1,"Append"==a.type?a.tableAppendFieldsDto.forEach(s=>{s.isSelectAllChildInDM=t}):"Merge"==a.type?a.mergeFieldListDTO.forEach(s=>{s.isSelectAllChildInDM=t}):a.sheet.forEach(s=>{s.isSelectAllChildInDM=t})})}),null===(o=this.allDatasetDetailsList)||void 0===o||o.forEach(i=>{i.isSelectAllParentInDM=!1,i.datasetFieldDTOList.forEach(a=>{a.isSelectAllChildInDM=t})})}whereFirstRow(){return this.formBuilder.group({column:["",w.kI.required],signOperator:["",w.kI.required],columnSearch:[""]})}whereRemainingRows(){return this.formBuilder.group({operator:["",w.kI.required],column:["",w.kI.required],signOperator:["",w.kI.required],columnSearch:[""]})}addOpearatorValueFieldsInDS(t,o){this.whereArrInDS().push(this.whereRemainingRows()),console.log(t,o)}delOpearatorValueFieldsInDS(t,o){this.whereArrInDS().removeAt(t),this.signOperatorWhereInDS.splice(t,1),console.log(t,o)}changeColumnInDSForWhere(t,o,i,a){let s=this.whereArrInDS().controls[o].get("column");console.log(o,i,a,s.value);let l=s.value.dataType,c=[];c=this.getOpearatorList.filter(d=>d.operatorType.trim()==l),this.signOperatorWhereInDS[o]=c[0].operatorList}changeOperatorInDSForWhere(t,o,i,a){"IS NULL"==t.value||"IS NOT NULL"==t.value?this.removeValueAtInDM(o):this.addValueAtInDM(o)}whereArrInDS(){return this.datasetTableForm.get("where")}appendDataset(){var t;let o=this.allDatasetDetailsList.filter(l=>l.selected);if(o.length<2)return this.submitted=!0,void this.popup.open(!1,"Please select atleast two Dataset Tables for Appending !");o.forEach(l=>{l.datasetFieldDTOList.forEach(c=>{c.fieldNameColumnType=c.fieldName.trim()+"."+c.columnType})});let i=[];i=o.map(l=>l.datasetFieldDTOList.map(c=>c.fieldName.trim()+"."+c.columnType));let a=o.map(l=>l.datasetFieldDTOList.map(c=>c.fieldName.trim()+"."+c.columnType));console.log(i),console.log(this.findCommon(a));let s=this.findCommon(a);this.unique=[],o.forEach((l,c)=>{let d=[];l.datasetFieldDTOList.forEach((_,u)=>{(null==s?void 0:s.includes(_.fieldNameColumnType))||d.push(_.fieldNameColumnType)}),0!=d.length&&this.unique.push(l.datasetName+":"+d+"\n")}),console.log("Mismatch ",o),console.log(this.unique),0!=this.unique.length?this.enableAppendDatasetError=!0:this.enableDatasetAppendPopup=!0,null===(t=this.datasetAppendForm.get("appendNameControl"))||void 0===t||t.reset()}findCommon(t){let o;for(let i=0;i<t.length-1;i++)if(o=this.getIntersection(t[i],t[i+1]),!o.length)return[];return o}getIntersection(t,o){var i=new Set(o);return[...new Set(t)].filter(a=>i.has(a))}ellipsisInDM(t,o){this.allDatasetDetailsList.forEach((i,a)=>{a==o?t.isSelectedEllipsis=!t.isSelectedEllipsis:i.isSelectedEllipsis=!1})}appendDatasetApi(){var t;let o=null===(t=this.datasetAppendForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim();this.loader.show(),this.solService.getExistDataset(o,"dataset").subscribe(i=>{this.loader.hide(),this.enableDatasetAppendPopup=!1,this.submited1=!1,this.submittedErrorMsg="",this.createDatasetAppend(o),console.log(i)},i=>{this.loader.hide(),this.submited1=!0,this.submittedErrorMsg="Dataset Name Already Exist!!!"})}createDatasetAppend(t){let o=[],i={processId:this.process.processId,dataSetAppendDetailsDto:{appendName:t,datasetTableAppendDtos:o},userId:this.userInfo.userId};this.allDatasetDetailsList.forEach(a=>{a.selected&&o.push({datasetId:a.datasetId,datasetName:a.datasetName})}),this.solService.addDatasetAppend(i).subscribe(a=>{this.getAllDataSetNameAPI({id:5})},a=>{this.popup.open(!1,a.error.statusMessage),this.loader.hide()})}uploadSQLScriptBtn(){this.uploadSQLBtn=!0,this.sqlScriptForm.reset(),this.enableUploadSQL=!0,this.isBtnClickedSQL_Python="SQL"}uploadPythonScriptBtn(){this.uploadSQLBtn=!0,this.sqlScriptForm.reset(),this.enableUploadPython=!0,this.isBtnClickedSQL_Python="P"}generateScript(t){this.saveUploadScript("Manual",t)}uploadPythonScript(){}uploadSQL_PythonScript(t,o){if("Python Script"==o){const i=t.target.files[0];if("py"==t.target.files[0].name.split(".")[1]||"txt"==t.target.files[0].name.split(".")[1]){let a=new FileReader;a.onload=s=>{this.uploadSQLBtn=!1,this.sqlScriptForm.patchValue({sqlScript:JSON.parse(JSON.stringify(a.result))})},a.readAsText(i)}}else if("SQL script"==o){const i=t.target.files[0];if("sql"==t.target.files[0].name.split(".")[1]||"txt"==t.target.files[0].name.split(".")[1]){let a=new FileReader;a.onload=s=>{this.uploadSQLBtn=!1,this.sqlScriptForm.patchValue({sqlScript:JSON.parse(JSON.stringify(a.result))})},a.readAsText(i)}}}saveUploadScript(t,o){var i;let a={processId:this.process.processId,userId:this.userInfo.userId,type:t[0]};("Python Script"==t||"SQL script"==t)&&(a.script=null===(i=this.sqlScriptForm.get("sqlScript"))||void 0===i?void 0:i.value.split("\n").join(" ")),this.solService.uploadScriptToProcess(a).subscribe(s=>{console.log(s),"Python Script"==t?this.executeScript(1,"enableUploadSQLPython"):"SQL script"==t?this.executeScript(2,"enableUploadSQLPython"):"Manual"==t&&("view script"==o?this.getSolutionScript("enableViewscriptPopup"):"powerBi"==o&&this.powerBiContinue())},s=>{this.popup.open(!1,s.error.statusMessage),this.loader.hide()})}getViewScript(){this.isManualScript=!0,this.getViewScriptForm.reset(),this.generateScript("view script")}getSolutionScript(t){this.sqlScriptForm.reset(),this.solService.getSolutionScript(this.process.processId).subscribe(o=>{var i,a,s,l,c;if(o){let d=null===(i=o.responseData)||void 0===i?void 0:i.type;"enableViewscriptPopup"==t?(this.enableViewscriptPopup=!0,this.getViewScriptForm.controls.gscript.disable()):"enableUploadSQLPython"==t&&(""==o.responseData.script?this.uploadSQLBtn=!0:(this.sqlScriptForm.patchValue({sqlScript:o.responseData.script,type:d}),"SQL script"==this.selectedScriptTypeInUF&&"S"==d?this.uploadSQLBtn=!1:"Python Script"==this.selectedScriptTypeInUF&&"P"==d&&(this.uploadSQLBtn=!0),this.nextBtnInUploadScriptInUF=!0)),this.getViewScriptForm.patchValue({gscript:null===(a=o.responseData)||void 0===a?void 0:a.gscript,script:null===(s=o.responseData)||void 0===s?void 0:s.script,solutionScriptId:null===(l=o.responseData)||void 0===l?void 0:l.solutionScriptId,type:null===(c=o.responseData)||void 0===c?void 0:c.type})}},o=>{"enableViewscriptPopup"==t&&this.popup.open(!1,"No data"),this.loader.hide()})}updateViewScript(){var t,o,i;let a={processId:this.process.processId,userId:this.userInfo.userId};this.isUploadScript&&(a.script=null===(t=this.getViewScriptForm.get("script"))||void 0===t?void 0:t.value.split("\n").join(" "),a.type=null===(o=this.getViewScriptForm.get("type"))||void 0===o?void 0:o.value),this.isManualScript&&(a.gscript=null===(i=this.getViewScriptForm.get("gscript"))||void 0===i?void 0:i.value.split("\n").join(" "),a.type="M"),console.log(a),this.solService.uploadScriptToProcess(a).subscribe(s=>{this.enableViewscriptPopup=!1,this.popup.open(!0,s.statusMessage)})}executeViewScript(){var t,o;let i;this.isUploadScript?"P"==(null===(t=this.getViewScriptForm.get("type"))||void 0===t?void 0:t.value)?i=1:"S"==(null===(o=this.getViewScriptForm.get("type"))||void 0===o?void 0:o.value)&&(i=2):this.isManualScript&&(i=2),this.executeScript(i,"enableViewscriptPopup")}executeScript(t,o){this.solService.execscript(this.process.processId,t).subscribe(i=>{"enableViewscriptPopup"==o?this.updateViewScript():"enableUploadSQLPython"==o&&(this.enableUploadSQLPython=!1,this.changeTabs({id:5},"next")),this.popup.open(!0,i.responseData)},i=>{this.popup.open(!1,i.error.statusMessage),console.log(i)})}isSQL_Python(t){t==this.isManualScript?(this.isManualScript=!0,this.isUploadScript=!1):t==this.isUploadScript&&(this.isUploadScript=!0,this.isManualScript=!1)}closeClickContinueInDMPopup(){this.clickContinueInDM=!1}selectDesktopOrServices(t,o){this.desktopServicesArray.forEach(i=>i.isChecked=!1),o.isChecked=!0,t.target.checked&&("Power BI Services"==o.value?this.powerBIServices(o):"Power BI Desktop"==o.value&&console.log("desktop"))}powerBIServices(t){if(0!=this.allDatasetDetailsList.filter(o=>1==o.selected).length)this.SaveContinue();else if(0!=this.uploadedScriptTableList.filter(o=>o.isChecked).length){let o=this.uploadedScriptTableList.filter(i=>i.isChecked).map(i=>i.tableName);console.log(o),this.generateJsonForUploadScript(o)}}generateJsonForUploadScript(t){let o={processId:this.process.processId,tableList:t};this.solService.generateJsonForUploadScript(o).subscribe(i=>{i&&(this.pushDataset({userId:this.userInfo.userId,tables:o.tableList,processId:this.process.processId}),console.log(i))},i=>{})}hasValueCOlumnAt(t){return!!this.whereArrInDS().controls[t].get("value")}addValueAtInDM(t){this.whereArrInDS().controls[t].addControl("value",this.fb.control(""))}removeValueAtInDM(t){this.whereArrInDS().controls[t].removeControl("value")}overrideConfirm(){this.isOverride?this.isOverride=!1:this.enableOverRideConfirmPopup=!0}overrideOK(){this.enableOverRideConfirmPopup=!1,this.isOverride=!0}closeOverridePopup(){this.isOverride=!1,this.enableOverRideConfirmPopup=!1}executeProject(){this.loader.show(),this.solService.execSolutionScript(this.process.processId).subscribe(t=>{this.loader.hide()},t=>{this.loader.hide()})}deleteRelationRow(t){this.relationshipArr().removeAt(t),this.relationship.splice(t,1)}addRelationshipRow(){return this.formBuilder.group({fromTable:["",w.kI.required],toTable:["",w.kI.required],crossFilteringBehavior:["",w.kI.required],fromColumn:["",w.kI.required],toColumn:["",w.kI.required]})}relationshipArr(){return this.addRelationshipForm.get("addRelationshipRows")}fetchFromTables(){return this.selectedDateList.map(t=>({name:t.datasetName,value:t.tableName}))}fetchToTables(t){const o=this.relationship;return this.selectedDateList.map(i=>{var a;return(null===(a=o[t])||void 0===a?void 0:a.fromTable)!==i.tableName?{name:i.datasetName,value:i.tableName}:null}).filter(function(i){return null!=i})}fetchTableColumns(t){return this.selectedDateList.find(i=>i.tableName===t).datasetFieldDTOList.map(i=>({name:i.fieldName,value:i.columnName}))}fetchCrossFltrBehaviours(){return[{name:"Automatic",value:"Automatic"},{name:"Many To Many",value:"BothDirections"},{name:"One To Many",value:"OneDirection"}]}openRelModal(){this.addRelationshipForm.controls.addRelationshipRows=this.fb.array([this.addRelationshipRow()]),this.submitedRelation=!1,console.log("seelcted tables:",this.selectedDateList),this.showRelationshipModal=!0,this.relationship=[{name:"",fromTable:"",fromTableList:this.fetchFromTables(),crossFilteringBehavior:this.fetchCrossFltrBehaviours()[0].value,cfbList:this.fetchCrossFltrBehaviours(),fromColumn:"",fromColumnList:[],toTable:"",toTablesList:[],toColumn:"",toColumnList:[],validators:{name:0,fromtable:0,fromColumn:0,toTable:0,toColumn:0}}],console.log("relation ship info:",this.relationship)}closeRelModal(){this.showRelationshipModal=!1,this.relationship=[]}addNewRelation(t){let o=this.relationshipArr().length;this.relationshipArr().controls[o-1].invalid||(this.relationshipArr().push(this.addRelationshipRow()),this.relationship.push({name:"",fromTable:"",fromTableList:this.fetchFromTables(),crossFilteringBehavior:this.fetchCrossFltrBehaviours()[0].value,cfbList:this.fetchCrossFltrBehaviours(),fromColumn:"",fromColumnList:[],toTable:"",toTablesList:[],toColumn:"",toColumnList:[],validators:{name:0,fromtable:0,fromColumn:0,toTable:0,toColumn:0}}))}onChangeToTable(t,o){let i=this.relationshipArr().controls[t].value.toTable;this.relationship[t][o+"ColumnList"]=this.fetchTableColumns(i)}populateToTables(t,o){let i=[];return this.relationship[t].fromTableList.forEach(a=>{o!=a.value&&i.push(a)}),i}onChangeTable(t,o){console.log("index",t);let i=this.relationshipArr().controls[t].value.fromTable;this.relationship[t][o+"ColumnList"]=this.fetchTableColumns(i),this.relationship[t].toTableList=this.populateToTables(t,i),this.filterExistingRel(this.relationship[t].fromTable,t)}filterExistingRel(t,o){const i=this.relationship.filter(a=>a.fromTable===t).map(a=>a.toTable).filter(function(a){return null!=a&&""!==a});this.relationship[o].toTableList=this.relationship[o].toTableList.filter(a=>i.indexOf(a.value)<0)}onCheck(t,o){if(console.log(t),"dataset"==o){this.allDatasetDetailsList.forEach(a=>{t.datasetId==a.datasetId&&(a.selected=!a.selected)});const i=this.selectedDateList.findIndex(a=>a.datasetName===t.datasetName);i>-1?this.selectedDateList.splice(i,1):this.selectedDateList.push(t),this.selectedDateList.length>1?(this.disableContinue=!0,this.disableRelButton=!1):(this.disableContinue=!1,this.disableRelButton=!0),console.log(this.allDatasetDetailsList)}else"scriptGeneratedTable"==o&&(t.isChecked=0==t.isChecked,console.log(this.uploadedScriptTableList))}validateRelation(t){return t.validators.name=t.name?0:1,t.validators.fromTable=t.fromTable?0:1,t.validators.fromColumn=t.fromColumn?0:1,t.validators.toTable=t.toTable?0:1,t.validators.toColumn=t.toColumn?0:1,t.validators.name||t.validators.fromTable||t.validators.fromColumn||t.validators.toTable||t.validators.toColumn}disableContinueBtn(){return this.selectedDateList.length>1&&this.disableContinue}saveRelation(){if(!this.validateRelation(this.relationship[this.relationship.length-1])){let t=this.relationship.map(o=>({name:o.name,fromTable:o.fromTable,crossFilteringBehavior:o.crossFilteringBehavior,fromColumn:o.fromColumn,toTable:o.toTable,toColumn:o.toColumn}));this.relationship=[],this.relationShipPayload=this.relationShipPayload.concat(t),this.showRelationshipModal=!1,this.disableContinue=!1}}saveRelationship(){this.submitedRelation=!0;let t=0;this.relationshipArr().controls.forEach((o,i)=>{o.invalid&&(t=1)}),1!=t?(this.relationShipPayload=[],this.relationshipArr().controls.forEach(o=>{this.relationShipPayload.push({name:"",fromTable:o.value.fromTable,crossFilteringBehavior:o.value.crossFilteringBehavior,fromColumn:o.value.fromColumn,toTable:o.value.toTable,toColumn:o.value.toColumn}),this.relationship=[],this.showRelationshipModal=!1,this.disableContinue=!1})):this.popup.open(!1,"Enter all the required fields")}clickContinue(){console.log(this.process.statusName),console.log("relationShipPayload",this.relationShipPayload),this.desktopServicesArray.forEach(t=>t.isChecked=!1),this.generateScript("powerBi")}powerBiContinue(){let t=this.allDatasetDetailsList.filter(i=>1==i.selected).length,o=this.uploadedScriptTableList.filter(i=>i.isChecked).length;if(this.process.powerBiDatasetExists){if(this.process.powerBiDatasetExists)if(t>1){if(0==this.relationShipPayload.length)return void this.popup.open(!1,"Please Map Dataset Tables !!");this.SaveContinue()}else this.SaveContinue()}else{if(0==t&&0==o)return void this.popup.open(!1,"Please select atleast one Table !!");if(1==t||1==o)this.clickContinueInDM=!0,this.clickContinueInDM=!1,this.powerBIServices({value:"Power BI Services"});else if(o>1)this.clickContinueInDM=!0,this.clickContinueInDM=!1,this.powerBIServices({value:"Power BI Services"});else if(t>1){if(0==this.relationShipPayload.length)return void this.popup.open(!1,"Please Map Dataset Tables !!");this.clickContinueInDM=!0,this.clickContinueInDM=!1,this.powerBIServices({value:"Power BI Services"})}}}SaveContinue(){let t=[];this.allDatasetDetailsList.forEach(i=>{i.selected&&t.push(i.tableName)});let o={tables:t,userId:this.userInfo.userId,processId:this.process.processId};this.relationShipPayload.length>0&&(this.relationShipPayload.forEach((i,a)=>{i.name="relation"+a}),o.relationShips=this.relationShipPayload),console.log(o),this.pushDataset(o)}pushDataset(t){this.loader.show(),this.solService.postPushDataSets(t,this.isOverride).subscribe(o=>{localStorage.setItem("PBIdata",JSON.stringify(o.responseData)),this.router.navigate(["/user/admin1/powerbi-interface"]),this.loader.hide(),this.clickContinueInDM=!1},o=>{this.popup.open(!1,o.error),this.loader.hide()})}oneNext(t,o){var i=this;let a={userId:this.userInfo.userId,processId:this.process.processId,checkDtoslist:[]};this.fileListt.forEach(l=>{var c;null===(c=l.totalSheetList)||void 0===c||c.filteredData.forEach(d=>{a.checkDtoslist.push(d.sheetSelected?{id:d.templateId,value:1}:{id:d.templateId,value:0})})});let s=this.uploadedManualToggleForm.controls.manualOrUploaded;a.solutionType=null==this.process.solutionType?"M":(s.value?"U":"M")==this.process.solutionType?null:s.value?"U":"M",this.solService.saveCheckedSheetList(a).subscribe(function(){var l=(0,$e.Z)(function*(c){i.process.solutionType=null==i.process.solutionType?"M":s.value?"U":"M",localStorage.setItem("process",JSON.stringify(i.process)),console.log(localStorage.getItem("process")),"manual"==o?yield i.getNewTargetFilesList(t):"uploadedScript"==o&&i.saveUploadScript(i.selectedScriptTypeInUF,"")});return function(c){return l.apply(this,arguments)}}(),l=>{})}getNewTargetFilesList(t){this.solService.getAllFileTemplateListByProcessID(this.process.processId).subscribe(o=>{var i,a;let s=this.totalfileDetails(null===(i=null==o?void 0:o.responseData)||void 0===i?void 0:i.totalfileDetails,t);this.targetFileList=s,this.tartargetFileListForSearch=this.totalfileDetails(null===(a=null==o?void 0:o.responseData)||void 0===a?void 0:a.totalfileDetails,t),this.masterChkInTF(),console.log("this.targetFileList",this.targetFileList),this.tabtab(t)})}threeNext(t){var o=this;let i={fieldCheckListDtos:[]},a=[];console.log(this.targetFileList,"this.targetFileList"),this.targetFileList.forEach(s=>{s.sheet.forEach(l=>{l.isChecked&&l.isCheckedChildDirtyInTF?a.push({id:l.columnId,value:1}):!l.isChecked&&l.isCheckedChildDirtyInTF&&a.push({id:l.columnId,value:0})})}),i.fieldCheckListDtos.push({type:"TemplateField",checkDtoslist:a}),this.solService.saveFieldCheckList(i).subscribe(function(){var s=(0,$e.Z)(function*(l){o.threePrev(t)});return function(l){return s.apply(this,arguments)}}(),s=>{})}getAppendFilesApi(){this.getAppendFilesList=[],this.solService.getAppendFiles(this.process.processId).subscribe(t=>{var o;this.getAppendFilesList=null===(o=t.responseData)||void 0===o?void 0:o.appendSheetList,console.log("getAppendFiles",t)},t=>{})}getJoinFilesListApi(){this.getJoinFilesList=[],this.solService.getMergeList(this.process.processId).subscribe(t=>{var o;this.getJoinFilesList=null===(o=t.responseData)||void 0===o?void 0:o.templatesMergeDetailsList,console.log("getMergeList",t)},t=>{})}fourPrev(t){this.append_SourceFilesList=[],this.getJoinFilesList=[],this.loader.show(),(0,Ji.D)([this.solService.getTargetFileList(this.process.processId),this.solService.getMergeList(this.process.processId)]).subscribe(o=>{var i,a,s,l,c,d;this.loader.hide(),console.log(o);let _=this.appendResponse(null===(a=null===(i=o[0])||void 0===i?void 0:i.responseData.appendSheetListDto)||void 0===a?void 0:a.appendSheetList),u=this.totalfileDetails(null===(l=null===(s=o[0])||void 0===s?void 0:s.responseData.templateFileDetailsListDto)||void 0===l?void 0:l.totalfileDetails,t);_.forEach(f=>this.append_SourceFilesList.push(f)),u.forEach(f=>this.append_SourceFilesList.push(f)),this.append_SourceFilesListForSearch=JSON.parse(JSON.stringify(this.append_SourceFilesList)),console.log("this.append_SourceFilesList",this.append_SourceFilesList),this.getJoinFilesList=null===(d=null===(c=o[1])||void 0===c?void 0:c.responseData)||void 0===d?void 0:d.templatesMergeDetailsList,this.tabsChange(t),this.selectedTab=t.id})}appendResponse(t){return t.forEach(o=>{o.isAppendExpandInJoin=!0,o.tableNameUI=o.appendName,o.searchValueInCreateDatasetPopup="",o.searchValueInColumnPopup="",o.isSelectAllParentInDM=!1,o.tableAppendFieldsDto.forEach(i=>{i.isSelectAllChildInDM=!1,i.fileType=o.type,i.showTabColName=o.appendName+"["+i.fieldName+"]",i.isDropdownDirtyInTF=!1})}),t}totalfileDetails(t,o){t.forEach(a=>{a.totalSheetList.forEach(s=>{var l;if(null!=s.sheet){const c=s.sheetName;s.isCheckedInTF=!s.sheet.map(_=>_.isChecked).includes(!1),s.isCheckedParentDirtyInTF=!1,null===(l=s.sheet)||void 0===l||l.forEach(_=>{var u;let f=this.allDataTypeByDatatypeName.filter(m=>m.dataTypeName==_.columnType);_.filteredColumnTypeList=null===(u=f[0])||void 0===u?void 0:u.dataTypeList,_.templateId=s.templateId,_.tableName=s.tableName,_.isCheckedChildDirtyInTF=!1,_.isDropdownDirtyInTF=!1,_.type="template","xlsx"==a.fileExt||"xls"==a.fileExt?(_.showTabColName=a.fileName+"-"+c+"."+a.fileExt+"["+_.fieldName+"]",_.tableNameUI=a.fileName+"-"+c+"."+a.fileExt):("txt"==a.fileExt||"csv"==a.fileExt||"json"==a.fileExt)&&(_.showTabColName=a.fileNameWithExt+"["+_.fieldName+"]",_.tableNameUI=a.fileNameWithExt),_.fileExt=a.fileExt})}})});const i=[];return t.forEach(a=>{a.isSelectAllParentInDM=!1,a.totalSheetList.forEach(s=>{var l;s.sheetSelected&&(null===(l=s.sheet)||void 0===l||l.forEach(c=>{c.isSelectAllChildInDM=!1}),s.type="template","xlsx"==s.fileExt||"xls"==s.fileExt?i.push(Object.assign(Object.assign({searchValueInTF:"",searchValueInCreateDatasetPopup:"",searchValueInColumnPopup:"",isSourceFilesExpandInJoin:!0,fileExt:s.fileExt,fileName:a.fileName+"-"+s.sheetName+"."+a.fileExt},s),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:a.fileName+"-"+s.sheetName+"."+a.fileExt})):("csv"==s.fileExt||"txt"==s.fileExt||"json"==s.fileExt)&&i.push(Object.assign(Object.assign({searchValueInTF:"",searchValueInCreateDatasetPopup:"",searchValueInColumnPopup:"",isSourceFilesExpandInJoin:!0,fileExt:s.fileExt,fileName:a.fileNameWithExt},s),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:a.fileNameWithExt})))})}),5==o.id?i.filter(a=>a.sheet.some(s=>1==s.isChecked)).map(a=>Object.assign({},a,{sheet:a.sheet.filter(s=>1==s.isChecked)})):i}threePrev(t){this.getAppendFilesList=[],this.sourceFilesList=[],this.sourceFilesListForSearch=[],(0,Ji.D)([this.solService.getAllFileTemplateListByProcessID(this.process.processId),this.solService.getAppendFiles(this.process.processId)]).subscribe(o=>{var i,a,s;this.sourceFilesList=this.totalfileDetails(null===(a=null===(i=o[0])||void 0===i?void 0:i.responseData)||void 0===a?void 0:a.totalfileDetails,t),this.sourceFilesListForSearch=JSON.parse(JSON.stringify(this.sourceFilesList)),console.log("this.targetFileList",this.targetFileList),this.getAppendFilesList=null===(s=o[1].responseData)||void 0===s?void 0:s.appendSheetList,console.log("sourceFilesList",this.sourceFilesList),this.tabtab(t)})}getAllOperatorsList(){this.solService.getAllOperators().subscribe(t=>{this.getOpearatorList=null==t?void 0:t.responseData,console.log("this.getOpearatorList",this.getOpearatorList)},t=>{})}targetFileNextCndn(){return this.targetFileList.filter(o=>o.sheet.some(i=>1==i.isChecked)).map(o=>Object.assign({},o,{sheet:o.sheet.filter(i=>1==i.isChecked)}))}changeTabs(t,o){if(console.log(t,o),this.submitted=!1,this.submittedErrorMsg="",this.getAllDataTypeByDatatypeName(),0==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/add-process"]),this.getAllOrganizations(t),this.getAllIndustry()),1==t.id&&"next"==o&&this.addProcessSave(t),1==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/upload-files"]),this.getAllFileTemplateListByProcessID(t),null!=this.process.solutionType&&"U"==this.process.solutionType))return this.enableUploadSQLPython=!0,void this.getSolutionScript("enableUploadSQLPython");if(2==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/target-files"]),this.getNewTargetFilesList(t)),2==t.id&&"next"==o){if(1==this.nextBtnEnableInUF())return void this.popup.open(!1,"Please select atleast one file");if(this.uploadedManualToggleForm.value.manualOrUploaded)return this.enableUploadSQLPython=!0,void this.getSolutionScript("enableUploadSQLPython");this.enableUploadSQLPython=!1,this.router.navigate(["/user/admin1/solutionboard/target-files"]),this.oneNext(t,"manual")}3==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/append"]),this.threePrev(t)),3==t.id&&"next"==o&&(0!=this.targetFileNextCndn().length?(this.router.navigate(["/user/admin1/solutionboard/append"]),this.threeNext(t)):this.popup.open(!1,"Please select atleast one Column or Table")),4==t.id&&"prev"==o&&(null!=this.process.solutionType?"U"==this.process.solutionType?this.changeTabs({id:1},"prev"):"M"==this.process.solutionType&&(this.router.navigate(["/user/admin1/solutionboard/join"]),this.fourPrev(t)):(this.router.navigate(["/user/admin1/solutionboard/join"]),this.fourPrev(t))),4==t.id&&"next"==o&&(this.router.navigate(["/user/admin1/solutionboard/join"]),this.fourPrev(t)),5==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/data-modeling"]),this.getTargetFileList(t),this.getUploadedScriptTableList(),this.getAllFunctions(),this.getAllOperatorsList()),5==t.id&&"next"==o&&(this.router.navigate(["/user/admin1/solutionboard/data-modeling"]),this.getTargetFileList(t),this.getUploadedScriptTableList(),this.getAllFunctions(),this.getAllOperatorsList())}closePopup(){this.ScenarioPopup=!1}Popup(){this.ScenarioPopup=!0}overlayPopUp(){this.DataPopUp=!0,this.guid=!0}nextguid(t){0==t?this.guidindex=0:1==t?this.guidindex=1:2==t?this.guidindex=2:3==t?this.guidindex=3:(t=4)&&(this.DataPopUp=!1,this.guid=!1,this.guidindex=0)}tabsChange(t){console.log(t.id),this.activeTab=t.id,this.tabs.forEach(o=>{o.isActive=t.id==o.id}),console.log(this.tabs)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(qi.H7),e.Y36(fe.gz),e.Y36(Nn.D),e.Y36(w.qu),e.Y36(Hn.R),e.Y36(Jt.e),e.Y36(w.qu),e.Y36(fe.gz),e.Y36(fe.F0),e.Y36(fe.F0),e.Y36(e.sBO),e.Y36(e.Qsj),e.Y36(Jt.e),e.Y36(co.uw),e.Y36(fe.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-process"]],viewQuery:function(t,o){if(1&t&&(e.Gf(G_,5),e.Gf(X_,7),e.Gf(j_,5),e.Gf(ep,5),e.Gf(tp,5),e.Gf(np,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.form=i.first),e.iGM(i=e.CRH())&&(o.sort=i.first),e.iGM(i=e.CRH())&&(o.toggleButton=i.first),e.iGM(i=e.CRH())&&(o.menu=i.first),e.iGM(i=e.CRH())&&(o.innerTables=i),e.iGM(i=e.CRH())&&(o.innerSort=i)}},decls:47,vars:28,consts:[[1,"heading"],[1,"page-title-wrapper"],[4,"ngIf"],[1,"consen","mainContainer","padd-10",2,"padding-top","10px !important"],[1,"steps-block",3,"selectedIndex","selectedIndexChange"],["mat-tab-label",""],["class","taxt_audit-report",4,"ngIf"],[1,"number",3,"ngClass"],[1,"inner-container"],[3,"formGroup"],[1,"row"],[1,"col-md-8"],[1,"col-md-12"],["class","main",4,"ngIf"],[1,"row","genericSol"],[1,"input-group"],["type","text","formControlName","processNameControl",1,"form-control","reflect-model",3,"ngClass"],[1,"col-md-6"],["formControlName","processDescriptionControl",1,"form-control","reflect-model",2,"height","335px",3,"ngClass"],[1,"col","bord"],[1,"header"],["type","checkbox","name","list_name","value","m1","id","selectAll",1,"form-check-input",3,"checked","change"],["for","selectAll"],["type","text","placeholder","Search",1,"form-control","reflect-model",3,"keyup"],["mat-button",""],[1,"dds-icon","dds-icon_search__l__stroke"],[4,"ngFor","ngForOf"],[1,"col-md-4"],["class","but upload-block",4,"ngIf"],[1,"button-group"],["mat-button","","type","reset",1,"btnn",3,"click"],[1,"dds-icon","dds-icon_arrow_back__l__stroke"],["mat-button","",1,"btnn",3,"click"],[1,"dds-icon","dds-icon_arrow_right__s__stroke"],[1,"main"],["appearance","fill"],["placeholder","Select Client","formControlName","chooseclient",1,"form-control","reflect-model",3,"ngClass"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["example",""],[1,"header1"],["matExpansionPanelContent",""],["class","col-sm-4 subheading",4,"ngFor","ngForOf"],[1,"col-sm-4","subheading"],["type","checkbox","name","first",1,"form-check-input",3,"checked","change"],["for","exampleCheck1",1,"form-check-label"],[1,"col-md-5"],["for","onChangeAddFeatureList",1,"form-check-label"],[1,"input-group","flex-list"],["type","checkbox","id","onChangeAddFeatureList","formControlName","addfeaturelist",1,"form-check-input",3,"change"],[1,"col-md-7"],[1,"mat-card","no-padding"],["class","mat-card-div",4,"ngFor","ngForOf"],[1,"mat-card-div"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"form-check-label"],[1,"but","upload-block"],[1,"upload-button",3,"ngClass"],["for","imgfile",1,"button",3,"ngClass"],["type","file","id","imgfile","accept","image/png, image/gif, image/jpeg","formControlName","imgFile",2,"display","none",3,"change"],[1,"upload-inner"],[1,"image-box"],[1,"icon","image-icon"],[1,"title"],["class","upload-note",4,"ngIf"],[1,"error"],[1,"upload-button"],["for","vidfile",1,"button",3,"ngClass"],["type","file","id","vidfile","formControlName","vidFile",2,"display","none",3,"change"],[1,"icon","video-icon"],["for","brochurefile",1,"button",3,"ngClass"],["type","file","id","brochurefile","formControlName","broFile",2,"display","none",3,"change"],[1,"icon","broucher-icon"],[1,"upload-note"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],["form","ngForm"],[1,"input-group","button-block"],["href","javascript:void(0);","color","primary",1,"mat-button",3,"click"],[1,"dds-icon","dds-icon_plus__l__stroke"],[1,"scroll"],[1,"table","table-striped"],["scope","col"],["class","dds-icon dds-icon_edit__l__stroke",3,"click",4,"ngIf"],["class","dds-icon dds-icon_checkmark__l__stroke",3,"click",4,"ngIf"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],["formControlName","aName",1,"form-control",3,"value"],["formControlName","aDescription",1,"form-control",3,"value"],[1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[1,"dds-icon","dds-icon_checkmark__l__stroke",3,"click"],[1,"upload-files-block"],["class","row",4,"ngIf"],[1,"dds-icon","dds-icon_arrow_left__l__stroke",2,"margin-right","10px","margin-left","0px"],["mat-button","","class","btnn",3,"disabled","click",4,"ngIf"],[1,"upload-inner-block"],["appFileDragAndDrop","",3,"filesChangeEmiter"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[1,"note-block"],[1,"col-md-9"],[1,"toolbar-block"],[1,"block-title"],[1,"search-block"],["type","text","placeholder","Search",3,"keyup"],[1,"mat-button"],[1,"dds-icon","dds-icon_search"],[1,"table-container"],["mat-table","","multiTemplateDataRows","","matSort","",1,"mat-elevation-z8","upload-table",3,"dataSource"],["outerSort","matSort"],["matColumnDef","expand"],["mat-header-cell","","aria-label","row actions",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"example-element-row","example-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],[1,"col-md-3"],["mat-button","",1,"primary"],[1,"dds-icon","dds-icon_info__l__stroke","info",2,"margin-left","0px","margin-right","0px"],[1,"space-evenly"],[1,"upload-inner-block",2,"height","28vh"],[1,"toggle-btn-block"],["formControlName","manualOrUploaded",3,"click"],["mat-header-cell","","aria-label","row actions"],["type","checkbox","name","list_name","value","m1",3,"ngModel","ngModelChange","change"],["mat-cell",""],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","change","ngModelChange"],["mat-icon-button","","aria-label","expand row",3,"click"],[1,"dds-icon","dds-icon_chevron_down__l__stroke"],[1,"dds-icon","dds-icon_chevron_up__l__stroke"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["title","preview",3,"click"],["title","copy table name",1,"dds-icon","dds-icon_copy__l__stroke",3,"click"],["title","delete",3,"click"],["class","example-element-detail",4,"ngIf"],[1,"example-element-detail"],["class","inner-table mat-elevation-z8",4,"ngIf"],[1,"inner-table","mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["innerTables","","innerSort","matSort"],["mat-row","",4,"matRowDef","matRowDefColumns"],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","ngModelChange","change"],["mat-header-row",""],["mat-row",""],["mat-row","",3,"click"],["mat-row","",1,"example-detail-row"],["mat-button","",1,"btnn",3,"disabled","click"],[1,"row",2,"margin","0px !important",3,"ngClass"],[1,"col-md-9",2,"padding-left","0px"],[1,"targetFileRow"],["type","button",1,"mat-button"],[1,"dds-icon","dds-icon_search__s__stroke"],["mat-button","",1,"primary",3,"click"],[1,"table-container","targetfiles-table"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"dds-icon","dds-icon_arrow_right__l__stroke"],["colspan","3"],[1,"trrr"],["multi","","is-open","true"],[3,"expanded","opened","closed"],[1,"mat-row"],[1,"dataP",3,"click"],["src","../../assets/images/apd-icon.png","alt","",2,"margin","0 10px 0 0"],[1,"rightIcons1",3,"click"],["title","Edit",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],["type","text","placeholder","Search",3,"value","keyup"],["style","cursor: pointer",4,"ngFor","ngForOf"],[2,"cursor","pointer"],[1,"col-md-3",2,"padding-right","0px"],[1,"custom-note","no-padd","no-border"],[1,"dds-icon","dds-icon_info__l__stroke"],[1,"row","append-block"],["type","text","placeholder","Search",1,"form-control",3,"keyup"],[1,"createNewSoltionsTable","appendTable","mat-table"],["matSort","",3,"matSortChange"],["mat-sort-header","fileName"],["class","trrr",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"col-md-2"],["mat-button","",1,"btnn",2,"margin","30px",3,"click"],[1,"createNewSoltionsTable","appendTable"],["mat-sort-header","appendName"],[1,"apd-item"],[2,"width","50%"],["title","preview",1,"dds-icon","dds-icon_eyeopen",3,"click"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"color","#75787b"],[1,"dds-icon","dds-icon_file_txt__l__filled",2,"color","#75787b"],[1,"dds-icon","dds-icon_file_csv__l__filled",2,"color","#75787b"],["src","../../assets/images/Json.svg","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],[1,"dataP",3,"title","click"],["title","Edit",1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[1,"table","table-striped","createNewSoltionsTable","appendTable"],["colspan","2",2,"padding","0px !important","height","auto"],[1,"header",2,"margin-bottom","0px",3,"click"],["class","dds-icon dds-icon_chevron_down__s__stroke",4,"ngIf"],["class","dds-icon dds-icon_chevron_up__s__stroke",4,"ngIf"],["class","",4,"ngFor","ngForOf"],[1,"header",3,"click"],["mat-button","","class","btnn",3,"disabled","ngClass","click",4,"ngIf"],[1,"dds-icon","dds-icon_chevron_down__s__stroke"],[1,"dds-icon","dds-icon_chevron_up__s__stroke"],[1,""],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","change"],[1,"rightIcons"],["mat-button","",1,"btnn",3,"disabled","ngClass","click"],[3,"title"],["src","../../assets/images/jnd-icon.png","alt","",2,"margin","0 10px 0 0"],["title","Delete",1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[1,"toobar-block","data-toolbar"],[1,"dds-icon","dds-icon_plus"],[1,"dataModeling"],[1,"clo-md-12"],[1,"data-mode-table"],[1,"table-header"],["class","mat-table empty-records empty-inner",4,"ngIf"],["multi","","class","mat-table","is-open","true",4,"ngIf"],["mat-button","",1,"btnn",2,"margin-right","auto !important",3,"disabled","click"],[1,"dds-icon","dds-icon_show__s__stroke"],[1,"mat-table","empty-records","empty-inner"],["multi","","is-open","true",1,"mat-table"],[3,"expanded","opened","closed",4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input",2,"margin-right","8px",3,"click"],["mat-icon-button","","aria-label","Example icon-button with a menu",1,"action-button",3,"click"],["class","actions-menu",4,"ngIf"],[1,"search1","col-md-6","inner-search"],["id","form1","value","","placeholder","Search",1,"form-control",3,"keyup"],[1,"actions-menu"],["mat-menu-item",""],["title","View Dataset","title","preview",1,"dds-icon","dds-icon_eyeopen",3,"click"],["mat-menu-item","",4,"ngIf"],["title","View Script",1,"dds-icon","dds-icon_file",3,"click"],["title","Delete Dataset",1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],["title","Edit Dataset",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[3,"click"],[1,"rightIcons",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup",2,"min-width","1165px"],[1,"taxt-header","popup-header"],["aria-label","Close",1,"close",3,"click"],[1,"report-modal-close","dds-icon","dds-icon_close__l__stroke"],[1,"popup-body"],["formArrayName","addRelationshipRows",1,"join-name-group",2,"padding-bottom","0px"],["class","join-new-form","style","padding-right:20px;",3,"formGroupName",4,"ngFor","ngForOf"],[1,"popup-footer","button-group"],["mat-button","",3,"click"],[1,"dds-icon","dds-icon_close"],[1,"join-new-form",2,"padding-right","20px",3,"formGroupName"],["id","Name","formControlName","fromTable","placeholder","select from table",1,"form-control",3,"ngClass","selectionChange"],["id","Name","formControlName","crossFilteringBehavior","placeholder","Select Relationship",1,"form-control",3,"ngClass"],["id","Name","formControlName","toTable","placeholder","select to table",1,"form-control",3,"ngClass","selectionChange"],["id","Name","formControlName","fromColumn","placeholder","select table column",1,"form-control",3,"ngClass"],["id","Name","formControlName","toColumn","placeholder","select table column",1,"form-control",3,"ngClass"],[1,"col-md-1"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","title","Table Delete",3,"click",4,"ngIf"],[1,"flex-child"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",3,"click"],["mat-button","","title","Table Delete",1,"dds-icon","dds-icon_delete__l__stroke","btnn",3,"click"],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","click"],[2,"width","auto !important","margin-right","20px","margin-bottom","0px",3,"click"],[1,"taxt-audit-popup",2,"min-width","560px"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["type","text","formControlName","name",1,"form-control","reflect-model",3,"ngClass"],[1,"input-group",2,"margin-bottom","0px"],["type","text","formControlName","description",1,"form-control","reflect-model",2,"height","200px",3,"ngClass"],[1,"popup-footer","button-block"],["mat-button","","type","button",3,"click"],["mat-button","","type","submit",1,"primary"],[1,"taxt-audit-popup"],[1,"close",3,"click"],[1,"upload"],[1,"file-name-block"],["src","../../../assets/images/Group 4899.svg"],[1,"upload-file-info"],["class","ico dds-icon dds-icon_alert__l__stroke","style","color: red !important; margin-left: 84%;",4,"ngIf"],["class","completedprogress","style","margin-left: 74%;",4,"ngIf"],[1,"progress"],[1,"ico","dds-icon","dds-icon_alert__l__stroke",2,"color","red !important","margin-left","84%"],[1,"completedprogress",2,"margin-left","74%"],["class","failedprogress-bar","role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["class","progress-bar","role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"failedprogress-bar"],["role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress-bar"],[1,"row","popup"],[1,"field"],["type","text","formControlName","appendNameControl","oninput","this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\\..*)\\./g, '$1');",3,"ngClass","keyup"],[1,"col-sm-12","popup-footer","button-group"],["mat-button","","type","submit",3,"click"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[1,"col-sm-12",2,"float","right","text-align","right"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],["mat-button","",2,"color","#0076A8","background","#fff",3,"click"],[1,"taxt-audit-popup",2,"min-width","calc(100% - 60px)","height","calc(100vh - 60px)",3,"ngClass"],[1,"user-guide-link",3,"click"],[1,"dds-icon","dds-icon_help__l__stroke"],["type","button",1,"close",3,"click"],[1,"popup-body",2,"display","block","height","calc(100% - 45px)","margin-top","45px"],[1,"dataset-group"],[1,"col-md-3","combination",3,"ngClass"],[1,"combinations-sidebar"],["type","submit",1,"mat-button"],["class","mat-table","style","text-align: center; font-size: 13px",4,"ngIf"],[1,"col-md-9","combination","expTable"],[1,"row","data-file-inputgroup"],["mat-button","",1,"columns-button",3,"ngClass","click"],["class","mat-table empty-records","style","text-align: center; font-size: 13px",4,"ngIf"],[1,"mat-table","empty-records",2,"text-align","center","font-size","13px"],[1,"rightIcons1"],["id","form1","placeholder","Search",1,"form-control",3,"value","keyup"],[1,"inner-check-all"],["type","checkbox","title","Select All",1,"form-check-input",2,"margin-top","10px","margin-bottom","10px","height","18px","width","18px",3,"ngModel","ngModelChange","change"],[2,"margin-top","6px"],["class","scroll","style","cursor: pointer",4,"ngFor","ngForOf"],[1,"scroll",2,"cursor","pointer"],[1,"mat-table",2,"text-align","center","font-size","13px"],[1,"table-container",2,"height","auto","max-height","30vh","border-bottom","1px solid #97999B"],[2,"text-align","right"],[1,"input-group",2,"margin-bottom","0px",3,"ngClass"],[1,"border-bottom"],["formArrayName","where"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"row",3,"ngClass"],["multiple","","placeholder","Select groupBy","formControlName","groupBy",1,"form-control",3,"title","closed","selectionChange"],["matSelect",""],[3,"change"],["type","text","placeholder","search","formControlName","groupBySearch"],[3,"title","value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","type","button","aria-label","Clear",3,"click",4,"ngIf"],["matInput","","formControlName","having","placeholder","Having",1,"form-control"],["multiple","","placeholder","Select orderBy","formControlName","orderBy",1,"form-control",3,"title","closed","selectionChange"],["type","text","placeholder","search","formControlName","orderBySearch"],[2,"width","1%","border","0"],[2,"text-align","right","width","1%","border","0"],[3,"formGroupName"],[1,"addRow","row"],["appearance","fill",1,"col-md-3"],["placeholder","Select Column","formControlName","column",1,"form-control",3,"title","closed","selectionChange"],["type","text","placeholder","search","formControlName","columnSearch"],["placeholder","Select Operator","formControlName","signOperator",1,"form-control",3,"selectionChange"],["placeholder","Select AND/OR","formControlName","operator",1,"form-control"],["matSuffix","","mat-icon-button","","type","button","aria-label","Clear",3,"click"],[3,"title","value"],["placeholder","Value","formControlName","value",1,"form-control"],[1,"dds-icon","dds-icon_plus__l__stroke",3,"click"],[1,"custom-popup",3,"ngClass"],[1,"custom-popup-container"],[3,"selectedIndex"],[1,"custom-popup-footer","button-group"],[1,"dds-icon","dds-icon_arrow_rotate_right__s__stroke"],[1,"number",3,"ngClass","click"],[1,"number",3,"click"],["formArrayName","DSetRows",1,"popup",2,"margin-top","10px"],[1,"join-name-group",2,"padding-bottom","0px"],[1,"join-new-form",2,"padding-right","20px"],["appearance","fill",1,"col-md-4"],["formControlName","Ptable",1,"form-control",3,"placeholder","ngClass","closed","selectionChange"],["type","text","placeholder","search",3,"value","keyup"],["placeholder","Join Type","formControlName","join",1,"form-control",3,"ngClass","selectionChange"],["placeholder","Foreign Table","formControlName","Ftable",1,"form-control",3,"ngClass","selectionChange","closed"],["formArrayName","columns"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"ngClass","selectionChange","closed"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"ngClass","selectionChange","closed"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn",3,"click",4,"ngIf"],["selectForeignKeyInDS","",3,"value",4,"ngFor","ngForOf"],["selectForeignKeyInDS","",3,"value"],["mat-button","",1,"dds-icon","dds-icon_delete__l__stroke","btnn",3,"click"],[1,"taxt-audit-popup",2,"width","1165px !important"],[1,"field","col-md-6"],["formArrayName","Merg"],[1,"join-scroll"],["formArrayName","tableControl",1,"join-name-group"],[1,"join-new-form"],["formControlName","table1",1,"form-control",3,"placeholder","ngClass","selectionChange","closed"],["placeholder","Select Join","formControlName","join",1,"form-control",3,"ngClass","selectionChange"],["placeholder","Select Foreign Table","formControlName","table2",1,"form-control",3,"ngClass","selectionChange","closed"],["maformGroupt-button","","class","dds-icon dds-icon_delete__l__stroke btnn delete-column-block","title","Table Delete",3,"click",4,"ngIf"],["formArrayName","column",1,"append-columns"],["mat-button","","class","add-table-button","title","Table",3,"disabled","click",4,"ngIf"],["maformGroupt-button","","title","Table Delete",1,"dds-icon","dds-icon_delete__l__stroke","btnn","delete-column-block",3,"click"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff; font-size: 14px","title","Column",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff; font-size: 14px","title","Column Delete",3,"click",4,"ngIf"],["mat-button","","title","Column",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"color","#fff","font-size","14px",3,"click"],["mat-button","","title","Column Delete",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"color","#fff","font-size","14px",3,"click"],["mat-button","","title","Table",1,"add-table-button",3,"disabled","click"],[1,"dds-icon","dds-icon_plus__l__stroke","btnn"],[1,"taxt-audit-popup","popup",2,"min-width","642px"],[1,"popup-header"],["class","createExpressionList-form",4,"ngFor","ngForOf"],[1,"createExpressionList-form"],["formControlName","sourceFieldName","oninput","this.value = this.value.replace(/[^0-9a-zA-Z_ ]/g, '').replace(/(\\..*)\\./g, '$1');","placeholder","Column Name",1,"form-control",3,"ngClass","value","select","click","keyup"],[1,"flex-list"],["type","checkbox","formControlName","excludeInSelect","name","where"],["appearance","fill",1,""],["placeholder","Select DataType","formControlName","columnType",1,"form-control",3,"value","ngClass","disabled","selectionChange"],["class","col-md-6",4,"ngIf"],["cols","20","rows","10","placeholder","Expression","formControlName","sourceExpressionName","name","Expression","id","",1,"form-control",3,"ngClass","value","select","click","keyup"],[1,"dropdown","col-md-3"],["id","toggleButton",1,"button-set"],["toggleButton",""],["mat-button","",1,"functions-button",3,"click"],["src","../../assets/images/fletter.svg","width","18px","alt",""],["class","dropdown-content scroll","id","menu",4,"ngIf"],[1,"button-set"],["mat-button","","type","buttion",3,"click"],["class","dropdown-content drop-column scroll",4,"ngIf"],["type","button",1,"mat-button",3,"click"],["mat-button","","class","btnn",3,"click",4,"ngIf"],["mat-button","","class","primary",3,"click",4,"ngIf"],["placeholder","Select DateFormat","formControlName","columnFormat",1,"form-control"],["id","menu",1,"dropdown-content","scroll"],["menu",""],[1,"search"],["id","form1","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],["style","\n                          border-bottom: 1px solid #000;\n                          border-radius: 0;\n                          padding: 0;\n                        ",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #000","border-radius","0","padding","0"],[1,"dropdown-content","drop-column","scroll"],["multi","","is-open","true",1,""],[1,"",3,"click"],["id","form1","value","","placeholder","Search",1,"form-control",3,"value","keyup"],["class","","style","cursor: pointer",4,"ngFor","ngForOf"],[1,"",2,"cursor","pointer"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"margin-right","10px"],["multi","","class","","is-open","true",4,"ngIf"],[1,"taxt_audit-report","enableUploadSQLPopup"],[1,"popup-body",2,"padding-bottom","0px !important"],[1,"script-upload"],["for","sqlTxtFile",1,"button"],["type","file","id","sqlTxtFile",2,"display","none",3,"change"],["mat-input","","type","name","formControlName","sqlScript","name","s",1,"form-control","script-area",3,"ngClass"],["mat-button","",2,"color","#0076a8","background","#fff",3,"click"],[1,"but","script-upload"],["mat-input","","type","name","formControlName","gscript","name","m",1,"form-control",2,"background-color","#000 !important",3,"ngClass"],[1,"taxt-audit-popup",2,"min-width","475px"],[1,"message-inner"],["class","delete-message",4,"ngIf"],[1,"dds-icon","dds-icon_delete__l__stroke"],[1,"delete-message"],[1,"taxt-audit-popup",2,"min-width","960px"],["mat-button","",1,"close",3,"click"],[1,"table-container","spreadsheet-table"],[1,"popup-footer"],[1,"spacer"],["formArrayName","targetFileList"],["type","text","name","first","formControlName","newColumnName",3,"ngClass"],["placeholder","Select DataType","formControlName","columnType",1,"form-control",3,"selectionChange"],["placeholder","Select Data Format","formControlName","dateFormat",1,"form-control",3,"selectionChange"],[1,"sort-btn"],[1,"dds-icon",3,"ngClass"],[1,"sort-default"],["style","width: 120px; word-break: break-all",4,"ngFor","ngForOf"],[2,"width","120px","word-break","break-all"],["mat-button","","type","submit",1,"primary",3,"click"],["mat-input","","type","name","cols","50","formControlName","sqlScript","name","s",1,"form-control","script-area",2,"min-height","60vh","width","100%","margin-bottom","0px",3,"ngClass"],["type","name","name","s",2,"color","red",3,"disabled"],["appearance","fill",2,"margin-left","auto","margin-right","20px"],["placeholder","Select Script Type",1,"form-control","reflect-model",3,"value","selectionChange"],[1,"find-block"],["type","text","formControlName","findAll",1,"form-control","reflect-model"],["type","text","formControlName","replaceAll",1,"form-control","reflect-model"],[1,"select-items-group"],[1,"select-item"],["type","checkbox","id","pBiDesktop","name","genericitem",3,"checked","click"],["for","pBiDesktop"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul")(3,"li"),e._uU(4,"Solutions Board"),e.qZA(),e.YNc(5,ip,3,0,"ng-container",2),e.YNc(6,op,3,0,"ng-container",2),e.TgZ(7,"li"),e._uU(8),e.qZA()()()(),e.TgZ(9,"div",3)(10,"mat-tab-group",4),e.NdJ("selectedIndexChange",function(a){return o.selectedTab=a}),e.TgZ(11,"mat-tab"),e.YNc(12,rp,3,1,"ng-template",5),e.YNc(13,Zp,52,13,"ng-container",2),e.qZA(),e.TgZ(14,"mat-tab"),e.YNc(15,Pp,3,1,"ng-template",5),e.YNc(16,fu,10,3,"mat-card",2),e.qZA(),e.TgZ(17,"mat-tab"),e.YNc(18,mu,3,1,"ng-template",5),e.YNc(19,Cu,33,4,"ng-container",2),e.qZA(),e.TgZ(20,"mat-tab"),e.YNc(21,Tu,3,1,"ng-template",5),e.YNc(22,Zu,52,4,"ng-container",2),e.qZA(),e.TgZ(23,"mat-tab"),e.YNc(24,Pu,3,1,"ng-template",5),e.YNc(25,ju,62,9,"ng-container",2),e.qZA(),e.TgZ(26,"mat-tab"),e.YNc(27,ef,3,1,"ng-template",5),e.YNc(28,wf,40,6,"mat-card",2),e.qZA()()(),e.YNc(29,Sf,26,7,"div",2),e.YNc(30,qf,15,6,"div",2),e.YNc(31,Qf,23,5,"div",2),e.YNc(32,Yf,20,5,"div",2),e.YNc(33,Gm,52,17,"div",2),e.YNc(34,lh,19,2,"div",2),e.YNc(35,wh,27,6,"div",2),e.YNc(36,f0,11,3,"div",2),e.YNc(37,g0,12,2,"div",2),e.YNc(38,C0,12,2,"div",2),e.YNc(39,b0,18,2,"div",2),e.YNc(40,y0,22,4,"div",2),e.YNc(41,k0,23,5,"div",2),e.YNc(42,H0,24,9,"div",6),e.YNc(43,Y0,19,4,"div",2),e.YNc(44,V0,15,2,"div",2),e.YNc(45,j0,15,4,"div",2),e.YNc(46,t1,12,1,"div",2)),2&t&&(e.xp6(5),e.Q6J("ngIf",o.process.processId),e.xp6(1),e.Q6J("ngIf",null==o.process.processId||null==o.process.processId),e.xp6(2),e.hij("Process Name: ",o.process.processName,""),e.xp6(2),e.Q6J("selectedIndex",o.selectedTab),e.xp6(3),e.Q6J("ngIf",0==o.tabs[0].id&&1==o.tabs[0].isActive),e.xp6(3),e.Q6J("ngIf",1==o.tabs[1].id&&1==o.tabs[1].isActive),e.xp6(3),e.Q6J("ngIf",2==o.tabs[2].id&&1==o.tabs[2].isActive),e.xp6(3),e.Q6J("ngIf",3==o.tabs[3].id&&1==o.tabs[3].isActive),e.xp6(3),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(3),e.Q6J("ngIf",5==o.tabs[5].id&&1==o.tabs[5].isActive),e.xp6(1),e.Q6J("ngIf",o.ScenarioPopup),e.xp6(1),e.Q6J("ngIf",o.progressBarPopup),e.xp6(1),e.Q6J("ngIf",o.enableAppendNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableDatasetAppendPopup),e.xp6(1),e.Q6J("ngIf",o.enableDataSetPopUp),e.xp6(1),e.Q6J("ngIf",o.saveDataSetPopup),e.xp6(1),e.Q6J("ngIf",o.enableMergeNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableCreateExpression),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQL),e.xp6(1),e.Q6J("ngIf",o.enableUploadPython),e.xp6(1),e.Q6J("ngIf",o.enableViewscriptPopup),e.xp6(1),e.Q6J("ngIf",o.enableDeletePopup),e.xp6(1),e.Q6J("ngIf",o.enableDatasetAppendPopup),e.xp6(1),e.Q6J("ngIf",o.showTargetFilePopup),e.xp6(1),e.Q6J("ngIf",o.enableViewScriptDSPopup),e.xp6(1),e.Q6J("ngIf",o.enableAppendDatasetError),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQLPython),e.xp6(1),e.Q6J("ngIf",o.clickContinueInDM))},directives:[be.O5,_o.SP,_o.uX,_o.uD,be.mk,w._Y,w.JL,w.sg,ir,Ln.KE,hi.gD,w.JJ,w.u,be.sg,Et.ey,w.Fj,Ze.lW,lt.pp,lt.ib,lt.yz,lt.yK,lt.u4,lt.HS,w.Wl,Se.a8,W_,Ne.BZ,Ri.YE,Ne.w1,Ne.fO,Ne.ge,w.On,Ne.Dz,Ne.ev,Ri.nU,Ne.as,Ne.XQ,Ne.nj,Ne.Gk,gt.Rr,zr.Hw,z_.OP,w.CE,w.x0,Ln.R9,Ls.oG,Qi.Nt],pipes:[Is],styles:[".info[_ngcontent-%COMP%]{float:right;border-radius:43%;font-size:26px;color:#fff;background-color:#0076a8}.completed[_ngcontent-%COMP%]{background-color:#0ff}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}tr.example-detail-row[_ngcontent-%COMP%]{height:0}.inner-table[_ngcontent-%COMP%]{width:100%}.inner-table[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-top:15px;width:100%}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:#777}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.progress[_ngcontent-%COMP%]{margin-top:40px}"],data:{animation:[(0,Qn.X$)("detailExpand",[(0,Qn.SB)("collapsed",(0,Qn.oB)({height:"0px",minHeight:"0"})),(0,Qn.SB)("expanded",(0,Qn.oB)({height:"*"})),(0,Qn.eR)("expanded <=> collapsed",(0,Qn.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),n})();var o1=ce(9677);function r1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21)(2,"mat-card",22)(3,"div",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().selectISP(1,"Industry: Consumer and Industrial Products")}),e.TgZ(4,"div",24),e._UZ(5,"span",25),e.qZA(),e.TgZ(6,"mat-card-subtitle",26),e._uU(7," Consumer and Industrial Products"),e.qZA()()()(),e.TgZ(8,"div",21)(9,"mat-card",22)(10,"div",24),e._UZ(11,"span",27),e.qZA(),e.TgZ(12,"mat-card-subtitle",26),e._uU(13,"Financial Services "),e.qZA()()(),e.TgZ(14,"div",21)(15,"mat-card",22)(16,"div",24),e._UZ(17,"span",28),e.qZA(),e.TgZ(18,"mat-card-subtitle",26),e._uU(19,"Public Sector "),e.qZA()()(),e.TgZ(20,"div",21)(21,"mat-card",22)(22,"div",24),e._UZ(23,"span",25),e.qZA(),e.TgZ(24,"mat-card-subtitle",26),e._uU(25,"Consumer and Industrial Products"),e.qZA()()(),e.TgZ(26,"div",21)(27,"mat-card",22)(28,"div",24),e._UZ(29,"span",27),e.qZA(),e.TgZ(30,"mat-card-subtitle",26),e._uU(31,"Financial Services "),e.qZA()()(),e.TgZ(32,"div",21)(33,"mat-card",22)(34,"div",24),e._UZ(35,"span",28),e.qZA(),e.TgZ(36,"mat-card-subtitle",26),e._uU(37,"Public Sector "),e.qZA()()(),e.TgZ(38,"div",21)(39,"mat-card",22)(40,"div",24),e._UZ(41,"span",25),e.qZA(),e.TgZ(42,"mat-card-subtitle",26),e._uU(43,"Consumer and Industrial Products"),e.qZA()()(),e.TgZ(44,"div",21)(45,"mat-card",22)(46,"div",24),e._UZ(47,"span",27),e.qZA(),e.TgZ(48,"mat-card-subtitle",26),e._uU(49,"Financial Services "),e.qZA()()(),e.TgZ(50,"div",21)(51,"mat-card",22)(52,"div",24),e._UZ(53,"span",28),e.qZA(),e.TgZ(54,"mat-card-subtitle",26),e._uU(55,"Public Sector "),e.qZA()()(),e.TgZ(56,"div",21)(57,"mat-card",22)(58,"div",24),e._UZ(59,"span",28),e.qZA(),e.TgZ(60,"mat-card-subtitle",26),e._uU(61,"Public Sector "),e.qZA()()(),e.TgZ(62,"div",21)(63,"mat-card",22)(64,"div",24),e._UZ(65,"span",28),e.qZA(),e.TgZ(66,"mat-card-subtitle",26),e._uU(67,"Public Sector "),e.qZA()()()()}}function a1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"div",21)(2,"mat-card",22)(3,"div",23),e.NdJ("click",function(){return e.CHM(t),e.oxw().selectISP(2,"Sector: Automotive")}),e.TgZ(4,"div",24),e._UZ(5,"span",30),e.qZA(),e.TgZ(6,"mat-card-subtitle",26),e._uU(7," Automotive "),e.qZA()()()(),e.TgZ(8,"div",21)(9,"mat-card",22)(10,"div",24),e._UZ(11,"span",25),e.qZA(),e.TgZ(12,"mat-card-subtitle",26),e._uU(13,"Consumer Products "),e.qZA()()(),e.TgZ(14,"div",21)(15,"mat-card",22)(16,"div",24),e._UZ(17,"span",31),e.qZA(),e.TgZ(18,"mat-card-subtitle",26),e._uU(19,"Industrial Products and Services "),e.qZA()()(),e.TgZ(20,"div",21)(21,"mat-card",22)(22,"div",24),e._UZ(23,"span",25),e.qZA(),e.TgZ(24,"mat-card-subtitle",26),e._uU(25,"Retail Whole sale and Distribution "),e.qZA()()(),e.TgZ(26,"div",21)(27,"mat-card",22)(28,"div",24),e._UZ(29,"span",27),e.qZA(),e.TgZ(30,"mat-card-subtitle",32),e._uU(31,"Chemicals and Speciality Materials "),e.qZA()()(),e.TgZ(32,"div",21)(33,"mat-card",22)(34,"div",24),e._UZ(35,"span",28),e.qZA(),e.TgZ(36,"mat-card-subtitle",26),e._uU(37,"Public Sector "),e.qZA()()(),e.TgZ(38,"div",21)(39,"mat-card",22)(40,"div",24),e._UZ(41,"span",25),e.qZA(),e.TgZ(42,"mat-card-subtitle",26),e._uU(43,"Consumer and Industrial "),e.qZA()()(),e.TgZ(44,"div",21)(45,"mat-card",22)(46,"div",24),e._UZ(47,"span",27),e.qZA(),e.TgZ(48,"mat-card-subtitle",26),e._uU(49,"Financial Services "),e.qZA()()(),e.TgZ(50,"div",21)(51,"mat-card",22)(52,"div",24),e._UZ(53,"span",28),e.qZA(),e.TgZ(54,"mat-card-subtitle",26),e._uU(55,"Public Sector "),e.qZA()()()()}}function s1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"div",21)(2,"mat-card",22)(3,"div",33),e.NdJ("click",function(){return e.CHM(t),e.oxw().selectISP(3,"Add Process: Record to Report")}),e.TgZ(4,"div",24),e._UZ(5,"span",34),e.qZA(),e.TgZ(6,"mat-card-subtitle",26),e._uU(7," Add Process "),e.qZA()()()()()}}let l1=(()=>{class n{constructor(){this.selectedIndexISP=0,this.links=[{name:"Select Industry",isActive:!0,selectedIndex:0},{name:"Select Sector",isActive:!1,selectedIndex:1},{name:"Add Process",isActive:!1,selectedIndex:2}],this.activeLink=this.links[0],this.createSolutionDetails=[]}ngOnInit(){}selectISP(t,o){this.selectedIndexISP=t,console.log(this.createSolutionDetails)}tabChanged(t){this.selectedIndexISP=t.index}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-solution-board"]],decls:49,vars:4,consts:[[1,"heading"],[2,"color","#0076A8"],[1,"container"],[1,"row","no-gutters"],[1,"col",2,"margin-left","5px"],[1,"cards"],[3,"selectedIndex","selectedTabChange"],["label","Select Industry"],["label","Select Sector"],["label","Add Process"],["class","row scroll",4,"ngIf"],["class","row",4,"ngIf"],[1,"col"],[1,"main"],[1,"table","table-striped"],[2,"background-color","#041E42","color","white"],["scope","col"],[1,"col-sm-4",2,"float","right","margin","5% 0 5% 0"],["mat-button","",2,"width","40%","height","35px","color","#0076A8","border-color","#0076A8"],["mat-button","","routerLink","/user/admin1/user-management",2,"width","40%","height","35px","background-color","#0076A8","color","white"],[1,"row","scroll"],[1,"col-sm-4"],[1,"example-card"],[3,"click"],[2,"text-align","center","font-size","40px","color","#005587","padding","6px 0px 0px 0px"],[1,"dds-icon","dds-icon_user__l__stroke"],[2,"padding","12px","text-align","center","font-size","12px","margin-top","-16px"],[1,"dds-icon","dds-icon_money__s__filled"],[1,"dds-icon","dds-icon_users__l__stroke"],[1,"row"],[1,"dds-icon","dds-icon_sun__l__stroke"],[1,"dds-icon","dds-icon_folder__l__stroke"],[2,"padding","11px","text-align","center","font-size","12px","margin-top","-16px"],["routerLink","/user/admin1/add-process",3,"click"],[1,"dds-icon","dds-icon_plus__l__stroke"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Solution Board"),e.qZA(),e.TgZ(3,"h5")(4,"span",1),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6," Solution Board / Create New Solution"),e.qZA()(),e.TgZ(7,"div",2)(8,"div",3)(9,"div",4)(10,"mat-card")(11,"div",5)(12,"div")(13,"mat-tab-group",6),e.NdJ("selectedTabChange",function(a){return o.tabChanged(a)}),e.TgZ(14,"mat-tab",7),e._uU(15," Select Industry "),e.qZA(),e.TgZ(16,"mat-tab",8),e._uU(17," Select Sector "),e.qZA(),e.TgZ(18,"mat-tab",9),e._uU(19," Add Process "),e.qZA()(),e._UZ(20,"div"),e.qZA()(),e.YNc(21,r1,68,0,"div",10),e.YNc(22,a1,56,0,"div",11),e.YNc(23,s1,8,0,"div",11),e.qZA()(),e.TgZ(24,"div",12)(25,"mat-card")(26,"div")(27,"div",13)(28,"table",14)(29,"thead")(30,"tr",15)(31,"th",16),e._uU(32,"Create Solution Details"),e.qZA()()(),e.TgZ(33,"tbody")(34,"tr")(35,"td"),e._uU(36," Industry: Consumer and Industrial Products"),e.qZA()(),e.TgZ(37,"tr")(38,"td"),e._uU(39,"Sector: Automotive"),e.qZA()(),e.TgZ(40,"tr")(41,"td"),e._uU(42,"Process: Record to Report"),e.qZA()()()()()(),e.TgZ(43,"div",17)(44,"button",18),e._uU(45,"Reset"),e.qZA(),e._uU(46," \xa0 \xa0 "),e.TgZ(47,"button",19),e._uU(48,"Next"),e.qZA()()()()()()),2&t&&(e.xp6(13),e.Q6J("selectedIndex",o.selectedIndexISP),e.xp6(8),e.Q6J("ngIf",0==o.selectedIndexISP),e.xp6(1),e.Q6J("ngIf",1==o.selectedIndexISP),e.xp6(1),e.Q6J("ngIf",2==o.selectedIndexISP))},directives:[Se.a8,_o.SP,_o.uX,be.O5,Se.$j,fe.rH,Ze.lW],styles:[".mat-card[_ngcontent-%COMP%]{height:33rem;border-radius:0;margin-bottom:10px;padding:0;box-shadow:0 -1px 6px 1px #cccaca}.example-card[_ngcontent-%COMP%]{max-width:700px;height:7rem;margin:15px}.container[_ngcontent-%COMP%]{margin-top:5%}.heading[_ngcontent-%COMP%]{background-color:#fff;color:#000;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:25px;font-weight:600}h5[_ngcontent-%COMP%]{font-size:15px}.cards[_ngcontent-%COMP%]{display:flex}.part1[_ngcontent-%COMP%]{width:70%;height:58px;padding:10px 10px 10px 13px}.part2[_ngcontent-%COMP%]{width:30%;height:96px;padding:35px 10px 10px 20px}h3[_ngcontent-%COMP%]{border-width:7px;margin:0 -13px 16px;padding-left:10px;font-size:16px}form[_ngcontent-%COMP%]{padding:35px}.row[_ngcontent-%COMP%]{padding-bottom:20px}.row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}.scroll[_ngcontent-%COMP%]{max-height:435px;overflow-y:scroll}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}"]}),n})();var c1=ce(6260),Hi=ce(8896),ti=ce(3144);function d1(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().addProject(a)}),e.TgZ(2,"p"),e._uU(3),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(3),e.hij(" ",t.processName," ")}}function _1(n,r){1&n&&(e.TgZ(0,"div")(1,"div",22)(2,"div",23)(3,"div",24),e._UZ(4,"h4",25),e.qZA(),e.TgZ(5,"div",26)(6,"h3"),e._uU(7,"Project Created Successfully !"),e.qZA(),e._UZ(8,"div",27),e.qZA(),e.TgZ(9,"div",28)(10,"button",29),e._uU(11,"Ok"),e.qZA()()()()())}const p1=function(n){return{"is-invalid":n}};let u1=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u){this.loader=t,this.Users_service=o,this.Master=i,this.solution=a,this._sanitizer=s,this.toast=l,this.router=c,this.route=d,this.popup=_,this.formbuilder=u,this.flag=!0,this.submited=!1}ngOnInit(){this.projectForm=this.formbuilder.group({processname:[""],projectname:["",w.kI.required],standalone:[""]}),this.getprocessbyid(),this.CreationData=JSON.parse(this.route.snapshot.paramMap.get("createproject")||""),console.log(this.CreationData)}getprocessbyid(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(t,t.userId),this.Users_service.getprocessbyid(t.userId,1).subscribe(o=>{this.processes=o.responseData,console.log(this.processes),this.userProcess=[],""!=this.CreationData&&(this.processdetails=this.CreationData,this.processName=this.CreationData.processName),this.AllProcess.forEach(i=>{o.responseData.forEach(a=>{a.processId==i.processId&&this.userProcess.push(i)})}),this.loader.hide(),console.log("userid process",this.userProcess,this.processes)})}addProject(t){this.processdetails=t,console.log(t),this.processName=t.processName}success(t){this.AddEventProceeding=!0,this.addEventIndex=t}CloseModal(){this.AddEventProceeding=!1}createProject(){}projectSubmit(){if(this.loader.show(),this.submited=!0,this.projectForm.invalid)return console.log(this.projectForm),void this.toast.error({title:"Error",message:"Enter All the Required Fields"});let t;this.processes.forEach(i=>{i.processId==this.processdetails.processId&&(localStorage.setItem("projectProcess",JSON.stringify(i.processId)),t=this.processdetails.orgsolnId)});let o={projectName:this.projectForm.value.projectname,executionType:this.projectForm.value.standalone?"S":"I",processName:this.processName};this.processes.forEach(i=>{this.processName==i.processName&&(o.organizationSolutionId=i.orgsolnId)}),console.log(o),this.solution.createProject(o).subscribe(i=>{console.log(i),this.toast.success({title:"Success",message:"Project created successfully !"}),localStorage.setItem("project",JSON.stringify(i.responseData)),this.AddEventProceeding=!0,this.loader.hide(),this.router.navigate(["/user/admin1/view-download1"])},i=>{this.loader.hide(),this.toast.error({title:"Error",message:i.statusMessage})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Nn.D),e.Y36(Hi.f),e.Y36(Hn.R),e.Y36(Jt.e),e.Y36(qi.H7),e.Y36(ti.q),e.Y36(fe.F0),e.Y36(fe.gz),e.Y36(Fn.q),e.Y36(w.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-project"]],decls:48,vars:7,consts:[[1,"heading"],[1,"consen"],[1,"row","sec"],[1,"col-md-6"],[1,"dlob"],[1,"header"],[1,""],[1,"row","container","sec1"],["class","col-md-4 sub",4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit"],[1,"col-sm-8",2,"display","flex","padding-top","20px","margin-left","20px"],["type","text","formControlName","processname","readonly","",1,"form-control","reflect-model",3,"value"],[1,"col-sm-8",2,"display","flex","margin-left","20px"],["type","text","formControlName","projectname","oninput","this.value = this.value.replace(/[^a-zA-Z10-9 ]/g, '').replace(/(\\..*)\\./g, '$1');","maxlength","50",1,"form-control","reflect-model",3,"ngClass"],[1,"col-sm-12",2,"display","flex","text-align","center","margin-left","130px"],["formControlName","standalone"],[1,"col-sm-12","button"],["mat-button","","type","reset",1,"reset"],["mat-button","","type","submit",1,"submit"],[4,"ngIf"],[1,"col-md-4","sub"],[1,"card",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px","height","34px","margin-bottom","20px"],[2,"text-align","center"],[1,"dds-icon","dds-icon_check","next",2,"border-radius","100%"],[1,"col-sm-4",2,"float","right","margin","5% 22% 5% 0"],["mat-button","",2,"width","40%","height","35px","background-color","#0076A8","color","white","border-radius","0","margin-top","42px"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Create Project"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"mat-card")(7,"div")(8,"div",4)(9,"div",5)(10,"h3"),e._uU(11,"Select Process"),e.qZA()(),e.TgZ(12,"div",6)(13,"div",7),e.YNc(14,d1,4,1,"div",8),e.qZA()()()()()(),e.TgZ(15,"div",3)(16,"mat-card")(17,"div")(18,"div",4)(19,"form",9),e.NdJ("ngSubmit",function(){return o.projectSubmit()}),e.TgZ(20,"div",5)(21,"h3"),e._uU(22,"Create Project Details"),e.qZA()(),e.TgZ(23,"div",10)(24,"label"),e._uU(25,"Process"),e.TgZ(26,"sup"),e._uU(27,"*"),e.qZA()(),e._UZ(28,"input",11),e.qZA(),e._UZ(29,"br"),e.TgZ(30,"div",12)(31,"label"),e._uU(32,"Enter Project Name"),e.TgZ(33,"sup"),e._uU(34,"*"),e.qZA()(),e._UZ(35,"input",13),e.qZA(),e.TgZ(36,"div",14)(37,"label"),e._uU(38,"Incremental"),e.qZA(),e._UZ(39,"mat-slide-toggle",15),e.TgZ(40,"label"),e._uU(41,"Standalone"),e.qZA()(),e.TgZ(42,"div",16)(43,"button",17),e._uU(44,"Reset"),e.qZA(),e.TgZ(45,"button",18),e._uU(46,"Create Project"),e.qZA()()()()()()()()(),e.YNc(47,_1,12,0,"div",19)),2&t&&(e.xp6(14),e.Q6J("ngForOf",o.processes),e.xp6(5),e.Q6J("formGroup",o.projectForm),e.xp6(9),e.s9C("value",o.processName),e.xp6(7),e.Q6J("ngClass",e.VKq(5,p1,o.submited&&o.projectForm.controls.projectname.errors)),e.xp6(12),e.Q6J("ngIf",o.AddEventProceeding))},directives:[Se.a8,be.sg,w._Y,w.JL,w.sg,w.Fj,w.JJ,w.u,w.nD,be.mk,gt.Rr,Ze.lW,be.O5],styles:[".mat-card[_ngcontent-%COMP%]{border-radius:0;margin-bottom:10px;padding:0;height:100%;background-color:#fff;box-shadow:0 -1px 6px 1px #cccaca}.dlob[_ngcontent-%COMP%]   .col-sm-12[_ngcontent-%COMP%]{padding:5px 10px}.dlob[_ngcontent-%COMP%]   .col-sm-12[_ngcontent-%COMP%]:first-child{padding:10px 10px 5px}.dlob[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{float:left;width:170px;font-family:open_sans-regular;font-size:14px;line-height:18px;padding:3px 5px 0 0}.dlob[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{float:left;border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px;width:calc(100% - 170px)}.dlob[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.dlob[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.dlob[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.dlob[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.button[_ngcontent-%COMP%]{margin:20px 0 0;top:60px;text-align:right;float:left;width:100%}.button[_ngcontent-%COMP%]   .reset[_ngcontent-%COMP%]{color:#0076a8;border:1px solid #0076A8;border-radius:0;margin:24px 0 20px 15px!important;background-color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:12px 0;min-height:36px;transition:all .5s cubic-bezier(.77,0,.175,1)}.button[_ngcontent-%COMP%]   .reset[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important}.button[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{border-radius:0;border:0;margin:24px 0 20px 15px!important;background-color:#0076a8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:12px 0;min-height:36px;transition:all .5s cubic-bezier(.77,0,.175,1)}.button[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important}.container[_ngcontent-%COMP%]{margin-top:1%}.page[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:10px}.proc[_ngcontent-%COMP%]{margin-left:20px}.sec[_ngcontent-%COMP%]{height:70vh}.sec1[_ngcontent-%COMP%]{margin:0}.sec1[_ngcontent-%COMP%]   .sub[_ngcontent-%COMP%]{padding:12px 8px;display:table;width:150px;height:150px}.sec1[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{margin:0;padding:20px;text-align:center;display:table-cell;height:100%;vertical-align:middle;border-radius:0;box-shadow:inset 0 2px 4px #00000029,0 10px 10px #0000001a}.sec1[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0;font-size:15px;font-family:open_sans-medium}.sec1[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{background-color:#ddefe8}.sec1[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:auto;font-size:40px}.btn[_ngcontent-%COMP%]{border-radius:0;margin-bottom:10px;background-color:#0076a8;color:#fff;width:10%}.cards[_ngcontent-%COMP%]{display:flex}.tabs[_ngcontent-%COMP%]{display:inline-flex}.tab[_ngcontent-%COMP%]{display:flex;margin-right:1px;padding:5px 0;text-align:center;width:100px;align-items:center}.tab[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:0!important;margin:auto}.tab[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-left:0!important;margin:auto}.tab.act[_ngcontent-%COMP%]{color:#fff;background-color:#0076a8}.tab.inact[_ngcontent-%COMP%]{color:#000;background-color:#eaeaea}.fin[_ngcontent-%COMP%]{padding:0;border-radius:0;margin:0 10px;background-color:#fff;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]{max-height:300px;overflow-y:scroll}.scroll[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.scroll[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.status[_ngcontent-%COMP%]{display:flex}.success[_ngcontent-%COMP%]{background-color:#86bc25;color:#fff;padding:10px}.succ[_ngcontent-%COMP%]{color:#86bc25;font-size:20px;margin:auto}.failure[_ngcontent-%COMP%]{background-color:#da291c;color:#fff;padding:10px}.fail[_ngcontent-%COMP%]{color:#da291c;font-size:20px;margin:auto}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.head[_ngcontent-%COMP%]{padding:10px 0 10px 15px;color:#0076a8}.head[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:24px}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.middle[_ngcontent-%COMP%]{height:600px;margin-top:20px;padding:10px 10px 10px 13px}.part1[_ngcontent-%COMP%]{width:80%;height:58px;padding:10px 10px 10px 13px}.part2[_ngcontent-%COMP%]{width:20%;height:100px;padding:23px 10px 10px 5px}.row[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#0076a8}h3[_ngcontent-%COMP%]{border-left-style:solid;border-width:7px;margin:0 -13px 16px;padding-left:10px;font-size:20px}.part2[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:50px;color:#fff!important}.form-check-input[_ngcontent-%COMP%]{font-size:25px;border-radius:0}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0076a8;border-color:#0076a8}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}.row[_ngcontent-%COMP%]{padding-bottom:20px}.row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}select[_ngcontent-%COMP%]{width:100%;height:36px}.icon_style[_ngcontent-%COMP%]{color:#005587;font-size:26px;font-weight:700}.taxt-audit-popup[_ngcontent-%COMP%]{width:550px}.dds-icon_check[_ngcontent-%COMP%]{font-size:60px;color:#005587}.check-off[_ngcontent-%COMP%]{color:gray;border-radius:50%;border:none;background:LightGrey;height:30px;width:30px}.check-on[_ngcontent-%COMP%]{color:#fff;background-color:green;border-radius:50%;border:none;height:30px;width:30px}.na-off[_ngcontent-%COMP%]{color:gray;border:none;background:transparent;height:30px;width:30px}.na-on[_ngcontent-%COMP%]{border-radius:50%;background-color:#f5f5f5;border:1px solid grey;height:30px;width:30px}.deny-off[_ngcontent-%COMP%]{background-color:#d3d3d3;color:gray;height:30px;width:30px;border-radius:50%;border:none}.deny-on[_ngcontent-%COMP%]{color:#fff;background-color:red;border-radius:50%;border:none;height:30px;width:30px}.header[_ngcontent-%COMP%]{width:100%;height:45px;background-color:#0076a8}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;line-height:24px;color:#fff;padding:10px 15px;font-family:open_sans-regular}.next[_ngcontent-%COMP%]{position:absolute;top:45%;left:48%;font-size:38px;color:#0076a8;border:4px #0076A8 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:45px;width:45px}sup[_ngcontent-%COMP%]{color:red}"]}),n})();var on=1200,gi=1252,f1=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gr={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},rr=function(n){-1!=f1.indexOf(n)&&(gi=Gr[0]=n)},un=function(n){on=n,rr(n)};function ar(){un(1200),function m1(){rr(1252)}()}function sr(n){for(var r=[],t=0,o=n.length;t<o;++t)r[t]=n.charCodeAt(t);return r}function Zs(n){for(var r=[],t=0;t<n.length>>1;++t)r[t]=String.fromCharCode(n.charCodeAt(2*t+1)+(n.charCodeAt(2*t)<<8));return r.join("")}var Re,Yi=function(n){var r=n.charCodeAt(0),t=n.charCodeAt(1);return 255==r&&254==t?function h1(n){for(var r=[],t=0;t<n.length>>1;++t)r[t]=String.fromCharCode(n.charCodeAt(2*t)+(n.charCodeAt(2*t+1)<<8));return r.join("")}(n.slice(2)):254==r&&255==t?Zs(n.slice(2)):65279==r?n.slice(1):n},fo=function(r){return String.fromCharCode(r)},Xr=function(r){return String.fromCharCode(r)},ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ho(n){for(var r="",t=0,o=0,i=0,a=0,s=0,l=0,c=0,d=0;d<n.length;)a=(t=n.charCodeAt(d++))>>2,s=(3&t)<<4|(o=n.charCodeAt(d++))>>4,l=(15&o)<<2|(i=n.charCodeAt(d++))>>6,c=63&i,isNaN(o)?l=c=64:isNaN(i)&&(c=64),r+=ni.charAt(a)+ni.charAt(s)+ni.charAt(l)+ni.charAt(c);return r}function rn(n){var r="",a=0,s=0,l=0,c=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<n.length;)a=ni.indexOf(n.charAt(d++)),s=ni.indexOf(n.charAt(d++)),r+=String.fromCharCode(a<<2|s>>4),64!==(l=ni.indexOf(n.charAt(d++)))&&(r+=String.fromCharCode((15&s)<<4|l>>2)),64!==(c=ni.indexOf(n.charAt(d++)))&&(r+=String.fromCharCode((3&l)<<6|c));return r}var Ee=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),Vn=function(){if("undefined"!=typeof Buffer){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch(r){n=!0}return n?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function ii(n){return Ee?Buffer.alloc?Buffer.alloc(n):new Buffer(n):"undefined"!=typeof Uint8Array?new Uint8Array(n):new Array(n)}function Ps(n){return Ee?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):"undefined"!=typeof Uint8Array?new Uint8Array(n):new Array(n)}var an=function(r){return Ee?Vn(r,"binary"):r.split("").map(function(t){return 255&t.charCodeAt(0)})};function oi(n){if(Array.isArray(n))return n.map(function(o){return String.fromCharCode(o)}).join("");for(var r=[],t=0;t<n.length;++t)r[t]=String.fromCharCode(n[t]);return r.join("")}function jr(n){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(n instanceof ArrayBuffer)return jr(new Uint8Array(n));for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=n[t];return r}var kt=Ee?function(n){return Buffer.concat(n.map(function(r){return Buffer.isBuffer(r)?r:Vn(r)}))}:function(n){if("undefined"!=typeof Uint8Array){var r=0,t=0;for(r=0;r<n.length;++r)t+=n[r].length;var o=new Uint8Array(t),i=0;for(r=0,t=0;r<n.length;t+=i,++r)if(i=n[r].length,n[r]instanceof Uint8Array)o.set(n[r],t);else{if("string"==typeof n[r])throw"wtf";o.set(new Uint8Array(n[r]),t)}return o}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))},qt=/\u0000/g,xo=/[\u0001-\u0006]/g;function Vi(n){for(var r="",t=n.length-1;t>=0;)r+=n.charAt(t--);return r}function An(n,r){var t=""+n;return t.length>=r?t:_t("0",r-t.length)+t}function ea(n,r){var t=""+n;return t.length>=r?t:_t(" ",r-t.length)+t}function lr(n,r){var t=""+n;return t.length>=r?t:t+_t(" ",r-t.length)}var Os=Math.pow(2,32);function $i(n,r){return n>Os||n<-Os?function v1(n,r){var t=""+Math.round(n);return t.length>=r?t:_t("0",r-t.length)+t}(n,r):function C1(n,r){var t=""+n;return t.length>=r?t:_t("0",r-t.length)+t}(Math.round(n),r)}function cr(n,r){return n.length>=7+(r=r||0)&&103==(32|n.charCodeAt(r))&&101==(32|n.charCodeAt(r+1))&&110==(32|n.charCodeAt(r+2))&&101==(32|n.charCodeAt(r+3))&&114==(32|n.charCodeAt(r+4))&&97==(32|n.charCodeAt(r+5))&&108==(32|n.charCodeAt(r+6))}var Us=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ta=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],we={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Bs={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},b1={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function dr(n,r,t){for(var o=n<0?-1:1,i=n*o,a=0,s=1,l=0,c=1,d=0,_=0,u=Math.floor(i);d<r&&(l=(u=Math.floor(i))*s+a,_=u*d+c,!(i-u<5e-8));)i=1/(i-u),a=s,s=l,c=d,d=_;if(_>r&&(d>r?(_=c,l=a):(_=d,l=s)),!t)return[0,o*l,_];var f=Math.floor(o*l/_);return[f,o*l-f*_,_]}function ri(n,r,t){if(n>2958465||n<0)return null;var o=0|n,i=Math.floor(86400*(n-o)),a=0,s=[],l={D:o,T:i,u:86400*(n-o)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(o+=1462),l.u>.9999&&(l.u=0,86400==++i&&(l.T=i=0,++o,++l.D)),60===o)s=t?[1317,10,29]:[1900,2,29],a=3;else if(0===o)s=t?[1317,8,29]:[1900,1,0],a=6;else{o>60&&--o;var c=new Date(1900,0,1);c.setDate(c.getDate()+o-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),o<60&&(a=(a+6)%7),t&&(a=function D1(n,r){r[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=a,l}var Js=new Date(1899,11,31,0,0,0),w1=Js.getTime(),S1=new Date(1900,2,1,0,0,0);function qs(n,r){var t=n.getTime();return r?t-=1262304e5:n>=S1&&(t+=864e5),(t-(w1+6e4*(n.getTimezoneOffset()-Js.getTimezoneOffset())))/864e5}function na(n){return-1==n.indexOf(".")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vo(n){var t,r=Math.floor(Math.log(Math.abs(n))*Math.LOG10E);return t=r>=-4&&r<=-1?n.toPrecision(10+r):Math.abs(r)<=9?function A1(n){var r=n<0?12:11,t=na(n.toFixed(12));return t.length<=r||(t=n.toPrecision(10)).length<=r?t:n.toExponential(5)}(n):10===r?n.toFixed(10).substr(0,12):function y1(n){var r=na(n.toFixed(11));return r.length>(n<0?12:11)||"0"===r||"-0"===r?n.toPrecision(6):r}(n),na(function N1(n){return-1==n.indexOf("E")?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function xi(n,r){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(0|n)===n?n.toString(10):vo(n);case"undefined":return"";case"object":if(null==n)return"";if(n instanceof Date)return sn(14,qs(n,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+n)}function k1(n,r,t,o){var c,i="",a=0,s=0,l=t.y,d=0;switch(n){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4}break;case 109:switch(r.length){case 1:case 2:c=t.m,d=r.length;break;case 3:return ta[t.m-1][1];case 5:return ta[t.m-1][0];default:return ta[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,d=r.length;break;case 3:return Us[t.q][0];default:return Us[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,d=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,d=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,d=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(s=o>=2?3===o?1e3:100:1===o?10:1,(a=Math.round(s*(t.S+t.u)))>=60*s&&(a=0),"s"===r?0===a?"0":""+a/s:(i=An(a,2+o),"ss"===r?i.substr(0,2):"."+i.substr(2,r.length-1))):An(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":c=24*t.D+t.H;break;case"[m]":case"[mm]":c=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":c=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}d=3===r.length?1:2;break;case 101:c=l,d=1}return d>0?An(c,d):""}function ai(n){if(n.length<=3)return n;for(var t=n.length%3,o=n.substr(0,t);t!=n.length;t+=3)o+=(o.length>0?",":"")+n.substr(t,3);return o}var Rs=/%/g;function Qs(n,r){var t,o=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+Qs(n,-r);var i=n.indexOf(".");-1===i&&(i=n.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),-1===(t=(r/Math.pow(10,a)).toPrecision(o+1+(i+a)%i)).indexOf("e")){var s=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,_){return c+d+_.substr(0,(i+a)%i)+"."+_.substr(a)+"E"})}else t=r.toExponential(o);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Hs=/# (\?+)( ?)\/( ?)(\d+)/,Ys=/^#*0*\.([0#]+)/,Vs=/\).*[0#]/,$s=/\(###\) ###\\?-####/;function zt(n){for(var t,r="",o=0;o!=n.length;++o)switch(t=n.charCodeAt(o)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ks(n,r){var t=Math.pow(10,r);return""+Math.round(n*t)/t}function Ws(n,r){var t=n-Math.floor(n),o=Math.pow(10,r);return r<(""+Math.round(t*o)).length?0:Math.round(t*o)}function fn(n,r,t){if(40===n.charCodeAt(0)&&!r.match(Vs)){var o=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?fn("n",o,t):"("+fn("n",o,-t)+")"}if(44===r.charCodeAt(r.length-1))return function M1(n,r,t){for(var o=r.length-1;44===r.charCodeAt(o-1);)--o;return $n(n,r.substr(0,o),t/Math.pow(10,3*(r.length-o)))}(n,r,t);if(-1!==r.indexOf("%"))return function F1(n,r,t){var o=r.replace(Rs,""),i=r.length-o.length;return $n(n,o,t*Math.pow(10,2*i))+_t("%",i)}(n,r,t);if(-1!==r.indexOf("E"))return Qs(r,t);if(36===r.charCodeAt(0))return"$"+fn(n,r.substr(" "==r.charAt(1)?2:1),t);var i,a,s,l,c=Math.abs(t),d=t<0?"-":"";if(r.match(/^00+$/))return d+$i(c,r.length);if(r.match(/^[#?]+$/))return"0"===(i=$i(t,0))&&(i=""),i.length>r.length?i:zt(r.substr(0,r.length-i.length))+i;if(a=r.match(Hs))return function L1(n,r,t){var o=parseInt(n[4],10),i=Math.round(r*o),a=Math.floor(i/o),s=i-a*o,l=o;return t+(0===a?"":""+a)+" "+(0===s?_t(" ",n[1].length+1+n[4].length):ea(s,n[1].length)+n[2]+"/"+n[3]+An(l,n[4].length))}(a,c,d);if(r.match(/^#+0+$/))return d+$i(c,r.length-r.indexOf("0"));if(a=r.match(Ys))return i=Ks(t,a[1].length).replace(/^([^\.]+)$/,"$1."+zt(a[1])).replace(/\.$/,"."+zt(a[1])).replace(/\.(\d*)$/,function(h,p){return"."+p+_t("0",zt(a[1]).length-p.length)}),-1!==r.indexOf("0.")?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return d+Ks(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return d+ai($i(c,0));if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+fn(n,r,-t):ai(""+(Math.floor(t)+function E1(n,r){return r<(""+Math.round((n-Math.floor(n))*Math.pow(10,r))).length?1:0}(t,a[1].length)))+"."+An(Ws(t,a[1].length),a[1].length);if(a=r.match(/^#,#*,#0/))return fn(n,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Vi(fn(n,r.replace(/[\\-]/g,""),t)),s=0,Vi(Vi(r.replace(/\\/g,"")).replace(/[0#]/g,function(h){return s<i.length?i.charAt(s++):"0"===h?"0":""}));if(r.match($s))return"("+(i=fn(n,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var _="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=dr(c,Math.pow(10,s)-1,!1),i=""+d," "==(_=$n("n",a[1],l[1])).charAt(_.length-1)&&(_=_.substr(0,_.length-1)+"0"),i+=_+a[2]+"/"+a[3],(_=lr(l[2],s)).length<a[4].length&&(_=zt(a[4].substr(a[4].length-_.length))+_),i+=_;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),d+((l=dr(c,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?ea(l[1],s)+a[2]+"/"+a[3]+lr(l[2],s):_t(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return i=$i(t,0),r.length<=i.length?i:zt(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var u=r.indexOf(".")-s,f=r.length-i.length-u;return zt(r.substr(0,u)+i+r.substr(r.length-f))}if(a=r.match(/^00,000\.([#0]*0)$/))return s=Ws(t,a[1].length),t<0?"-"+fn(n,r,-t):ai(function Z1(n){return n<2147483647&&n>-2147483648?""+(n>=0?0|n:n-1|0):""+Math.floor(n)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?An(0,3-h.length):"")+h})+"."+An(s,a[1].length);switch(r){case"###,##0.00":return fn(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=ai($i(c,0));return"0"!==m?d+m:"";case"###,###.00":return fn(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return fn(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function zs(n,r){var t,o=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+zs(n,-r);var i=n.indexOf(".");-1===i&&(i=n.indexOf("E"));var a=Math.floor(Math.log(r)*Math.LOG10E)%i;if(a<0&&(a+=i),!(t=(r/Math.pow(10,a)).toPrecision(o+1+(i+a)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+a):t+="E+"+(s-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,_){return c+d+_.substr(0,(i+a)%i)+"."+_.substr(a)+"E"})}else t=r.toExponential(o);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function In(n,r,t){if(40===n.charCodeAt(0)&&!r.match(Vs)){var o=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?In("n",o,t):"("+In("n",o,-t)+")"}if(44===r.charCodeAt(r.length-1))return function P1(n,r,t){for(var o=r.length-1;44===r.charCodeAt(o-1);)--o;return $n(n,r.substr(0,o),t/Math.pow(10,3*(r.length-o)))}(n,r,t);if(-1!==r.indexOf("%"))return function O1(n,r,t){var o=r.replace(Rs,""),i=r.length-o.length;return $n(n,o,t*Math.pow(10,2*i))+_t("%",i)}(n,r,t);if(-1!==r.indexOf("E"))return zs(r,t);if(36===r.charCodeAt(0))return"$"+In(n,r.substr(" "==r.charAt(1)?2:1),t);var i,a,s,l,c=Math.abs(t),d=t<0?"-":"";if(r.match(/^00+$/))return d+An(c,r.length);if(r.match(/^[#?]+$/))return i=""+t,0===t&&(i=""),i.length>r.length?i:zt(r.substr(0,r.length-i.length))+i;if(a=r.match(Hs))return function I1(n,r,t){return t+(0===r?"":""+r)+_t(" ",n[1].length+2+n[4].length)}(a,c,d);if(r.match(/^#+0+$/))return d+An(c,r.length-r.indexOf("0"));if(a=r.match(Ys))return i=(i=(""+t).replace(/^([^\.]+)$/,"$1."+zt(a[1])).replace(/\.$/,"."+zt(a[1]))).replace(/\.(\d*)$/,function(h,p){return"."+p+_t("0",zt(a[1]).length-p.length)}),-1!==r.indexOf("0.")?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),a=r.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=r.match(/^#{1,3},##0(\.?)$/))return d+ai(""+c);if(a=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+In(n,r,-t):ai(""+t)+"."+_t("0",a[1].length);if(a=r.match(/^#,#*,#0/))return In(n,r.replace(/^#,#*,/,""),t);if(a=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Vi(In(n,r.replace(/[\\-]/g,""),t)),s=0,Vi(Vi(r.replace(/\\/g,"")).replace(/[0#]/g,function(h){return s<i.length?i.charAt(s++):"0"===h?"0":""}));if(r.match($s))return"("+(i=In(n,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var _="";if(a=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),l=dr(c,Math.pow(10,s)-1,!1),i=""+d," "==(_=$n("n",a[1],l[1])).charAt(_.length-1)&&(_=_.substr(0,_.length-1)+"0"),i+=_+a[2]+"/"+a[3],(_=lr(l[2],s)).length<a[4].length&&(_=zt(a[4].substr(a[4].length-_.length))+_),i+=_;if(a=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),d+((l=dr(c,Math.pow(10,s)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?ea(l[1],s)+a[2]+"/"+a[3]+lr(l[2],s):_t(" ",2*s+1+a[2].length+a[3].length));if(a=r.match(/^[#0?]+$/))return r.length<=(i=""+t).length?i:zt(r.substr(0,r.length-i.length))+i;if(a=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var u=r.indexOf(".")-s,f=r.length-i.length-u;return zt(r.substr(0,u)+i+r.substr(r.length-f))}if(a=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+In(n,r,-t):ai(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(h){return"00,"+(h.length<3?An(0,3-h.length):"")+h})+"."+An(0,a[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=ai(""+c);return"0"!==m?d+m:"";default:if(r.match(/\.[0#?]*$/))return In(n,r.slice(0,r.lastIndexOf(".")),t)+zt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function $n(n,r,t){return(0|t)===t?In(n,r,t):fn(n,r,t)}var Gs=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function vi(n){for(var r=0,t="",o="";r<n.length;)switch(t=n.charAt(r)){case"G":cr(n,r)&&(r+=6),r++;break;case'"':for(;34!==n.charCodeAt(++r)&&r<n.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===n.charAt(r+1)||"2"===n.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===n.substr(r,3).toUpperCase()||"AM/PM"===n.substr(r,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===n.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(o=t;"]"!==n.charAt(r++)&&r<n.length;)o+=n.charAt(r);if(o.match(Gs))return!0;break;case".":case"0":case"#":for(;r<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++r))>-1||"\\"==t&&"-"==n.charAt(r+1)&&"0#".indexOf(n.charAt(r+2))>-1););break;case"?":for(;n.charAt(++r)===t;);break;case"*":++r,(" "==n.charAt(r)||"*"==n.charAt(r))&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<n.length&&"0123456789".indexOf(n.charAt(++r))>-1;);break;default:++r}return!1}var Xs=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function js(n,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0}return!1}function sn(n,r,t){null==t&&(t={});var o="";switch(typeof n){case"string":o="m/d/yy"==n&&t.dateNF?t.dateNF:n;break;case"number":null==(o=14==n&&t.dateNF?t.dateNF:(null!=t.table?t.table:we)[n])&&(o=t.table&&t.table[Bs[n]]||we[Bs[n]]),null==o&&(o=b1[n]||"General")}if(cr(o,0))return xi(r,t);r instanceof Date&&(r=qs(r,t.date1904));var i=function J1(n,r){var t=function U1(n){for(var r=[],t=!1,o=0,i=0;o<n.length;++o)switch(n.charCodeAt(o)){case 34:t=!t;break;case 95:case 42:case 92:++o;break;case 59:r[r.length]=n.substr(i,o-i),i=o+1}if(r[r.length]=n.substr(i),!0===t)throw new Error("Format |"+n+"| unterminated string ");return r}(n),o=t.length,i=t[o-1].indexOf("@");if(o<4&&i>-1&&--o,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var a=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[o,a];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var s=t[0].match(Xs),l=t[1].match(Xs);return js(r,s)?[o,t[0]]:js(r,l)?[o,t[1]]:[o,t[null!=s&&null!=l?2:1]]}return[o,a]}(o,r);if(cr(i[1]))return xi(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return function B1(n,r,t,o){for(var d,_,u,i=[],a="",s=0,l="",c="t",f="H";s<n.length;)switch(l=n.charAt(s)){case"G":if(!cr(n,s))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";34!==(u=n.charCodeAt(++s))&&s<n.length;)a+=String.fromCharCode(u);i[i.length]={t:"t",v:a},++s;break;case"\\":var m=n.charAt(++s);i[i.length]={t:"("===m||")"===m?m:"t",v:m},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:r},++s;break;case"B":case"b":if("1"===n.charAt(s+1)||"2"===n.charAt(s+1)){if(null==d&&null==(d=ri(r,t,"2"===n.charAt(s+1))))return"";i[i.length]={t:"X",v:n.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||null==d&&null==(d=ri(r,t)))return"";for(a=l;++s<n.length&&n.charAt(s).toLowerCase()===l;)a+=l;"m"===l&&"h"===c.toLowerCase()&&(l="M"),"h"===l&&(l=f),i[i.length]={t:l,v:a},c=l;break;case"A":case"a":case"\u4e0a":var p={t:l,v:l};if(null==d&&(d=ri(r,t)),"A/P"===n.substr(s,3).toUpperCase()?(null!=d&&(p.v=d.H>=12?"P":"A"),p.t="T",f="h",s+=3):"AM/PM"===n.substr(s,5).toUpperCase()?(null!=d&&(p.v=d.H>=12?"PM":"AM"),p.t="T",s+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===n.substr(s,5).toUpperCase()?(null!=d&&(p.v=d.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",s+=5,f="h"):(p.t="t",++s),null==d&&"T"===p.t)return"";i[i.length]=p,c=l;break;case"[":for(a=l;"]"!==n.charAt(s++)&&s<n.length;)a+=n.charAt(s);if("]"!==a.slice(-1))throw'unterminated "[" block: |'+a+"|";if(a.match(Gs)){if(null==d&&null==(d=ri(r,t)))return"";i[i.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",vi(n)||(i[i.length]={t:"t",v:a}));break;case".":if(null!=d){for(a=l;++s<n.length&&"0"===(l=n.charAt(s));)a+=l;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=l;++s<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(s))>-1;)a+=l;i[i.length]={t:"n",v:a};break;case"?":for(a=l;n.charAt(++s)===l;)a+=l;i[i.length]={t:l,v:a},c=l;break;case"*":++s,(" "==n.charAt(s)||"*"==n.charAt(s))&&++s;break;case"(":case")":i[i.length]={t:1===o?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=l;s<n.length&&"0123456789".indexOf(n.charAt(++s))>-1;)a+=n.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:l,v:l},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(l))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"t",v:l},++s}var x,g=0,v=0;for(s=i.length-1,c="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=f,c="h",g<1&&(g=1);break;case"s":(x=i[s].v.match(/\.0+$/))&&(v=Math.max(v,x[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=i[s].t;break;case"m":"s"===c&&(i[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[s].v.match(/[Hh]/)&&(g=1),g<2&&i[s].v.match(/[Mm]/)&&(g=2),g<3&&i[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M)}var b,C="";for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=k1(i[s].t.charCodeAt(0),i[s].v,d,v),i[s].t="t";break;case"n":case"?":for(b=s+1;null!=i[b]&&("?"===(l=i[b].t)||"D"===l||(" "===l||"t"===l)&&null!=i[b+1]&&("?"===i[b+1].t||"t"===i[b+1].t&&"/"===i[b+1].v)||"("===i[s].t&&(" "===l||"n"===l||")"===l)||"t"===l&&("/"===i[b].v||" "===i[b].v&&null!=i[b+1]&&"?"==i[b+1].t));)i[s].v+=i[b].v,i[b]={v:"",t:";"},++b;C+=i[s].v,s=b-1;break;case"G":i[s].t="t",i[s].v=xi(r,t)}var M,A,y="";if(C.length>0){40==C.charCodeAt(0)?(M=r<0&&45===C.charCodeAt(0)?-r:r,A=$n("n",C,M)):(A=$n("n",C,M=r<0&&o>1?-r:r),M<0&&i[0]&&"t"==i[0].t&&(A=A.substr(1),i[0].v="-"+i[0].v)),b=A.length-1;var U=i.length;for(s=0;s<i.length;++s)if(null!=i[s]&&"t"!=i[s].t&&i[s].v.indexOf(".")>-1){U=s;break}var P=i.length;if(U===i.length&&-1===A.indexOf("E")){for(s=i.length-1;s>=0;--s)null==i[s]||-1==="n?".indexOf(i[s].t)||(b>=i[s].v.length-1?i[s].v=A.substr(1+(b-=i[s].v.length),i[s].v.length):b<0?i[s].v="":(i[s].v=A.substr(0,b+1),b=-1),i[s].t="t",P=s);b>=0&&P<i.length&&(i[P].v=A.substr(0,b+1)+i[P].v)}else if(U!==i.length&&-1===A.indexOf("E")){for(b=A.indexOf(".")-1,s=U;s>=0;--s)if(null!=i[s]&&-1!=="n?".indexOf(i[s].t)){for(_=i[s].v.indexOf(".")>-1&&s===U?i[s].v.indexOf(".")-1:i[s].v.length-1,y=i[s].v.substr(_+1);_>=0;--_)b>=0&&("0"===i[s].v.charAt(_)||"#"===i[s].v.charAt(_))&&(y=A.charAt(b--)+y);i[s].v=y,i[s].t="t",P=s}for(b>=0&&P<i.length&&(i[P].v=A.substr(0,b+1)+i[P].v),b=A.indexOf(".")+1,s=U;s<i.length;++s)if(null!=i[s]&&(-1!=="n?(".indexOf(i[s].t)||s===U)){for(_=i[s].v.indexOf(".")>-1&&s===U?i[s].v.indexOf(".")+1:0,y=i[s].v.substr(0,_);_<i[s].v.length;++_)b<A.length&&(y+=A.charAt(b++));i[s].v=y,i[s].t="t",P=s}}}for(s=0;s<i.length;++s)null!=i[s]&&"n?".indexOf(i[s].t)>-1&&(i[s].v=$n(i[s].t,i[s].v,M=o>1&&r<0&&s>0&&"-"===i[s-1].v?-r:r),i[s].t="t");var B="";for(s=0;s!==i.length;++s)null!=i[s]&&(B+=i[s].v);return B}(i[1],r,t,i[0])}function En(n,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=we[t]){if(we[t]==n){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return we[r]=n,r}function Ki(){we=function T1(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',n}()}var R1={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},el=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Y1=function(){var n={version:"1.2.0"},t=function r(){for(var A=0,U=new Array(256),P=0;256!=P;++P)U[P]=A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=1&(A=P)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1)?-306674912^A>>>1:A>>>1;return"undefined"!=typeof Int32Array?new Int32Array(U):U}(),i=function o(A){var U=0,P=0,B=0,J="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(B=0;256!=B;++B)J[B]=A[B];for(B=0;256!=B;++B)for(P=A[B],U=256+B;U<4096;U+=256)P=J[U]=P>>>8^A[255&P];var O=[];for(B=1;16!=B;++B)O[B-1]="undefined"!=typeof Int32Array?J.subarray(256*B,256*B+256):J.slice(256*B,256*B+256);return O}(t),a=i[0],s=i[1],l=i[2],c=i[3],d=i[4],_=i[5],u=i[6],f=i[7],m=i[8],h=i[9],p=i[10],g=i[11],v=i[12],x=i[13],C=i[14];return n.table=t,n.bstr=function b(A,U){for(var P=-1^U,B=0,J=A.length;B<J;)P=P>>>8^t[255&(P^A.charCodeAt(B++))];return~P},n.buf=function y(A,U){for(var P=-1^U,B=A.length-15,J=0;J<B;)P=C[A[J++]^255&P]^x[A[J++]^P>>8&255]^v[A[J++]^P>>16&255]^g[A[J++]^P>>>24]^p[A[J++]]^h[A[J++]]^m[A[J++]]^f[A[J++]]^u[A[J++]]^_[A[J++]]^d[A[J++]]^c[A[J++]]^l[A[J++]]^s[A[J++]]^a[A[J++]]^t[A[J++]];for(B+=15;J<B;)P=P>>>8^t[255&(P^A[J++])];return~P},n.str=function M(A,U){for(var P=-1^U,B=0,J=A.length,O=0,ee=0;B<J;)(O=A.charCodeAt(B++))<128?P=P>>>8^t[255&(P^O)]:O<2048?P=(P=P>>>8^t[255&(P^(192|O>>6&31))])>>>8^t[255&(P^(128|63&O))]:O>=55296&&O<57344?(O=64+(1023&O),ee=1023&A.charCodeAt(B++),P=(P=(P=(P=P>>>8^t[255&(P^(240|O>>8&7))])>>>8^t[255&(P^(128|O>>2&63))])>>>8^t[255&(P^(128|ee>>6&15|(3&O)<<4))])>>>8^t[255&(P^(128|63&ee))]):P=(P=(P=P>>>8^t[255&(P^(224|O>>12&15))])>>>8^t[255&(P^(128|O>>6&63))])>>>8^t[255&(P^(128|63&O))];return~P},n}(),Te=function(){var c,r={};function o(T){if("/"==T.charAt(T.length-1))return-1===T.slice(0,-1).indexOf("/")?T:o(T.slice(0,-1));var D=T.lastIndexOf("/");return-1===D?T:T.slice(0,D+1)}function i(T){if("/"==T.charAt(T.length-1))return i(T.slice(0,-1));var D=T.lastIndexOf("/");return-1===D?T:T.slice(D+1)}function a(T,D){"string"==typeof D&&(D=new Date(D));var S=D.getHours();S=(S=S<<6|D.getMinutes())<<5|D.getSeconds()>>>1,T.write_shift(2,S);var N=D.getFullYear()-1980;N=(N=N<<4|D.getMonth()+1)<<5|D.getDate(),T.write_shift(2,N)}function l(T){Ot(T,0);for(var D={},S=0;T.l<=T.length-4;){var N=T.read_shift(2),k=T.read_shift(2),F=T.l+k,q={};21589===N&&(1&(S=T.read_shift(1))&&(q.mtime=T.read_shift(4)),k>5&&(2&S&&(q.atime=T.read_shift(4)),4&S&&(q.ctime=T.read_shift(4))),q.mtime&&(q.mt=new Date(1e3*q.mtime))),T.l=F,D[N]=q}return D}function d(){return c||(c={})}function _(T,D){if(80==T[0]&&75==T[1])return F_(T,D);if(109==(32|T[0])&&105==(32|T[1]))return function rO(T,D){if("mime-version:"!=_e(T.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var S=D&&D.root||"",N=(Ee&&Buffer.isBuffer(T)?T.toString("binary"):_e(T)).split("\r\n"),k=0,F="";for(k=0;k<N.length;++k)if(/^Content-Location:/i.test(F=N[k])&&(F=F.slice(F.indexOf("file")),S||(S=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,S.length)!=S))for(;S.length>0&&(S=(S=S.slice(0,S.length-1)).slice(0,S.lastIndexOf("/")+1),F.slice(0,S.length)!=S););var q=(N[1]||"").match(/boundary="(.*?)"/);if(!q)throw new Error("MAD cannot find boundary");var K="--"+(q[1]||""),Y={FileIndex:[],FullPaths:[]};A(Y);var j,ae=0;for(k=0;k<N.length;++k){var he=N[k];he!==K&&he!==K+"--"||(ae++&&oO(Y,N.slice(j,k),S),j=k)}return Y}(T,D);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var S,k,F,q,K,H,N=512,R=[],Y=T.slice(0,512);Ot(Y,0);var j=function u(T){if(80==T[T.l]&&75==T[T.l+1])return[0,0];T.chk(pe,"Header Signature: "),T.l+=16;var D=T.read_shift(2,"u");return[T.read_shift(2,"u"),D]}(Y);switch(S=j[0]){case 3:N=512;break;case 4:N=4096;break;case 0:if(0==j[1])return F_(T,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}512!==N&&Ot(Y=T.slice(0,N),28);var ae=T.slice(0,N);!function f(T,D){var S;switch(T.l+=2,S=T.read_shift(2)){case 9:if(3!=D)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(4!=D)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}(Y,S);var he=Y.read_shift(4,"i");if(3===S&&0!==he)throw new Error("# Directory Sectors: Expected 0 saw "+he);Y.l+=4,q=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),K=Y.read_shift(4,"i"),k=Y.read_shift(4,"i"),H=Y.read_shift(4,"i"),F=Y.read_shift(4,"i");for(var se=-1,de=0;de<109&&!((se=Y.read_shift(4,"i"))<0);++de)R[de]=se;var De=function m(T,D){for(var S=Math.ceil(T.length/D)-1,N=[],k=1;k<S;++k)N[k-1]=T.slice(k*D,(k+1)*D);return N[S-1]=T.slice(S*D),N}(T,N);g(H,F,De,N,R);var it=function x(T,D,S,N){var k=T.length,F=[],q=[],K=[],H=[],R=N-1,Y=0,j=0,ae=0,he=0;for(Y=0;Y<k;++Y)if(K=[],(ae=Y+D)>=k&&(ae-=k),!q[ae]){H=[];var se=[];for(j=ae;j>=0;){se[j]=!0,q[j]=!0,K[K.length]=j,H.push(T[j]);var de=S[Math.floor(4*j/N)];if(N<4+(he=4*j&R))throw new Error("FAT boundary crossed: "+j+" 4 "+N);if(!T[de]||se[j=Ti(T[de],he)])break}F[ae]={nodes:K,data:wl([H])}}return F}(De,q,R,N);it[q].name="!Directory",k>0&&K!==ee&&(it[K].name="!MiniFAT"),it[R[0]].name="!FAT",it.fat_addrs=R,it.ssz=N;var Nt=[],pn=[],er=[];(function C(T,D,S,N,k,F,q,K){for(var he,H=0,R=N.length?2:0,Y=D[T].data,j=0,ae=0;j<Y.length;j+=128){var se=Y.slice(j,j+128);Ot(se,64),ae=se.read_shift(2),he=hr(se,0,ae-R),N.push(he);var de={name:he,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0};0!==se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2)&&(de.ct=b(se,se.l-8)),0!==se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2)&&(de.mt=b(se,se.l-8)),de.start=se.read_shift(4,"i"),de.size=se.read_shift(4,"i"),de.size<0&&de.start<0&&(de.size=de.type=0,de.start=ee,de.name=""),5===de.type?(H=de.start,k>0&&H!==ee&&(D[H].name="!StreamData")):de.size>=4096?(de.storage="fat",void 0===D[de.start]&&(D[de.start]=v(S,de.start,D.fat_addrs,D.ssz)),D[de.start].name=de.name,de.content=D[de.start].data.slice(0,de.size)):(de.storage="minifat",de.size<0?de.size=0:H!==ee&&de.start!==ee&&D[H]&&(de.content=p(de,D[H].data,(D[K]||{}).data))),de.content&&Ot(de.content,0),F[he]=de,q.push(de)}})(q,it,De,Nt,k,{},pn,K),function h(T,D,S){for(var N=0,k=0,F=0,q=0,K=0,H=S.length,R=[],Y=[];N<H;++N)R[N]=Y[N]=N,D[N]=S[N];for(;K<Y.length;++K)k=T[N=Y[K]].L,F=T[N].R,q=T[N].C,R[N]===N&&(-1!==k&&R[k]!==k&&(R[N]=R[k]),-1!==F&&R[F]!==F&&(R[N]=R[F])),-1!==q&&(R[q]=N),-1!==k&&N!=R[N]&&(R[k]=R[N],Y.lastIndexOf(k)<K&&Y.push(k)),-1!==F&&N!=R[N]&&(R[F]=R[N],Y.lastIndexOf(F)<K&&Y.push(F));for(N=1;N<H;++N)R[N]===N&&(-1!==F&&R[F]!==F?R[N]=R[F]:-1!==k&&R[k]!==k&&(R[N]=R[k]));for(N=1;N<H;++N)if(0!==T[N].type){if((K=N)!=R[K])do{D[N]=D[K=R[K]]+"/"+D[N]}while(0!==K&&-1!==R[K]&&K!=R[K]);R[N]=-1}for(D[0]+="/",N=1;N<H;++N)2!==T[N].type&&(D[N]+="/")}(pn,er,Nt),Nt.shift();var tr={FileIndex:pn,FullPaths:er};return D&&D.raw&&(tr.raw={header:ae,sectors:De}),tr}function p(T,D,S){for(var k=T.size,F=[],q=T.start;S&&k>0&&q>=0;)F.push(D.slice(q*O,q*O+O)),k-=O,q=Ti(S,4*q);return 0===F.length?V(0):kt(F).slice(0,T.size)}function g(T,D,S,N,k){var F=ee;if(T===ee){if(0!==D)throw new Error("DIFAT chain shorter than expected")}else if(-1!==T){var q=S[T],K=(N>>>2)-1;if(!q)return;for(var H=0;H<K&&(F=Ti(q,4*H))!==ee;++H)k.push(F);g(Ti(q,N-4),D-1,S,N,k)}}function v(T,D,S,N,k){var F=[],q=[];k||(k=[]);var K=N-1,H=0,R=0;for(H=D;H>=0;){k[H]=!0,F[F.length]=H,q.push(T[H]);var Y=S[Math.floor(4*H/N)];if(N<4+(R=4*H&K))throw new Error("FAT boundary crossed: "+H+" 4 "+N);if(!T[Y])break;H=Ti(T[Y],R)}return{nodes:F,data:wl([q])}}function b(T,D){return new Date(1e3*(Ft(T,D+4)/1e7*Math.pow(2,32)+Ft(T,D)/1e7-11644473600))}function A(T,D){var S=D||{},N=S.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");0===T.FullPaths.length&&(T.FullPaths[0]=N+"/",T.FileIndex[0]={name:N,type:5}),S.CLSID&&(T.FileIndex[0].clsid=S.CLSID),function U(T){var D="\x01Sh33tJ5";if(!Te.find(T,"/"+D)){var S=V(4);S[0]=55,S[1]=S[3]=50,S[2]=54,T.FileIndex.push({name:D,type:2,content:S,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+D),P(T)}}(T)}function P(T,D){A(T);for(var S=!1,N=!1,k=T.FullPaths.length-1;k>=0;--k){var F=T.FileIndex[k];switch(F.type){case 0:N?S=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(F.R*F.L*F.C)&&(S=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(S=!0);break;default:S=!0}}if(S||D){var q=new Date(1987,1,19),K=0,H=Object.create?Object.create(null):{},R=[];for(k=0;k<T.FullPaths.length;++k)H[T.FullPaths[k]]=!0,0!==T.FileIndex[k].type&&R.push([T.FullPaths[k],T.FileIndex[k]]);for(k=0;k<R.length;++k){var Y=o(R[k][0]);(N=H[Y])||(R.push([Y,{name:i(Y).replace("/",""),type:1,clsid:ve,ct:q,mt:q,content:null}]),H[Y]=!0)}for(R.sort(function(he,se){return function t(T,D){for(var S=T.split("/"),N=D.split("/"),k=0,F=0,q=Math.min(S.length,N.length);k<q;++k){if(F=S[k].length-N[k].length)return F;if(S[k]!=N[k])return S[k]<N[k]?-1:1}return S.length-N.length}(he[0],se[0])}),T.FullPaths=[],T.FileIndex=[],k=0;k<R.length;++k)T.FullPaths[k]=R[k][0],T.FileIndex[k]=R[k][1];for(k=0;k<R.length;++k){var j=T.FileIndex[k],ae=T.FullPaths[k];if(j.name=i(ae).replace("/",""),j.L=j.R=j.C=-(j.color=1),j.size=j.content?j.content.length:0,j.start=0,j.clsid=j.clsid||ve,0===k)j.C=R.length>1?1:-1,j.size=0,j.type=5;else if("/"==ae.slice(-1)){for(K=k+1;K<R.length&&o(T.FullPaths[K])!=ae;++K);for(j.C=K>=R.length?-1:K,K=k+1;K<R.length&&o(T.FullPaths[K])!=o(ae);++K);j.R=K>=R.length?-1:K,j.type=1}else o(T.FullPaths[k+1]||"")==o(ae)&&(j.R=k+1),j.type=2}}}function B(T,D){var S=D||{};if("mad"==S.fileType)return function aO(T,D){for(var S=D||{},N=S.boundary||"SheetJS",k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(N="------="+N).slice(2)+'"',"","",""],F=T.FullPaths[0],q=F,K=T.FileIndex[0],H=1;H<T.FullPaths.length;++H)if(q=T.FullPaths[H].slice(F.length),(K=T.FileIndex[H]).size&&K.content&&"\x01Sh33tJ5"!=q){q=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var R=K.content,Y=Ee&&Buffer.isBuffer(R)?R.toString("binary"):_e(R),j=0,ae=Math.min(1024,Y.length),he=0,se=0;se<=ae;++se)(he=Y.charCodeAt(se))>=32&&he<128&&++j;var de=j>=4*ae/5;k.push(N),k.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+q),k.push("Content-Transfer-Encoding: "+(de?"quoted-printable":"base64")),k.push("Content-Type: "+eO(K,q)),k.push(""),k.push(de?nO(Y):tO(Y))}return k.push(N+"--\r\n"),k.join("\r\n")}(T,S);if("zip"===(P(T),S.fileType))return function j7(T,D){var S=D||{},N=[],k=[],F=V(1),q=S.compression?8:0,R=0,Y=0,j=0,ae=0,he=T.FullPaths[0],se=he,de=T.FileIndex[0],De=[],it=0;for(R=1;R<T.FullPaths.length;++R)if(se=T.FullPaths[R].slice(he.length),(de=T.FileIndex[R]).size&&de.content&&"\x01Sh33tJ5"!=se){var tn=j,Nt=V(se.length);for(Y=0;Y<se.length;++Y)Nt.write_shift(1,127&se.charCodeAt(Y));Nt=Nt.slice(0,Nt.l),De[ae]=Y1.buf(de.content,0);var pn=de.content;8==q&&(pn=Z(pn)),(F=V(30)).write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,0),F.write_shift(2,q),de.mt?a(F,de.mt):F.write_shift(4,0),F.write_shift(-4,De[ae]),F.write_shift(4,pn.length),F.write_shift(4,de.content.length),F.write_shift(2,Nt.length),F.write_shift(2,0),j+=F.length,N.push(F),j+=Nt.length,N.push(Nt),j+=pn.length,N.push(pn),(F=V(46)).write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,0),F.write_shift(2,q),F.write_shift(4,0),F.write_shift(-4,De[ae]),F.write_shift(4,pn.length),F.write_shift(4,de.content.length),F.write_shift(2,Nt.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,tn),it+=F.l,k.push(F),it+=Nt.length,k.push(Nt),++ae}return(F=V(22)).write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ae),F.write_shift(2,ae),F.write_shift(4,it),F.write_shift(4,j),F.write_shift(2,0),kt([kt(N),kt(k),F])}(T,S);var N=function(he){for(var se=0,de=0,De=0;De<he.FileIndex.length;++De){var it=he.FileIndex[De];if(it.content){var tn=it.content.length;tn>0&&(tn<4096?se+=tn+63>>6:de+=tn+511>>9)}}for(var Nt=he.FullPaths.length+3>>2,er=se+127>>7,tr=(se+7>>3)+de+Nt+er,Bi=tr+127>>7,Ns=Bi<=109?0:Math.ceil((Bi-109)/127);tr+Bi+Ns+127>>7>Bi;)Ns=++Bi<=109?0:Math.ceil((Bi-109)/127);var ei=[1,Ns,Bi,er,Nt,de,se,0];return he.FileIndex[0].size=se<<6,ei[7]=(he.FileIndex[0].start=ei[0]+ei[1]+ei[2]+ei[3]+ei[4]+ei[5])+(ei[6]+7>>3),ei}(T),k=V(N[7]<<9),F=0,q=0;for(F=0;F<8;++F)k.write_shift(1,ie[F]);for(F=0;F<8;++F)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),F=0;F<3;++F)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,N[2]),k.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:ee),k.write_shift(4,N[3]),k.write_shift(-4,N[1]?N[0]-1:ee),k.write_shift(4,N[1]),F=0;F<109;++F)k.write_shift(-4,F<N[2]?N[1]+F:-1);if(N[1])for(q=0;q<N[1];++q){for(;F<236+127*q;++F)k.write_shift(-4,F<N[2]?N[1]+F:-1);k.write_shift(-4,q===N[1]-1?ee:q+1)}var K=function(he){for(q+=he;F<q-1;++F)k.write_shift(-4,F+1);he&&(++F,k.write_shift(-4,ee))};for(q=F=0,q+=N[1];F<q;++F)k.write_shift(-4,me.DIFSECT);for(q+=N[2];F<q;++F)k.write_shift(-4,me.FATSECT);K(N[3]),K(N[4]);for(var H=0,R=0,Y=T.FileIndex[0];H<T.FileIndex.length;++H)(Y=T.FileIndex[H]).content&&!((R=Y.content.length)<4096)&&(Y.start=q,K(R+511>>9));for(K(N[6]+7>>3);511&k.l;)k.write_shift(-4,me.ENDOFCHAIN);for(q=F=0,H=0;H<T.FileIndex.length;++H)(Y=T.FileIndex[H]).content&&(R=Y.content.length)&&!(R>=4096)&&(Y.start=q,K(R+63>>6));for(;511&k.l;)k.write_shift(-4,me.ENDOFCHAIN);for(F=0;F<N[4]<<2;++F){var j=T.FullPaths[F];if(j&&0!==j.length){Y=T.FileIndex[F],0===F&&(Y.start=Y.size?Y.start-1:ee);var ae=0===F&&S.root||Y.name;if(R=2*(ae.length+1),k.write_shift(64,ae,"utf16le"),k.write_shift(2,R),k.write_shift(1,Y.type),k.write_shift(1,Y.color),k.write_shift(-4,Y.L),k.write_shift(-4,Y.R),k.write_shift(-4,Y.C),Y.clsid)k.write_shift(16,Y.clsid,"hex");else for(H=0;H<4;++H)k.write_shift(4,0);k.write_shift(4,Y.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,Y.start),k.write_shift(4,Y.size),k.write_shift(4,0)}else{for(H=0;H<17;++H)k.write_shift(4,0);for(H=0;H<3;++H)k.write_shift(4,-1);for(H=0;H<12;++H)k.write_shift(4,0)}}for(F=1;F<T.FileIndex.length;++F)if((Y=T.FileIndex[F]).size>=4096)if(k.l=Y.start+1<<9,Ee&&Buffer.isBuffer(Y.content))Y.content.copy(k,k.l,0,Y.size),k.l+=Y.size+511&-512;else{for(H=0;H<Y.size;++H)k.write_shift(1,Y.content[H]);for(;511&H;++H)k.write_shift(1,0)}for(F=1;F<T.FileIndex.length;++F)if((Y=T.FileIndex[F]).size>0&&Y.size<4096)if(Ee&&Buffer.isBuffer(Y.content))Y.content.copy(k,k.l,0,Y.size),k.l+=Y.size+63&-64;else{for(H=0;H<Y.size;++H)k.write_shift(1,Y.content[H]);for(;63&H;++H)k.write_shift(1,0)}if(Ee)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}r.version="1.2.1";var z,O=64,ee=-2,pe="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],ve="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ve,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _e(T){for(var D=new Array(T.length),S=0;S<T.length;++S)D[S]=String.fromCharCode(T[S]);return D.join("")}function Z(T){return z?z.deflateRawSync(T):Oe(T)}for(var T,D,E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ne="undefined"!=typeof Uint8Array,G=ne?new Uint8Array(256):[],Me=0;Me<256;++Me)G[Me]=(void 0,255&((D=139536&((T=Me)<<1|T<<11)|558144&(T<<5|T<<15))>>16|D>>8|D));function L(T,D){var S=G[255&T];return D<=8?S>>>8-D:(S=S<<8|G[T>>8&255],D<=16?S>>>16-D:(S=S<<8|G[T>>16&255])>>>24-D)}function We(T,D){var S=7&D,N=D>>>3;return(T[N]|(S<=6?0:T[N+1]<<8))>>>S&3}function Ue(T,D){var S=7&D,N=D>>>3;return(T[N]|(S<=5?0:T[N+1]<<8))>>>S&7}function Be(T,D){var S=7&D,N=D>>>3;return(T[N]|(S<=3?0:T[N+1]<<8))>>>S&31}function ue(T,D){var S=7&D,N=D>>>3;return(T[N]|(S<=1?0:T[N+1]<<8))>>>S&127}function mt(T,D,S){var N=7&D,k=D>>>3,q=T[k]>>>N;return S<8-N||(q|=T[k+1]<<8-N,S<16-N)||(q|=T[k+2]<<16-N,S<24-N)||(q|=T[k+3]<<24-N),q&(1<<S)-1}function bn(T,D,S){var N=7&D,k=D>>>3;return N<=5?T[k]|=(7&S)<<N:(T[k]|=S<<N&255,T[k+1]=(7&S)>>8-N),D+3}function qn(T,D,S){return T[D>>>3]|=S=(1&S)<<(7&D),D+1}function Xn(T,D,S){var k=D>>>3;return T[k]|=255&(S<<=7&D),T[k+1]=S>>>=8,D+8}function Xo(T,D,S){var k=D>>>3;return T[k]|=255&(S<<=7&D),T[k+1]=255&(S>>>=8),T[k+2]=S>>>8,D+16}function fi(T,D){var S=T.length,N=2*S>D?2*S:D+5,k=0;if(S>=D)return T;if(Ee){var F=Ps(N);if(T.copy)T.copy(F);else for(;k<T.length;++k)F[k]=T[k];return F}if(ne){var q=new Uint8Array(N);if(q.set)q.set(T);else for(;k<S;++k)q[k]=T[k];return q}return T.length=N,T}function _n(T){for(var D=new Array(T),S=0;S<T;++S)D[S]=0;return D}function jn(T,D,S){var N=1,k=0,F=0,q=0,K=0,H=T.length,R=ne?new Uint16Array(32):_n(32);for(F=0;F<32;++F)R[F]=0;for(F=H;F<S;++F)T[F]=0;H=T.length;var Y=ne?new Uint16Array(H):_n(H);for(F=0;F<H;++F)R[k=T[F]]++,N<k&&(N=k),Y[F]=0;for(R[0]=0,F=1;F<=N;++F)R[F+16]=K=K+R[F-1]<<1;for(F=0;F<H;++F)0!=(K=T[F])&&(Y[F]=R[K+16]++);var j=0;for(F=0;F<H;++F)if(0!=(j=T[F]))for(K=L(Y[F],N)>>N-j,q=(1<<N+4-j)-1;q>=0;--q)D[K|q<<j]=15&j|F<<4;return N}var mi=ne?new Uint16Array(512):_n(512),jo=ne?new Uint16Array(32):_n(32);if(!ne){for(var jt=0;jt<512;++jt)mi[jt]=0;for(jt=0;jt<32;++jt)jo[jt]=0}!function(){for(var T=[],D=0;D<32;D++)T.push(5);jn(T,jo,32);var S=[];for(D=0;D<=143;D++)S.push(8);for(;D<=255;D++)S.push(9);for(;D<=279;D++)S.push(7);for(;D<=287;D++)S.push(8);jn(S,mi,288)}();var Rn=function(){for(var D=ne?new Uint8Array(32768):[],S=0,N=0;S<le.length-1;++S)for(;N<le[S+1];++N)D[N]=S;for(;N<32768;++N)D[N]=29;var k=ne?new Uint8Array(259):[];for(S=0,N=0;S<W.length-1;++S)for(;N<W[S+1];++N)k[N]=S;return function(H,R){return H.length<8?function F(K,H){for(var R=0;R<K.length;){var Y=Math.min(65535,K.length-R);for(H.write_shift(1,+(R+Y==K.length)),H.write_shift(2,Y),H.write_shift(2,65535&~Y);Y-- >0;)H[H.l++]=K[R++]}return H.l}(H,R):function q(K,H){for(var R=0,Y=0,j=ne?new Uint16Array(32768):[];Y<K.length;){var ae=Math.min(65535,K.length-Y);if(ae<10){for(7&(R=bn(H,R,+(Y+ae==K.length)))&&(R+=8-(7&R)),H.l=R/8|0,H.write_shift(2,ae),H.write_shift(2,65535&~ae);ae-- >0;)H[H.l++]=K[Y++];R=8*H.l}else{R=bn(H,R,+(Y+ae==K.length)+2);for(var he=0;ae-- >0;){var se=K[Y],de=-1,De=0;if((de=j[he=32767&(he<<5^se)])&&((de|=-32768&Y)>Y&&(de-=32768),de<Y))for(;K[de+De]==K[Y+De]&&De<250;)++De;if(De>2){(se=k[De])<=22?R=Xn(H,R,G[se+1]>>1)-1:(Xn(H,R,3),Xn(H,R+=5,G[se-23]>>5),R+=3);var it=se<8?0:se-4>>2;it>0&&(Xo(H,R,De-W[se]),R+=it),R=Xn(H,R,G[se=D[Y-de]]>>3),R-=3;var tn=se<4?0:se-2>>1;tn>0&&(Xo(H,R,Y-de-le[se]),R+=tn);for(var Nt=0;Nt<De;++Nt)j[he]=32767&Y,he=32767&(he<<5^K[Y]),++Y;ae-=De-1}else se<=143?se+=48:R=qn(H,R,1),R=Xn(H,R,G[se]),j[he]=32767&Y,++Y}R=Xn(H,R,0)-1}}return H.l=(R+7)/8|0,H.l}(H,R)}}();function Oe(T){var D=V(50+Math.floor(1.1*T.length)),S=Rn(T,D);return D.slice(0,S)}var ht=ne?new Uint16Array(32768):_n(32768),wn=ne?new Uint16Array(32768):_n(32768),yt=ne?new Uint16Array(128):_n(128),Ui=1,y_=1;function z7(T,D){var S=Be(T,D)+257,N=Be(T,D+=5)+1,k=function ze(T,D){var S=7&D,N=D>>>3;return(T[N]|(S<=4?0:T[N+1]<<8))>>>S&15}(T,D+=5)+4;D+=4;for(var F=0,q=ne?new Uint8Array(19):_n(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,R=ne?new Uint8Array(8):_n(8),Y=ne?new Uint8Array(8):_n(8),j=q.length,ae=0;ae<k;++ae)q[E[ae]]=F=Ue(T,D),H<F&&(H=F),R[F]++,D+=3;var he=0;for(R[0]=0,ae=1;ae<=H;++ae)Y[ae]=he=he+R[ae-1]<<1;for(ae=0;ae<j;++ae)0!=(he=q[ae])&&(K[ae]=Y[he]++);var se=0;for(ae=0;ae<j;++ae)if(0!=(se=q[ae])){he=G[K[ae]]>>8-se;for(var de=(1<<7-se)-1;de>=0;--de)yt[he|de<<se]=7&se|ae<<3}var De=[];for(H=1;De.length<S+N;)switch(he=yt[ue(T,D)],D+=7&he,he>>>=3){case 16:for(F=3+We(T,D),D+=2,he=De[De.length-1];F-- >0;)De.push(he);break;case 17:for(F=3+Ue(T,D),D+=3;F-- >0;)De.push(0);break;case 18:for(F=11+ue(T,D),D+=7;F-- >0;)De.push(0);break;default:De.push(he),H<he&&(H=he)}var it=De.slice(0,S),tn=De.slice(S);for(ae=S;ae<286;++ae)it[ae]=0;for(ae=N;ae<30;++ae)tn[ae]=0;return Ui=jn(it,ht,286),y_=jn(tn,wn,30),D}function D_(T,D){var N=function G7(T,D){if(3==T[0]&&!(3&T[1]))return[ii(D),2];for(var S=0,N=0,k=Ps(D||1<<18),F=0,q=k.length>>>0,K=0,H=0;0==(1&N);)if(N=Ue(T,S),S+=3,N>>>1!=0)for(N>>1==1?(K=9,H=5):(S=z7(T,S),K=Ui,H=y_);;){!D&&q<F+32767&&(q=(k=fi(k,F+32767)).length);var Y=mt(T,S,K),j=N>>>1==1?mi[Y]:ht[Y];if(S+=15&j,0==((j>>>=4)>>>8&255))k[F++]=j;else{if(256==j)break;var ae=(j-=257)<8?0:j-4>>2;ae>5&&(ae=0);var he=F+W[j];ae>0&&(he+=mt(T,S,ae),S+=ae),Y=mt(T,S,H),S+=15&(j=N>>>1==1?jo[Y]:wn[Y]);var se=(j>>>=4)<4?0:j-2>>1,de=le[j];for(se>0&&(de+=mt(T,S,se),S+=se),!D&&q<he&&(q=(k=fi(k,he+100)).length);F<he;)k[F]=k[F-de],++F}}else{7&S&&(S+=8-(7&S));var R=T[S>>>3]|T[1+(S>>>3)]<<8;if(S+=32,R>0)for(!D&&q<F+R&&(q=(k=fi(k,F+R)).length);R-- >0;)k[F++]=T[S>>>3],S+=8}return D?[k,S+7>>>3]:[k.slice(0,F),S+7>>>3]}(T.slice(T.l||0),D);return T.l+=N[1],N[0]}function k_(T,D){if(!T)throw new Error(D);"undefined"!=typeof console&&console.error(D)}function F_(T,D){var S=T;Ot(S,0);var F={FileIndex:[],FullPaths:[]};A(F,{root:D.root});for(var q=S.length-4;(80!=S[q]||75!=S[q+1]||5!=S[q+2]||6!=S[q+3])&&q>=0;)--q;S.l=q+4,S.l+=4;var K=S.read_shift(2);S.l+=6;var H=S.read_shift(4);for(S.l=H,q=0;q<K;++q){S.l+=20;var R=S.read_shift(4),Y=S.read_shift(4),j=S.read_shift(2),ae=S.read_shift(2),he=S.read_shift(2);S.l+=8;var se=S.read_shift(4),de=l(S.slice(S.l+j,S.l+j+ae));S.l+=j+ae+he;var De=S.l;S.l=se+4,X7(S,R,Y,F,de),S.l=De}return F}function X7(T,D,S,N,k){T.l+=2;var F=T.read_shift(2),q=T.read_shift(2),K=function s(T){var D=65535&T.read_shift(2),S=65535&T.read_shift(2),N=new Date,k=31&S,F=15&(S>>>=5);S>>>=4,N.setMilliseconds(0),N.setFullYear(S+1980),N.setMonth(F-1),N.setDate(k);var q=31&D,K=63&(D>>>=5);return N.setHours(D>>>=6),N.setMinutes(K),N.setSeconds(q<<1),N}(T);if(8257&F)throw new Error("Unsupported ZIP encryption");T.read_shift(4);for(var R=T.read_shift(4),Y=T.read_shift(4),j=T.read_shift(2),ae=T.read_shift(2),he="",se=0;se<j;++se)he+=String.fromCharCode(T[T.l++]);if(ae){var de=l(T.slice(T.l,T.l+ae));(de[21589]||{}).mt&&(K=de[21589].mt),((k||{})[21589]||{}).mt&&(K=k[21589].mt)}T.l+=ae;var De=T.slice(T.l,T.l+R);switch(q){case 8:De=function Q(T,D){if(!z)return D_(T,D);var N=new(0,z.InflateRaw),k=N._processChunk(T.slice(T.l),N._finishFlushFlag);return T.l+=N.bytesRead,k}(T,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+q)}var it=!1;8&F&&(134695760==T.read_shift(4)&&(T.read_shift(4),it=!0),R=T.read_shift(4),Y=T.read_shift(4)),R!=D&&k_(it,"Bad compressed size: "+D+" != "+R),Y!=S&&k_(it,"Bad uncompressed size: "+S+" != "+Y),Ss(N,he,De,{unsafe:!0,mt:K})}var Vr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function eO(T,D){if(T.ctype)return T.ctype;var S=T.name||"",N=S.match(/\.([^\.]+)$/);return N&&Vr[N[1]]||D&&(N=(S=D).match(/[\.\\]([^\.\\])+$/))&&Vr[N[1]]?Vr[N[1]]:"application/octet-stream"}function tO(T){for(var D=ho(T),S=[],N=0;N<D.length;N+=76)S.push(D.slice(N,N+76));return S.join("\r\n")+"\r\n"}function nO(T){var D=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(R){var Y=R.charCodeAt(0).toString(16).toUpperCase();return"="+(1==Y.length?"0"+Y:Y)});"\n"==(D=D.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(D="=0D"+D.slice(1));for(var S=[],N=(D=D.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),k=0;k<N.length;++k){var F=N[k];if(0!=F.length)for(var q=0;q<F.length;){var K=76,H=F.slice(q,q+K);"="==H.charAt(K-1)?K--:"="==H.charAt(K-2)?K-=2:"="==H.charAt(K-3)&&(K-=3),H=F.slice(q,q+K),(q+=K)<F.length&&(H+="="),S.push(H)}else S.push("")}return S.join("\r\n")}function oO(T,D,S){for(var q,N="",k="",F="",K=0;K<10;++K){var H=D[K];if(!H||H.match(/^\s*$/))break;var R=H.match(/^(.*?):\s*([^\s].*)$/);if(R)switch(R[1].toLowerCase()){case"content-location":N=R[2].trim();break;case"content-type":F=R[2].trim();break;case"content-transfer-encoding":k=R[2].trim()}}switch(++K,k.toLowerCase()){case"base64":q=an(rn(D.slice(K).join("")));break;case"quoted-printable":q=function iO(T){for(var D=[],S=0;S<T.length;++S){for(var N=T[S];S<=T.length&&"="==N.charAt(N.length-1);)N=N.slice(0,N.length-1)+T[++S];D.push(N)}for(var k=0;k<D.length;++k)D[k]=D[k].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return an(D.join("\r\n"))}(D.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var Y=Ss(T,N.slice(S.length),q,{unsafe:!0});F&&(Y.ctype=F)}function Ss(T,D,S,N){var k=N&&N.unsafe;k||A(T);var F=!k&&Te.find(T,D);if(!F){var q=T.FullPaths[0];D.slice(0,q.length)==q?q=D:("/"!=q.slice(-1)&&(q+="/"),q=(q+D).replace("//","/")),F={name:i(D),type:2},T.FileIndex.push(F),T.FullPaths.push(q),k||Te.utils.cfb_gc(T)}return F.content=S,F.size=S?S.length:0,N&&(N.CLSID&&(F.clsid=N.CLSID),N.mt&&(F.mt=N.mt),N.ct&&(F.ct=N.ct)),F}return r.find=function J(T,D){var S=T.FullPaths.map(function(H){return H.toUpperCase()}),N=S.map(function(H){var R=H.split("/");return R[R.length-("/"==H.slice(-1)?2:1)]}),k=!1;47===D.charCodeAt(0)?(k=!0,D=S[0].slice(0,-1)+D):k=-1!==D.indexOf("/");var F=D.toUpperCase(),q=!0===k?S.indexOf(F):N.indexOf(F);if(-1!==q)return T.FileIndex[q];var K=!F.match(xo);for(F=F.replace(qt,""),K&&(F=F.replace(xo,"!")),q=0;q<S.length;++q)if((K?S[q].replace(xo,"!"):S[q]).replace(qt,"")==F||(K?N[q].replace(xo,"!"):N[q]).replace(qt,"")==F)return T.FileIndex[q];return null},r.read=function M(T,D){var S=D&&D.type;switch(S||Ee&&Buffer.isBuffer(T)&&(S="buffer"),S||"base64"){case"file":return function y(T,D){return d(),_(c.readFileSync(T),D)}(T,D);case"base64":return _(an(rn(T)),D);case"binary":return _(an(T),D)}return _(T,D)},r.parse=_,r.write=function ge(T,D){var S=B(T,D);switch(D&&D.type||"buffer"){case"file":return d(),c.writeFileSync(D.filename,S),S;case"binary":return"string"==typeof S?S:_e(S);case"base64":return ho("string"==typeof S?S:_e(S));case"buffer":if(Ee)return Buffer.isBuffer(S)?S:Vn(S);case"array":return"string"==typeof S?an(S):S}return S},r.writeFile=function Pe(T,D,S){d();var N=B(T,S);c.writeFileSync(D,N)},r.utils={cfb_new:function sO(T){var D={};return A(D,T),D},cfb_add:Ss,cfb_del:function lO(T,D){A(T);var S=Te.find(T,D);if(S)for(var N=0;N<T.FileIndex.length;++N)if(T.FileIndex[N]==S)return T.FileIndex.splice(N,1),T.FullPaths.splice(N,1),!0;return!1},cfb_mov:function cO(T,D,S){A(T);var N=Te.find(T,D);if(N)for(var k=0;k<T.FileIndex.length;++k)if(T.FileIndex[k]==N)return T.FileIndex[k].name=i(S),T.FullPaths[k]=S,!0;return!1},cfb_gc:function dO(T){P(T,!0)},ReadShift:No,CheckField:Zl,prep_blob:Ot,bconcat:kt,use_zlib:function I(T){try{var S=new(0,T.InflateRaw);if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),!S.bytesRead)throw new Error("zlib does not expose bytesRead");z=T}catch(N){console.error("cannot use native zlib: "+(N.message||N))}},_deflateRaw:Oe,_inflateRaw:D_,consts:me},r}();function dt(n){for(var r=Object.keys(n),t=[],o=0;o<r.length;++o)Object.prototype.hasOwnProperty.call(n,r[o])&&t.push(r[o]);return t}function _r(n){for(var r=[],t=dt(n),o=0;o!==t.length;++o)r[n[t[o]]]=t[o];return r}var ur=new Date(1899,11,30,0,0,0);function At(n,r){var t=n.getTime();return r&&(t-=1263168e5),(t-(ur.getTime()+6e4*(n.getTimezoneOffset()-ur.getTimezoneOffset())))/864e5}var nl=new Date,W1=ur.getTime()+6e4*(nl.getTimezoneOffset()-ur.getTimezoneOffset()),il=nl.getTimezoneOffset();function fr(n){var r=new Date;return r.setTime(24*n*60*60*1e3+W1),r.getTimezoneOffset()!==il&&r.setTime(r.getTime()+6e4*(r.getTimezoneOffset()-il)),r}function z1(n){var r=0,t=0,o=!1,i=n.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+n+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(t=1,a>3&&(o=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!o)throw new Error("Unsupported ISO Duration Field: M");t*=60}r+=t*parseInt(i[a],10)}return r}var ol=new Date("2017-02-19T19:06:09.000Z"),rl=isNaN(ol.getFullYear())?new Date("2/19/17"):ol,G1=2017==rl.getFullYear();function at(n,r){var t=new Date(n);if(G1)return r>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(n instanceof Date)return n;if(1917==rl.getFullYear()&&!isNaN(t.getFullYear())){var o=t.getFullYear();return n.indexOf(""+o)>-1||t.setFullYear(t.getFullYear()+100),t}var i=n.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return n.indexOf("Z")>-1&&(a=new Date(a.getTime()-60*a.getTimezoneOffset()*1e3)),a}function Ci(n,r){if(Ee&&Buffer.isBuffer(n)){if(r){if(255==n[0]&&254==n[1])return Pn(n.slice(2).toString("utf16le"));if(254==n[1]&&255==n[2])return Pn(Zs(n.slice(2).toString("binary")))}return n.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(r){if(255==n[0]&&254==n[1])return Pn(new TextDecoder("utf-16le").decode(n.slice(2)));if(254==n[0]&&255==n[1])return Pn(new TextDecoder("utf-16be").decode(n.slice(2)))}var t={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(a){return t[a]||a})}catch(a){}for(var o=[],i=0;i!=n.length;++i)o.push(String.fromCharCode(n[i]));return o.join("")}function je(n){if("undefined"!=typeof JSON&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if("object"!=typeof n||null==n)return n;if(n instanceof Date)return new Date(n.getTime());var r={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=je(n[t]));return r}function _t(n,r){for(var t="";t.length<r;)t+=n;return t}function yn(n){var r=Number(n);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(n))return r;var t=1,o=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(o))&&(o=o.replace(/[(](.*)[)]/,function(i,a){return t=-t,a}),isNaN(r=Number(o)))?r:r/t}var X1=["january","february","march","april","may","june","july","august","september","october","november","december"];function Wi(n){var r=new Date(n),t=new Date(NaN),o=r.getYear(),i=r.getMonth(),a=r.getDate();if(isNaN(a))return t;var s=n.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==X1.indexOf(s))return t}else if(s.match(/[a-z]/))return t;return o<0||o>8099?t:(i>0||a>1)&&101!=o?r:n.match(/[^-0-9:,\/\\]/)?t:r}var j1=function(){var n=5=="abacaba".split(/(:?b)/i).length;return function(t,o,i){if(n||"string"==typeof o)return t.split(o);for(var a=t.split(o),s=[a[0]],l=1;l<a.length;++l)s.push(i),s.push(a[l]);return s}}();function al(n){return n?n.content&&n.type?Ci(n.content,!0):n.data?Yi(n.data):n.asNodeBuffer&&Ee?Yi(n.asNodeBuffer().toString("binary")):n.asBinary?Yi(n.asBinary()):n._data&&n._data.getContent?Yi(Ci(Array.prototype.slice.call(n._data.getContent(),0))):null:null}function sl(n){if(!n)return null;if(n.data)return sr(n.data);if(n.asNodeBuffer&&Ee)return n.asNodeBuffer();if(n._data&&n._data.getContent){var r=n._data.getContent();return"string"==typeof r?sr(r):Array.prototype.slice.call(r)}return n.content&&n.type?n.content:null}function mn(n,r){for(var t=n.FullPaths||dt(n.files),o=r.toLowerCase().replace(/[\/]/g,"\\"),i=o.replace(/\\/g,"/"),a=0;a<t.length;++a){var s=t[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(o==s||i==s)return n.files?n.files[t[a]]:n.FileIndex[a]}return null}function ia(n,r){var t=mn(n,r);if(null==t)throw new Error("Cannot find file "+r+" in zip");return t}function Ct(n,r,t){if(!t)return function eg(n){return n&&".bin"===n.name.slice(-4)?sl(n):al(n)}(ia(n,r));if(!r)return null;try{return Ct(n,r)}catch(o){return null}}function ln(n,r,t){if(!t)return al(ia(n,r));if(!r)return null;try{return ln(n,r)}catch(o){return null}}function ll(n,r,t){if(!t)return sl(ia(n,r));if(!r)return null;try{return ll(n,r)}catch(o){return null}}function cl(n){for(var r=n.FullPaths||dt(n.files),t=[],o=0;o<r.length;++o)"/"!=r[o].slice(-1)&&t.push(r[o].replace(/^Root Entry[\/]/,""));return t.sort()}function dl(n,r){switch(r.type){case"base64":return Te.read(n,{type:"base64"});case"binary":return Te.read(n,{type:"binary"});case"buffer":case"array":return Te.read(n,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function bo(n,r){if("/"==n.charAt(0))return n.slice(1);var t=r.split("/");"/"!=r.slice(-1)&&t.pop();for(var o=n.split("/");0!==o.length;){var i=o.shift();".."===i?t.pop():"."!==i&&t.push(i)}return t.join("/")}var Tt='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',tg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_l=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Rt=Tt.match(_l)?_l:/<[^>]*>/g,ig=/<\w*:/,og=/<(\/?)\w+:/;function Ae(n,r,t){for(var o={},i=0,a=0;i!==n.length&&32!==(a=n.charCodeAt(i))&&10!==a&&13!==a;++i);if(r||(o[0]=n.slice(0,i)),i===n.length)return o;var s=n.match(tg),l=0,c="",d=0,_="",u="",f=1;if(s)for(d=0;d!=s.length;++d){for(u=s[d],a=0;a!=u.length&&61!==u.charCodeAt(a);++a);for(_=u.slice(0,a).trim();32==u.charCodeAt(a+1);)++a;for(f=34==(i=u.charCodeAt(a+1))||39==i?1:0,c=u.slice(a+1+f,u.length-f),l=0;l!=_.length&&58!==_.charCodeAt(l);++l);if(l===_.length)_.indexOf("_")>0&&(_=_.slice(0,_.indexOf("_"))),o[_]=c,t||(o[_.toLowerCase()]=c);else{var m=(5===l&&"xmlns"===_.slice(0,5)?"xmlns":"")+_.slice(l+1);if(o[m]&&"ext"==_.slice(l-3,l))continue;o[m]=c,t||(o[m.toLowerCase()]=c)}}return o}function Zn(n){return n.replace(og,"<$1")}var pl={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ra=_r(pl),Qe=function(){var n=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,r=/_x([\da-fA-F]{4})_/gi;return function t(o){var i=o+"",a=i.indexOf("<![CDATA[");if(-1==a)return i.replace(n,function(l,c){return pl[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=i.indexOf("]]>");return t(i.slice(0,a))+i.slice(a+9,s)+t(i.slice(s+3))}}(),aa=/[&<>'"]/g,fl=/[\u0000-\u001f]/g;function sa(n){return(n+"").replace(aa,function(t){return ra[t]}).replace(/\n/g,"<br/>").replace(fl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var ml=function(){var n=/&#(\d+);/g;function r(t,o){return String.fromCharCode(parseInt(o,10))}return function(o){return o.replace(n,r)}}();function tt(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function la(n){for(var r="",t=0,o=0,i=0,a=0,s=0,l=0;t<n.length;)(o=n.charCodeAt(t++))<128?r+=String.fromCharCode(o):(i=n.charCodeAt(t++),o>191&&o<224?(s=(31&o)<<6,s|=63&i,r+=String.fromCharCode(s)):(a=n.charCodeAt(t++),o<240?r+=String.fromCharCode((15&o)<<12|(63&i)<<6|63&a):(l=((7&o)<<18|(63&i)<<12|(63&a)<<6|63&(s=n.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(1023&l)))));return r}function hl(n){var t,o,l,r=ii(2*n.length),i=1,a=0,s=0;for(o=0;o<n.length;o+=i)i=1,(l=n.charCodeAt(o))<128?t=l:l<224?(t=64*(31&l)+(63&n.charCodeAt(o+1)),i=2):l<240?(t=4096*(15&l)+64*(63&n.charCodeAt(o+1))+(63&n.charCodeAt(o+2)),i=3):(i=4,t=262144*(7&l)+4096*(63&n.charCodeAt(o+1))+64*(63&n.charCodeAt(o+2))+(63&n.charCodeAt(o+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(r[a++]=255&s,r[a++]=s>>>8,s=0),r[a++]=t%256,r[a++]=t>>>8;return r.slice(0,a).toString("ucs2")}function gl(n){return Vn(n,"binary").toString("utf8")}var mr="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Xe=Ee&&(gl(mr)==la(mr)&&gl||hl(mr)==la(mr)&&hl)||la,Pn=Ee?function(n){return Vn(n,"utf8").toString("binary")}:function(n){for(var r=[],t=0,o=0,i=0;t<n.length;)switch(o=n.charCodeAt(t++),!0){case o<128:r.push(String.fromCharCode(o));break;case o<2048:r.push(String.fromCharCode(192+(o>>6))),r.push(String.fromCharCode(128+(63&o)));break;case o>=55296&&o<57344:o-=55296,i=n.charCodeAt(t++)-56320+(o<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(63&i)));break;default:r.push(String.fromCharCode(224+(o>>12))),r.push(String.fromCharCode(128+(o>>6&63))),r.push(String.fromCharCode(128+(63&o)))}return r.join("")},wo=function(){var n={};return function(t,o){var i=t+"|"+(o||"");return n[i]?n[i]:n[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",o||"")}}(),xl=function(){var n=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var o=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),i=0;i<n.length;++i)o=o.replace(n[i][0],n[i][1]);return o}}(),lg=function(){var n={};return function(t){return void 0!==n[t]?n[t]:n[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),cg=/<\/?(?:vt:)?variant>/g,dg=/<(?:vt:)([^>]*)>([\s\S]*)</;function vl(n,r){var t=Ae(n),o=n.match(lg(t.baseType))||[],i=[];if(o.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+o.length+" != "+t.size);return i}return o.forEach(function(a){var s=a.replace(cg,"").match(dg);s&&i.push({v:Xe(s[2]),t:s[1]})}),i}var Cl=/(^\s|\s$|\n)/;function oe(n,r,t){return"<"+n+(null!=t?function Tl(n){return dt(n).map(function(r){return" "+r+'="'+n[r]+'"'}).join("")}(t):"")+(null!=r?(r.match(Cl)?' xml:space="preserve"':"")+">"+r+"</"+n:"/")+">"}function da(n){if(Ee&&Buffer.isBuffer(n))return n.toString("utf8");if("string"==typeof n)return n;if("undefined"!=typeof Uint8Array&&n instanceof Uint8Array)return Xe(oi(jr(n)));throw new Error("Bad input format: expected Buffer or string")}var So=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,li=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bl=function(n){for(var r=[],o=0;o<n[0].length;++o)if(n[0][o])for(var i=0,a=n[0][o].length;i<a;i+=10240)r.push.apply(r,n[0][o].slice(i,i+10240));return r},wl=Ee?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(r){return Buffer.isBuffer(r)?r:Vn(r)})):bl(n)}:bl,Sl=function(n,r,t){for(var o=[],i=r;i<t;i+=2)o.push(String.fromCharCode(Kn(n,i)));return o.join("").replace(qt,"")},hr=Ee?function(n,r,t){return Buffer.isBuffer(n)?n.toString("utf16le",r,t).replace(qt,""):Sl(n,r,t)}:Sl,Nl=function(n,r,t){for(var o=[],i=r;i<r+t;++i)o.push(("0"+n[i].toString(16)).slice(-2));return o.join("")},Al=Ee?function(n,r,t){return Buffer.isBuffer(n)?n.toString("hex",r,r+t):Nl(n,r,t)}:Nl,yl=function(n,r,t){for(var o=[],i=r;i<t;i++)o.push(String.fromCharCode(Gi(n,i)));return o.join("")},zi=Ee?function(r,t,o){return Buffer.isBuffer(r)?r.toString("utf8",t,o):yl(r,t,o)}:yl,Dl=function(n,r){var t=Ft(n,r);return t>0?zi(n,r+4,r+4+t-1):""},_a=Dl,kl=function(n,r){var t=Ft(n,r);return t>0?zi(n,r+4,r+4+t-1):""},pa=kl,Fl=function(n,r){var t=2*Ft(n,r);return t>0?zi(n,r+4,r+4+t-1):""},ua=Fl,Ml=function(r,t){var o=Ft(r,t);return o>0?hr(r,t+4,t+4+o):""},fa=Ml,Ll=function(n,r){var t=Ft(n,r);return t>0?zi(n,r+4,r+4+t):""},ma=Ll,Il=function(n,r){return function pg(n,r){for(var t=1-2*(n[r+7]>>>7),o=((127&n[r+7])<<4)+(n[r+6]>>>4&15),i=15&n[r+6],a=5;a>=0;--a)i=256*i+n[r+a];return 2047==o?0==i?t*(1/0):NaN:(0==o?o=-1022:(o-=1023,i+=Math.pow(2,52)),t*Math.pow(2,o-52)*i)}(n,r)},gr=Il,ha=function(r){return Array.isArray(r)||"undefined"!=typeof Uint8Array&&r instanceof Uint8Array};Ee&&(_a=function(r,t){if(!Buffer.isBuffer(r))return Dl(r,t);var o=r.readUInt32LE(t);return o>0?r.toString("utf8",t+4,t+4+o-1):""},pa=function(r,t){if(!Buffer.isBuffer(r))return kl(r,t);var o=r.readUInt32LE(t);return o>0?r.toString("utf8",t+4,t+4+o-1):""},ua=function(r,t){if(!Buffer.isBuffer(r))return Fl(r,t);var o=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+o-1)},fa=function(r,t){if(!Buffer.isBuffer(r))return Ml(r,t);var o=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+o)},ma=function(r,t){if(!Buffer.isBuffer(r))return Ll(r,t);var o=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+o)},gr=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Il(r,t)},ha=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||"undefined"!=typeof Uint8Array&&r instanceof Uint8Array});var Gi=function(n,r){return n[r]},Kn=function(n,r){return 256*n[r+1]+n[r]},fg=function(n,r){var t=256*n[r+1]+n[r];return t<32768?t:-1*(65535-t+1)},Ft=function(n,r){return n[r+3]*(1<<24)+(n[r+2]<<16)+(n[r+1]<<8)+n[r]},Ti=function(n,r){return n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]},mg=function(n,r){return n[r]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]};function No(n,r){var o,i,s,l,c,d,t="",a=[];switch(r){case"dbcs":if(d=this.l,Ee&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(c=0;c<n;++c)t+=String.fromCharCode(Kn(this,d)),d+=2;n*=2;break;case"utf8":t=zi(this,this.l,this.l+n);break;case"utf16le":t=hr(this,this.l,this.l+(n*=2));break;case"wstr":return No.call(this,n,"dbcs");case"lpstr-ansi":t=_a(this,this.l),n=4+Ft(this,this.l);break;case"lpstr-cp":t=pa(this,this.l),n=4+Ft(this,this.l);break;case"lpwstr":t=ua(this,this.l),n=4+2*Ft(this,this.l);break;case"lpp4":n=4+Ft(this,this.l),t=fa(this,this.l),2&n&&(n+=2);break;case"8lpp4":n=4+Ft(this,this.l),t=ma(this,this.l),3&n&&(n+=4-(3&n));break;case"cstr":for(n=0,t="";0!==(s=Gi(this,this.l+n++));)a.push(fo(s));t=a.join("");break;case"_wstr":for(n=0,t="";0!==(s=Kn(this,this.l+n));)a.push(fo(s)),n+=2;n+=2,t=a.join("");break;case"dbcs-cont":for(t="",d=this.l,c=0;c<n;++c){if(this.lens&&-1!==this.lens.indexOf(d))return s=Gi(this,d),this.l=d+1,l=No.call(this,n-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(fo(Kn(this,d))),d+=2}t=a.join(""),n*=2;break;case"cpstr":0;case"sbcs-cont":for(t="",d=this.l,c=0;c!=n;++c){if(this.lens&&-1!==this.lens.indexOf(d))return s=Gi(this,d),this.l=d+1,l=No.call(this,n-c,s?"dbcs-cont":"sbcs-cont"),a.join("")+l;a.push(fo(Gi(this,d))),d+=1}t=a.join("");break;default:switch(n){case 1:return o=Gi(this,this.l),this.l++,o;case 2:return o=("i"===r?fg:Kn)(this,this.l),this.l+=2,o;case 4:case-4:return"i"===r||0==(128&this[this.l+3])?(o=(n>0?Ti:mg)(this,this.l),this.l+=4,o):(i=Ft(this,this.l),this.l+=4,i);case 8:case-8:if("f"===r)return i=8==n?gr(this,this.l):gr([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=Al(this,this.l,n)}}return this.l+=n,t}var xg=function(n,r,t){n[t]=255&r,n[t+1]=r>>>8&255};function vg(n,r,t){var o=0,i=0;if("dbcs"===t){for(i=0;i!=r.length;++i)xg(this,r.charCodeAt(i),this.l+2*i);o=2*r.length}else if("sbcs"===t){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=255&r.charCodeAt(i);o=r.length}else{if("hex"===t){for(;i<n;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===t){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(r.length,n);++i){var l=r.charCodeAt(i);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(n){case 1:o=1,this[this.l]=255&r;break;case 2:o=2,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8);break;case 3:o=3,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8),this[this.l+2]=255&(r>>>=8);break;case 4:o=4,function(n,r,t){n[t]=255&r,n[t+1]=r>>>8&255,n[t+2]=r>>>16&255,n[t+3]=r>>>24&255}(this,r,this.l);break;case 8:if(o=8,"f"===t){!function ug(n,r,t){var o=(r<0||1/r==-1/0?1:0)<<7,i=0,a=0,s=o?-r:r;isFinite(s)?0==s?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(r)?26985:0);for(var l=0;l<=5;++l,a/=256)n[t+l]=255&a;n[t+6]=(15&i)<<4|15&a,n[t+7]=i>>4|o}(this,r,this.l);break}case 16:break;case-4:o=4,function(n,r,t){n[t]=255&r,n[t+1]=r>>8&255,n[t+2]=r>>16&255,n[t+3]=r>>24&255}(this,r,this.l)}}return this.l+=o,this}function Zl(n,r){var t=Al(this,this.l,n.length>>1);if(t!==n)throw new Error(r+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Ot(n,r){n.l=r,n.read_shift=No,n.chk=Zl,n.write_shift=vg}function Qt(n,r){n.l+=r}function V(n){var r=ii(n);return Ot(r,0),r}function Wn(n,r,t){if(n){var o,i,a;Ot(n,n.l||0);for(var s=n.length,l=0,c=0;n.l<s;){128&(l=n.read_shift(1))&&(l=(127&l)+((127&n.read_shift(1))<<7));var d=Ho[l]||Ho[65535];for(a=127&(o=n.read_shift(1)),i=1;i<4&&128&o;++i)a+=(127&(o=n.read_shift(1)))<<7*i;c=n.l+a;var _=d.f&&d.f(n,a,t);if(n.l=c,r(_,d,l))return}}}function Gt(){var n=[],r=Ee?256:2048,t=function(d){var _=V(d);return Ot(_,0),_},o=t(r),i=function(){!o||(o.length>o.l&&((o=o.slice(0,o.l)).l=o.length),o.length>0&&n.push(o),o=null)},a=function(d){return o&&d<o.length-o.l?o:(i(),o=t(Math.max(d+1,r)))};return{next:a,push:function(d){i(),null==(o=d).l&&(o.l=o.length),a(r)},end:function(){return i(),kt(n)},_bufs:n}}function Ao(n,r,t){var o=je(n);if(r.s?(o.cRel&&(o.c+=r.s.c),o.rRel&&(o.r+=r.s.r)):(o.cRel&&(o.c+=r.c),o.rRel&&(o.r+=r.r)),!t||t.biff<12){for(;o.c>=256;)o.c-=256;for(;o.r>=65536;)o.r-=65536}return o}function Pl(n,r,t){var o=je(n);return o.s=Ao(o.s,r.s,t),o.e=Ao(o.e,r.s,t),o}function yo(n,r){if(n.cRel&&n.c<0)for(n=je(n);n.c<0;)n.c+=r>8?16384:256;if(n.rRel&&n.r<0)for(n=je(n);n.r<0;)n.r+=r>8?1048576:r>5?65536:16384;var t=ye(n);return!n.cRel&&null!=n.cRel&&(t=function bg(n){return n.replace(/^([A-Z])/,"$$$1")}(t)),!n.rRel&&null!=n.rRel&&(t=function Cg(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function ga(n,r){return 0!=n.s.r||n.s.rRel||n.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||n.e.rRel?0!=n.s.c||n.s.cRel||n.e.c!=(r.biff>=12?16383:255)||n.e.cRel?yo(n.s,r.biff)+":"+yo(n.e,r.biff):(n.s.rRel?"":"$")+pt(n.s.r)+":"+(n.e.rRel?"":"$")+pt(n.e.r):(n.s.cRel?"":"$")+nt(n.s.c)+":"+(n.e.cRel?"":"$")+nt(n.e.c)}function xa(n){return parseInt(function Tg(n){return n.replace(/\$(\d+)$/,"$1")}(n),10)-1}function pt(n){return""+(n+1)}function va(n){for(var r=function wg(n){return n.replace(/^\$([A-Z])/,"$1")}(n),t=0,o=0;o!==r.length;++o)t=26*t+r.charCodeAt(o)-64;return t-1}function nt(n){if(n<0)throw new Error("invalid column "+n);var r="";for(++n;n;n=Math.floor((n-1)/26))r=String.fromCharCode((n-1)%26+65)+r;return r}function st(n){for(var r=0,t=0,o=0;o<n.length;++o){var i=n.charCodeAt(o);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function ye(n){for(var r=n.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(n.r+1)}function dn(n){var r=n.indexOf(":");return-1==r?{s:st(n),e:st(n)}:{s:st(n.slice(0,r)),e:st(n.slice(r+1))}}function ke(n,r){return void 0===r||"number"==typeof r?ke(n.s,n.e):("string"!=typeof n&&(n=ye(n)),"string"!=typeof r&&(r=ye(r)),n==r?n:n+":"+r)}function Je(n){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,o=0,i=0,a=n.length;for(t=0;o<a&&!((i=n.charCodeAt(o)-64)<1||i>26);++o)t=26*t+i;for(r.s.c=--t,t=0;o<a&&!((i=n.charCodeAt(o)-48)<0||i>9);++o)t=10*t+i;if(r.s.r=--t,o===a||10!=i)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++o,t=0;o!=a&&!((i=n.charCodeAt(o)-64)<1||i>26);++o)t=26*t+i;for(r.e.c=--t,t=0;o!=a&&!((i=n.charCodeAt(o)-48)<0||i>9);++o)t=10*t+i;return r.e.r=--t,r}function On(n,r,t){return null==n||null==n.t||"z"==n.t?"":void 0!==n.w?n.w:("d"==n.t&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),"e"==n.t?zn[n.v]||n.v:function Ol(n,r){var t="d"==n.t&&r instanceof Date;if(null!=n.z)try{return n.w=sn(n.z,t?At(r):r)}catch(o){}try{return n.w=sn((n.XF||{}).numFmtId||(t?14:0),t?At(r):r)}catch(o){return""+r}}(n,null==r?n.v:r))}function ci(n,r){var t=r&&r.sheet?r.sheet:"Sheet1",o={};return o[t]=n,{SheetNames:[t],Sheets:o}}function Ul(n,r,t){var o=t||{},i=n?Array.isArray(n):o.dense,a=n||(i?[]:{}),s=0,l=0;if(a&&null!=o.origin){if("number"==typeof o.origin)s=o.origin;else{var c="string"==typeof o.origin?st(o.origin):o.origin;s=c.r,l=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var _=Je(a["!ref"]);d.s.c=_.s.c,d.s.r=_.s.r,d.e.c=Math.max(d.e.c,_.e.c),d.e.r=Math.max(d.e.r,_.e.r),-1==s&&(d.e.r=s=_.e.r+1)}for(var u=0;u!=r.length;++u)if(r[u]){if(!Array.isArray(r[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=r[u].length;++f)if(void 0!==r[u][f]){var m={v:r[u][f]},h=s+u,p=l+f;if(d.s.r>h&&(d.s.r=h),d.s.c>p&&(d.s.c=p),d.e.r<h&&(d.e.r=h),d.e.c<p&&(d.e.c=p),!r[u][f]||"object"!=typeof r[u][f]||Array.isArray(r[u][f])||r[u][f]instanceof Date)if(Array.isArray(m.v)&&(m.f=r[u][f][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(o.nullError)m.t="e",m.v=0;else{if(!o.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=o.dateNF||we[14],o.cellDates?(m.t="d",m.w=sn(m.z,At(m.v))):(m.t="n",m.v=At(m.v),m.w=sn(m.z,m.v))):m.t="s";else m=r[u][f];if(i)a[h]||(a[h]=[]),a[h][p]&&a[h][p].z&&(m.z=a[h][p].z),a[h][p]=m;else{var g=ye({c:p,r:h});a[g]&&a[g].z&&(m.z=a[g].z),a[g]=m}}}return d.s.c<1e7&&(a["!ref"]=ke(d)),a}function Xi(n,r){return Ul(null,n,r)}function Ht(n){var r=n.read_shift(4);return 0===r?"":n.read_shift(r,"dbcs")}function Ag(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Ca(n,r){var t=n.l,o=n.read_shift(1),i=Ht(n),a=[],s={t:i,h:i};if(0!=(1&o)){for(var l=n.read_shift(4),c=0;c!=l;++c)a.push(Ag(n));s.r=a}else s.r=[{ich:0,ifnt:0}];return n.l=t+r,s}var Dg=Ca;function hn(n){var r=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:r,iStyleRef:t}}function wi(n){var r=n.read_shift(2);return r+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:r}}var Fg=Ht;function Ta(n){var r=n.read_shift(4);return 0===r||4294967295===r?"":n.read_shift(r,"dbcs")}var Mg=Ht,wa=Ta;function Na(n){var r=n.slice(n.l,n.l+4),t=1&r[0],o=2&r[0];n.l+=4;var i=0===o?gr([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):Ti(r,0)>>2;return t?i/100:i}function ql(n){var r={s:{},e:{}};return r.s.r=n.read_shift(4),r.e.r=n.read_shift(4),r.s.c=n.read_shift(4),r.e.c=n.read_shift(4),r}var Ni=ql;function Yt(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Rl(n,r){var o=n.read_shift(4);switch(o){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[n.read_shift(4)]||""}if(o>400)throw new Error("Unsupported Clipboard: "+o.toString(16));return n.l-=4,n.read_shift(0,1==r?"lpstr":"lpwstr")}var qg=[80,81],ya={1:{n:"CodePage",t:2},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Da={1:{n:"CodePage",t:2},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Yl={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Rg=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Qg(n){return n.map(function(r){return[r>>16&255,r>>8&255,255&r]})}var yi=je(Qg([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),zn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Vl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ka={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Do(n){var r=n.lastIndexOf("/");return n.slice(0,r+1)+"_rels/"+n.slice(r+1)+".rels"}function ko(n,r){var t={"!id":{}};if(!n)return t;"/"!==r.charAt(0)&&(r="/"+r);var o={};return(n.match(Rt)||[]).forEach(function(i){var a=Ae(i);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var l="External"===a.TargetMode?a.Target:bo(a.Target,r);t[l]=s,o[a.Id]=s}}),t["!id"]=o,t}var gn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Xg=function(){for(var n=new Array(gn.length),r=0;r<gn.length;++r){var t=gn[r],o="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);n[r]=new RegExp("<"+o+"[^>]*>([\\s\\S]*?)</"+o+">")}return n}();function Wl(n){var r={};n=Xe(n);for(var t=0;t<gn.length;++t){var o=gn[t],i=n.match(Xg[t]);null!=i&&i.length>0&&(r[o[1]]=Qe(i[1])),"date"===o[2]&&r[o[1]]&&(r[o[1]]=at(r[o[1]]))}return r}var Di=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Xl(n,r,t,o){var i=[];if("string"==typeof n)i=vl(n,o);else for(var a=0;a<n.length;++a)i=i.concat(n[a].map(function(_){return{v:_}}));var s="string"==typeof r?vl(r,o).map(function(_){return _.v}):r,l=0,c=0;if(s.length>0)for(var d=0;d!==i.length;d+=2){switch(c=+i[d+1].v,i[d].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":t.NamedRanges=c,t.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(l,l+c)}l+=c}}var Ia,ex=/<[^>]+>[^<]*/g,La={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function nx(n,r,t){Ia||(Ia=_r(La)),n[r=Ia[r]||r]=t}function Ea(n){var r=n.read_shift(4),t=n.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function tc(n,r,t){var o=n.l,i=n.read_shift(0,"lpstr-cp");if(t)for(;n.l-o&3;)++n.l;return i}function nc(n,r,t){var o=n.read_shift(0,"lpwstr");return t&&(n.l+=4-(o.length+1&3)&3),o}function ic(n,r,t){return 31===r?nc(n):tc(n,0,t)}function Za(n,r,t){return ic(n,r,!1===t?0:4)}function cx(n){var r=n.l,t=Sr(n,81);return 0==n[n.l]&&0==n[n.l+1]&&n.l-r&2&&(n.l+=2),[t,Sr(n,3)]}function oc(n,r){for(var t=n.read_shift(4),o={},i=0;i!=t;++i){var a=n.read_shift(4),s=n.read_shift(4);o[a]=n.read_shift(s,1200===r?"utf16le":"utf8").replace(qt,"").replace(xo,"!"),1200===r&&s%2&&(n.l+=2)}return 3&n.l&&(n.l=n.l>>3<<2),o}function rc(n){var r=n.read_shift(4),t=n.slice(n.l,n.l+r);return n.l+=r,(3&r)>0&&(n.l+=4-(3&r)&3),t}function Sr(n,r,t){var i,o=n.read_shift(2),a=t||{};if(n.l+=2,12!==r&&o!==r&&-1===qg.indexOf(r)&&(4126!=(65534&r)||4126!=(65534&o)))throw new Error("Expected type "+r+" saw "+o);switch(12===r?o:r){case 2:return i=n.read_shift(2,"i"),a.raw||(n.l+=2),i;case 3:return n.read_shift(4,"i");case 11:return 0!==n.read_shift(4);case 19:return n.read_shift(4);case 30:return tc(n,0,4).replace(qt,"");case 31:return nc(n);case 64:return Ea(n);case 65:return rc(n);case 71:return function _x(n){var r={};return r.Size=n.read_shift(4),n.l+=r.Size+3-(r.Size-1)%4,r}(n);case 80:return Za(n,o,!a.raw).replace(qt,"");case 81:return function ax(n,r){if(!r)throw new Error("VtUnalignedString must have positive length");return ic(n,r,0)}(n,o).replace(qt,"");case 4108:return function dx(n){for(var r=n.read_shift(4),t=[],o=0;o<r/2;++o)t.push(cx(n));return t}(n);case 4126:case 4127:return 4127==o?function sx(n){for(var r=n.read_shift(4),t=[],o=0;o!=r;++o){var i=n.l;t[o]=n.read_shift(0,"lpwstr").replace(qt,""),n.l-i&2&&(n.l+=2)}return t}(n):function lx(n){for(var r=n.read_shift(4),t=[],o=0;o!=r;++o)t[o]=n.read_shift(0,"lpstr-cp").replace(qt,"");return t}(n);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+o)}}function sc(n,r){var t=n.l,o=n.read_shift(4),i=n.read_shift(4),a=[],s=0,l=0,c=-1,d={};for(s=0;s!=i;++s){var _=n.read_shift(4),u=n.read_shift(4);a[s]=[_,u+t]}a.sort(function(x,C){return x[1]-C[1]});var f={};for(s=0;s!=i;++s){if(n.l!==a[s][1]){var m=!0;if(s>0&&r)switch(r[a[s-1][0]].t){case 2:n.l+2===a[s][1]&&(n.l+=2,m=!1);break;case 80:case 4108:n.l<=a[s][1]&&(n.l=a[s][1],m=!1)}if((!r||0==s)&&n.l<=a[s][1]&&(m=!1,n.l=a[s][1]),m)throw new Error("Read Error: Expected address "+a[s][1]+" at "+n.l+" :"+s)}if(r){var h=r[a[s][0]];if(f[h.n]=Sr(n,h.t,{raw:!0}),"version"===h.p&&(f[h.n]=String(f[h.n]>>16)+"."+("0000"+String(65535&f[h.n])).slice(-4)),"CodePage"==h.n)switch(f[h.n]){case 0:f[h.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:un(l=f[h.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[h.n])}}else if(1===a[s][0]){if(l=f.CodePage=Sr(n,2),un(l),-1!==c){var p=n.l;n.l=a[c][1],d=oc(n,l),n.l=p}}else if(0===a[s][0]){if(0===l){c=s,n.l=a[s+1][1];continue}d=oc(n,l)}else{var v,g=d[a[s][0]];switch(n[n.l]){case 65:n.l+=4,v=rc(n);break;case 30:case 31:n.l+=4,v=Za(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 3:n.l+=4,v=n.read_shift(4,"i");break;case 19:n.l+=4,v=n.read_shift(4);break;case 5:n.l+=4,v=n.read_shift(8,"f");break;case 11:n.l+=4,v=ft(n,4);break;case 64:n.l+=4,v=at(Ea(n));break;default:throw new Error("unparsed value: "+n[n.l])}f[g]=v}}return n.l=t+o,f}function dc(n,r,t){var o=n.content;if(!o)return{};Ot(o,0);var i,a,s,l,c=0;o.chk("feff","Byte Order: "),o.read_shift(2);var d=o.read_shift(4),_=o.read_shift(16);if(_!==Te.utils.consts.HEADER_CLSID&&_!==t)throw new Error("Bad PropertySet CLSID "+_);if(1!==(i=o.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(a=o.read_shift(16),l=o.read_shift(4),1===i&&l!==o.l)throw new Error("Length mismatch: "+l+" !== "+o.l);2===i&&(s=o.read_shift(16),c=o.read_shift(4));var h,u=sc(o,r),f={SystemIdentifier:d};for(var m in u)f[m]=u[m];if(f.FMTID=a,1===i)return f;if(c-o.l==2&&(o.l+=2),o.l!==c)throw new Error("Length mismatch 2: "+o.l+" !== "+c);try{h=sc(o,null)}catch(p){}for(m in h)f[m]=h[m];return f.FMTID=[a,s],f}function di(n,r){return n.read_shift(r),null}function ft(n,r){return 1===n.read_shift(r)}function wt(n){return n.read_shift(2,"u")}function pc(n,r){return function fx(n,r,t){for(var o=[],i=n.l+r;n.l<i;)o.push(t(n,i-n.l));if(i!==n.l)throw new Error("Slurp error");return o}(n,r,wt)}function Fo(n,r,t){var o=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=on;t&&t.biff>=8&&(on=1200),t&&8!=t.biff?12==t.biff&&(i="wstr"):n.read_shift(1)&&(i="dbcs-cont"),t.biff>=2&&t.biff<=5&&(i="cpstr");var l=o?n.read_shift(o,i):"";return on=a,l}function hx(n){var r=on;on=1200;var c,t=n.read_shift(2),o=n.read_shift(1),i=4&o,a=8&o,s=1+(1&o),l=0,d={};a&&(l=n.read_shift(2)),i&&(c=n.read_shift(4));var u=0===t?"":n.read_shift(t,2==s?"dbcs-cont":"sbcs-cont");return a&&(n.l+=4*l),i&&(n.l+=c),d.t=u,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),on=r,d}function ki(n,r,t){if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(r,"cpstr");if(t.biff>=12)return n.read_shift(r,"dbcs-cont")}var i=n.read_shift(1);return n.read_shift(r,0===i?"sbcs-cont":"dbcs-cont")}function Mo(n,r,t){var o=n.read_shift(t&&2==t.biff?1:2);return 0===o?(n.l++,""):ki(n,o,t)}function Fi(n,r,t){if(t.biff>5)return Mo(n,0,t);var o=n.read_shift(1);return 0===o?(n.l++,""):n.read_shift(o,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function Nr(n){var r=n.read_shift(4);return r>0?n.read_shift(r,"utf16le").replace(qt,""):""}function hc(n){return[n.read_shift(1),n.read_shift(1),n.read_shift(1),n.read_shift(1)]}function gc(n,r){var t=hc(n);return t[3]=0,t}function Un(n){return{r:n.read_shift(2),c:n.read_shift(2),ixfe:n.read_shift(2)}}function Ax(n,r,t){var o=t.biff>8?4:2;return[n.read_shift(o),n.read_shift(o,"i"),n.read_shift(o,"i")]}function xc(n){return[n.read_shift(2),Na(n)]}function Ar(n){var r=n.read_shift(2),t=n.read_shift(2);return{s:{c:n.read_shift(2),r},e:{c:n.read_shift(2),r:t}}}function Cc(n){var r=n.read_shift(2),t=n.read_shift(2);return{s:{c:n.read_shift(1),r},e:{c:n.read_shift(1),r:t}}}var Dx=Cc;function Tc(n){n.l+=4;var r=n.read_shift(2),t=n.read_shift(2),o=n.read_shift(2);return n.l+=12,[t,r,o]}function Vt(n){n.l+=2,n.l+=n.read_shift(2)}var Mx={0:Vt,4:Vt,5:Vt,6:Vt,7:function Fx(n){return n.l+=4,n.cf=n.read_shift(2),{}},8:Vt,9:Vt,10:Vt,11:Vt,12:Vt,13:function kx(n){var r={};return n.l+=4,n.l+=16,r.fSharedNote=n.read_shift(2),n.l+=4,r},14:Vt,15:Vt,16:Vt,17:Vt,18:Vt,19:Vt,20:Vt,21:Tc};function yr(n,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=n.read_shift(2),(r-=2)>=2&&(t.dt=n.read_shift(2),n.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return n.read_shift(r),t}function bc(n,r,t){var o=0;t&&2==t.biff||(o=n.read_shift(2));var i=n.read_shift(2);return t&&2==t.biff&&(o=1-(i>>15),i&=32767),[{Unsynced:1&o,DyZero:(2&o)>>1,ExAsc:(4&o)>>2,ExDsc:(8&o)>>3},i]}var o2=Fi;function wc(n,r,t){var o=n.l+r,i=8!=t.biff&&t.biff?2:4,a=n.read_shift(i),s=n.read_shift(i),l=n.read_shift(2),c=n.read_shift(2);return n.l=o,{s:{r:a,c:l},e:{r:s,c}}}function Nc(n,r,t){var o=Un(n);(2==t.biff||9==r)&&++n.l;var i=function mx(n){var r=n.read_shift(1);return 1===n.read_shift(1)?r:1===r}(n);return o.val=i,o.t=!0===i||!1===i?"b":"e",o}var Ac=function Nx(n,r,t){return 0===r?"":Fi(n,0,t)};function yc(n,r,t){var i,o=n.read_shift(2),a={fBuiltIn:1&o,fWantAdvise:o>>>1&1,fWantPict:o>>>2&1,fOle:o>>>3&1,fOleLink:o>>>4&1,cf:o>>>5&1023,fIcon:o>>>15&1};return 14849===t.sbcch&&(i=function yx(n,r,t){n.l+=4;var o=n.l+(r-=4),i=Fo(n,0,t),a=n.read_shift(2);if(a!==(o-=n.l))throw new Error("Malformed AddinUdf: padding = "+o+" != "+a);return n.l+=a,i}(n,r-2,t)),a.body=i||n.read_shift(r-2),"string"==typeof i&&(a.Name=i),a}var g2=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Dc(n,r,t){var o=n.l+r,i=n.read_shift(2),a=n.read_shift(1),s=n.read_shift(1),l=n.read_shift(t&&2==t.biff?1:2),c=0;(!t||t.biff>=5)&&(5!=t.biff&&(n.l+=2),c=n.read_shift(2),5==t.biff&&(n.l+=2),n.l+=4);var d=ki(n,s,t);32&i&&(d=g2[d.charCodeAt(0)]);var _=o-n.l;t&&2==t.biff&&--_;var u=o!=n.l&&0!==l&&_>0?function I3(n,r,t,o){var s,i=n.l+r,a=Bo(n,o,t);return i!==n.l&&(s=Uo(n,i-n.l,a,t)),[a,s]}(n,_,t,l):[];return{chKey:a,Name:d,itab:c,rgce:u}}function kc(n,r,t){if(t.biff<8)return function x2(n,r,t){3==n[n.l+1]&&n[n.l]++;var o=Fo(n,0,t);return 3==o.charCodeAt(0)?o.slice(1):o}(n,0,t);for(var o=[],i=n.l+r,a=n.read_shift(t.biff>8?4:2);0!=a--;)o.push(Ax(n,0,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return o}function Fc(n,r,t){var o=Dx(n,6);switch(t.biff){case 2:n.l++,r-=7;break;case 3:case 4:n.l+=2,r-=8;break;default:n.l+=6,r-=12}return[o,M3(n,r,t)]}var y2={8:function(n,r){var t=n.l+r;n.l+=10;var o=n.read_shift(2);n.l+=4,n.l+=2,n.l+=2,n.l+=2,n.l+=4;var i=n.read_shift(1);return n.l+=i,n.l=t,{fmt:o}}};function Mc(n,r,t){if(!t.cellStyles)return Qt(n,r);var o=t&&t.biff>=12?4:2,i=n.read_shift(o),a=n.read_shift(o),s=n.read_shift(o),l=n.read_shift(o),c=n.read_shift(2);2==o&&(n.l+=2);var d={s:i,e:a,w:s,ixfe:l,flags:c};return(t.biff>=5||!t.biff)&&(d.level=c>>8&7),d}var Q2=Un,H2=pc,Y2=Mo,tv=[2,3,48,49,131,139,140,245],Oa=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=_r({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function o(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var _=Xi(function t(l,c){var d=[],_=ii(1);switch(c.type){case"base64":_=an(rn(l));break;case"binary":_=an(l);break;case"buffer":case"array":_=l}Ot(_,0);var u=_.read_shift(1),f=!!(136&u),m=!1,h=!1;switch(u){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:m=!0,f=!0;break;case 140:h=!0;break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,g=521;2==u&&(p=_.read_shift(2)),_.l+=3,2!=u&&(p=_.read_shift(4)),p>1048576&&(p=1e6),2!=u&&(g=_.read_shift(2));var v=_.read_shift(2),x=c.codepage||1252;2!=u&&(_.l+=16,_.read_shift(1),0!==_[_.l]&&(x=n[_[_.l]]),_.l+=1,_.l+=2),h&&(_.l+=36);for(var C=[],b={},y=Math.min(_.length,2==u?521:g-10-(m?264:0)),M=h?32:11;_.l<y&&13!=_[_.l];)switch(b={},b.name=Re.utils.decode(x,_.slice(_.l,_.l+M)).replace(/[\u0000\r\n].*$/g,""),_.l+=M,b.type=String.fromCharCode(_.read_shift(1)),2!=u&&!h&&(b.offset=_.read_shift(4)),b.len=_.read_shift(1),2==u&&(b.offset=_.read_shift(2)),b.dec=_.read_shift(1),b.name.length&&C.push(b),2!=u&&(_.l+=h?13:14),b.type){case"B":(!m||8!=b.len)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(13!==_[_.l]&&(_.l=g-1),13!==_.read_shift(1))throw new Error("DBF Terminator not found "+_.l+" "+_[_.l]);_.l=g;var A=0,U=0;for(d[0]=[],U=0;U!=C.length;++U)d[0][U]=C[U].name;for(;p-- >0;)if(42!==_[_.l])for(++_.l,d[++A]=[],U=0,U=0;U!=C.length;++U){var P=_.slice(_.l,_.l+C[U].len);_.l+=C[U].len,Ot(P,0);var B=Re.utils.decode(x,P);switch(C[U].type){case"C":B.trim().length&&(d[A][U]=B.replace(/\s+$/,""));break;case"D":d[A][U]=8===B.length?new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):B;break;case"F":d[A][U]=parseFloat(B.trim());break;case"+":case"I":d[A][U]=h?2147483648^P.read_shift(-4,"i"):P.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[A][U]=!0;break;case"N":case"F":d[A][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));d[A][U]="##MEMO##"+(h?parseInt(B.trim(),10):P.read_shift(4));break;case"N":(B=B.replace(/\u0000/g,"").trim())&&"."!=B&&(d[A][U]=+B||0);break;case"@":d[A][U]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":d[A][U]=new Date(864e5*(P.read_shift(4)-2440588)+P.read_shift(4));break;case"Y":d[A][U]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][U]=-P.read_shift(-8,"f");break;case"B":if(m&&8==C[U].len){d[A][U]=P.read_shift(8,"f");break}case"G":case"P":P.l+=C[U].len;break;case"0":if("_NullFlags"===C[U].name)break;default:throw new Error("DBF Unsupported data type "+C[U].type)}}else _.l+=v;if(2!=u&&_.l<_.length&&26!=_[_.l++])throw new Error("DBF EOF Marker missing "+(_.l-1)+" of "+_.length+" "+_[_.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=C,d}(l,d),d);return _["!cols"]=d.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete d.DBF,_}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function i(l,c){try{return ci(o(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}},to_sheet:o,from_sheet:function s(l,c){var d=c||{};if(+d.codepage>=0&&un(+d.codepage),"string"==d.type)throw new Error("Cannot write DBF to JS string");var _=Gt(),u=Ur(l,{header:1,raw:!0,cellDates:!0}),f=u[0],m=u.slice(1),h=l["!cols"]||[],p=0,g=0,v=0,x=1;for(p=0;p<f.length;++p)if(((h[p]||{}).DBF||{}).name)f[p]=h[p].DBF.name,++v;else if(null!=f[p]){if(++v,"number"==typeof f[p]&&(f[p]=f[p].toString(10)),"string"!=typeof f[p])throw new Error("DBF Invalid column name "+f[p]+" |"+typeof f[p]+"|");if(f.indexOf(f[p])!==p)for(g=0;g<1024;++g)if(-1==f.indexOf(f[p]+"_"+g)){f[p]+="_"+g;break}}var C=Je(l["!ref"]),b=[],y=[],M=[];for(p=0;p<=C.e.c-C.s.c;++p){var A="",U="",P=0,B=[];for(g=0;g<m.length;++g)null!=m[g][p]&&B.push(m[g][p]);if(0!=B.length&&null!=f[p]){for(g=0;g<B.length;++g){switch(typeof B[g]){case"number":U="B";break;case"string":default:U="C";break;case"boolean":U="L";break;case"object":U=B[g]instanceof Date?"D":"C"}P=Math.max(P,String(B[g]).length),A=A&&A!=U?"C":U}P>250&&(P=250),"C"==(U=((h[p]||{}).DBF||{}).type)&&h[p].DBF.len>P&&(P=h[p].DBF.len),"B"==A&&"N"==U&&(A="N",M[p]=h[p].DBF.dec,P=h[p].DBF.len),y[p]="C"==A||"N"==U?P:a[A]||0,x+=y[p],b[p]=A}else b[p]="?"}var J=_.next(32);for(J.write_shift(4,318902576),J.write_shift(4,m.length),J.write_shift(2,296+32*v),J.write_shift(2,x),p=0;p<4;++p)J.write_shift(4,0);for(J.write_shift(4,0|(+r[gi]||3)<<8),p=0,g=0;p<f.length;++p)if(null!=f[p]){var O=_.next(32),ee=(f[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,ee,"sbcs"),O.write_shift(1,"?"==b[p]?"C":b[p],"sbcs"),O.write_shift(4,g),O.write_shift(1,y[p]||a[b[p]]||0),O.write_shift(1,M[p]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),g+=y[p]||a[b[p]]||0}var pe=_.next(264);for(pe.write_shift(4,13),p=0;p<65;++p)pe.write_shift(4,0);for(p=0;p<m.length;++p){var ie=_.next(x);for(ie.write_shift(1,0),g=0;g<f.length;++g)if(null!=f[g])switch(b[g]){case"L":ie.write_shift(1,null==m[p][g]?63:m[p][g]?84:70);break;case"B":ie.write_shift(8,m[p][g]||0,"f");break;case"N":var ve="0";for("number"==typeof m[p][g]&&(ve=m[p][g].toFixed(M[g]||0)),v=0;v<y[g]-ve.length;++v)ie.write_shift(1,32);ie.write_shift(1,ve,"sbcs");break;case"D":m[p][g]?(ie.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var me=String(null!=m[p][g]?m[p][g]:"").slice(0,y[g]);for(ie.write_shift(1,me,"sbcs"),v=0;v<y[g]-me.length;++v)ie.write_shift(1,32)}}return _.next(1).write_shift(1,26),_.end()}}}(),Lc=function(){var n={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1bN("+dt(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(f,m){var h=n[m];return"number"==typeof h?Xr(h):h},o=function(f,m,h){var p=m.charCodeAt(0)-32<<4|h.charCodeAt(0)-48;return 59==p?f:Xr(p)};function a(f,m){var J,h=f.split(/[\n\r]+/),p=-1,g=-1,v=0,x=0,C=[],b=[],y=null,M={},A=[],U=[],P=[],B=0;for(+m.codepage>=0&&un(+m.codepage);v!==h.length;++v){B=0;var ie,O=h[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,o).replace(r,t),ee=O.replace(/;;/g,"\0").split(";").map(function(E){return E.replace(/\u0000/g,";")});if(O.length>0)switch(ee[0]){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==ee[1].charAt(0)&&b.push(O.slice(3).replace(/;;/g,";"));break;case"C":var ve=!1,me=!1,Pe=!1,_e=!1,ge=-1,z=-1;for(x=1;x<ee.length;++x)switch(ee[x].charAt(0)){case"A":case"G":break;case"X":g=parseInt(ee[x].slice(1))-1,me=!0;break;case"Y":for(p=parseInt(ee[x].slice(1))-1,me||(g=0),J=C.length;J<=p;++J)C[J]=[];break;case"K":'"'===(ie=ee[x].slice(1)).charAt(0)?ie=ie.slice(1,ie.length-1):"TRUE"===ie?ie=!0:"FALSE"===ie?ie=!1:isNaN(yn(ie))?isNaN(Wi(ie).getDate())||(ie=at(ie)):(ie=yn(ie),null!==y&&vi(y)&&(ie=fr(ie))),ve=!0;break;case"E":_e=!0;var I=io(ee[x].slice(1),{r:p,c:g});C[p][g]=[C[p][g],I];break;case"S":Pe=!0,C[p][g]=[C[p][g],"S5S"];break;case"R":ge=parseInt(ee[x].slice(1))-1;break;case"C":z=parseInt(ee[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}if(ve&&(C[p][g]&&2==C[p][g].length?C[p][g][0]=ie:C[p][g]=ie,y=null),Pe){if(_e)throw new Error("SYLK shared formula cannot have own formula");var Q=ge>-1&&C[ge][z];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");C[p][g][1]=Xc(Q[1],{r:p-ge,c:g-z})}break;case"F":var Z=0;for(x=1;x<ee.length;++x)switch(ee[x].charAt(0)){case"X":g=parseInt(ee[x].slice(1))-1,++Z;break;case"Y":for(p=parseInt(ee[x].slice(1))-1,J=C.length;J<=p;++J)C[J]=[];break;case"M":B=parseInt(ee[x].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":y=b[parseInt(ee[x].slice(1))];break;case"W":for(P=ee[x].slice(1).split(" "),J=parseInt(P[0],10);J<=parseInt(P[1],10);++J)B=parseInt(P[2],10),U[J-1]=0===B?{hidden:!0}:{wch:B},Ii(U[J-1]);break;case"C":U[g=parseInt(ee[x].slice(1))-1]||(U[g]={});break;case"R":A[p=parseInt(ee[x].slice(1))-1]||(A[p]={}),B>0?(A[p].hpt=B,A[p].hpx=to(B)):0===B&&(A[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}Z<1&&(y=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+O)}}return A.length>0&&(M["!rows"]=A),U.length>0&&(M["!cols"]=U),m&&m.sheetRows&&(C=C.slice(0,m.sheetRows)),[C,M]}function s(f,m){var h=function i(f,m){switch(m.type){case"base64":return a(rn(f),m);case"binary":return a(f,m);case"buffer":return a(Ee&&Buffer.isBuffer(f)?f.toString("binary"):oi(f),m);case"array":return a(Ci(f),m)}throw new Error("Unrecognized type "+m.type)}(f,m),g=h[1],v=Xi(h[0],m);return dt(g).forEach(function(x){v[x]=g[x]}),v}function c(f,m,h,p){var g="C;Y"+(h+1)+";X"+(p+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+Ya(f.f,{r:h,c:p}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return g}return n["|"]=254,{to_workbook:function l(f,m){return ci(s(f,m),m)},to_sheet:s,from_sheet:function u(f,m){var v,h=["ID;PWXL;N;E"],p=[],g=Je(f["!ref"]),x=Array.isArray(f),C="\r\n";h.push("P;PGeneral"),h.push("F;P0;DG0G8;M255"),f["!cols"]&&function d(f,m){m.forEach(function(h,p){var g="F;W"+(p+1)+" "+(p+1)+" ";h.hidden?g+="0":("number"==typeof h.width&&!h.wpx&&(h.wpx=Io(h.width)),"number"==typeof h.wpx&&!h.wch&&(h.wch=Eo(h.wpx)),"number"==typeof h.wch&&(g+=Math.round(h.wch)))," "!=g.charAt(g.length-1)&&f.push(g)})}(h,f["!cols"]),f["!rows"]&&function _(f,m){m.forEach(function(h,p){var g="F;";h.hidden?g+="M0;":h.hpt?g+="M"+20*h.hpt+";":h.hpx&&(g+="M"+20*Zo(h.hpx)+";"),g.length>2&&f.push(g+"R"+(p+1))})}(h,f["!rows"]),h.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var b=g.s.r;b<=g.e.r;++b)for(var y=g.s.c;y<=g.e.c;++y){var M=ye({r:b,c:y});(v=x?(f[b]||[])[y]:f[M])&&(null!=v.v||v.f&&!v.F)&&p.push(c(v,0,b,y))}return h.join(C)+C+p.join(C)+C+"E"+C}}}(),Ic=function(){function r(a,s){for(var l=a.split("\n"),c=-1,d=-1,_=0,u=[];_!==l.length;++_)if("BOT"!==l[_].trim()){if(!(c<0)){for(var f=l[_].trim().split(","),m=f[0],h=f[1],p=l[++_]||"";1&(p.match(/["]/g)||[]).length&&_<l.length-1;)p+="\n"+l[++_];switch(p=p.trim(),+m){case-1:if("BOT"===p){u[++c]=[],d=0;continue}if("EOD"!==p)throw new Error("Unrecognized DIF special command "+p);break;case 0:u[c][d]="TRUE"===p||"FALSE"!==p&&(isNaN(yn(h))?isNaN(Wi(h).getDate())?h:at(h):yn(h)),++d;break;case 1:(p=(p=p.slice(1,p.length-1)).replace(/""/g,'"'))&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[c][d++]=""!==p?p:null}if("EOD"===p)break}}else u[++c]=[],d=0;return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),u}function t(a,s){return Xi(function n(a,s){switch(s.type){case"base64":return r(rn(a),s);case"binary":return r(a,s);case"buffer":return r(Ee&&Buffer.isBuffer(a)?a.toString("binary"):oi(a),s);case"array":return r(Ci(a),s)}throw new Error("Unrecognized type "+s.type)}(a,s),s)}return{to_workbook:function o(a,s){return ci(t(a,s),s)},to_sheet:t,from_sheet:function(){var a=function(c,d,_,u,f){c.push(d),c.push(_+","+u),c.push('"'+f.replace(/"/g,'""')+'"')},s=function(c,d,_,u){c.push(d+","+_),c.push(1==d?'"'+u.replace(/"/g,'""')+'"':u)};return function(c){var u,d=[],_=Je(c["!ref"]),f=Array.isArray(c);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,_.e.r-_.s.r+1,""),a(d,"TUPLES",0,_.e.c-_.s.c+1,""),a(d,"DATA",0,0,"");for(var m=_.s.r;m<=_.e.r;++m){s(d,-1,0,"BOT");for(var h=_.s.c;h<=_.e.c;++h){var p=ye({r:m,c:h});if(u=f?(c[m]||[])[h]:c[p])switch(u.t){case"n":var g=u.w;!g&&null!=u.v&&(g=u.v),null==g?s(d,1,0,u.f&&!u.F?"="+u.f:""):s(d,0,g,"V");break;case"b":s(d,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":s(d,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=sn(u.z||we[14],At(at(u.v)))),s(d,0,u.w,"V");break;default:s(d,1,0,"")}else s(d,1,0,"")}}return s(d,-1,0,"EOD"),d.join("\r\n")}}()}}(),Ec=function(){function n(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function o(u,f){return Xi(function t(u,f){for(var m=u.split("\n"),h=-1,p=-1,g=0,v=[];g!==m.length;++g){var x=m[g].trim().split(":");if("cell"===x[0]){var C=st(x[1]);if(v.length<=C.r)for(h=v.length;h<=C.r;++h)v[h]||(v[h]=[]);switch(h=C.r,p=C.c,x[2]){case"t":v[h][p]=n(x[3]);break;case"v":v[h][p]=+x[3];break;case"vtf":var b=x[x.length-1];case"vtc":v[h][p]="nl"===x[3]?!!+x[4]:+x[4],"vtf"==x[2]&&(v[h][p]=[v[h][p],b])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}(u,f),f)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),c="--SocialCalcSpreadsheetControlSave--";function d(u){if(!u||!u["!ref"])return"";for(var h,f=[],m=[],p="",g=dn(u["!ref"]),v=Array.isArray(u),x=g.s.r;x<=g.e.r;++x)for(var C=g.s.c;C<=g.e.c;++C)if(p=ye({r:x,c:C}),(h=v?(u[x]||[])[C]:u[p])&&null!=h.v&&"z"!==h.t){switch(m=["cell",p,"t"],h.t){case"s":case"str":m.push(r(h.v));break;case"n":h.f?(m[2]="vtf",m[3]="n",m[4]=h.v,m[5]=r(h.f)):(m[2]="v",m[3]=h.v);break;case"b":m[2]="vt"+(h.f?"f":"c"),m[3]="nl",m[4]=h.v?"1":"0",m[5]=r(h.f||(h.v?"TRUE":"FALSE"));break;case"d":var b=At(at(h.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=h.w||sn(h.z||we[14],b);break;case"e":continue}f.push(m.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join("\n")}return{to_workbook:function i(u,f){return ci(o(u,f),f)},to_sheet:o,from_sheet:function _(u){return[a,s,l,s,d(u),c].join("\n")}}}(),eo=function(){function n(_,u,f,m,h){h.raw?u[f][m]=_:""===_||(u[f][m]="TRUE"===_||"FALSE"!==_&&(isNaN(yn(_))?isNaN(Wi(_).getDate())?_:at(_):yn(_)))}var t={44:",",9:"\t",59:";",124:"|"},o={44:3,9:2,59:1,124:0};function i(_){for(var u={},f=!1,m=0,h=0;m<_.length;++m)34==(h=_.charCodeAt(m))?f=!f:!f&&h in t&&(u[h]=(u[h]||0)+1);for(m in h=[],u)Object.prototype.hasOwnProperty.call(u,m)&&h.push([u[m],m]);if(!h.length)for(m in u=o)Object.prototype.hasOwnProperty.call(u,m)&&h.push([u[m],m]);return h.sort(function(p,g){return p[0]-g[0]||o[p[1]]-o[g[1]]}),t[h.pop()[1]]||44}function s(_,u){return!u||!u.PRN||u.FS||"sep="==_.slice(0,4)||_.indexOf("\t")>=0||_.indexOf(",")>=0||_.indexOf(";")>=0?function a(_,u){var f=u||{},m="",h=f.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};"sep="==_.slice(0,4)?13==_.charCodeAt(5)&&10==_.charCodeAt(6)?(m=_.charAt(4),_=_.slice(7)):13==_.charCodeAt(5)||10==_.charCodeAt(5)?(m=_.charAt(4),_=_.slice(6)):m=i(_.slice(0,1024)):m=f&&f.FS?f.FS:i(_.slice(0,1024));var g=0,v=0,x=0,C=0,b=0,y=m.charCodeAt(0),M=!1,A=0,U=_.charCodeAt(0);_=_.replace(/\r\n/gm,"\n");var P=null!=f.dateNF?function Q1(n){var r="number"==typeof n?we[n]:n;return r=r.replace(el,"(\\d+)"),new RegExp("^"+r+"$")}(f.dateNF):null;function B(){var J=_.slice(C,b),O={};if('"'==J.charAt(0)&&'"'==J.charAt(J.length-1)&&(J=J.slice(1,-1).replace(/""/g,'"')),0===J.length)O.t="z";else if(f.raw)O.t="s",O.v=J;else if(0===J.trim().length)O.t="s",O.v=J;else if(61==J.charCodeAt(0))34==J.charCodeAt(1)&&34==J.charCodeAt(J.length-1)?(O.t="s",O.v=J.slice(2,-1).replace(/""/g,'"')):function hT(n){return 1!=n.length}(J)?(O.t="n",O.f=J.slice(1)):(O.t="s",O.v=J);else if("TRUE"==J)O.t="b",O.v=!0;else if("FALSE"==J)O.t="b",O.v=!1;else if(isNaN(x=yn(J)))if(!isNaN(Wi(J).getDate())||P&&J.match(P)){O.z=f.dateNF||we[14];var ee=0;P&&J.match(P)&&(J=function H1(n,r,t){var o=-1,i=-1,a=-1,s=-1,l=-1,c=-1;(r.match(el)||[]).forEach(function(u,f){var m=parseInt(t[f+1],10);switch(u.toLowerCase().charAt(0)){case"y":o=m;break;case"d":a=m;break;case"h":s=m;break;case"s":c=m;break;case"m":s>=0?l=m:i=m}}),c>=0&&-1==l&&i>=0&&(l=i,i=-1);var d=(""+(o>=0?o:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);7==d.length&&(d="0"+d),8==d.length&&(d="20"+d);var _=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==s&&-1==l&&-1==c?d:-1==o&&-1==i&&-1==a?_:d+"T"+_}(0,f.dateNF,J.match(P)||[]),ee=1),f.cellDates?(O.t="d",O.v=at(J,ee)):(O.t="n",O.v=At(at(J,ee))),!1!==f.cellText&&(O.w=sn(O.z,O.v instanceof Date?At(O.v):O.v)),f.cellNF||delete O.z}else O.t="s",O.v=J;else O.t="n",!1!==f.cellText&&(O.w=J),O.v=x;if("z"==O.t||(f.dense?(h[g]||(h[g]=[]),h[g][v]=O):h[ye({c:v,r:g})]=O),U=_.charCodeAt(C=b+1),p.e.c<v&&(p.e.c=v),p.e.r<g&&(p.e.r=g),A==y)++v;else if(v=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;b<_.length;++b)switch(A=_.charCodeAt(b)){case 34:34===U&&(M=!M);break;case y:case 10:case 13:if(!M&&B())break e}return b-C>0&&B(),h["!ref"]=ke(p),h}(_,u):Xi(function r(_,u){var f=u||{},m=[];if(!_||0===_.length)return m;for(var h=_.split(/[\r\n]/),p=h.length-1;p>=0&&0===h[p].length;)--p;for(var g=10,v=0,x=0;x<=p;++x)-1==(v=h[x].indexOf(" "))?v=h[x].length:v++,g=Math.max(g,v);for(x=0;x<=p;++x){m[x]=[];var C=0;for(n(h[x].slice(0,g).trim(),m,x,C,f),C=1;C<=(h[x].length-g)/10+1;++C)n(h[x].slice(g+10*(C-1),g+10*C).trim(),m,x,C,f)}return f.sheetRows&&(m=m.slice(0,f.sheetRows)),m}(_,u),u)}function l(_,u){var f="",m="string"==u.type?[0,0,0,0]:ls(_,u);switch(u.type){case"base64":f=rn(_);break;case"binary":case"string":f=_;break;case"buffer":f=65001==u.codepage?_.toString("utf8"):Ee&&Buffer.isBuffer(_)?_.toString("binary"):oi(_);break;case"array":f=Ci(_);break;default:throw new Error("Unrecognized type "+u.type)}return 239==m[0]&&187==m[1]&&191==m[2]?f=Xe(f.slice(3)):"string"!=u.type&&"buffer"!=u.type&&65001==u.codepage&&(f=Xe(f)),"socialcalc:version:"==f.slice(0,19)?Ec.to_sheet("string"==u.type?f:Xe(f),u):s(f,u)}return{to_workbook:function c(_,u){return ci(l(_,u),u)},to_sheet:l,from_sheet:function d(_){for(var m,u=[],f=Je(_["!ref"]),h=Array.isArray(_),p=f.s.r;p<=f.e.r;++p){for(var g=[],v=f.s.c;v<=f.e.c;++v){var x=ye({r:p,c:v});if((m=h?(_[p]||[])[v]:_[x])&&null!=m.v){for(var C=(m.w||(On(m),m.w)||"").slice(0,10);C.length<10;)C+=" ";g.push(C+(0===v?" ":""))}else g.push("          ")}u.push(g.join(""))}return u.join("\n")}}}(),Li=function(){function n(I,Q,Z){if(I){Ot(I,I.l||0);for(var E=Z.Enum||ge;I.l<I.length;){var W=I.read_shift(2),le=E[W]||E[65535],te=I.read_shift(2),ne=I.l+te,G=le.f&&le.f(I,te,Z);if(I.l=ne,Q(G,le,W))return}}}function t(I,Q){if(!I)return I;var Z=Q||{},E=Z.dense?[]:{},W="Sheet1",le="",te=0,ne={},G=[],Me=[],L={s:{r:0,c:0},e:{r:0,c:0}},We=Z.sheetRows||0;if(0==I[2]&&(8==I[3]||9==I[3])&&I.length>=16&&5==I[14]&&108===I[15])throw new Error("Unsupported Works 3 for Mac file");if(2==I[2])Z.Enum=ge,n(I,function(ue,mt,bn){switch(bn){case 0:Z.vers=ue,ue>=4096&&(Z.qpro=!0);break;case 6:L=ue;break;case 204:ue&&(le=ue);break;case 222:le=ue;break;case 15:case 51:Z.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:14==bn&&112==(112&ue[2])&&(15&ue[2])>1&&(15&ue[2])<15&&(ue[1].z=Z.dateNF||we[14],Z.cellDates&&(ue[1].t="d",ue[1].v=fr(ue[1].v))),Z.qpro&&ue[3]>te&&(E["!ref"]=ke(L),ne[W]=E,G.push(W),E=Z.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},te=ue[3],W=le||"Sheet"+(te+1),le="");var qn=Z.dense?(E[ue[0].r]||[])[ue[0].c]:E[ye(ue[0])];if(qn){qn.t=ue[1].t,qn.v=ue[1].v,null!=ue[1].z&&(qn.z=ue[1].z),null!=ue[1].f&&(qn.f=ue[1].f);break}Z.dense?(E[ue[0].r]||(E[ue[0].r]=[]),E[ue[0].r][ue[0].c]=ue[1]):E[ye(ue[0])]=ue[1]}},Z);else{if(26!=I[2]&&14!=I[2])throw new Error("Unrecognized LOTUS BOF "+I[2]);Z.Enum=z,14==I[2]&&(Z.qpro=!0,I.l=0),n(I,function(ue,mt,bn){switch(bn){case 204:W=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>te&&(E["!ref"]=ke(L),ne[W]=E,G.push(W),E=Z.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},W="Sheet"+((te=ue[3])+1)),We>0&&ue[0].r>=We)break;Z.dense?(E[ue[0].r]||(E[ue[0].r]=[]),E[ue[0].r][ue[0].c]=ue[1]):E[ye(ue[0])]=ue[1],L.e.c<ue[0].c&&(L.e.c=ue[0].c),L.e.r<ue[0].r&&(L.e.r=ue[0].r);break;case 27:ue[14e3]&&(Me[ue[14e3][0]]=ue[14e3][1]);break;case 1537:Me[ue[0]]=ue[1],ue[0]==te&&(W=ue[1])}},Z)}if(E["!ref"]=ke(L),ne[le||W]=E,G.push(le||W),!Me.length)return{SheetNames:G,Sheets:ne};for(var Ue={},ze=[],Be=0;Be<Me.length;++Be)ne[G[Be]]?(ze.push(Me[Be]||G[Be]),Ue[Me[Be]]=ne[Me[Be]]||ne[G[Be]]):(ze.push(Me[Be]),Ue[Me[Be]]={"!ref":"A1"});return{SheetNames:ze,Sheets:Ue}}function d(I,Q,Z){var E=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&20768!=Z.vers?(E[0].c=I.read_shift(1),E[3]=I.read_shift(1),E[0].r=I.read_shift(2),I.l+=2):(E[2]=I.read_shift(1),E[0].c=I.read_shift(2),E[0].r=I.read_shift(2)),E}function _(I,Q,Z){var E=I.l+Q,W=d(I,0,Z);if(W[1].t="s",20768==Z.vers){I.l++;var le=I.read_shift(1);return W[1].v=I.read_shift(le,"utf8"),W}return Z.qpro&&I.l++,W[1].v=I.read_shift(E-I.l,"cstr"),W}function u(I,Q,Z){var E=V(7+Z.length);E.write_shift(1,255),E.write_shift(2,Q),E.write_shift(2,I),E.write_shift(1,39);for(var W=0;W<E.length;++W){var le=Z.charCodeAt(W);E.write_shift(1,le>=128?95:le)}return E.write_shift(1,0),E}function m(I,Q,Z){var E=V(7);return E.write_shift(1,255),E.write_shift(2,Q),E.write_shift(2,I),E.write_shift(2,Z,"i"),E}function p(I,Q,Z){var E=V(13);return E.write_shift(1,255),E.write_shift(2,Q),E.write_shift(2,I),E.write_shift(8,Z,"f"),E}function v(I,Q,Z){var E=32768&Q;return Q=(E?I:0)+((Q&=-32769)>=8192?Q-16384:Q),(E?"":"$")+(Z?nt(Q):pt(Q))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function y(I){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=I.read_shift(2),Q[3]=I[I.l++],Q[0].c=I[I.l++],Q}function A(I,Q,Z,E){var W=V(6+E.length);W.write_shift(2,I),W.write_shift(1,Z),W.write_shift(1,Q),W.write_shift(1,39);for(var le=0;le<E.length;++le){var te=E.charCodeAt(le);W.write_shift(1,te>=128?95:te)}return W.write_shift(1,0),W}function P(I,Q){var Z=y(I),E=I.read_shift(4),W=I.read_shift(4),le=I.read_shift(2);if(65535==le)return 0===E&&3221225472===W?(Z[1].t="e",Z[1].v=15):0===E&&3489660928===W?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var te=32768&le;return le=(32767&le)-16446,Z[1].v=(1-2*te)*(W*Math.pow(2,le+32)+E*Math.pow(2,le)),Z}function B(I,Q,Z,E){var W=V(14);if(W.write_shift(2,I),W.write_shift(1,Z),W.write_shift(1,Q),0==E)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var le=0,te=0,G=0;return E<0&&(le=1,E=-E),te=0|Math.log2(E),0==(2147483648&(G=(E/=Math.pow(2,te-31))>>>0))&&(++te,G=(E/=2)>>>0),E-=G,G|=2147483648,G>>>=0,E*=Math.pow(2,32),W.write_shift(4,E>>>0),W.write_shift(4,G),W.write_shift(2,te+=16383+(le?32768:0)),W}function ee(I,Q){var Z=y(I),E=I.read_shift(8,"f");return Z[1].v=E,Z}function ie(I,Q){return 0==I[I.l+Q-1]?I.read_shift(Q,"cstr"):""}function _e(I,Q){var Z=V(5+I.length);Z.write_shift(2,14e3),Z.write_shift(2,Q);for(var E=0;E<I.length;++E){var W=I.charCodeAt(E);Z[Z.l++]=W>127?95:W}return Z[Z.l++]=0,Z}var ge={0:{n:"BOF",f:wt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function l(I,Q,Z){var E={s:{c:0,r:0},e:{c:0,r:0}};return 8==Q&&Z.qpro?(E.s.c=I.read_shift(1),I.l++,E.s.r=I.read_shift(2),E.e.c=I.read_shift(1),I.l++,E.e.r=I.read_shift(2),E):(E.s.c=I.read_shift(2),E.s.r=I.read_shift(2),12==Q&&Z.qpro&&(I.l+=2),E.e.c=I.read_shift(2),E.e.r=I.read_shift(2),12==Q&&Z.qpro&&(I.l+=2),65535==E.s.c&&(E.s.c=E.e.c=E.s.r=E.e.r=0),E)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function f(I,Q,Z){var E=d(I,0,Z);return E[1].v=I.read_shift(2,"i"),E}},14:{n:"NUMBER",f:function h(I,Q,Z){var E=d(I,0,Z);return E[1].v=I.read_shift(8,"f"),E}},15:{n:"LABEL",f:_},16:{n:"FORMULA",f:function g(I,Q,Z){var E=I.l+Q,W=d(I,0,Z);if(W[1].v=I.read_shift(8,"f"),Z.qpro)I.l=E;else{var le=I.read_shift(2);(function b(I,Q){Ot(I,0);for(var Z=[],E=0,W="",le="",te="",ne="";I.l<I.length;){var G=I[I.l++];switch(G){case 0:Z.push(I.read_shift(8,"f"));break;case 1:le=v(Q[0].c,I.read_shift(2),!0),W=v(Q[0].r,I.read_shift(2),!1),Z.push(le+W);break;case 2:var Me=v(Q[0].c,I.read_shift(2),!0),L=v(Q[0].r,I.read_shift(2),!1);le=v(Q[0].c,I.read_shift(2),!0),W=v(Q[0].r,I.read_shift(2),!1),Z.push(Me+L+":"+le+W);break;case 3:if(I.l<I.length)return void console.error("WK1 premature formula end");break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(I.read_shift(2));break;case 6:for(var We="";G=I[I.l++];)We+=String.fromCharCode(G);Z.push('"'+We.replace(/"/g,'""')+'"');break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:ne=Z.pop(),te=Z.pop(),Z.push(["AND","OR"][G-20]+"("+te+","+ne+")");break;default:if(G<32&&C[G])ne=Z.pop(),te=Z.pop(),Z.push(te+C[G]+ne);else{if(!x[G])return G<=7?console.error("WK1 invalid opcode "+G.toString(16)):G<=24?console.error("WK1 unsupported op "+G.toString(16)):G<=30?console.error("WK1 invalid opcode "+G.toString(16)):G<=115?console.error("WK1 unsupported function opcode "+G.toString(16)):console.error("WK1 unrecognized opcode "+G.toString(16));if(69==(E=x[G][1])&&(E=I[I.l++]),E>Z.length)return void console.error("WK1 bad formula parse 0x"+G.toString(16)+":|"+Z.join("|")+"|");var Ue=Z.slice(-E);Z.length-=E,Z.push(x[G][0]+"("+Ue.join(",")+")")}}}1==Z.length?Q[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")})(I.slice(I.l,I.l+le),W),I.l+=le}return W}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:_},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:function ve(I,Q){var Z=I[I.l++];Z>Q-1&&(Z=Q-1);for(var E="";E.length<Z;)E+=String.fromCharCode(I[I.l++]);return E}},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function M(I,Q){var Z=y(I);return Z[1].t="s",Z[1].v=I.read_shift(Q-4,"cstr"),Z}},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:function U(I,Q){var Z=y(I);Z[1].v=I.read_shift(2);var E=Z[1].v>>1;if(1&Z[1].v)switch(7&E){case 0:E=5e3*(E>>3);break;case 1:E=500*(E>>3);break;case 2:E=(E>>3)/20;break;case 3:E=(E>>3)/200;break;case 4:E=(E>>3)/2e3;break;case 5:E=(E>>3)/2e4;break;case 6:E=(E>>3)/16;break;case 7:E=(E>>3)/64}return Z[1].v=E,Z}},25:{n:"FORMULA19",f:function J(I,Q){var Z=P(I);return I.l+=Q-14,Z}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Pe(I,Q){for(var Z={},E=I.l+Q;I.l<E;){var W=I.read_shift(2);if(14e3==W){for(Z[W]=[0,""],Z[W][0]=I.read_shift(2);I[I.l];)Z[W][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return Z}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function O(I,Q){var Z=y(I),E=I.read_shift(4);return Z[1].v=E>>6,Z}},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:function pe(I,Q){var Z=ee(I);return I.l+=Q-10,Z}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function me(I,Q,Z){if(Z.qpro&&!(Q<21)){var E=I.read_shift(1);return I.l+=17,I.l+=1,I.l+=2,[E,I.read_shift(Q-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function o(I,Q){var Z=Q||{};if(+Z.codepage>=0&&un(+Z.codepage),"string"==Z.type)throw new Error("Cannot write WK1 to JS string");var E=Gt(),W=Je(I["!ref"]),le=Array.isArray(I),te=[];re(E,0,function a(I){var Q=V(2);return Q.write_shift(2,I),Q}(1030)),re(E,6,function c(I){var Q=V(8);return Q.write_shift(2,I.s.c),Q.write_shift(2,I.s.r),Q.write_shift(2,I.e.c),Q.write_shift(2,I.e.r),Q}(W));for(var ne=Math.min(W.e.r,8191),G=W.s.r;G<=ne;++G)for(var Me=pt(G),L=W.s.c;L<=W.e.c;++L){G===W.s.r&&(te[L]=nt(L));var Ue=le?(I[G]||[])[L]:I[te[L]+Me];Ue&&"z"!=Ue.t&&("n"==Ue.t?(0|Ue.v)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?re(E,13,m(G,L,Ue.v)):re(E,14,p(G,L,Ue.v)):re(E,15,u(G,L,On(Ue).slice(0,239))))}return re(E,1),E.end()},book_to_wk3:function i(I,Q){var Z=Q||{};if(+Z.codepage>=0&&un(+Z.codepage),"string"==Z.type)throw new Error("Cannot write WK3 to JS string");var E=Gt();re(E,0,function s(I){var Q=V(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var Z=0,E=0,W=0,le=0;le<I.SheetNames.length;++le){var ne=I.Sheets[I.SheetNames[le]];if(ne&&ne["!ref"]){++W;var G=dn(ne["!ref"]);Z<G.e.r&&(Z=G.e.r),E<G.e.c&&(E=G.e.c)}}return Z>8191&&(Z=8191),Q.write_shift(2,Z),Q.write_shift(1,W),Q.write_shift(1,E),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}(I));for(var W=0,le=0;W<I.SheetNames.length;++W)(I.Sheets[I.SheetNames[W]]||{})["!ref"]&&re(E,27,_e(I.SheetNames[W],le++));var te=0;for(W=0;W<I.SheetNames.length;++W){var ne=I.Sheets[I.SheetNames[W]];if(ne&&ne["!ref"]){for(var G=Je(ne["!ref"]),Me=Array.isArray(ne),L=[],We=Math.min(G.e.r,8191),Ue=G.s.r;Ue<=We;++Ue)for(var ze=pt(Ue),Be=G.s.c;Be<=G.e.c;++Be){Ue===G.s.r&&(L[Be]=nt(Be));var mt=Me?(ne[Ue]||[])[Be]:ne[L[Be]+ze];mt&&"z"!=mt.t&&("n"==mt.t?re(E,23,B(Ue,Be,te,mt.v)):re(E,22,A(Ue,Be,te,On(mt).slice(0,239))))}++te}}return re(E,1),E.end()},to_workbook:function r(I,Q){switch(Q.type){case"base64":return t(an(rn(I)),Q);case"binary":return t(an(I),Q);case"buffer":case"array":return t(I,Q)}throw"Unsupported type "+Q.type}}}(),ov=function(){var n=wo("t"),r=wo("rPr");function t(a){var s=a.match(n);if(!s)return{t:"s",v:""};var l={t:"s",v:Qe(s[1])},c=a.match(r);return c&&(l.s=function iv(n){var r={},t=n.match(Rt),o=0,i=!1;if(t)for(;o!=t.length;++o){var a=Ae(t[o]);switch(a[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==a.val)break;r.cp=Gr[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=a.val;break;case"<sz":r.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==a.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==a.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":a.rgb&&(r.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==a[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+a[0])}}return r}(c[1])),l}var o=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(o,"").split(i).map(t).filter(function(l){return l.v})}}(),rv=function(){var r=/(\r\n|\n)/g;function o(i){var a=[[],i.v,[]];return i.v?(i.s&&function t(i,a,s){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),a.push('<span style="'+l.join("")+'">'),i.b&&(a.push("<b>"),s.push("</b>")),i.i&&(a.push("<i>"),s.push("</i>")),i.strike&&(a.push("<s>"),s.push("</s>"));var c=i.valign||"";"superscript"==c||"super"==c?c="sup":"subscript"==c&&(c="sub"),""!=c&&(a.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>")}(i.s,a[0],a[2]),a[0].join("")+a[1].replace(r,"<br/>")+a[2].join("")):""}return function(a){return a.map(o).join("")}}(),av=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sv=/<(?:\w+:)?r>/,lv=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ua(n,r){var t=!r||r.cellHTML,o={};return n?(n.match(/^\s*<(?:\w+:)?t[^>]*>/)?(o.t=Qe(Xe(n.slice(n.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),o.r=Xe(n),t&&(o.h=sa(o.t))):n.match(sv)&&(o.r=Xe(n),o.t=Qe(Xe((n.replace(lv,"").match(av)||[]).join("").replace(Rt,""))),t&&(o.h=rv(ov(o.r)))),o):{t:""}}var cv=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dv=/<(?:\w+:)?(?:si|sstItem)>/g,_v=/<\/(?:\w+:)?(?:si|sstItem)>/;function Pc(n){for(var r=[],t=n.split(""),o=0;o<t.length;++o)r[o]=t[o].charCodeAt(0);return r}function Gn(n,r){var t={};return t.Major=n.read_shift(2),t.Minor=n.read_shift(2),r>=4&&(n.l+=r-4),t}function Cv(n){for(var r=n.read_shift(4),t=n.l+r-4,o={},i=n.read_shift(4),a=[];i-- >0;)a.push({t:n.read_shift(4),v:n.read_shift(0,"lpp4")});if(o.name=n.read_shift(0,"lpp4"),o.comps=a,n.l!=t)throw new Error("Bad DataSpaceMapEntry: "+n.l+" != "+t);return o}function Oc(n,r){var t=n.l+r,o={};o.Flags=63&n.read_shift(4),n.l+=4,o.AlgID=n.read_shift(4);var i=!1;switch(o.AlgID){case 26126:case 26127:case 26128:i=36==o.Flags;break;case 26625:i=4==o.Flags;break;case 0:i=16==o.Flags||4==o.Flags||36==o.Flags;break;default:throw"Unrecognized encryption algorithm: "+o.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return o.AlgIDHash=n.read_shift(4),o.KeySize=n.read_shift(4),o.ProviderType=n.read_shift(4),n.l+=8,o.CSPName=n.read_shift(t-n.l>>1,"utf16le"),n.l=t,o}function Uc(n,r){var t={},o=n.l+r;return n.l+=4,t.Salt=n.slice(n.l,n.l+16),n.l+=16,t.Verifier=n.slice(n.l,n.l+16),n.l+=16,n.read_shift(4),t.VerifierHash=n.slice(n.l,o),n.l=o,t}function Av(n){if(36!=(63&n.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=n.read_shift(4);return{t:"Std",h:Oc(n,t),v:Uc(n,n.length-n.l)}}function yv(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Dv(n){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];n.l+=4;var t=n.read_shift(n.length-n.l,"utf8"),o={};return t.replace(Rt,function(a){var s=Ae(a);switch(Zn(s[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(l){o[l]=s[l]});break;case"<dataIntegrity":o.encryptedHmacKey=s.encryptedHmacKey,o.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":o.encs=[];break;case"<keyEncryptor":o.uri=s.uri;break;case"<encryptedKey":o.encs.push(s);break;default:throw s[0]}}),o}var Bc=function(){var n=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(s,l){return function(s){return 255&(s/2|128*s)}(s^l)};return function(s){for(var l=Pc(s),c=function(s){for(var l=r[s.length-1],c=104,d=s.length-1;d>=0;--d)for(var _=s[d],u=0;7!=u;++u)64&_&&(l^=t[c]),_*=2,--c;return l}(l),d=l.length,_=ii(16),u=0;16!=u;++u)_[u]=0;var h;for(1==(1&d)&&(_[d]=i(n[0],c>>8),_[--d]=i(l[l.length-1],255&c));d>0;)_[--d]=i(l[d],c>>8),_[--d]=i(l[d],255&c);for(d=15,h=15-l.length;h>0;)_[d]=i(n[h],c>>8),--h,_[--d]=i(l[d],255&c),--d,--h;return _}}();var Jc=function(){function n(i,a){switch(a.type){case"base64":return r(rn(i),a);case"binary":return r(i,a);case"buffer":return r(Ee&&Buffer.isBuffer(i)?i.toString("binary"):oi(i),a);case"array":return r(Ci(i),a)}throw new Error("Unrecognized type "+a.type)}function r(i,a){var l=(a||{}).dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(_,u){Array.isArray(l)&&(l[u]=[]);for(var h,f=/\\\w+\b/g,m=0,p=-1;h=f.exec(_);){if("\\cell"===h[0]){var g=_.slice(m,f.lastIndex-h[0].length);if(" "==g[0]&&(g=g.slice(1)),++p,g.length){var v={v:g,t:"s"};Array.isArray(l)?l[u][p]=v:l[ye({r:u,c:p})]=v}}m=f.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=ke(d),l}return{to_workbook:function t(i,a){return ci(n(i,a),a)},to_sheet:n,from_sheet:function o(i){for(var l,a=["{\\rtf1\\ansi"],s=Je(i["!ref"]),c=Array.isArray(i),d=s.s.r;d<=s.e.r;++d){a.push("\\trowd\\trautofit1");for(var _=s.s.c;_<=s.e.c;++_)a.push("\\cellx"+(_+1));for(a.push("\\pard\\intbl"),_=s.s.c;_<=s.e.c;++_){var u=ye({r:d,c:_});(l=c?(i[d]||[])[_]:i[u])&&(null!=l.v||l.f&&!l.F)&&(a.push(" "+(l.w||(On(l),l.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}}}();function Lo(n){for(var r=0,t=1;3!=r;++r)t=256*t+(n[r]>255?255:n[r]<0?0:n[r]);return t.toString(16).toUpperCase().slice(1)}function Dr(n,r){if(0===r)return n;var t=function Ov(n){var r=n[0]/255,t=n[1]/255,o=n[2]/255,i=Math.max(r,t,o),a=Math.min(r,t,o),s=i-a;if(0===s)return[0,0,r];var c,l=0,d=i+a;switch(c=s/(d>1?2-d:d),i){case r:l=((t-o)/s+6)%6;break;case t:l=(o-r)/s+2;break;case o:l=(r-t)/s+4}return[l/6,c,d/2]}(function Pv(n){var r=n.slice("#"===n[0]?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}(n));return t[2]=r<0?t[2]*(1+r):1-(1-t[2])*(1-r),Lo(function Uv(n){var c,t=n[1],o=n[2],i=2*t*(o<.5?o:1-o),a=o-i/2,s=[a,a,a],l=6*n[0];if(0!==t)switch(0|l){case 0:case 6:c=i*l,s[0]+=i,s[1]+=c;break;case 1:s[0]+=c=i*(2-l),s[1]+=i;break;case 2:c=i*(l-2),s[1]+=i,s[2]+=c;break;case 3:s[1]+=c=i*(4-l),s[2]+=i;break;case 4:c=i*(l-4),s[2]+=i,s[0]+=c;break;case 5:s[2]+=c=i*(6-l),s[0]+=i}for(var d=0;3!=d;++d)s[d]=Math.round(255*s[d]);return s}(t))}var $t=6;function Io(n){return Math.floor((n+Math.round(128/$t)/256)*$t)}function Eo(n){return Math.floor((n-5)/$t*100+.5)/100}function kr(n){return Math.round((n*$t+5)/$t*256)/256}function Ja(n){return kr(Eo(Io(n)))}function qa(n){var r=Math.abs(n-Ja(n)),t=$t;if(r>.005)for($t=1;$t<15;++$t)Math.abs(n-Ja(n))<=r&&(r=Math.abs(n-Ja(n)),t=$t);$t=t}function Ii(n){n.width?(n.wpx=Io(n.width),n.wch=Eo(n.wpx),n.MDW=$t):n.wpx?(n.wch=Eo(n.wpx),n.width=kr(n.wch),n.MDW=$t):"number"==typeof n.wch&&(n.width=kr(n.wch),n.wpx=Io(n.width),n.MDW=$t),n.customWidth&&delete n.customWidth}function Zo(n){return 96*n/96}function to(n){return 96*n/96}var Rv={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Fr=["numFmtId","fillId","fontId","borderId","xfId"],Mr=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],zv=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,o=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u,_={};return l?((u=(l=l.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(r))&&function Vv(n,r,t){r.NumberFmt=[];for(var o=dt(we),i=0;i<o.length;++i)r.NumberFmt[o[i]]=we[o[i]];var a=n[0].match(Rt);if(a)for(i=0;i<a.length;++i){var s=Ae(a[i]);switch(Zn(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=Qe(Xe(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&null!=r.NumberFmt[c];--c);r.NumberFmt[c]=l}En(l,c)}break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(u,_,d),(u=l.match(i))&&function Yv(n,r,t,o){r.Fonts=[];var i={},a=!1;(n[0].match(Rt)||[]).forEach(function(s){var l=Ae(s);switch(Zn(l[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Xe(l.val));break;case"<b":i.bold=l.val?tt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?tt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?tt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?tt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?tt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?tt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?tt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<charset":if("1"==l.val)break;l.codepage=Gr[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=tt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=yi[i.color.index];81==i.color.index&&(c=yi[1]),c||(c=yi[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Dr(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(o&&o.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fonts")}})}(u,_,c,d),(u=l.match(o))&&function Hv(n,r,t,o){r.Fills=[];var i={},a=!1;(n[0].match(Rt)||[]).forEach(function(s){var l=Ae(s);switch(Zn(l[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r.Fills.push(i={});break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),null!=l.rgb&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o&&o.WTF&&!a)throw new Error("unrecognized "+l[0]+" in fills")}})}(u,_,0,d),(u=l.match(a))&&function Qv(n,r,t,o){r.Borders=[];var i={},a=!1;(n[0].match(Rt)||[]).forEach(function(s){var l=Ae(s);switch(Zn(l[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=tt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=tt(l.diagonalDown)),r.Borders.push(i);break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o&&o.WTF&&!a)throw new Error("unrecognized "+l[0]+" in borders")}})}(u,_,0,d),(u=l.match(t))&&function Kv(n,r,t){r.CellXf=[];var o,i=!1;(n[0].match(Rt)||[]).forEach(function(a){var s=Ae(a),l=0;switch(Zn(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(o=s)[0],l=0;l<Fr.length;++l)o[Fr[l]]&&(o[Fr[l]]=parseInt(o[Fr[l]],10));for(l=0;l<Mr.length;++l)o[Mr[l]]&&(o[Mr[l]]=tt(o[Mr[l]]));if(r.NumberFmt&&o.numFmtId>392)for(l=392;l>60;--l)if(r.NumberFmt[o.numFmtId]==r.NumberFmt[l]){o.numFmtId=l;break}r.CellXf.push(o);break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),null!=s.textRotation&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=tt(s.wrapText)),o.alignment=c;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(u,_,d),_):_}}(),nC=Qt,oC=Qt,vC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function CC(n,r,t){r.themeElements.clrScheme=[];var o={};(n[0].match(Rt)||[]).forEach(function(i){var a=Ae(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":o.rgb=a.val;break;case"<a:sysClr":o.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(r.themeElements.clrScheme[vC.indexOf(a[0])]=o,o={}):o.name=a[0].slice(3,a[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function TC(){}function bC(){}var wC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,SC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,NC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,yC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Vc(n,r){(!n||0===n.length)&&(n=function Qa(n,r){if(r&&r.themeXLSX)return r.themeXLSX;if(n&&"string"==typeof n.raw)return n.raw;var t=[Tt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}());var t,o={};if(!(t=n.match(yC)))throw new Error("themeElements not found in theme");return function AC(n,r,t){var o;r.themeElements={},[["clrScheme",wC,CC],["fontScheme",SC,TC],["fmtScheme",NC,bC]].forEach(function(i){if(!(o=n.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](o,r,t)})}(t[0],o,r),o.raw=n,o}function IC(n){var r=n.read_shift(2),t=n.read_shift(2)-4,o=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:o[1]=function FC(n){var r={};switch(r.xclrType=n.read_shift(2),r.nTintShade=n.read_shift(2),r.xclrType){case 0:case 4:n.l+=4;break;case 1:r.xclrValue=function MC(n,r){return Qt(n,r)}(n,4);break;case 2:r.xclrValue=hc(n);break;case 3:r.xclrValue=function kC(n){return n.read_shift(4)}(n)}return n.l+=8,r}(n);break;case 6:o[1]=function LC(n,r){return Qt(n,r)}(n,t);break;case 14:case 15:o[1]=n.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return o}function ZC(n,r){r.forEach(function(t){})}function Wc(n,r,t,o){var a,i=Array.isArray(n);r.forEach(function(s){var l=st(s.ref);if(i?(n[l.r]||(n[l.r]=[]),a=n[l.r][l.c]):a=n[s.ref],!a){a={t:"z"},i?n[l.r][l.c]=a:n[s.ref]=a;var c=Je(n["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=ke(c);d!==n["!ref"]&&(n["!ref"]=d)}a.c||(a.c=[]);var _={a:s.author,t:s.t,r:s.r,T:t};s.h&&(_.h=s.h);for(var u=a.c.length-1;u>=0;--u){if(!t&&a.c[u].T)return;t&&!a.c[u].T&&a.c.splice(u,1)}if(t&&o)for(u=0;u<o.length;++u)if(_.a==o[u].id){_.a=o[u].name||_.a;break}a.c.push(_)})}var oT=Ht,io=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(o,i,a,s){var l=!1,c=!1;0==a.length?c=!0:"["==a.charAt(0)&&(c=!0,a=a.slice(1,-1)),0==s.length?l=!0:"["==s.charAt(0)&&(l=!0,s=s.slice(1,-1));var d=a.length>0?0|parseInt(a,10):0,_=s.length>0?0|parseInt(s,10):0;return l?_+=r.c:--_,c?d+=r.r:--d,i+(l?"":"$")+nt(_)+(c?"":"$")+pt(d)}return function(i,a){return r=a,i.replace(n,t)}}(),Ha=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ya=function(){return function(r,t){return r.replace(Ha,function(o,i,a,s,l,c){var d=va(s)-(a?0:t.c),_=xa(c)-(l?0:t.r);return i+"R"+(0==_?"":l?_+1:"["+_+"]")+"C"+(0==d?"":a?d+1:"["+d+"]")})}}();function Xc(n,r){return n.replace(Ha,function(t,o,i,a,s,l){return o+("$"==i?i+a:nt(va(a)+r.c))+("$"==s?s+l:pt(xa(l)+r.r))})}function mT(n,r,t){var i=dn(r).s,a=st(t);return Xc(n,{r:a.r-i.r,c:a.c-i.c})}function jc(n){return n.replace(/_xlfn\./g,"")}function St(n){n.l+=1}function _i(n,r){var t=n.read_shift(1==r?1:2);return[16383&t,t>>14&1,t>>15&1]}function ed(n,r,t){var o=2;if(t){if(t.biff>=2&&t.biff<=5)return td(n);12==t.biff&&(o=4)}var i=n.read_shift(o),a=n.read_shift(o),s=_i(n,2),l=_i(n,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function td(n){var r=_i(n,2),t=_i(n,2),o=n.read_shift(1),i=n.read_shift(1);return{s:{r:r[0],c:o,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function nd(n,r,t){if(t&&t.biff>=2&&t.biff<=5)return function xT(n){var r=_i(n,2),t=n.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}(n);var o=n.read_shift(t&&12==t.biff?4:2),i=_i(n,2);return{r:o,c:i[0],cRel:i[1],rRel:i[2]}}function vT(n){var r=n.read_shift(2),t=n.read_shift(2);return{r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function id(n){var r=1&n[n.l+1];return n.l+=4,[r,1]}function od(n){return[n.read_shift(1),n.read_shift(1)]}function KT(n,r){var t=[n.read_shift(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=ft(n,1)?"TRUE":"FALSE",12!=r&&(n.l+=7);break;case 37:case 16:t[1]=zn[n[n.l]],n.l+=12==r?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Yt(n);break;case 2:t[1]=Fi(n,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function WT(n,r,t){for(var o=n.read_shift(12==t.biff?4:2),i=[],a=0;a!=o;++a)i.push((12==t.biff?Ni:Ar)(n,8));return i}function zT(n,r,t){var o=0,i=0;12==t.biff?(o=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),o=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--o,0==--i&&(i=256));for(var a=0,s=[];a!=o&&(s[a]=[]);++a)for(var l=0;l!=i;++l)s[a][l]=KT(n,t.biff);return s}function Oo(n,r,t){return n.l+=2,[vT(n)]}function Va(n){return n.l+=6,[]}function rd(n){return n.l+=2,[wt(n),1&n.read_shift(2)]}var g3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],ad={1:{n:"PtgExp",f:function RT(n,r,t){return n.l++,t&&12==t.biff?[n.read_shift(4,"i"),0]:[n.read_shift(2),n.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:Qt},3:{n:"PtgAdd",f:St},4:{n:"PtgSub",f:St},5:{n:"PtgMul",f:St},6:{n:"PtgDiv",f:St},7:{n:"PtgPower",f:St},8:{n:"PtgConcat",f:St},9:{n:"PtgLt",f:St},10:{n:"PtgLe",f:St},11:{n:"PtgEq",f:St},12:{n:"PtgGe",f:St},13:{n:"PtgGt",f:St},14:{n:"PtgNe",f:St},15:{n:"PtgIsect",f:St},16:{n:"PtgUnion",f:St},17:{n:"PtgRange",f:St},18:{n:"PtgUplus",f:St},19:{n:"PtgUminus",f:St},20:{n:"PtgPercent",f:St},21:{n:"PtgParen",f:St},22:{n:"PtgMissArg",f:St},23:{n:"PtgStr",f:function $T(n,r,t){return n.l++,Fo(n,0,t)}},26:{n:"PtgSheet",f:function C3(n,r,t){return n.l+=5,n.l+=2,n.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function T3(n,r,t){return n.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function QT(n){return n.l++,zn[n.read_shift(1)]}},29:{n:"PtgBool",f:function YT(n){return n.l++,0!==n.read_shift(1)}},30:{n:"PtgInt",f:function HT(n){return n.l++,n.read_shift(2)}},31:{n:"PtgNum",f:function VT(n){return n.l++,Yt(n)}},32:{n:"PtgArray",f:function yT(n,r,t){var o=(96&n[n.l++])>>5;return n.l+=2==t.biff?6:12==t.biff?14:7,[o]}},33:{n:"PtgFunc",f:function UT(n,r,t){var o=(96&n[n.l])>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[R3[i],cd[i],o]}},34:{n:"PtgFuncVar",f:function BT(n,r,t){var o=n[n.l++],i=n.read_shift(1),a=t&&t.biff<=3?[88==o?-1:0,n.read_shift(1)]:function JT(n){return[n[n.l+1]>>7,32767&n.read_shift(2)]}(n);return[i,(0===a[0]?cd:q3)[a[1]]]}},35:{n:"PtgName",f:function GT(n,r,t){var o=n.read_shift(1)>>>5&3,a=n.read_shift(!t||t.biff>=8?4:2);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12}return[o,0,a]}},36:{n:"PtgRef",f:function ZT(n,r,t){var o=(96&n[n.l])>>5;return n.l+=1,[o,nd(n,0,t)]}},37:{n:"PtgArea",f:function bT(n,r,t){return[(96&n[n.l++])>>5,ed(n,0,t)]}},38:{n:"PtgMemArea",f:function e3(n,r,t){var o=n.read_shift(1)>>>5&3;return n.l+=t&&2==t.biff?3:4,[o,n.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:Qt},40:{n:"PtgMemNoMem",f:Qt},41:{n:"PtgMemFunc",f:function t3(n,r,t){return[n.read_shift(1)>>>5&3,n.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function n3(n,r,t){var o=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,12==t.biff&&(n.l+=2),[o]}},43:{n:"PtgAreaErr",f:function ST(n,r,t){var o=(96&n[n.l++])>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[o]}},44:{n:"PtgRefN",f:function PT(n,r,t){var o=(96&n[n.l])>>5;n.l+=1;var i=function CT(n,r,t){var o=t&&t.biff?t.biff:8;if(o>=2&&o<=5)return function TT(n){var r=n.read_shift(2),t=n.read_shift(1),o=(32768&r)>>15,i=(16384&r)>>14;return r&=16383,1==o&&r>=8192&&(r-=16384),1==i&&t>=128&&(t-=256),{r,c:t,cRel:i,rRel:o}}(n);var i=n.read_shift(o>=12?4:2),a=n.read_shift(2),s=(16384&a)>>14,l=(32768&a)>>15;if(a&=16383,1==l)for(;i>524287;)i-=1048576;if(1==s)for(;a>8191;)a-=16384;return{r:i,c:a,cRel:s,rRel:l}}(n,0,t);return[o,i]}},45:{n:"PtgAreaN",f:function AT(n,r,t){var o=(96&n[n.l++])>>5,i=function gT(n,r,t){if(t.biff<8)return td(n);var o=n.read_shift(12==t.biff?4:2),i=n.read_shift(12==t.biff?4:2),a=_i(n,2),s=_i(n,2);return{s:{r:o,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}(n,0,t);return[o,i]}},46:{n:"PtgMemAreaN",f:function b3(n){return[n.read_shift(1)>>>5&3,n.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function w3(n){return[n.read_shift(1)>>>5&3,n.read_shift(2)]}},57:{n:"PtgNameX",f:function XT(n,r,t){return 5==t.biff?function jT(n){var r=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var o=n.read_shift(2);return n.l+=12,[r,t,o]}(n):[n.read_shift(1)>>>5&3,n.read_shift(2),n.read_shift(4)]}},58:{n:"PtgRef3d",f:function OT(n,r,t){var o=(96&n[n.l])>>5;n.l+=1;var i=n.read_shift(2);return t&&5==t.biff&&(n.l+=12),[o,i,nd(n,0,t)]}},59:{n:"PtgArea3d",f:function wT(n,r,t){var o=(96&n[n.l++])>>5,i=n.read_shift(2,"i");if(t&&5===t.biff)n.l+=12;return[o,i,ed(n,0,t)]}},60:{n:"PtgRefErr3d",f:function o3(n,r,t){var o=(96&n[n.l++])>>5,i=n.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6}return n.l+=a,[o,i]}},61:{n:"PtgAreaErr3d",f:function NT(n,r,t){var o=(96&n[n.l++])>>5,i=n.read_shift(2),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12}return n.l+=a,[o,i]}},255:{}},N3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},A3={1:{n:"PtgElfLel",f:rd},2:{n:"PtgElfRw",f:Oo},3:{n:"PtgElfCol",f:Oo},6:{n:"PtgElfRwV",f:Oo},7:{n:"PtgElfColV",f:Oo},10:{n:"PtgElfRadical",f:Oo},11:{n:"PtgElfRadicalS",f:Va},13:{n:"PtgElfColS",f:Va},15:{n:"PtgElfColSV",f:Va},16:{n:"PtgElfRadicalLel",f:rd},25:{n:"PtgList",f:function x3(n){n.l+=2;var r=n.read_shift(2),t=n.read_shift(2),o=n.read_shift(4),i=n.read_shift(2),a=n.read_shift(2);return{ixti:r,coltype:3&t,rt:g3[t>>2&31],idx:o,c:i,C:a}}},29:{n:"PtgSxName",f:function v3(n){return n.l+=2,[n.read_shift(4)]}},255:{}},y3={0:{n:"PtgAttrNoop",f:function S3(n){return n.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function LT(n,r,t){var o=255&n[n.l+1]?1:0;return n.l+=t&&2==t.biff?3:4,[o]}},2:{n:"PtgAttrIf",f:function FT(n,r,t){var o=255&n[n.l+1]?1:0;return n.l+=2,[o,n.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function DT(n,r,t){n.l+=2;for(var o=n.read_shift(t&&2==t.biff?1:2),i=[],a=0;a<=o;++a)i.push(n.read_shift(t&&2==t.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function kT(n,r,t){var o=255&n[n.l+1]?1:0;return n.l+=2,[o,n.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function qT(n,r,t){n.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:id},33:{n:"PtgAttrBaxcel",f:id},64:{n:"PtgAttrSpace",f:function IT(n){return n.read_shift(2),od(n)}},65:{n:"PtgAttrSpaceSemi",f:function ET(n){return n.read_shift(2),od(n)}},128:{n:"PtgAttrIfError",f:function MT(n){var r=255&n[n.l+1]?1:0;return n.l+=2,[r,n.read_shift(2)]}},255:{}};function Uo(n,r,t,o){if(o.biff<8)return Qt(n,r);for(var i=n.l+r,a=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=zT(n,0,o),a.push(t[s][1]);break;case"PtgMemArea":t[s][2]=WT(n,0,o),a.push(t[s][2]);break;case"PtgExp":o&&12==o.biff&&(t[s][1][1]=n.read_shift(4),a.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0]}return 0!=(r=i-n.l)&&a.push(Qt(n,r)),a}function Bo(n,r,t){for(var i,a,o=n.l+r,s=[];o!=n.l;)r=o-n.l,i=ad[a=n[n.l]]||ad[N3[a]],(24===a||25===a)&&(i=(24===a?A3:y3)[n[n.l+1]]),i&&i.f?s.push([i.n,i.f(n,r,t)]):Qt(n,r);return s}function D3(n){for(var r=[],t=0;t<n.length;++t){for(var o=n[t],i=[],a=0;a<o.length;++a){var s=o[a];i.push(s?2===s[0]?'"'+s[1].replace(/"/g,'""')+'"':s[1]:"")}r.push(i.join(","))}return r.join(";")}var k3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sd(n,r,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[r]))return n.SheetNames[r];if(!n.XTI)return"SH33TJSERR6";var o=n.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":n.XTI[r-1];if(!o)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[o[0]][0]){case 357:return i=-1==o[1]?"#REF":n.SheetNames[o[1]],o[1]==o[2]?i:i+":"+n.SheetNames[o[2]];case 358:return null!=t.SID?n.SheetNames[t.SID]:"SH33TJSSAME"+n[o[0]][0];default:return"SH33TJSSRC"+n[o[0]][0]}switch(n[o[0]][0][0]){case 1025:return i=-1==o[1]?"#REF":n.SheetNames[o[1]]||"SH33TJSERR3",o[1]==o[2]?i:i+":"+n.SheetNames[o[2]];case 14849:return n[o[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[o[0]][0][3]?(i=-1==o[1]?"#REF":n[o[0]][0][3][o[1]]||"SH33TJSERR4",o[1]==o[2]?i:i+":"+n[o[0]][0][3][o[2]]):"SH33TJSERR2"}}function ld(n,r,t){var o=sd(n,r,t);return"#REF"==o?o:function F3(n,r){if(!(n||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}(o,t)}function Kt(n,r,t,o,i){var c,d,_,m,a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},l=[],u=0,f=0,h="";if(!n[0]||!n[0][0])return"";for(var p=-1,g="",v=0,x=n[0].length;v<x;++v){var C=n[0][v];switch(C[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(n[0][p][1][0]){case 0:g=_t(" ",n[0][p][1][1]);break;case 1:g=_t("\r",n[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][p][1][0])}d+=g,p=-1}l.push(d+k3[C[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":_=Ao(C[1][1],s,i),l.push(yo(_,a));break;case"PtgRefN":_=t?Ao(C[1][1],t,i):C[1][1],l.push(yo(_,a));break;case"PtgRef3d":u=C[1][1],_=Ao(C[1][2],s,i),h=ld(o,u,i),l.push(h+"!"+yo(_,a));break;case"PtgFunc":case"PtgFuncVar":var y=C[1][0],M=C[1][1];y||(y=0);var A=0==(y&=127)?[]:l.slice(-y);l.length-=y,"User"===M&&(M=A.shift()),l.push(M+"("+A.join(",")+")");break;case"PtgBool":l.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":l.push(C[1]);break;case"PtgNum":l.push(String(C[1]));break;case"PtgStr":l.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":m=Pl(C[1][1],t?{s:t}:s,i),l.push(ga(m,i));break;case"PtgArea":m=Pl(C[1][1],s,i),l.push(ga(m,i));break;case"PtgArea3d":m=C[1][2],h=ld(o,u=C[1][1],i),l.push(h+"!"+ga(m,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgName":var U=(o.names||[])[(f=C[1][2])-1]||(o[0]||[])[f],P=U?U.Name:"SH33TJSNAME"+String(f);P&&"_xlfn."==P.slice(0,6)&&!i.xlfn&&(P=P.slice(6)),l.push(P);break;case"PtgNameX":var J,B=C[1][1];if(f=C[1][2],!(i.biff<=5)){var O="";if(14849==((o[B]||[])[0]||[])[0]||(1025==((o[B]||[])[0]||[])[0]?o[B][f]&&o[B][f].itab>0&&(O=o.SheetNames[o[B][f].itab-1]+"!"):O=o.SheetNames[f-1]+"!"),o[B]&&o[B][f])O+=o[B][f].Name;else if(o[0]&&o[0][f])O+=o[0][f].Name;else{var ee=(sd(o,B,i)||"").split(";;");ee[f-1]?O=ee[f-1]:O+="SH33TJSERRX"}l.push(O);break}B<0&&(B=-B),o[B]&&(J=o[B][f]),J||(J={Name:"SH33TJSERRY"}),l.push(J.Name);break;case"PtgParen":var pe="(",ie=")";if(p>=0){switch(g="",n[0][p][1][0]){case 2:pe=_t(" ",n[0][p][1][1])+pe;break;case 3:pe=_t("\r",n[0][p][1][1])+pe;break;case 4:ie=_t(" ",n[0][p][1][1])+ie;break;case 5:ie=_t("\r",n[0][p][1][1])+ie;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][p][1][0])}p=-1}l.push(pe+l.pop()+ie);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":l.push("#REF!");break;case"PtgExp":var ve={c:t.c,r:t.r};if(o.sharedf[ye(_={c:C[1][1],r:C[1][0]})]){var me=o.sharedf[ye(_)];l.push(Kt(me,0,ve,o,i))}else{var Pe=!1;for(c=0;c!=o.arrayf.length;++c)if(!(_.c<(d=o.arrayf[c])[0].s.c||_.c>d[0].e.c||_.r<d[0].s.r||_.r>d[0].e.r)){l.push(Kt(d[1],0,ve,o,i)),Pe=!0;break}Pe||l.push(C[1])}break;case"PtgArray":l.push("{"+D3(C[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":l.push("");break;case"PtgList":l.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(C))}if(3!=i.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(n[0][v][0])){var ge=!0;switch((C=n[0][p])[1][0]){case 4:ge=!1;case 0:g=_t(" ",C[1][1]);break;case 5:ge=!1;case 1:g=_t("\r",C[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}l.push((ge?g:"")+l.pop()+(ge?"":g)),p=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function M3(n,r,t){var a,o=n.l+r,i=2==t.biff?1:2,s=n.read_shift(i);if(65535==s)return[[],Qt(n,r-2)];var l=Bo(n,s,t);return r!==s+i&&(a=Uo(n,r-s-i,l,t)),n.l=o,[l,a]}function E3(n,r,t){var i,o=n.l+r,a=n.read_shift(2),s=Bo(n,a,t);return 65535==a?[[],Qt(n,r-2)]:(r!==a+2&&(i=Uo(n,o-a-2,s,t)),[s,i])}function $a(n,r,t){var o=n.l+r,i=Un(n);2==t.biff&&++n.l;var a=function Z3(n){var r;if(65535!==Kn(n,n.l+6))return[Yt(n),"n"];switch(n[n.l]){case 0:return n.l+=8,["String","s"];case 1:return r=1===n[n.l+2],n.l+=8,[r,"b"];case 2:return r=n[n.l+2],n.l+=8,[r,"e"];case 3:return n.l+=8,["","s"]}return[]}(n),s=n.read_shift(1);2!=t.biff&&(n.read_shift(1),t.biff>=5&&n.read_shift(4));var l=function L3(n,r,t){var a,o=n.l+r,i=2==t.biff?1:2,s=n.read_shift(i);if(65535==s)return[[],Qt(n,r-2)];var l=Bo(n,s,t);return r!==s+i&&(a=Uo(n,r-s-i,l,t)),n.l=o,[l,a]}(n,o-n.l,t);return{cell:i,val:a[0],formula:l,shared:s>>3&1,tt:a[1]}}function Lr(n,r,t){var o=n.read_shift(4),i=Bo(n,o,t),a=n.read_shift(4);return[i,a>0?Uo(n,a,i,t):null]}var U3=Lr,Ir=Lr,B3=Lr,J3=Lr,q3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cd={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},R3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function dd(n){return"of:"==n.slice(0,3)&&(n=n.slice(3)),61==n.charCodeAt(0)&&61==(n=n.slice(1)).charCodeAt(0)&&(n=n.slice(1)),(n=(n=(n=n.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ka(n){var r=n.split(":");return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Jo={},oo={};function Ei(n,r){if(n){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==n.left&&(n.left=t[0]),null==n.right&&(n.right=t[1]),null==n.top&&(n.top=t[2]),null==n.bottom&&(n.bottom=t[3]),null==n.header&&(n.header=t[4]),null==n.footer&&(n.footer=t[5])}}function _d(n,r,t,o,i,a){try{o.cellNF&&(n.z=we[r])}catch(l){if(o.WTF)throw l}if("z"!==n.t||o.cellStyles){if("d"===n.t&&"string"==typeof n.v&&(n.v=at(n.v)),(!o||!1!==o.cellText)&&"z"!==n.t)try{if(null==we[r]&&En(R1[r]||"General",r),"e"===n.t)n.w=n.w||zn[n.v];else if(0===r)if("n"===n.t)n.w=(0|n.v)===n.v?n.v.toString(10):vo(n.v);else if("d"===n.t){var s=At(n.v);n.w=(0|s)===s?s.toString(10):vo(s)}else{if(void 0===n.v)return"";n.w=xi(n.v,oo)}else n.w=sn(r,"d"===n.t?At(n.v):n.v,oo)}catch(l){if(o.WTF)throw l}if(o.cellStyles&&null!=t)try{n.s=a.Fills[t],n.s.fgColor&&n.s.fgColor.theme&&!n.s.fgColor.rgb&&(n.s.fgColor.rgb=Dr(i.themeElements.clrScheme[n.s.fgColor.theme].rgb,n.s.fgColor.tint||0),o.WTF&&(n.s.fgColor.raw_rgb=i.themeElements.clrScheme[n.s.fgColor.theme].rgb)),n.s.bgColor&&n.s.bgColor.theme&&(n.s.bgColor.rgb=Dr(i.themeElements.clrScheme[n.s.bgColor.theme].rgb,n.s.bgColor.tint||0),o.WTF&&(n.s.bgColor.raw_rgb=i.themeElements.clrScheme[n.s.bgColor.theme].rgb))}catch(l){if(o.WTF&&a.Fills)throw l}}}var Y3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,V3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,$3=/<(?:\w:)?hyperlink [^>]*>/gm,K3=/"(\w*:\w*)"/,W3=/<(?:\w:)?col\b[^>]*[\/]?>/g,z3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,G3=/<(?:\w:)?pageMargins[^>]*\/>/g,pd=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,X3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,j3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function za(n,r,t,o){var i=Ae(n);t.Sheets[o]||(t.Sheets[o]={}),i.codeName&&(t.Sheets[o].CodeName=Qe(Xe(i.codeName)))}var fb=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,xb=function(){var n=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,o=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=wo("v"),s=wo("f");return function(c,d,_,u,f,m){for(var M,A,B,J,ie,h=0,p="",g=[],v=[],x=0,C=0,b=0,y="",U=0,P=0,O=0,ee=0,pe=Array.isArray(m.CellXf),ve=[],me=[],Pe=Array.isArray(d),_e=[],ge={},z=!1,I=!!_.sheetStubs,Q=c.split(r),Z=0,E=Q.length;Z!=E;++Z){var W=(p=Q[Z].trim()).length;if(0!==W){var le=0;e:for(h=0;h<W;++h)switch(p[h]){case">":if("/"!=p[h-1]){++h;break e}if(_&&_.cellStyles){if(U=null!=(A=Ae(p.slice(le,h),!0)).r?parseInt(A.r,10):U+1,P=-1,_.sheetRows&&_.sheetRows<U)continue;ge={},z=!1,A.ht&&(z=!0,ge.hpt=parseFloat(A.ht),ge.hpx=to(ge.hpt)),"1"==A.hidden&&(z=!0,ge.hidden=!0),null!=A.outlineLevel&&(z=!0,ge.level=+A.outlineLevel),z&&(_e[U-1]=ge)}break;case"<":le=h}if(le>=h)break;if(U=null!=(A=Ae(p.slice(le,h),!0)).r?parseInt(A.r,10):U+1,P=-1,!(_.sheetRows&&_.sheetRows<U)){u.s.r>U-1&&(u.s.r=U-1),u.e.r<U-1&&(u.e.r=U-1),_&&_.cellStyles&&(ge={},z=!1,A.ht&&(z=!0,ge.hpt=parseFloat(A.ht),ge.hpx=to(ge.hpt)),"1"==A.hidden&&(z=!0,ge.hidden=!0),null!=A.outlineLevel&&(z=!0,ge.level=+A.outlineLevel),z&&(_e[U-1]=ge)),g=p.slice(h).split(n);for(var te=0;te!=g.length&&"<"==g[te].trim().charAt(0);++te);for(g=g.slice(te),h=0;h!=g.length;++h)if(0!==(p=g[h].trim()).length){if(v=p.match(t),x=h,C=0,b=0,p="<c "+("<"==p.slice(0,1)?">":"")+p,null!=v&&2===v.length){for(x=0,y=v[1],C=0;C!=y.length&&!((b=y.charCodeAt(C)-64)<1||b>26);++C)x=26*x+b;P=--x}else++P;for(C=0;C!=p.length&&62!==p.charCodeAt(C);++C);if(++C,(A=Ae(p.slice(0,C),!0)).r||(A.r=ye({r:U-1,c:P})),M={t:""},null!=(v=(y=p.slice(C)).match(a))&&""!==v[1]&&(M.v=Qe(v[1])),_.cellFormula){if(null!=(v=y.match(s))&&""!==v[1]){if(M.f=Qe(Xe(v[1])).replace(/\r\n/g,"\n"),_.xlfn||(M.f=jc(M.f)),v[0].indexOf('t="array"')>-1)M.F=(y.match(i)||[])[1],M.F.indexOf(":")>-1&&ve.push([Je(M.F),M.F]);else if(v[0].indexOf('t="shared"')>-1){J=Ae(v[0]);var ne=Qe(Xe(v[1]));_.xlfn||(ne=jc(ne)),me[parseInt(J.si,10)]=[J,ne,A.r]}}else(v=y.match(/<f[^>]*\/>/))&&me[(J=Ae(v[0])).si]&&(M.f=mT(me[J.si][1],me[J.si][2],A.r));var G=st(A.r);for(C=0;C<ve.length;++C)G.r>=ve[C][0].s.r&&G.r<=ve[C][0].e.r&&G.c>=ve[C][0].s.c&&G.c<=ve[C][0].e.c&&(M.F=ve[C][1])}if(null==A.t&&void 0===M.v)if(M.f||M.F)M.v=0,M.t="n";else{if(!I)continue;M.t="z"}else M.t=A.t||"n";switch(u.s.c>P&&(u.s.c=P),u.e.c<P&&(u.e.c=P),M.t){case"n":if(""==M.v||null==M.v){if(!I)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(void 0===M.v){if(!I)continue;M.t="z"}else B=Jo[parseInt(M.v,10)],M.v=B.t,M.r=B.r,_.cellHTML&&(M.h=B.h);break;case"str":M.t="s",M.v=null!=M.v?Xe(M.v):"",_.cellHTML&&(M.h=sa(M.v));break;case"inlineStr":v=y.match(o),M.t="s",null!=v&&(B=Ua(v[1]))?(M.v=B.t,_.cellHTML&&(M.h=B.h)):M.v="";break;case"b":M.v=tt(M.v);break;case"d":_.cellDates?M.v=at(M.v,1):(M.v=At(at(M.v,1)),M.t="n");break;case"e":(!_||!1!==_.cellText)&&(M.w=M.v),M.v=Vl[M.v]}if(O=ee=0,ie=null,pe&&void 0!==A.s&&null!=(ie=m.CellXf[A.s])&&(null!=ie.numFmtId&&(O=ie.numFmtId),_.cellStyles&&null!=ie.fillId&&(ee=ie.fillId)),_d(M,O,ee,_,f,m),_.cellDates&&pe&&"n"==M.t&&vi(we[O])&&(M.t="d",M.v=fr(M.v)),A.cm&&_.xlmeta){var Me=(_.xlmeta.Cell||[])[+A.cm-1];Me&&"XLDAPR"==Me.type&&(M.D=!0)}if(Pe){var L=st(A.r);d[L.r]||(d[L.r]=[]),d[L.r][L.c]=M}else d[A.r]=M}}}}_e.length>0&&(d["!rows"]=_e)}}(),wb=Ni;function fd(n){return[wi(n),Yt(n),"n"]}var a6=Ni,md=["left","right","top","bottom","header","footer"];var Ga=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],R6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Q6=[],H6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hd(n,r){for(var t=0;t!=n.length;++t)for(var o=n[t],i=0;i!=r.length;++i){var a=r[i];if(null==o[a[0]])o[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof o[a[0]]&&(o[a[0]]=tt(o[a[0]]));break;case"int":"string"==typeof o[a[0]]&&(o[a[0]]=parseInt(o[a[0]],10))}}}function gd(n,r){for(var t=0;t!=r.length;++t){var o=r[t];if(null==n[o[0]])n[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof n[o[0]]&&(n[o[0]]=tt(n[o[0]]));break;case"int":"string"==typeof n[o[0]]&&(n[o[0]]=parseInt(n[o[0]],10))}}}function xd(n){gd(n.WBProps,Ga),gd(n.CalcPr,H6),hd(n.WBView,R6),hd(n.Sheets,Q6),oo.date1904=tt(n.WBProps.date1904)}var V6="][*?/\\".split("");var K6=/<\w+:workbook/;function ew(n,r){var t={};return n.read_shift(4),t.ArchID=n.read_shift(4),n.l+=r-8,t}function cw(n,r,t,o,i,a,s,l){return".bin"===r.slice(-4)?function w6(n,r,t,o,i,a,s){if(!n)return n;var l=r||{};o||(o={"!id":{}});var d,h,p,g,v,x,C,b,y,M,c=l.dense?[]:{},_={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=[],f=!1,m=!1,A=[];l.biff=12,l["!row"]=0;var U=0,P=!1,B=[],J={},O=l.supbooks||i.supbooks||[[]];if(O.sharedf=J,O.arrayf=B,O.SheetNames=i.SheetNames||i.Sheets.map(function(ge){return ge.name}),!l.supbooks&&(l.supbooks=O,i.Names))for(var ee=0;ee<i.Names.length;++ee)O[0][ee+1]=i.Names[ee];var me,Pe,pe=[],ie=[],ve=!1;if(Ho[16]={n:"BrtShortReal",f:fd},Wn(n,function(z,I,Q){if(!m)switch(Q){case 148:d=z;break;case 0:h=z,l.sheetRows&&l.sheetRows<=h.r&&(m=!0),y=pt(v=h.r),l["!row"]=h.r,(z.hidden||z.hpt||null!=z.level)&&(z.hpt&&(z.hpx=to(z.hpt)),ie[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:z[2]},z[2]){case"n":p.v=z[1];break;case"s":p.v=(b=Jo[z[1]]).t,p.r=b.r;break;case"b":p.v=!!z[1];break;case"e":p.v=z[1],!1!==l.cellText&&(p.w=zn[p.v]);break;case"str":p.t="s",p.v=z[1];break;case"is":p.t="s",p.v=z[1].t}if((g=s.CellXf[z[0].iStyleRef])&&_d(p,g.numFmtId,null,l,a,s),x=-1==z[0].c?x+1:z[0].c,l.dense?(c[v]||(c[v]=[]),c[v][x]=p):c[nt(x)+y]=p,l.cellFormula){for(P=!1,U=0;U<B.length;++U){var Z=B[U];h.r>=Z[0].s.r&&h.r<=Z[0].e.r&&x>=Z[0].s.c&&x<=Z[0].e.c&&(p.F=ke(Z[0]),P=!0)}!P&&z.length>3&&(p.f=z[3])}if(_.s.r>h.r&&(_.s.r=h.r),_.s.c>x&&(_.s.c=x),_.e.r<h.r&&(_.e.r=h.r),_.e.c<x&&(_.e.c=x),l.cellDates&&g&&"n"==p.t&&vi(we[g.numFmtId])){var E=ri(p.v);E&&(p.t="d",p.v=new Date(E.y,E.m-1,E.d,E.H,E.M,E.S,E.u))}me&&("XLDAPR"==me.type&&(p.D=!0),me=void 0),Pe&&(Pe=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;p={t:"z",v:void 0},x=-1==z[0].c?x+1:z[0].c,l.dense?(c[v]||(c[v]=[]),c[v][x]=p):c[nt(x)+y]=p,_.s.r>h.r&&(_.s.r=h.r),_.s.c>x&&(_.s.c=x),_.e.r<h.r&&(_.e.r=h.r),_.e.c<x&&(_.e.c=x),me&&("XLDAPR"==me.type&&(p.D=!0),me=void 0),Pe&&(Pe=void 0);break;case 176:A.push(z);break;case 49:me=((l.xlmeta||{}).Cell||[])[z-1];break;case 494:var W=o["!id"][z.relId];for(W?(z.Target=W.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=W):""==z.relId&&(z.Target="#"+z.loc),v=z.rfx.s.r;v<=z.rfx.e.r;++v)for(x=z.rfx.s.c;x<=z.rfx.e.c;++x)l.dense?(c[v]||(c[v]=[]),c[v][x]||(c[v][x]={t:"z",v:void 0}),c[v][x].l=z):(C=ye({c:x,r:v}),c[C]||(c[C]={t:"z",v:void 0}),c[C].l=z);break;case 426:if(!l.cellFormula)break;B.push(z),(M=l.dense?c[v][x]:c[nt(x)+y]).f=Kt(z[1],0,{r:h.r,c:x},O,l),M.F=ke(z[0]);break;case 427:if(!l.cellFormula)break;J[ye(z[0].s)]=z[1],(M=l.dense?c[v][x]:c[nt(x)+y]).f=Kt(z[1],0,{r:h.r,c:x},O,l);break;case 60:if(!l.cellStyles)break;for(;z.e>=z.s;)pe[z.e--]={width:z.w/256,hidden:!!(1&z.flags),level:z.level},ve||(ve=!0,qa(z.w/256)),Ii(pe[z.e+1]);break;case 161:c["!autofilter"]={ref:ke(z)};break;case 476:c["!margins"]=z;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),z.name&&(i.Sheets[t].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),z.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:u.push(Q),f=!0;break;case 38:u.pop(),f=!1;break;default:if(!I.T&&(!f||l.WTF))throw new Error("Unexpected record 0x"+Q.toString(16))}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(_.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=ke(d||_)),l.sheetRows&&c["!ref"]){var _e=Je(c["!ref"]);l.sheetRows<=+_e.e.r&&(_e.e.r=l.sheetRows-1,_e.e.r>_.e.r&&(_e.e.r=_.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>_.e.c&&(_e.e.c=_.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ke(_e))}return A.length>0&&(c["!merges"]=A),pe.length>0&&(c["!cols"]=pe),ie.length>0&&(c["!rows"]=ie),c}(n,o,t,i,a,s,l):function eb(n,r,t,o,i,a,s){if(!n)return n;o||(o={"!id":{}});var l=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",_="",u=n.match(V3);u?(d=n.slice(0,u.index),_=n.slice(u.index+u[0].length)):d=_=n;var f=d.match(pd);f?za(f[0],0,i,t):(f=d.match(X3))&&function nb(n,r,t,o,i){za(n.slice(0,n.indexOf(">")),0,o,i)}(f[0],0,0,i,t);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var h=d.slice(m,m+50).match(K3);h&&function H3(n,r){var t=Je(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(n["!ref"]=ke(t))}(l,h[1])}var p=d.match(j3);p&&p[1]&&function mb(n,r){r.Views||(r.Views=[{}]),(n.match(fb)||[]).forEach(function(t,o){var i=Ae(t);r.Views[o]||(r.Views[o]={}),+i.zoomScale&&(r.Views[o].zoom=+i.zoomScale),tt(i.rightToLeft)&&(r.Views[o].RTL=!0)})}(p[1],i);var g=[];if(r.cellStyles){var v=d.match(W3);v&&function db(n,r){for(var t=!1,o=0;o!=r.length;++o){var i=Ae(r[o],!0);i.hidden&&(i.hidden=tt(i.hidden));var a=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,qa(i.width)),Ii(i);a<=s;)n[a++]=je(i)}}(g,v)}u&&xb(u[1],l,r,c,a,s);var x=_.match(z3);x&&(l["!autofilter"]=function pb(n){return{ref:(n.match(/ref="([^"]*)"/)||[])[1]}}(x[0]));var C=[],b=_.match(Y3);if(b)for(m=0;m!=b.length;++m)C[m]=Je(b[m].slice(b[m].indexOf('"')+1));var y=_.match($3);y&&function sb(n,r,t){for(var o=Array.isArray(n),i=0;i!=r.length;++i){var a=Ae(Xe(r[i]),!0);if(!a.ref)return;var s=((t||{})["!id"]||[])[a.id];s?(a.Target=s.Target,a.location&&(a.Target+="#"+Qe(a.location))):(a.Target="#"+Qe(a.location),s={Target:a.Target,TargetMode:"Internal"}),a.Rel=s,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var l=Je(a.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var _=ye({c:d,r:c});o?(n[c]||(n[c]=[]),n[c][d]||(n[c][d]={t:"z",v:void 0}),n[c][d].l=a):(n[_]||(n[_]={t:"z",v:void 0}),n[_].l=a)}}}(l,y,o);var M=_.match(G3);if(M&&(l["!margins"]=function lb(n){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){n[t]&&(r[t]=parseFloat(n[t]))}),r}(Ae(M[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=ke(c)),r.sheetRows>0&&l["!ref"]){var A=Je(l["!ref"]);r.sheetRows<=+A.e.r&&(A.e.r=r.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ke(A))}return g.length>0&&(l["!cols"]=g),C.length>0&&(l["!merges"]=C),l}(n,o,t,i,a,s,l)}var Ro,bd=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wd=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function kn(n,r){var t=n.split(/\s+/),o=[];if(r||(o[0]=t[0]),1===t.length)return o;var a,s,c,i=n.match(bd);if(i)for(c=0;c!=i.length;++c)-1===(s=(a=i[c].match(wd))[1].indexOf(":"))?o[a[1]]=a[2].slice(1,a[2].length-1):o["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return o}function Aw(n){var t={};if(1===n.split(/\s+/).length)return t;var i,a,l,o=n.match(bd);if(o)for(l=0;l!=o.length;++l)-1===(a=(i=o[l].match(wd))[1].indexOf(":"))?t[i[1]]=i[2].slice(1,i[2].length-1):t["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(a+1)]=i[2].slice(1,i[2].length-1);return t}function Dw(n,r,t,o){var i=o;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=tt(o);break;case"i2":case"int":i=parseInt(o,10);break;case"r4":case"float":i=parseFloat(o);break;case"date":case"dateTime.tz":i=at(o);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}n[Qe(r)]=i}function Fw(n,r,t){if(t.cellStyles&&r.Interior){var o=r.Interior;o.Pattern&&(o.patternType=Rv[o.Pattern]||o.Pattern)}n[r.ID]=r}function Mw(n,r,t,o,i,a,s,l,c,d){var _="General",u=o.StyleID,f={};d=d||{};var m=[],h=0;for(void 0===u&&l&&(u=l.StyleID),void 0===u&&s&&(u=s.StyleID);void 0!==a[u]&&(a[u].nf&&(_=a[u].nf),a[u].Interior&&m.push(a[u].Interior),a[u].Parent);)u=a[u].Parent;switch(t.Type){case"Boolean":o.t="b",o.v=tt(n);break;case"String":o.t="s",o.r=ml(Qe(n)),o.v=n.indexOf("<")>-1?Qe(r||n).replace(/<.*?>/g,""):o.r;break;case"DateTime":"Z"!=n.slice(-1)&&(n+="Z"),o.v=(at(n)-new Date(Date.UTC(1899,11,30)))/864e5,o.v!=o.v?o.v=Qe(n):o.v<60&&(o.v=o.v-1),(!_||"General"==_)&&(_="yyyy-mm-dd");case"Number":void 0===o.v&&(o.v=+n),o.t||(o.t="n");break;case"Error":o.t="e",o.v=Vl[n],!1!==d.cellText&&(o.w=n);break;default:""==n&&""==r?o.t="z":(o.t="s",o.v=ml(r||n))}if(function kw(n,r,t){if("z"!==n.t){if(!t||!1!==t.cellText)try{n.w="e"===n.t?n.w||zn[n.v]:"General"===r?"n"===n.t?(0|n.v)===n.v?n.v.toString(10):vo(n.v):xi(n.v):function yw(n,r){var t=Ro[n]||Qe(n);return"General"===t?xi(r):sn(t,r)}(r||"General",n.v)}catch(a){if(t.WTF)throw a}try{var o=Ro[r]||r||"General";if(t.cellNF&&(n.z=o),t.cellDates&&"n"==n.t&&vi(o)){var i=ri(n.v);i&&(n.t="d",n.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(t.WTF)throw a}}}(o,_,d),!1!==d.cellFormula)if(o.Formula){var p=Qe(o.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),o.f=io(p,i),delete o.Formula,"RC"==o.ArrayRange?o.F=io("RC:RC",i):o.ArrayRange&&(o.F=io(o.ArrayRange,i),c.push([Je(o.F),o.F]))}else for(h=0;h<c.length;++h)i.r>=c[h][0].s.r&&i.r<=c[h][0].e.r&&i.c>=c[h][0].s.c&&i.c<=c[h][0].e.c&&(o.F=c[h][1]);d.cellStyles&&(m.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),o.s=f),void 0!==o.StyleID&&(o.ixfe=o.StyleID)}function Lw(n){n.t=n.v||"",n.t=n.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),n.v=n.w=n.ixfe=void 0}function Xa(n,r){var t=r||{};Ki();var o=Yi(da(n));("binary"==t.type||"array"==t.type||"base64"==t.type)&&(o=Xe(o));var i=o.slice(0,1024).toLowerCase(),a=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var s=je(t);return s.type="string",eo.to_workbook(o,s)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(mt){i.indexOf("<"+mt)>=0&&(a=!0)}),a)return function f4(n,r){var t=n.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length)return ci(yd(t[0],r),r);var o={SheetNames:[],Sheets:{}};return t.forEach(function(i,a){fs(o,yd(i,r),"Sheet"+(a+1))}),o}(o,t);Ro={"General Number":"General","General Date":we[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":we[15],"Short Date":we[14],"Long Time":we[19],"Medium Time":we[18],"Short Time":we[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:we[2],Standard:we[4],Percent:we[10],Scientific:we[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,d,me,c=[],_={},u=[],f=t.dense?[]:{},m="",h={},p={},g=kn('<Data ss:Type="String">'),v=0,x=0,C=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y={},M={},A="",U=0,P=[],B={},J={},O=0,ee=[],pe=[],ie={},ve=[],Pe=!1,_e=[],ge=[],z={},I=0,Q=0,Z={Sheets:[],WBProps:{date1904:!1}},E={};So.lastIndex=0,o=o.replace(/<!--([\s\S]*?)-->/gm,"");for(var W="";l=So.exec(o);)switch(l[3]=(W=l[3]).toLowerCase()){case"data":if("data"==W){if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;"/"===l[1]?Mw(o.slice(v,l.index),A,g,"comment"==c[c.length-1][0]?ie:h,{c:x,r:C},y,ve[x],p,_e,t):(A="",g=kn(l[0]),v=l.index+l[0].length);break;case"cell":if("/"===l[1])if(pe.length>0&&(h.c=pe),(!t.sheetRows||t.sheetRows>C)&&void 0!==h.v&&(t.dense?(f[C]||(f[C]=[]),f[C][x]=h):f[nt(x)+pt(C)]=h),h.HRef&&(h.l={Target:Qe(h.HRef)},h.HRefScreenTip&&(h.l.Tooltip=h.HRefScreenTip),delete h.HRef,delete h.HRefScreenTip),(h.MergeAcross||h.MergeDown)&&(I=x+(0|parseInt(h.MergeAcross,10)),Q=C+(0|parseInt(h.MergeDown,10)),P.push({s:{c:x,r:C},e:{c:I,r:Q}})),t.sheetStubs)if(h.MergeAcross||h.MergeDown){for(var le=x;le<=I;++le)for(var te=C;te<=Q;++te)(le>x||te>C)&&(t.dense?(f[te]||(f[te]=[]),f[te][le]={t:"z"}):f[nt(le)+pt(te)]={t:"z"});x=I+1}else++x;else h.MergeAcross?x=I+1:++x;else(h=Aw(l[0])).Index&&(x=+h.Index-1),x<b.s.c&&(b.s.c=x),x>b.e.c&&(b.e.c=x),"/>"===l[0].slice(-2)&&++x,pe=[];break;case"row":"/"===l[1]||"/>"===l[0].slice(-2)?(C<b.s.r&&(b.s.r=C),C>b.e.r&&(b.e.r=C),"/>"===l[0].slice(-2)&&(p=kn(l[0])).Index&&(C=+p.Index-1),x=0,++C):((p=kn(l[0])).Index&&(C=+p.Index-1),z={},("0"==p.AutoFitHeight||p.Height)&&(z.hpx=parseInt(p.Height,10),z.hpt=Zo(z.hpx),ge[C]=z),"1"==p.Hidden&&(z.hidden=!0,ge[C]=z));break;case"worksheet":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));u.push(m),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(f["!ref"]=ke(b),t.sheetRows&&t.sheetRows<=b.e.r&&(f["!fullref"]=f["!ref"],b.e.r=t.sheetRows-1,f["!ref"]=ke(b))),P.length&&(f["!merges"]=P),ve.length>0&&(f["!cols"]=ve),ge.length>0&&(f["!rows"]=ge),_[m]=f}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=x=0,c.push([l[3],!1]),d=kn(l[0]),m=Qe(d.Name),f=t.dense?[]:{},P=[],_e=[],ge=[],Z.Sheets.push(E={name:m,Hidden:0});break;case"table":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if("/>"==l[0].slice(-2))break;c.push([l[3],!1]),ve=[],Pe=!1}break;case"style":"/"===l[1]?Fw(y,M,t):M=kn(l[0]);break;case"numberformat":M.nf=Qe(kn(l[0]).Format||"General"),Ro[M.nf]&&(M.nf=Ro[M.nf]);for(var ne=0;392!=ne&&we[ne]!=M.nf;++ne);if(392==ne)for(ne=57;392!=ne;++ne)if(null==we[ne]){En(M.nf,ne);break}break;case"column":if("table"!==c[c.length-1][0])break;if((me=kn(l[0])).Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!Pe&&me.wpx>10){Pe=!0,$t=6;for(var G=0;G<ve.length;++G)ve[G]&&Ii(ve[G])}Pe&&Ii(me),ve[me.Index-1||ve.length]=me;for(var Me=0;Me<+me.Span;++Me)ve[ve.length]=je(me);break;case"namedrange":if("/"===l[1])break;Z.Names||(Z.Names=[]);var L=Ae(l[0]),We={Name:L.Name,Ref:io(L.RefersTo.slice(1),{r:0,c:0})};Z.Sheets.length>0&&(We.Sheet=Z.Sheets.length-1),Z.Names.push(We);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===l[0].slice(-2))break;"/"===l[1]?A+=o.slice(U,l.index):U=l.index+l[0].length;break;case"interior":if(!t.cellStyles)break;M.Interior=kn(l[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===l[0].slice(-2))break;"/"===l[1]?nx(B,W,o.slice(O,l.index)):O=l.index+l[0].length;break;case"styles":case"workbook":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Lw(ie),pe.push(ie)}else c.push([l[3],!1]),ie={a:(d=kn(l[0])).Author};break;case"autofilter":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if("/"!==l[0].charAt(l[0].length-2)){var Ue=kn(l[0]);f["!autofilter"]={ref:io(Ue.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"datavalidation":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===l[1]){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&c.push([l[3],!0]);break;default:if(0==c.length&&"document"==l[3]||0==c.length&&"uof"==l[3])return Bd(o,t);var ze=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:ze=!1}break;case"componentoptions":switch(l[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:ze=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Z.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:ze=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":case"height":case"width":break;default:ze=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if("/>"!==l[0].slice(-2))if("/"===l[1])switch(o.slice(O,l.index)){case"SheetHidden":E.Hidden=1;break;case"SheetVeryHidden":E.Hidden=2}else O=l.index+l[0].length;break;case"header":f["!margins"]||Ei(f["!margins"]={},"xlml"),isNaN(+Ae(l[0]).Margin)||(f["!margins"].header=+Ae(l[0]).Margin);break;case"footer":f["!margins"]||Ei(f["!margins"]={},"xlml"),isNaN(+Ae(l[0]).Margin)||(f["!margins"].footer=+Ae(l[0]).Margin);break;case"pagemargins":var Be=Ae(l[0]);f["!margins"]||Ei(f["!margins"]={},"xlml"),isNaN(+Be.Top)||(f["!margins"].top=+Be.Top),isNaN(+Be.Left)||(f["!margins"].left=+Be.Left),isNaN(+Be.Right)||(f["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(f["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":Z.Views||(Z.Views=[]),Z.Views[0]||(Z.Views[0]={}),Z.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:ze=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:ze=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:ze=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:ze=!1}break;case"querytable":switch(l[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:ze=!1}break;case"datavalidation":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:ze=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:ze=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:ze=!1}break;case"smarttags":break;default:ze=!1}if(ze||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===l[0].slice(-2))break;"/"===l[1]?Dw(J,W,ee,o.slice(O,l.index)):(ee=l,O=l.index+l[0].length);break}if(t.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ue={};return!t.bookSheets&&!t.bookProps&&(ue.Sheets=_),ue.SheetNames=u,ue.Workbook=Z,ue.SSF=je(we),ue.Props=B,ue.Custprops=J,ue}function ja(n,r){switch(as(r=r||{}),r.type||"base64"){case"base64":return Xa(rn(n),r);case"binary":case"buffer":case"file":return Xa(n,r);case"array":return Xa(oi(n),r)}}var Vw=[60,1084,2066,2165,2175];function $w(n,r,t,o,i){var a=o,s=[],l=t.slice(t.l,t.l+a);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(n){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(l)}s.push(l),t.l+=a;for(var c=Kn(t,t.l),d=es[c],_=0;null!=d&&Vw.indexOf(c)>-1;)a=Kn(t,t.l+2),_=t.l+4,2066==c?_+=4:(2165==c||2175==c)&&(_+=12),l=t.slice(_,t.l+4+a),s.push(l),t.l+=4+a,d=es[c=Kn(t,t.l)];var u=kt(s);Ot(u,0);var f=0;u.lens=[];for(var m=0;m<s.length;++m)u.lens.push(f),f+=s[m].length;if(u.length<o)throw"XLS Record 0x"+n.toString(16)+" Truncated: "+u.length+" < "+o;return r.f(u,u.length,i)}function Bn(n,r,t){if("z"!==n.t&&n.XF){var o=0;try{o=n.z||n.XF.numFmtId||0,r.cellNF&&(n.z=we[o])}catch(a){if(r.WTF)throw a}if(!r||!1!==r.cellText)try{n.w="e"===n.t?n.w||zn[n.v]:0===o||"General"==o?"n"===n.t?(0|n.v)===n.v?n.v.toString(10):vo(n.v):xi(n.v):sn(o,n.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(a){if(r.WTF)throw a}if(r.cellDates&&o&&"n"==n.t&&vi(we[o]||String(o))){var i=ri(n.v);i&&(n.t="d",n.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Zr(n,r,t){return{v:n,ixfe:r,t}}function Nd(n,r){var t,o,i,a;if(r||(r={}),as(r),ar(),r.codepage&&rr(r.codepage),n.FullPaths){if(Te.find(n,"/encryption"))throw new Error("File is password-protected");t=Te.find(n,"!CompObj"),o=Te.find(n,"/Workbook")||Te.find(n,"/Book")}else{switch(r.type){case"base64":n=an(rn(n));break;case"binary":n=an(n);break;case"buffer":break;case"array":Array.isArray(n)||(n=Array.prototype.slice.call(n))}Ot(n,0),o={content:n}}if(t&&function Yw(n){var r={},t=n.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=function Zg(n){return Rl(n,1)}(t),t.length-t.l<=4)return r;var o=t.read_shift(4);if(0==o||o>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||1907505652!==(o=t.read_shift(4))||(r.UnicodeClipboardFormat=function Pg(n){return Rl(n,2)}(t),0==(o=t.read_shift(4))||o>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}(t),r.bookProps&&!r.bookSheets)i={};else{var s=Ee?"buffer":"array";if(o&&o.content)i=function Kw(n,r){var u,m,p,g,C,b,t={opts:{}},o={},i=r.dense?[]:{},a={},s={},l=null,c=[],d="",_={},f="",v={},x=[],y=[],M=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},P=function(Oe){return Oe<8?yi[Oe]:Oe<64&&M[Oe-8]||yi[Oe]},J=function(Oe,ht,wn){if(!(z>1||wn.sheetRows&&Oe.r>=wn.sheetRows)){if(wn.cellStyles&&ht.XF&&ht.XF.data&&function(Oe,ht,wn){var Ui,yt=ht.XF.data;yt&&yt.patternType&&wn&&wn.cellStyles&&(ht.s={},ht.s.patternType=yt.patternType,(Ui=Lo(P(yt.icvFore)))&&(ht.s.fgColor={rgb:Ui}),(Ui=Lo(P(yt.icvBack)))&&(ht.s.bgColor={rgb:Ui}))}(0,ht,wn),delete ht.ixfe,delete ht.XF,u=Oe,f=ye(Oe),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<s.s.r&&(s.s.r=Oe.r),Oe.c<s.s.c&&(s.s.c=Oe.c),Oe.r+1>s.e.r&&(s.e.r=Oe.r+1),Oe.c+1>s.e.c&&(s.e.c=Oe.c+1),wn.cellFormula&&ht.f)for(var yt=0;yt<x.length;++yt)if(!(x[yt][0].s.c>Oe.c||x[yt][0].s.r>Oe.r||x[yt][0].e.c<Oe.c||x[yt][0].e.r<Oe.r)){ht.F=ke(x[yt][0]),(x[yt][0].s.c!=Oe.c||x[yt][0].s.r!=Oe.r)&&delete ht.f,ht.f&&(ht.f=""+Kt(x[yt][1],0,Oe,_e,O));break}wn.dense?(i[Oe.r]||(i[Oe.r]=[]),i[Oe.r][Oe.c]=ht):i[f]=ht}},O={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(O.password=r.password);var ee,pe=[],ie=[],ve=[],me=[],Pe=!1,_e=[];_e.SheetNames=O.snames,_e.sharedf=O.sharedf,_e.arrayf=O.arrayf,_e.names=[],_e.XTI=[];var E,ge=0,z=0,I=0,Q=[],Z=[];O.codepage=1200,un(1200);for(var W=!1;n.l<n.length-1;){var le=n.l,te=n.read_shift(2);if(0===te&&10===ge)break;var ne=n.l===n.length?0:n.read_shift(2),G=es[te];if(G&&G.f){if(r.bookSheets&&133===ge&&133!==te)break;if(ge=te,2===G.r||12==G.r){var Me=n.read_shift(2);if(ne-=2,!O.enc&&Me!==te&&((255&Me)<<8|Me>>8)!==te)throw new Error("rt mismatch: "+Me+"!="+te);12==G.r&&(n.l+=10,ne-=10)}var L={};if(L=10===te?G.f(n,ne,O):$w(te,G,n,ne,O),0==z&&-1===[9,521,1033,2057].indexOf(ge))continue;switch(te){case 34:t.opts.Date1904=A.WBProps.date1904=L;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(O.enc||(n.l=0),O.enc=L,!r.password)throw new Error("File is password-protected");if(null==L.valid)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=L;break;case 66:var We=Number(L);switch(We){case 21010:We=1200;break;case 32768:We=1e4;break;case 32769:We=1252}un(O.codepage=We),W=!0;break;case 317:O.rrtabid=L;break;case 25:O.winlocked=L;break;case 439:t.opts.RefreshAll=L;break;case 12:t.opts.CalcCount=L;break;case 16:t.opts.CalcDelta=L;break;case 17:t.opts.CalcIter=L;break;case 13:t.opts.CalcMode=L;break;case 14:t.opts.CalcPrecision=L;break;case 95:t.opts.CalcSaveRecalc=L;break;case 15:O.CalcRefMode=L;break;case 2211:t.opts.FullCalc=L;break;case 129:L.fDialog&&(i["!type"]="dialog"),L.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),L.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:y.push(L);break;case 430:_e.push([L]),_e[_e.length-1].XTI=[];break;case 35:case 547:_e[_e.length-1].push(L);break;case 24:case 536:E={Name:L.Name,Ref:Kt(L.rgce,0,null,_e,O)},L.itab>0&&(E.Sheet=L.itab-1),_e.names.push(E),_e[0]||(_e[0]=[],_e[0].XTI=[]),_e[_e.length-1].push(L),"_xlnm._FilterDatabase"==L.Name&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&"PtgArea3d"==L.rgce[0][0][0]&&(Z[L.itab-1]={ref:ke(L.rgce[0][0][1][2])});break;case 22:O.ExternCount=L;break;case 23:0==_e.length&&(_e[0]=[],_e[0].XTI=[]),_e[_e.length-1].XTI=_e[_e.length-1].XTI.concat(L),_e.XTI=_e.XTI.concat(L);break;case 2196:if(O.biff<8)break;null!=E&&(E.Comment=L[1]);break;case 18:i["!protect"]=L;break;case 19:0!==L&&O.WTF&&console.error("Password verifier: "+L);break;case 133:a[L.pos]=L,O.snames.push(L.name);break;case 10:if(--z)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=ke(s),r.sheetRows&&r.sheetRows<=s.e.r){var Ue=s.e.r;s.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ke(s),s.e.r=Ue}s.e.r++,s.e.c++}pe.length>0&&(i["!merges"]=pe),ie.length>0&&(i["!objects"]=ie),ve.length>0&&(i["!cols"]=ve),me.length>0&&(i["!rows"]=me),A.Sheets.push(U)}""===d?_=i:o[d]=i,i=r.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===O.biff&&(O.biff={9:2,521:3,1033:4}[te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),O.biffguess=0==L.BIFFVer,0==L.BIFFVer&&4096==L.dt&&(O.biff=5,W=!0,un(O.codepage=28591)),8==O.biff&&0==L.BIFFVer&&16==L.dt&&(O.biff=2),z++)break;if(i=r.dense?[]:{},O.biff<8&&!W&&(W=!0,un(O.codepage=r.codepage||1252)),O.biff<5||0==L.BIFFVer&&4096==L.dt){""===d&&(d="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ze={pos:n.l-ne,name:d};a[ze.pos]=ze,O.snames.push(d)}else d=(a[le]||{name:""}).name;32==L.dt&&(i["!type"]="chart"),64==L.dt&&(i["!type"]="macro"),pe=[],ie=[],O.arrayf=x=[],ve=[],me=[],Pe=!1,U={Hidden:(a[le]||{hs:0}).hs,name:d};break;case 515:case 3:case 2:"chart"==i["!type"]&&(r.dense?(i[L.r]||[])[L.c]:i[ye({c:L.c,r:L.r})])&&++L.c,C={ixfe:L.ixfe,XF:y[L.ixfe]||{},v:L.val,t:"n"},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r);break;case 5:case 517:C={ixfe:L.ixfe,XF:y[L.ixfe],v:L.val,t:L.t},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r);break;case 638:C={ixfe:L.ixfe,XF:y[L.ixfe],v:L.rknum,t:"n"},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r);break;case 189:for(var Be=L.c;Be<=L.C;++Be){var ue=L.rkrec[Be-L.c][0];C={ixfe:ue,XF:y[ue],v:L.rkrec[Be-L.c][1],t:"n"},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:Be,r:L.r},C,r)}break;case 6:case 518:case 1030:if("String"==L.val){l=L;break}if((C=Zr(L.val,L.cell.ixfe,L.tt)).XF=y[C.ixfe],r.cellFormula){var mt=L.formula;if(mt&&mt[0]&&mt[0][0]&&"PtgExp"==mt[0][0][0]){var bn=mt[0][0][1][0],qn=mt[0][0][1][1],Xn=ye({r:bn,c:qn});v[Xn]?C.f=""+Kt(L.formula,0,L.cell,_e,O):C.F=((r.dense?(i[bn]||[])[qn]:i[Xn])||{}).F}else C.f=""+Kt(L.formula,0,L.cell,_e,O)}I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J(L.cell,C,r),l=L;break;case 7:case 519:if(!l)throw new Error("String record expects Formula");l.val=L,(C=Zr(L,l.cell.ixfe,"s")).XF=y[C.ixfe],r.cellFormula&&(C.f=""+Kt(l.formula,0,l.cell,_e,O)),I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J(l.cell,C,r),l=null;break;case 33:case 545:x.push(L);var Xo=ye(L[0].s);if(m=r.dense?(i[L[0].s.r]||[])[L[0].s.c]:i[Xo],r.cellFormula&&m){if(!l||!Xo||!m)break;m.f=""+Kt(L[1],0,L[0],_e,O),m.F=ke(L[0])}break;case 1212:if(!r.cellFormula)break;if(f){if(!l)break;v[ye(l.cell)]=L[0],((m=r.dense?(i[l.cell.r]||[])[l.cell.c]:i[ye(l.cell)])||{}).f=""+Kt(L[0],0,u,_e,O)}break;case 253:C=Zr(c[L.isst].t,L.ixfe,"s"),c[L.isst].h&&(C.h=c[L.isst].h),C.XF=y[C.ixfe],I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r);break;case 513:r.sheetStubs&&(C={ixfe:L.ixfe,XF:y[L.ixfe],t:"z"},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r));break;case 190:if(r.sheetStubs)for(var fi=L.c;fi<=L.C;++fi){var _n=L.ixfe[fi-L.c];C={ixfe:_n,XF:y[_n],t:"z"},I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:fi,r:L.r},C,r)}break;case 214:case 516:case 4:(C=Zr(L.val,L.ixfe,"s")).XF=y[C.ixfe],I>0&&(C.z=Q[C.ixfe>>8&63]),Bn(C,r,t.opts.Date1904),J({c:L.c,r:L.r},C,r);break;case 0:case 512:1===z&&(s=L);break;case 252:c=L;break;case 1054:if(4==O.biff){Q[I++]=L[1];for(var jn=0;jn<I+163&&we[jn]!=L[1];++jn);jn>=163&&En(L[1],I+163)}else En(L[1],L[0]);break;case 30:Q[I++]=L;for(var mi=0;mi<I+163&&we[mi]!=L;++mi);mi>=163&&En(L,I+163);break;case 229:pe=pe.concat(L);break;case 93:ie[L.cmo[0]]=O.lastobj=L;break;case 438:O.lastobj.TxO=L;break;case 127:O.lastobj.ImData=L;break;case 440:for(g=L[0].s.r;g<=L[0].e.r;++g)for(p=L[0].s.c;p<=L[0].e.c;++p)(m=r.dense?(i[g]||[])[p]:i[ye({c:p,r:g})])&&(m.l=L[1]);break;case 2048:for(g=L[0].s.r;g<=L[0].e.r;++g)for(p=L[0].s.c;p<=L[0].e.c;++p)(m=r.dense?(i[g]||[])[p]:i[ye({c:p,r:g})])&&m.l&&(m.l.Tooltip=L[1]);break;case 28:if(O.biff<=5&&O.biff>=2)break;m=r.dense?(i[L[0].r]||[])[L[0].c]:i[ye(L[0])];var jo=ie[L[2]];m||(r.dense?(i[L[0].r]||(i[L[0].r]=[]),m=i[L[0].r][L[0].c]={t:"z"}):m=i[ye(L[0])]={t:"z"},s.e.r=Math.max(s.e.r,L[0].r),s.s.r=Math.min(s.s.r,L[0].r),s.e.c=Math.max(s.e.c,L[0].c),s.s.c=Math.min(s.s.c,L[0].c)),m.c||(m.c=[]),m.c.push({a:L[1],t:jo.TxO.t});break;case 2173:ZC(0,L.ext);break;case 125:if(!O.cellStyles)break;for(;L.e>=L.s;)ve[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(1&L.flags)},Pe||(Pe=!0,qa(L.w/256)),Ii(ve[L.e+1]);break;case 520:var jt={};null!=L.level&&(me[L.r]=jt,jt.level=L.level),L.hidden&&(me[L.r]=jt,jt.hidden=!0),L.hpt&&(me[L.r]=jt,jt.hpt=L.hpt,jt.hpx=to(L.hpt));break;case 38:case 39:case 40:case 41:i["!margins"]||Ei(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[te]]=L;break;case 161:i["!margins"]||Ei(i["!margins"]={}),i["!margins"].header=L.header,i["!margins"].footer=L.footer;break;case 574:L.RTL&&(A.Views[0].RTL=!0);break;case 146:M=L;break;case 2198:ee=L;break;case 140:b=L;break;case 442:d?U.CodeName=L||U.name:A.WBProps.CodeName=L||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+te.toString(16)),n.l+=ne}return t.SheetNames=dt(a).sort(function(Rn,Oe){return Number(Rn)-Number(Oe)}).map(function(Rn){return a[Rn].name}),r.bookSheets||(t.Sheets=o),!t.SheetNames.length&&_["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=_)):t.Preamble=_,t.Sheets&&Z.forEach(function(Rn,Oe){t.Sheets[t.SheetNames[Oe]]["!autofilter"]=Rn}),t.Strings=c,t.SSF=je(we),O.enc&&(t.Encryption=O.enc),ee&&(t.Themes=ee),t.Metadata={},void 0!==b&&(t.Metadata.Country=b),_e.names.length>0&&(A.Names=_e.names),t.Workbook=A,t}(o.content,r);else if((a=Te.find(n,"PerfectOffice_MAIN"))&&a.content)i=Li.to_workbook(a.content,(r.type=s,r));else{if(!(a=Te.find(n,"NativeContent_MAIN"))||!a.content)throw(a=Te.find(n,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=Li.to_workbook(a.content,(r.type=s,r))}r.bookVBA&&n.FullPaths&&Te.find(n,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function cT(n){var r=Te.utils.cfb_new({root:"R"});return n.FullPaths.forEach(function(t,o){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Te.utils.cfb_add(r,i,n.FileIndex[o].content)}}),Te.write(r)}(n))}var l={};return n.FullPaths&&function Ww(n,r,t){var o=Te.find(n,"/!DocumentSummaryInformation");if(o&&o.size>0)try{var i=dc(o,ya,"02d5cdd59c2e1b10939708002b2cf9ae");for(var a in i)r[a]=i[a]}catch(d){if(t.WTF)throw d}var s=Te.find(n,"/!SummaryInformation");if(s&&s.size>0)try{var l=dc(s,Da,"e0859ff2f94f6810ab9108002b27b3d9");for(var c in l)null==r[c]&&(r[c]=l[c])}catch(d){if(t.WTF)throw d}r.HeadingPairs&&r.TitlesOfParts&&(Xl(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}(n,l,r),i.Props=i.Custprops=l,r.bookFiles&&(i.cfb=n),i}var Ho={0:{f:function Cb(n,r){var t={},o=n.l+r;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=o,7&a&&(t.level=7&a),16&a&&(t.hidden=!0),32&a&&(t.hpt=i/20),t}},1:{f:function Db(n){return[hn(n)]}},2:{f:function $b(n){return[hn(n),Na(n),"n"]}},3:{f:function Pb(n){return[hn(n),n.read_shift(1),"e"]}},4:{f:function Lb(n){return[hn(n),n.read_shift(1),"b"]}},5:{f:function Hb(n){return[hn(n),Yt(n),"n"]}},6:{f:function Xb(n){return[hn(n),Ht(n),"str"]}},7:{f:function Jb(n){return[hn(n),n.read_shift(4),"s"]}},8:{f:function r6(n,r,t){var o=n.l+r,i=hn(n);i.r=t["!row"];var s=[i,Ht(n),"str"];if(t.cellFormula){n.l+=2;var l=Ir(n,o-n.l,t);s[3]=Kt(l,0,i,t.supbooks,t)}else n.l=o;return s}},9:{f:function o6(n,r,t){var o=n.l+r,i=hn(n);i.r=t["!row"];var s=[i,Yt(n),"n"];if(t.cellFormula){n.l+=2;var l=Ir(n,o-n.l,t);s[3]=Kt(l,0,i,t.supbooks,t)}else n.l=o;return s}},10:{f:function n6(n,r,t){var o=n.l+r,i=hn(n);i.r=t["!row"];var s=[i,n.read_shift(1),"b"];if(t.cellFormula){n.l+=2;var l=Ir(n,o-n.l,t);s[3]=Kt(l,0,i,t.supbooks,t)}else n.l=o;return s}},11:{f:function i6(n,r,t){var o=n.l+r,i=hn(n);i.r=t["!row"];var s=[i,n.read_shift(1),"e"];if(t.cellFormula){n.l+=2;var l=Ir(n,o-n.l,t);s[3]=Kt(l,0,i,t.supbooks,t)}else n.l=o;return s}},12:{f:function Fb(n){return[wi(n)]}},13:{f:function Wb(n){return[wi(n),Na(n),"n"]}},14:{f:function Ub(n){return[wi(n),n.read_shift(1),"e"]}},15:{f:function Eb(n){return[wi(n),n.read_shift(1),"b"]}},16:{f:fd},17:{f:function e6(n){return[wi(n),Ht(n),"str"]}},18:{f:function Rb(n){return[wi(n),n.read_shift(4),"s"]}},19:{f:Ca},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function tw(n,r,t){var o=n.l+r;n.l+=4,n.l+=1;var i=n.read_shift(4),a=Mg(n),s=B3(n,0,t),l=Ta(n);n.l=o;var c={Name:a,Ptg:s};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}},40:{},42:{},43:{f:function jv(n,r,t){var o={};o.sz=n.read_shift(2)/20;var i=function Ig(n){var r=n.read_shift(1);return n.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(n);switch(i.fItalic&&(o.italic=1),i.fCondense&&(o.condense=1),i.fExtend&&(o.extend=1),i.fShadow&&(o.shadow=1),i.fOutline&&(o.outline=1),i.fStrikeout&&(o.strike=1),700===n.read_shift(2)&&(o.bold=1),n.read_shift(2)){case 1:o.vertAlign="superscript";break;case 2:o.vertAlign="subscript"}var s=n.read_shift(1);0!=s&&(o.underline=s);var l=n.read_shift(1);l>0&&(o.family=l);var c=n.read_shift(1);switch(c>0&&(o.charset=c),n.l++,o.color=function Lg(n){var r={},o=n.read_shift(1)>>>1,i=n.read_shift(1),a=n.read_shift(2,"i"),s=n.read_shift(1),l=n.read_shift(1),c=n.read_shift(1);switch(n.l++,o){case 0:r.auto=1;break;case 1:r.index=i;var d=yi[i];d&&(r.rgb=Lo(d));break;case 2:r.rgb=Lo([s,l,c]);break;case 3:r.theme=i}return 0!=a&&(r.tint=a>0?a/32767:a/32768),r}(n),n.read_shift(1)){case 1:o.scheme="major";break;case 2:o.scheme="minor"}return o.name=Ht(n),o}},44:{f:function Gv(n,r){return[n.read_shift(2),Ht(n)]}},45:{f:nC},46:{f:oC},47:{f:function iC(n,r){var t=n.l+r,o=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:o,numFmtId:i}}},48:{},49:{f:function Ng(n){return n.read_shift(4,"i")}},50:{},51:{f:function UC(n){for(var r=[],t=n.read_shift(4);t-- >0;)r.push([n.read_shift(4),n.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Mc},62:{f:function Gb(n){return[hn(n),Ca(n),"is"]}},63:{f:function $C(n){var r={};r.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),r.r=ye(t);var o=n.read_shift(1);return 2&o&&(r.l="1"),8&o&&(r.a="1"),r}},64:{f:function T6(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function g6(n){var r=n.read_shift(2);return n.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function Ab(n,r){var t={},o=n[n.l];return++n.l,t.above=!(64&o),t.left=!(128&o),n.l+=18,t.name=Fg(n,r-19),t}},148:{f:wb,p:16},151:{f:function _6(){}},152:{},153:{f:function X6(n,r){var t={},o=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=r>8?Ht(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(65536&o),t.backupFile=!!(64&o),t.checkCompatibility=!!(4096&o),t.date1904=!!(1&o),t.filterPrivacy=!!(8&o),t.hidePivotFieldList=!!(1024&o),t.promptedSolutions=!!(16&o),t.publishItems=!!(2048&o),t.refreshAllConnections=!!(262144&o),t.saveExternalLinkValues=!!(128&o),t.showBorderUnselectedTables=!!(4&o),t.showInkAnnotation=!!(32&o),t.showObjects=["all","placeholders","none"][o>>13&3],t.showPivotChartFilter=!!(32768&o),t.updateLinks=["userSet","never","always"][o>>8&3],t}},154:{},155:{},156:{f:function z6(n,r){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=wa(n,r-8),t.name=Ht(n),t}},157:{},158:{},159:{T:1,f:function fv(n){return[n.read_shift(4),n.read_shift(4)]}},160:{T:-1},161:{T:1,f:Ni},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:a6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function PC(n,r){return{flags:n.read_shift(4),version:n.read_shift(4),name:Ht(n)}}},336:{T:-1},337:{f:function qC(n){return n.l+=4,0!=n.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:wa},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function p6(n,r,t){var o=n.l+r,i=ql(n),a=n.read_shift(1),s=[i];if(s[2]=a,t.cellFormula){var l=U3(n,o-n.l,t);s[1]=l}else n.l=o;return s}},427:{f:function u6(n,r,t){var o=n.l+r,a=[Ni(n,16)];if(t.cellFormula){var s=J3(n,o-n.l,t);a[1]=s,n.l=o}else n.l=o;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function m6(n){var r={};return md.forEach(function(t){r[t]=Yt(n)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function Nb(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function c6(n,r){var t=n.l+r,o=Ni(n,16),i=Ta(n),a=Ht(n),s=Ht(n),l=Ht(n);n.l=t;var c={rfx:o,relId:i,loc:a,display:l};return s&&(c.Tooltip=s),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:wa},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:oT},633:{T:1},634:{T:-1},635:{T:1,f:function nT(n){var r={};r.iauthor=n.read_shift(4);var t=Ni(n,16);return r.rfx=t.s,r.ref=ye(t.s),n.l+=16,r}},636:{T:-1},637:{f:Dg},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function B6(n,r){return n.l+=10,{name:Ht(n)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function b6(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},es={6:{f:$a},10:{f:di},12:{f:wt},13:{f:wt},14:{f:ft},15:{f:ft},16:{f:Yt},17:{f:ft},18:{f:ft},19:{f:wt},20:{f:Ac},21:{f:Ac},23:{f:kc},24:{f:Dc},25:{f:ft},26:{},27:{},28:{f:function w2(n,r,t){return function b2(n,r,t){if(!(t.biff<8)){var o=n.read_shift(2),i=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2),l=Fi(n,0,t);return t.biff<8&&n.read_shift(1),[{r:o,c:i},l,s,a]}}(n,0,t)}},29:{},34:{f:ft},35:{f:yc},38:{f:Yt},39:{f:Yt},40:{f:Yt},41:{f:Yt},42:{f:ft},43:{f:ft},47:{f:function Zv(n,r,t){var o={Type:t.biff>=8?n.read_shift(2):0};return o.Type?function Ev(n,r,t){var o=t||{};return o.Info=n.read_shift(2),n.l-=2,o.Data=1===o.Info?function Fv(n){var r={},t=r.EncryptionVersionInfo=Gn(n,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=n.read_shift(16),r.EncryptedVerifier=n.read_shift(16),r.EncryptedVerifierHash=n.read_shift(16),r}(n):function kv(n,r){var t={},o=t.EncryptionVersionInfo=Gn(n,4);if(r-=4,2!=o.Minor)throw new Error("unrecognized minor version code: "+o.Minor);if(o.Major>4||o.Major<2)throw new Error("unrecognized major version code: "+o.Major);t.Flags=n.read_shift(4),r-=4;var i=n.read_shift(4);return r-=4,t.EncryptionHeader=Oc(n,i),t.EncryptionVerifier=Uc(n,r-=i),t}(n,r),o}(n,r-2,o):function Iv(n,r,t,o){var i={key:wt(n),verificationBytes:wt(n)};t.password&&(i.verifier=function Ba(n){var t,a,r=0,o=Pc(n),i=o.length+1;for((t=ii(i))[0]=o.length,a=1;a!=i;++a)t[a]=o[a-1];for(a=i-1;a>=0;--a)r=((0==(16384&r)?0:1)|r<<1&32767)^t[a];return 52811^r}(t.password)),o.valid=i.verificationBytes===i.verifier,o.valid&&(o.insitu=function(n){var r=0,t=Bc(n);return function(o){var i=function(n,r,t,o,i){var a,s;for(i||(i=r),o||(o=Bc("")),a=0;a!=r.length;++a)s=r[a],i[a]=s=255&((s^=o[t])>>5|s<<3),++t;return[i,t,o]}(0,o,r,t);return r=i[1],i[0]}}(t.password))}(n,0,t,o),o}},49:{f:function zx(n,r,t){var o={dyHeight:n.read_shift(2),fl:n.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:n.l+=2;break;default:n.l+=10}return o.name=Fo(n,0,t),o}},51:{f:wt},60:{},61:{f:function Yx(n){return{Pos:[n.read_shift(2),n.read_shift(2)],Dim:[n.read_shift(2),n.read_shift(2)],Flags:n.read_shift(2),CurTab:n.read_shift(2),FirstTab:n.read_shift(2),Selected:n.read_shift(2),TabRatio:n.read_shift(2)}}},64:{f:ft},65:{f:function Wx(){}},66:{f:wt},77:{},80:{},81:{},82:{},85:{f:wt},89:{},90:{},91:{},92:{f:function Ex(n,r,t){if(t.enc)return n.l+=r,"";var o=n.l,i=Fi(n,0,t);return n.read_shift(r+o-n.l),i}},93:{f:function A2(n,r,t){if(t&&t.biff<8)return function D2(n,r,t){n.l+=4;var o=n.read_shift(2),i=n.read_shift(2),a=n.read_shift(2);n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=6;var s=[];return s.push((y2[o]||Qt)(n,r-=36,t)),{cmo:[i,o,a],ft:s}}(n,r,t);var o=Tc(n),i=function Lx(n,r){for(var t=n.l+r,o=[];n.l<t;){var i=n.read_shift(2);n.l-=2;try{o.push(Mx[i](n,t-n.l))}catch(a){return n.l=t,o}}return n.l!=t&&(n.l=t),o}(n,r-22);return{cmo:o,ft:i}}},94:{},95:{f:ft},96:{},97:{},99:{f:ft},125:{f:Mc},128:{f:function _2(n){n.l+=4;var r=[n.read_shift(2),n.read_shift(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function Px(n,r,t){var o=t&&8==t.biff||2==r?n.read_shift(2):(n.l+=r,0);return{fDialog:16&o,fBelow:64&o,fRight:128&o}}},130:{f:wt},131:{f:ft},132:{f:ft},133:{f:function Ox(n,r,t){var o=n.read_shift(4),i=3&n.read_shift(1),a=n.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule"}var s=Fo(n,0,t);return 0===s.length&&(s="Sheet1"),{pos:o,hs:i,dt:a,name:s}}},134:{},140:{f:function E2(n){var t,r=[0,0];return t=n.read_shift(2),r[0]=Yl[t]||t,t=n.read_shift(2),r[1]=Yl[t]||t,r}},141:{f:wt},144:{},146:{f:function O2(n){for(var r=n.read_shift(2),t=[];r-- >0;)t.push(gc(n));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:wt},157:{},158:{},160:{f:H2},161:{f:function J2(n,r){var t={};return r<32||(n.l+=16,t.header=Yt(n),t.footer=Yt(n),n.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function s2(n,r){for(var t=n.l+r-2,o=n.read_shift(2),i=n.read_shift(2),a=[];n.l<t;)a.push(xc(n));if(n.l!==t)throw new Error("MulRK read error");var s=n.read_shift(2);if(a.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:o,c:i,C:s,rkrec:a}}},190:{f:function l2(n,r){for(var t=n.l+r-2,o=n.read_shift(2),i=n.read_shift(2),a=[];n.l<t;)a.push(n.read_shift(2));if(n.l!==t)throw new Error("MulBlank read error");var s=n.read_shift(2);if(a.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:o,c:i,C:s,ixfe:a}}},193:{f:di},197:{},198:{},199:{},200:{},201:{},202:{f:ft},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:wt},220:{},221:{f:ft},222:{},224:{f:function d2(n,r,t){var o={};return o.ifnt=n.read_shift(2),o.numFmtId=n.read_shift(2),o.flags=n.read_shift(2),o.fStyle=o.flags>>2&1,o.data=function c2(n,r,t,o){var i={},a=n.read_shift(4),s=n.read_shift(4),l=n.read_shift(4),c=n.read_shift(2);return i.patternType=Rg[l>>26],o.cellStyles&&(i.alc=7&a,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=15&s,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=127&l,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=127&c,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}(n,0,0,t),o}},225:{f:function Ix(n,r){return 0===r||n.read_shift(2),1200}},226:{f:di},227:{},229:{f:function S2(n,r){for(var t=[],o=n.read_shift(2);o--;)t.push(Ar(n));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function Bx(n,r){for(var t=n.l+r,o=n.read_shift(4),i=n.read_shift(4),a=[],s=0;s!=i&&n.l<t;++s)a.push(hx(n));return a.Count=o,a.Unique=i,a}},253:{f:function Xx(n){var r=Un(n);return r.isst=n.read_shift(4),r}},255:{f:function qx(n,r){var t={};return t.dsst=n.read_shift(2),n.l+=r-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ft},353:{f:di},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function h2(n,r,t){var o=n.l+r,i=n.read_shift(2),a=n.read_shift(2);if(t.sbcch=a,1025==a||14849==a)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var s=ki(n,a),l=[];o>n.l;)l.push(Mo(n));return[a,i,s,l]}},431:{f:ft},432:{},433:{},434:{},437:{},438:{f:function k2(n,r,t){var o=n.l,i="";try{n.l+=4,-1==[0,5,7,11,12,14].indexOf((t.lastobj||{cmo:[0,0]}).cmo[1])?n.l+=6:function xx(n){var r=n.read_shift(1);n.l++;var t=n.read_shift(2);n.l+=2}(n);var l=n.read_shift(2);n.read_shift(2),wt(n);var c=n.read_shift(2);n.l+=c;for(var d=1;d<n.lens.length-1;++d){if(n.l-o!=n.lens[d])throw new Error("TxO: bad continue record");var _=n[n.l];if((i+=ki(n,n.lens[d+1]-n.lens[d]-1)).length>=(_?l:2*l))break}if(i.length!==l&&i.length!==2*l)throw new Error("cchText: "+l+" != "+i.length);return n.l=o+r,{t:i}}catch(f){return n.l=o+r,{t:i}}}},439:{f:ft},440:{f:function F2(n,r){var t=Ar(n);n.l+=16;var o=function bx(n,r){var t=n.l+r,o=n.read_shift(4);if(2!==o)throw new Error("Unrecognized streamVersion: "+o);var i=n.read_shift(2);n.l+=2;var a,s,l,c,_,u,d="";16&i&&(a=Nr(n)),128&i&&(s=Nr(n)),257==(257&i)&&(l=Nr(n)),1==(257&i)&&(c=function Tx(n,r){var t=n.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function vx(n){var r=n.read_shift(4),t=n.l,o=!1;r>24&&(n.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===n.read_shift(16)&&(o=!0),n.l=t);var i=n.read_shift((o?r-24:r)>>1,"utf16le").replace(qt,"");return o&&(n.l+=24),i}(n);case"0303000000000000c000000000000046":return function Cx(n){for(var r=n.read_shift(2),t="";r-- >0;)t+="../";var o=n.read_shift(0,"lpstr-ansi");if(n.l+=2,57005!=n.read_shift(2))throw new Error("Bad FileMoniker");if(0===n.read_shift(4))return t+o.replace(/\\/g,"/");var a=n.read_shift(4);if(3!=n.read_shift(2))throw new Error("Bad FileMoniker");return t+n.read_shift(a>>1,"utf16le").replace(qt,"")}(n);default:throw new Error("Unsupported Moniker "+t)}}(n)),8&i&&(d=Nr(n)),32&i&&(_=n.read_shift(16)),64&i&&(u=Ea(n)),n.l=t;var f=s||l||c||"";f&&d&&(f+="#"+d),f||(f="#"+d),2&i&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var m={Target:f};return _&&(m.guid=_),u&&(m.time=u),a&&(m.Tooltip=a),m}(n,r-24);return[t,o]}},441:{},442:{f:Mo},443:{},444:{f:wt},445:{},446:{},448:{f:di},449:{f:function Hx(n){return n.read_shift(2),n.read_shift(4)},r:2},450:{f:di},512:{f:wc},513:{f:Q2},515:{f:function f2(n,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var o=Un(n),i=Yt(n);return o.val=i,o}},516:{f:function e2(n,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var i=Un(n);2==t.biff&&n.l++;var a=Mo(n,0,t);return i.val=a,i}},517:{f:Nc},519:{f:Y2},520:{f:function Rx(n){var r={};r.r=n.read_shift(2),r.c=n.read_shift(2),r.cnt=n.read_shift(2)-r.c;var t=n.read_shift(2);n.l+=4;var o=n.read_shift(1);return n.l+=3,7&o&&(r.level=7&o),32&o&&(r.hidden=!0),64&o&&(r.hpt=t/20),r}},523:{},545:{f:Fc},549:{f:bc},566:{},574:{f:function $x(n,r,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&n.read_shift(2)}}},638:{f:function a2(n){var r=n.read_shift(2),t=n.read_shift(2),o=xc(n);return{r,c:t,ixfe:o[0],rknum:o[1]}}},659:{},1048:{},1054:{f:function n2(n,r,t){return[n.read_shift(2),Fi(n,0,t)]}},1084:{},1212:{f:function C2(n,r,t){var o=Cc(n);n.l++;var i=n.read_shift(1);return[E3(n,r-=8,t),i,o]}},2048:{f:function L2(n,r){n.read_shift(2);var t=Ar(n),o=n.read_shift((r-10)/2,"dbcs-cont");return[t,o=o.replace(qt,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yr},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:di},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function U2(n){n.l+=2;var r={cxfs:0,crc:0};return r.cxfs=n.read_shift(2),r.crc=n.read_shift(4),r},r:12},2173:{f:function EC(n,r){n.l+=2;var o=n.read_shift(2);n.l+=2;for(var i=n.read_shift(2),a=[];i-- >0;)a.push(IC(n));return{ixfe:o,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ft,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function v2(n,r,t){if(!(t.biff<8)){var o=n.read_shift(2),i=n.read_shift(2);return[ki(n,o,t),ki(n,i,t)]}n.l+=r},r:12},2197:{},2198:{f:function DC(n,r,t){var o=n.l+r;if(124226!==n.read_shift(4)){if(!t.cellStyles)return void(n.l=o);var s,a=n.slice(n.l);n.l=o;try{s=dl(a,{type:"array"})}catch(c){return}var l=ln(s,"theme/theme/theme1.xml",!0);if(l)return Vc(l,t)}},r:12},2199:{},2200:{},2201:{},2202:{f:function T2(n){return[0!==n.read_shift(4),0!==n.read_shift(4),n.read_shift(4)]},r:12},2203:{f:di},2204:{},2205:{},2206:{},2207:{},2211:{f:function Qx(n){var r=function Sx(n){var r=n.read_shift(2),t=n.read_shift(2);return n.l+=8,{type:r,flags:t}}(n);if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==n.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:wt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function q2(n,r,t){var o={area:!1};if(5!=t.biff)return n.l+=r,o;var i=n.read_shift(1);return n.l+=3,16&i&&(o.area=!0),o}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function P2(n){for(var r=n.read_shift(2),t=[];r-- >0;)t.push(gc(n));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:wc},1:{},2:{f:function z2(n){var r=Un(n);++n.l;var t=n.read_shift(2);return r.t="n",r.val=t,r}},3:{f:function K2(n){var r=Un(n);++n.l;var t=Yt(n);return r.t="n",r.val=t,r}},4:{f:function $2(n,r,t){t.biffguess&&5==t.biff&&(t.biff=2);var o=Un(n);++n.l;var i=Fi(n,0,t);return o.t="str",o.val=i,o}},5:{f:Nc},7:{f:function X2(n){var r=n.read_shift(1);return 0===r?(n.l++,""):n.read_shift(r,"sbcs-cont")}},8:{},9:{f:yr},11:{},22:{f:wt},30:{f:o2},31:{},32:{},33:{f:Fc},36:{},37:{f:bc},50:{f:function j2(n,r){n.l+=6,n.l+=2,n.l+=1,n.l+=3,n.l+=1,n.l+=r-13}},62:{},52:{},67:{},68:{f:wt},69:{},86:{},126:{},127:{f:function V2(n){var r=n.read_shift(2),t=n.read_shift(2),o=n.read_shift(4),i={fmt:r,env:t,len:o,data:n.slice(n.l,n.l+o)};return n.l+=o,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function ev(n,r,t){var o=n.l+r,i=Un(n),a=n.read_shift(2),s=ki(n,a,t);return n.l=o,i.t="str",i.val=s,i}},223:{},234:{},354:{},421:{},518:{f:$a},521:{f:yr},536:{f:Dc},547:{f:yc},561:{},579:{},1030:{f:$a},1033:{f:yr},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function re(n,r,t,o){var i=r;if(!isNaN(i)){var a=o||(t||[]).length||0,s=n.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&ha(t)&&n.push(t)}}function yd(n,r){var t=r||{},o=t.dense?[]:{},i=(n=n.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=n.match(/<\/table/i),s=i.index,l=a&&a.index||n.length,c=j1(n.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,_=0,u=0,f=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},h=[];for(s=0;s<c.length;++s){var p=c[s].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=p.split(/<\/t[dh]>/i);for(l=0;l<v.length;++l){var x=v[l].trim();if(x.match(/<t[dh]/i)){for(var C=x,b=0;"<"==C.charAt(0)&&(b=C.indexOf(">"))>-1;)C=C.slice(b+1);for(var y=0;y<h.length;++y){var M=h[y];M.s.c==_&&M.s.r<d&&d<=M.e.r&&(_=M.e.c+1,y=-1)}var A=Ae(x.slice(0,x.indexOf(">")));f=A.colspan?+A.colspan:1,((u=+A.rowspan)>1||f>1)&&h.push({s:{r:d,c:_},e:{r:d+(u||1)-1,c:_+f-1}});var U=A.t||A["data-t"]||"";if(!C.length){_+=f;continue}if(C=xl(C),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>_&&(m.s.c=_),m.e.c<_&&(m.e.c=_),!C.length){_+=f;continue}var P={t:"s",v:C};t.raw||!C.trim().length||"s"==U||("TRUE"===C?P={t:"b",v:!0}:"FALSE"===C?P={t:"b",v:!1}:isNaN(yn(C))?isNaN(Wi(C).getDate())||(P={t:"d",v:at(C)},t.cellDates||(P={t:"n",v:At(P.v)}),P.z=t.dateNF||we[14]):P={t:"n",v:yn(C)}),t.dense?(o[d]||(o[d]=[]),o[d][_]=P):o[ye({r:d,c:_})]=P,_+=f}}}}else{if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}_=0}}return o["!ref"]=ke(m),h.length&&(o["!merges"]=h),o}function Dd(n,r,t,o){for(var i=n["!merges"]||[],a=[],s=r.s.c;s<=r.e.c;++s){for(var l=0,c=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>s||i[d].e.r<t||i[d].e.c<s)){if(i[d].s.r<t||i[d].s.c<s){l=-1;break}l=i[d].e.r-i[d].s.r+1,c=i[d].e.c-i[d].s.c+1;break}if(!(l<0)){var _=ye({r:t,c:s}),u=o.dense?(n[t]||[])[s]:n[_],f=u&&null!=u.v&&(u.h||sa(u.w||(On(u),u.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),o.editable?f='<span contenteditable="true">'+f+"</span>":u&&(m["data-t"]=u&&u.t||"z",null!=u.v&&(m["data-v"]=u.v),null!=u.z&&(m["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(f='<a href="'+u.l.Target+'">'+f+"</a>")),m.id=(o.id||"sjs")+"-"+_,a.push(oe("td",f,m))}}return"<tr>"+a.join("")+"</tr>"}function Id(n,r,t){var o=t||{},i=0,a=0;if(null!=o.origin)if("number"==typeof o.origin)i=o.origin;else{var s="string"==typeof o.origin?st(o.origin):o.origin;i=s.r,a=s.c}var l=r.getElementsByTagName("tr"),c=Math.min(o.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:i,c:a}};if(n["!ref"]){var _=dn(n["!ref"]);d.s.r=Math.min(d.s.r,_.s.r),d.s.c=Math.min(d.s.c,_.s.c),d.e.r=Math.max(d.e.r,_.e.r),d.e.c=Math.max(d.e.c,_.e.c),-1==i&&(d.e.r=i=_.e.r+1)}var u=[],f=0,m=n["!rows"]||(n["!rows"]=[]),h=0,p=0,g=0,v=0,x=0,C=0;for(n["!cols"]||(n["!cols"]=[]);h<l.length&&p<c;++h){var b=l[h];if(Zd(b)){if(o.display)continue;m[p]={hidden:!0}}var y=b.children;for(g=v=0;g<y.length;++g){var M=y[g];if(!o.display||!Zd(M)){var A=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):xl(M.innerHTML),U=M.getAttribute("data-z")||M.getAttribute("z");for(f=0;f<u.length;++f){var P=u[f];P.s.c==v+a&&P.s.r<p+i&&p+i<=P.e.r&&(v=P.e.c+1-a,f=-1)}C=+M.getAttribute("colspan")||1,((x=+M.getAttribute("rowspan")||1)>1||C>1)&&u.push({s:{r:p+i,c:v+a},e:{r:p+i+(x||1)-1,c:v+a+(C||1)-1}});var B={t:"s",v:A},J=M.getAttribute("data-t")||M.getAttribute("t")||"";null!=A&&(0==A.length?B.t=J||"z":o.raw||0==A.trim().length||"s"==J||("TRUE"===A?B={t:"b",v:!0}:"FALSE"===A?B={t:"b",v:!1}:isNaN(yn(A))?isNaN(Wi(A).getDate())||(B={t:"d",v:at(A)},o.cellDates||(B={t:"n",v:At(B.v)}),B.z=o.dateNF||we[14]):B={t:"n",v:yn(A)})),void 0===B.z&&null!=U&&(B.z=U);var O="",ee=M.getElementsByTagName("A");if(ee&&ee.length)for(var pe=0;pe<ee.length&&(!ee[pe].hasAttribute("href")||"#"==(O=ee[pe].getAttribute("href")).charAt(0));++pe);O&&"#"!=O.charAt(0)&&(B.l={Target:O}),o.dense?(n[p+i]||(n[p+i]=[]),n[p+i][v+a]=B):n[ye({c:v+a,r:p+i})]=B,d.e.c<v+a&&(d.e.c=v+a),v+=C}}++p}return u.length&&(n["!merges"]=(n["!merges"]||[]).concat(u)),d.e.r=Math.max(d.e.r,p-1+i),n["!ref"]=ke(d),p>=c&&(n["!fullref"]=ke((d.e.r=l.length-h+p-1+i,d))),n}function Ed(n,r){return Id((r||{}).dense?[]:{},n,r)}function Zd(n){var r="",t=function h4(n){return n.ownerDocument.defaultView&&"function"==typeof n.ownerDocument.defaultView.getComputedStyle?n.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(n);return t&&(r=t(n).getPropertyValue("display")),r||(r=n.style&&n.style.display),"none"===r}function g4(n){var r=n.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(o,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Qe(r.replace(/<[^>]*>/g,""))]}var Pd={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Od(n,r){var a,s,_,u,p,g,t=r||{},o=da(n),i=[],l={name:""},c="",d=0,f={},m=[],h=t.dense?[]:{},v={value:""},x="",C=0,y=[],M=-1,A=-1,U={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,B={},J=[],O={},ee=0,pe=0,ie=[],ve=1,me=1,Pe=[],_e={Names:[]},ge={},z=["",""],I=[],Q={},Z="",E=0,W=!1,le=!1,te=0;for(So.lastIndex=0,o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=So.exec(o);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===p[1]?(h["!ref"]=U.e.c>=U.s.c&&U.e.r>=U.s.r?ke(U):"A1:A1",t.sheetRows>0&&t.sheetRows<=U.e.r&&(h["!fullref"]=h["!ref"],U.e.r=t.sheetRows-1,h["!ref"]=ke(U)),J.length&&(h["!merges"]=J),ie.length&&(h["!rows"]=ie),_.name=_.\u540d\u79f0||_.name,"undefined"!=typeof JSON&&JSON.stringify(_),m.push(_.name),f[_.name]=h,le=!1):"/"!==p[0].charAt(p[0].length-2)&&(_=Ae(p[0],!1),M=A=-1,U.s.r=U.s.c=1e7,U.e.r=U.e.c=0,h=t.dense?[]:{},J=[],ie=[],le=!0);break;case"table-row-group":"/"===p[1]?--P:++P;break;case"table-row":case"\u884c":if("/"===p[1]){M+=ve,ve=1;break}if((u=Ae(p[0],!1)).\u884c\u53f7?M=u.\u884c\u53f7-1:-1==M&&(M=0),(ve=+u["number-rows-repeated"]||1)<10)for(te=0;te<ve;++te)P>0&&(ie[M+te]={level:P});A=-1;break;case"covered-table-cell":"/"!==p[1]&&++A,t.sheetStubs&&(t.dense?(h[M]||(h[M]=[]),h[M][A]={t:"z"}):h[ye({r:M,c:A})]={t:"z"}),x="",y=[];break;case"table-cell":case"\u6570\u636e":if("/"===p[0].charAt(p[0].length-2))++A,v=Ae(p[0],!1),me=parseInt(v["number-columns-repeated"]||"1",10),g={t:"z",v:null},v.formula&&0!=t.cellFormula&&(g.f=dd(Qe(v.formula))),"string"==(v.\u6570\u636e\u7c7b\u578b||v["value-type"])&&(g.t="s",g.v=Qe(v["string-value"]||""),t.dense?(h[M]||(h[M]=[]),h[M][A]=g):h[ye({r:M,c:A})]=g),A+=me-1;else if("/"!==p[1]){x="",C=0,y=[],me=1;var ne=ve?M+ve-1:M;if(++A>U.e.c&&(U.e.c=A),A<U.s.c&&(U.s.c=A),M<U.s.r&&(U.s.r=M),ne>U.e.r&&(U.e.r=ne),I=[],Q={},g={t:(v=Ae(p[0],!1)).\u6570\u636e\u7c7b\u578b||v["value-type"],v:null},t.cellFormula)if(v.formula&&(v.formula=Qe(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(ee=parseInt(v["number-matrix-rows-spanned"],10)||0,pe=parseInt(v["number-matrix-columns-spanned"],10)||0,g.F=ke(O={s:{r:M,c:A},e:{r:M+ee-1,c:A+pe-1}}),Pe.push([O,g.F])),v.formula)g.f=dd(v.formula);else for(te=0;te<Pe.length;++te)M>=Pe[te][0].s.r&&M<=Pe[te][0].e.r&&A>=Pe[te][0].s.c&&A<=Pe[te][0].e.c&&(g.F=Pe[te][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(ee=parseInt(v["number-rows-spanned"],10)||0,pe=parseInt(v["number-columns-spanned"],10)||0,J.push(O={s:{r:M,c:A},e:{r:M+ee-1,c:A+pe-1}})),v["number-columns-repeated"]&&(me=parseInt(v["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=tt(v["boolean-value"]);break;case"float":case"percentage":case"currency":g.t="n",g.v=parseFloat(v.value);break;case"date":g.t="d",g.v=at(v["date-value"]),t.cellDates||(g.t="n",g.v=At(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=z1(v["time-value"])/86400,t.cellDates&&(g.t="d",g.v=fr(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(v.\u6570\u636e\u6570\u503c);break;default:if("string"!==g.t&&"text"!==g.t&&g.t)throw new Error("Unsupported value type "+g.t);g.t="s",null!=v["string-value"]&&(x=Qe(v["string-value"]),y=[])}}else{if(W=!1,"s"===g.t&&(g.v=x||"",y.length&&(g.R=y),W=0==C),ge.Target&&(g.l=ge),I.length>0&&(g.c=I,I=[]),x&&!1!==t.cellText&&(g.w=x),W&&(g.t="z",delete g.v),(!W||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=M))for(var G=0;G<ve;++G){if(me=parseInt(v["number-columns-repeated"]||"1",10),t.dense)for(h[M+G]||(h[M+G]=[]),h[M+G][A]=0==G?g:je(g);--me>0;)h[M+G][A+me]=je(g);else for(h[ye({r:M+G,c:A})]=g;--me>0;)h[ye({r:M+G,c:A+me})]=je(g);U.e.c<=A&&(U.e.c=A)}A+=(me=parseInt(v["number-columns-repeated"]||"1",10))-1,me=0,g={},x="",y=[]}ge={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===p[1]){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else"/"!==p[0].charAt(p[0].length-2)&&i.push([p[3],!0]);break;case"annotation":if("/"===p[1]){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a;Q.t=x,y.length&&(Q.R=y),Q.a=Z,I.push(Q)}else"/"!==p[0].charAt(p[0].length-2)&&i.push([p[3],!1]);Z="",E=0,x="",C=0,y=[];break;case"creator":"/"===p[1]?Z=o.slice(E,p.index):E=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===p[1]){if((a=i.pop())[0]!==p[3])throw"Bad state: "+a}else"/"!==p[0].charAt(p[0].length-2)&&i.push([p[3],!1]);x="",C=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===p[1]){if(B[l.name]=c,(a=i.pop())[0]!==p[3])throw"Bad state: "+a}else"/"!==p[0].charAt(p[0].length-2)&&(c="",l=Ae(p[0],!1),i.push([p[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Ae(p[0],!1),c+=Pd[p[3]]["long"===s.style?1:0]}break;case"text":if("/>"===p[0].slice(-2))break;if("/"===p[1])switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=o.slice(d,p.index)}else d=p.index+p[0].length;break;case"named-range":z=Ka((s=Ae(p[0],!1))["cell-range-address"]);var Me={Name:s.name,Ref:z[0]+"!"+z[1]};le&&(Me.Sheet=m.length),_e.Names.push(Me);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if("/"!==p[1]||v&&v["string-value"])Ae(p[0],!1),C=p.index+p[0].length;else{var L=g4(o.slice(C,p.index));x=(x.length>0?x+"\n":"")+L[0]}break;case"database-range":if("/"===p[1])break;try{f[(z=Ka(Ae(p[0])["target-range-address"]))[0]]["!autofilter"]={ref:z[1]}}catch(Ue){}break;case"a":if("/"!==p[1]){if(!(ge=Ae(p[0],!1)).href)break;ge.Target=Qe(ge.href),delete ge.href,"#"==ge.Target.charAt(0)&&ge.Target.indexOf(".")>-1?(z=Ka(ge.Target.slice(1)),ge.Target="#"+z[0]+"!"+z[1]):ge.Target.match(/^\.\.[\\\/]/)&&(ge.Target=ge.Target.slice(3))}break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(t.WTF)throw new Error(p)}}var We={Sheets:f,SheetNames:m,Workbook:_e};return t.bookSheets&&delete We.Sheets,We}function Bd(n,r){return Od(n,r)}function Zi(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function ts(n){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(n):Xe(oi(n))}function ui(n){var r=n.reduce(function(i,a){return i+a.length},0),t=new Uint8Array(r),o=0;return n.forEach(function(i){t.set(i,o),o+=i.length}),t}function Rd(n){return 16843009*((n=(858993459&(n-=n>>1&1431655765))+(n>>2&858993459))+(n>>4)&252645135)>>>24}function Vo(n,r){var t=r?r[0]:0,o=127&n[t];e:if(n[t++]>=128&&(o|=(127&n[t])<<7,n[t++]<128||(o|=(127&n[t])<<14,n[t++]<128)||(o|=(127&n[t])<<21,n[t++]<128)||(o+=(127&n[t])*Math.pow(2,28),++t,n[t++]<128)||(o+=(127&n[t])*Math.pow(2,35),++t,n[t++]<128)||(o+=(127&n[t])*Math.pow(2,42),++t,n[t++]<128)))break e;return r&&(r[0]=t),o}function ut(n){var r=0,t=127&n[r];e:if(n[r++]>=128){if(t|=(127&n[r])<<7,n[r++]<128||(t|=(127&n[r])<<14,n[r++]<128)||(t|=(127&n[r])<<21,n[r++]<128))break e;t|=(127&n[r])<<28}return t}function He(n){for(var r=[],t=[0];t[0]<n.length;){var l,o=t[0],i=Vo(n,t),a=7&i,s=0;if(0==(i=Math.floor(i/8)))break;switch(a){case 0:for(var c=t[0];n[t[0]++]>=128;);l=n.slice(c,t[0]);break;case 5:l=n.slice(t[0],t[0]+(s=4)),t[0]+=s;break;case 1:l=n.slice(t[0],t[0]+(s=8)),t[0]+=s;break;case 2:s=Vo(n,t),l=n.slice(t[0],t[0]+s),t[0]+=s;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(o))}var d={data:l,type:a};null==r[i]?r[i]=[d]:r[i].push(d)}return r}function ns(n,r){return(null==n?void 0:n.map(function(t){return r(t.data)}))||[]}function w4(n,r){if(0!=n)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],o=Vo(r,t),i=[];t[0]<r.length;){var a=3&r[t[0]];if(0!=a){var c=0,d=0;if(1==a?(d=4+(r[t[0]]>>2&7),c=(224&r[t[0]++])<<3,c|=r[t[0]++]):(d=1+(r[t[0]++]>>2),2==a?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[ui(i)],0==c)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(i.push(i[0].slice(-c)),d-=c;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-c,-c+d))}else{var s=r[t[0]++]>>2;if(s<60)++s;else{var l=s-59;s=r[t[0]],l>1&&(s|=r[t[0]+1]<<8),l>2&&(s|=r[t[0]+2]<<16),l>3&&(s|=r[t[0]+3]<<24),s>>>=0,s++,t[0]+=l}i.push(r.slice(t[0],t[0]+s)),t[0]+=s}}var _=ui(i);if(_.length!=o)throw new Error("Unexpected length: ".concat(_.length," != ").concat(o));return _}function A4(n,r,t){switch(n[0]){case 0:case 1:case 2:case 3:return function S4(n,r,t,o){var u,i=Zi(n),a=i.getUint32(4,!0),s=(o>1?12:8)+4*Rd(a&(o>1?3470:398)),l=-1,c=-1,d=NaN,_=new Date(2001,0,1);switch(512&a&&(l=i.getUint32(s,!0),s+=4),s+=4*Rd(a&(o>1?12288:4096)),16&a&&(c=i.getUint32(s,!0),s+=4),32&a&&(d=i.getFloat64(s,!0),s+=8),64&a&&(_.setTime(_.getTime()+1e3*i.getFloat64(s,!0)),s+=8),n[2]){case 0:break;case 2:u={t:"n",v:d};break;case 3:u={t:"s",v:r[c]};break;case 5:u={t:"d",v:_};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(l>-1)u={t:"s",v:t[l]};else if(c>-1)u={t:"s",v:r[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(n.slice(0,4)));u={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(n.slice(0,4)))}return u}(n,r,t,n[0]);case 5:return function N4(n,r,t){var u,o=Zi(n),i=o.getUint32(8,!0),a=12,s=-1,l=-1,c=NaN,d=NaN,_=new Date(2001,0,1);switch(1&i&&(c=function T4(n,r){for(var t=(127&n[r+15])<<7|n[r+14]>>1,o=1&n[r+14],i=r+13;i>=r;--i)o=256*o+n[i];return(128&n[r+15]?-o:o)*Math.pow(10,t-6176)}(n,a),a+=16),2&i&&(d=o.getFloat64(a,!0),a+=8),4&i&&(_.setTime(_.getTime()+1e3*o.getFloat64(a,!0)),a+=8),8&i&&(l=o.getUint32(a,!0),a+=4),16&i&&(s=o.getUint32(a,!0),a+=4),n[1]){case 0:break;case 2:case 10:u={t:"n",v:c};break;case 3:u={t:"s",v:r[l]};break;case 5:u={t:"d",v:_};break;case 6:u={t:"b",v:d>0};break;case 7:u={t:"n",v:d/86400};break;case 8:u={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(31&i," : ").concat(n.slice(0,4)));u={t:"s",v:t[s]};break;default:throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(31&i," : ").concat(n.slice(0,4)))}return u}(n,r,t);default:throw new Error("Unsupported payload version ".concat(n[0]))}}function Wt(n){return Vo(He(n)[1][0].data)}function Qd(n,r){var t=He(r.data),o=ut(t[1][0].data),a=[];return(t[3]||[]).forEach(function(s){var l=He(s.data),c=ut(l[1][0].data)>>>0;switch(o){case 1:a[c]=ts(l[3][0].data);break;case 8:var _=He(n[Wt(l[9][0].data)][0].data),u=n[Wt(_[1][0].data)][0],f=ut(u.meta[1][0].data);if(2001!=f)throw new Error("2000 unexpected reference to ".concat(f));var m=He(u.data);a[c]=m[3].map(function(h){return ts(h.data)}).join("")}}),a}function F4(n,r){var o={"!ref":"A1"},i=n[Wt(He(r.data)[2][0].data)],a=ut(i[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function k4(n,r,t){var o,i=He(r.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ut(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(ut(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=ke(a);var s=He(i[4][0].data),l=Qd(n,n[Wt(s[4][0].data)][0]),c=(null==(o=s[17])?void 0:o[0])?Qd(n,n[Wt(s[17][0].data)][0]):[],d=He(s[3][0].data),_=0;d[1].forEach(function(u){var f=He(u.data),m=n[Wt(f[2][0].data)][0],h=ut(m.meta[1][0].data);if(6002!=h)throw new Error("6001 unexpected reference to ".concat(h));var p=function D4(n,r){var t,o=He(r.data),i=(null==(t=null==o?void 0:o[7])?void 0:t[0])?ut(o[7][0].data)>>>0>0?1:0:-1,a=ns(o[5],function(s){return function y4(n,r){var t,o,i,a,s,l,c,d,_,u,f,m,h,p,b,y,g=He(n),v=ut(g[1][0].data)>>>0,x=ut(g[2][0].data)>>>0,C=(null==(o=null==(t=g[8])?void 0:t[0])?void 0:o.data)&&ut(g[8][0].data)>0||!1;if((null==(a=null==(i=g[7])?void 0:i[0])?void 0:a.data)&&0!=r)b=null==(l=null==(s=g[7])?void 0:s[0])?void 0:l.data,y=null==(d=null==(c=g[6])?void 0:c[0])?void 0:d.data;else{if(!(null==(u=null==(_=g[4])?void 0:_[0])?void 0:u.data)||1==r)throw"NUMBERS Tile missing ".concat(r," cell storage");b=null==(m=null==(f=g[4])?void 0:f[0])?void 0:m.data,y=null==(p=null==(h=g[3])?void 0:h[0])?void 0:p.data}for(var M=C?4:1,A=Zi(b),U=[],P=0;P<b.length/2;++P){var B=A.getUint16(2*P,!0);B<65535&&U.push([P,B])}if(U.length!=x)throw"Expected ".concat(x," cells, found ").concat(U.length);var J=[];for(P=0;P<U.length-1;++P)J[U[P][0]]=y.subarray(U[P][1]*M,U[P+1][1]*M);return U.length>=1&&(J[U[U.length-1][0]]=y.subarray(U[U.length-1][1]*M)),{R:v,cells:J}}(s,i)});return{nrows:ut(o[4][0].data)>>>0,data:a.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,d){if(s[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));s[l.R][d]=c}),s},[])}}(0,m);p.data.forEach(function(g,v){g.forEach(function(x,C){var b=ye({r:_+v,c:C}),y=A4(x,l,c);y&&(t[b]=y)})}),_+=p.nrows})}(n,i[0],o),o}function rs(n){var r,t,o,i,a={},s=[];if(n.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),n.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d,_;try{d=function Cn(n){for(var r=[],t=0;t<n.length;){var o=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;r.push(w4(o,n.slice(t+=3,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return ui(r)}(c.content)}catch(u){return console.log("?? "+c.content.length+" "+(u.message||u))}try{_=function vn(n){for(var r,t=[],o=[0];o[0]<n.length;){var i=Vo(n,o),a=He(n.slice(o[0],o[0]+i));o[0]+=i;var s={id:ut(a[1][0].data),messages:[]};a[2].forEach(function(l){var c=He(l.data),d=ut(c[3][0].data);s.messages.push({meta:c,data:n.slice(o[0],o[0]+d)}),o[0]+=d}),(null==(r=a[3])?void 0:r[0])&&(s.merge=ut(a[3][0].data)>>>0>0),t.push(s)}return t}(d)}catch(u){return console.log("## "+(u.message||u))}_.forEach(function(u){a[u.id]=u.messages,s.push(u.id)})}}),!s.length)throw new Error("File has no messages");var l=(null==(i=null==(o=null==(t=null==(r=null==a?void 0:a[1])?void 0:r[0])?void 0:t.meta)?void 0:o[1])?void 0:i[0].data)&&1==ut(a[1][0].meta[1][0].data)&&a[1][0];if(l||s.forEach(function(c){a[c].forEach(function(d){if(1==ut(d.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=d}})}),!l)throw new Error("Cannot find Document root");return function L4(n,r){var t={SheetNames:[],Sheets:{}};if(ns(He(r.data)[1],Wt).forEach(function(a){n[a].forEach(function(s){if(2==ut(s.meta[1][0].data)){var c=function M4(n,r){var t,o=He(r.data),i={name:(null==(t=o[1])?void 0:t[0])?ts(o[1][0].data):"",sheets:[]};return ns(o[2],Wt).forEach(function(s){n[s].forEach(function(l){6e3==ut(l.meta[1][0].data)&&i.sheets.push(F4(n,l))})}),i}(n,s);c.sheets.forEach(function(d,_){fs(t,d,0==_?c.name:c.name+"_"+_,!0)})}})}),0==t.SheetNames.length)throw new Error("Empty NUMBERS file");return t}(a,l)}function as(n){!function Hd(n){return function(t){for(var o=0;o!=n.length;++o){var i=n[o];void 0===t[i[0]]&&(t[i[0]]=i[1]),"n"===i[2]&&(t[i[0]]=Number(t[i[0]]))}}}([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(n)}function Z4(n){return Fe.WS.indexOf(n)>-1?"sheet":Fe.CS&&n==Fe.CS?"chart":Fe.DS&&n==Fe.DS?"dialog":Fe.MS&&n==Fe.MS?"macro":n&&n.length?n:"sheet"}function O4(n,r,t,o,i,a,s,l,c,d,_,u){try{a[o]=ko(ln(n,t,!0),r);var m,f=Ct(n,r);switch(l){case"sheet":m=cw(f,r,i,c,a[o],d,_,u);break;case"chart":if(!(m=function dw(n,r,t,o,i,a,s,l){return".bin"===r.slice(-4)?function J6(n,r,t,o,i){if(!n)return n;o||(o={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},s=[],l=!1;return Wn(n,function(d,_,u){switch(u){case 550:a["!rel"]=d;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),d.name&&(i.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(u);break;case 38:s.pop();break;default:if(_.T>0)s.push(u);else if(_.T<0)s.pop();else if(!l||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}},r),o["!id"][a["!rel"]]&&(a["!drawel"]=o["!id"][a["!rel"]]),a}(n,o,t,i,a):function O6(n,r,t,o,i){if(!n)return n;o||(o={"!id":{}});var s,a={"!type":"chart","!drawel":null,"!rel":""},l=n.match(pd);return l&&za(l[0],0,i,t),(s=n.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=s[1]),o["!id"][a["!rel"]]&&(a["!drawel"]=o["!id"][a["!rel"]]),a}(n,0,t,i,a)}(f,r,i,c,a[o],d))||!m["!drawel"])break;var h=bo(m["!drawel"].Target,r),p=Do(h),g=function zC(n,r){if(!n)return"??";var t=(n.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}(ln(n,h,!0),ko(ln(n,p,!0),h)),v=bo(g,h),x=Do(v);m=function P6(n,r,t,o,i,a){var s=a||{"!type":"chart"};if(!n)return a;var l=0,c=0,d="A",_={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(n.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var f=function Z6(n){var o,r=[],t=n.match(/^<c:numCache>/);(n.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(a){var s=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!s||(r[+s[1]]=t?+s[2]:s[2])});var i=Qe((n.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(n.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(a){o=a.replace(/<.*?>/g,"")}),[r,i,o]}(u);_.s.r=_.s.c=0,_.e.c=l,d=nt(l),f[0].forEach(function(m,h){s[d+pt(h)]={t:"n",v:m,z:f[1]},c=h}),_.e.r<c&&(_.e.r=c),++l}),l>0&&(s["!ref"]=ke(_)),s}(ln(n,v,!0),0,0,ko(ln(n,x,!0),v),0,m);break;case"macro":m=function _w(n,r,t,o,i,a,s,l){return r.slice(-4),{"!type":"macro"}}(0,r);break;case"dialog":m=function pw(n,r,t,o,i,a,s,l){return r.slice(-4),{"!type":"dialog"}}(0,r);break;default:throw new Error("Unrecognized sheet type "+l)}s[o]=m;var C=[];a&&a[o]&&dt(a[o]).forEach(function(b){var y="";if(a[o][b].Type==Fe.CMNT){y=bo(a[o][b].Target,r);var M=function hw(n,r,t){return".bin"===r.slice(-4)?function aT(n,r){var t=[],o=[],i={},a=!1;return Wn(n,function(l,c,d){switch(d){case 632:o.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=o[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:case 37:case 38:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T&&(!a||r.WTF))throw new Error("Unexpected record 0x"+d.toString(16))}}),t}(n,t):function GC(n,r){if(n.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],o=[],i=n.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(""!==s&&""!==s.trim()){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&t.push(l[1])}});var a=n.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(s){if(""!==s&&""!==s.trim()){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ae(l[0]),d={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},_=st(c.ref);if(!(r.sheetRows&&r.sheetRows<=_.r)){var u=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!u&&!!u[1]&&Ua(u[1])||{r:"",t:"",h:""};d.r=f.r,"<t></t>"==f.r&&(f.t=f.h=""),d.t=(f.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(d.h=f.h),o.push(d)}}}}),o}(n,t)}(Ct(n,y,!0),y,c);if(!M||!M.length)return;Wc(m,M,!1)}a[o][b].Type==Fe.TCMNT&&(y=bo(a[o][b].Target,r),C=C.concat(function XC(n,r){var t=[],o=!1,i={},a=0;return n.replace(Rt,function(l,c){var d=Ae(l);switch(Zn(d[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":null!=i.t&&t.push(i);break;case"<text>":case"<text":a=c+l.length;break;case"</text>":i.t=n.slice(a,c).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":o=!0;break;case"</mentions>":case"</ext>":o=!1;break;default:if(!o&&r.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),t}(Ct(n,y,!0),c)))}),C&&C.length&&Wc(m,C,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function Tn(n){return"/"==n.charAt(0)?n.slice(1):n}function U4(n,r){if(Ki(),as(r=r||{}),mn(n,"META-INF/manifest.xml")||mn(n,"objectdata.xml"))return function Ud(n,r){r=r||{},mn(n,"META-INF/manifest.xml")&&function $g(n,r){for(var o,i,t=da(n);o=So.exec(t);)switch(o[3]){case"manifest":break;case"file-entry":if("/"==(i=Ae(o[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==i.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw o}}(Ct(n,"META-INF/manifest.xml"),r);var t=ln(n,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var o=Od(Xe(t),r);return mn(n,"meta.xml")&&(o.Props=Wl(Ct(n,"meta.xml"))),o}(n,r);if(mn(n,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==rs){if(n.FileIndex)return rs(n);var t=Te.utils.cfb_new();return cl(n).forEach(function(pe){!function Le(n,r,t){if(n.FullPaths){var o;if("string"==typeof t)return o=Ee?Vn(t):function x1(n){for(var r=[],t=0,o=n.length+250,i=ii(n.length+255),a=0;a<n.length;++a){var s=n.charCodeAt(a);if(s<128)i[t++]=s;else if(s<2048)i[t++]=192|s>>6&31,i[t++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var l=1023&n.charCodeAt(++a);i[t++]=240|s>>8&7,i[t++]=128|s>>2&63,i[t++]=128|l>>6&15|(3&s)<<4,i[t++]=128|63&l}else i[t++]=224|s>>12&15,i[t++]=128|s>>6&63,i[t++]=128|63&s;t>o&&(r.push(i.slice(0,t)),t=0,i=ii(65535),o=65530)}return r.push(i.slice(0,t)),kt(r)}(t),Te.utils.cfb_add(n,r,o);Te.utils.cfb_add(n,r,t)}else n.file(r,t)}(t,pe,ll(n,pe))}),rs(t)}throw new Error("Unsupported NUMBERS file")}if(!mn(n,"[Content_Types].xml"))throw mn(n,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):mn(n,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s,l,o=cl(n),i=function Yg(n){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!n||!n.match)return r;var t={};if((n.match(Rt)||[]).forEach(function(o){var i=Ae(o);switch(i[0].replace(ig,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":void 0!==r[ka[i.ContentType]]&&r[ka[i.ContentType]].push(i.PartName)}}),"http://schemas.openxmlformats.org/package/2006/content-types"!==r.xmlns)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}(ln(n,"[Content_Types].xml")),a=!1;if(0===i.workbooks.length&&Ct(n,l="xl/workbook.xml",!0)&&i.workbooks.push(l),0===i.workbooks.length){if(!Ct(n,l="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(l),a=!0}"bin"==i.workbooks[0].slice(-3)&&(a=!0);var c={},d={};if(!r.bookSheets&&!r.bookProps){if(Jo=[],i.sst)try{Jo=function mw(n,r,t){return".bin"===r.slice(-4)?function mv(n,r){var t=[],o=!1;return Wn(n,function(a,s,l){switch(l){case 159:t.Count=a[0],t.Unique=a[1];break;case 19:t.push(a);break;case 160:return!0;case 35:o=!0;break;case 36:o=!1;break;default:if(!o||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}(n,t):function pv(n,r){var t=[],o="";if(!n)return t;var i=n.match(cv);if(i){o=i[2].replace(dv,"").split(_v);for(var a=0;a!=o.length;++a){var s=Ua(o[a].trim(),r);null!=s&&(t[t.length]=s)}i=Ae(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}(n,t)}(Ct(n,Tn(i.sst)),i.sst,r)}catch(pe){if(r.WTF)throw pe}r.cellStyles&&i.themes.length&&(c=function fw(n,r,t){return Vc(n,t)}(ln(n,i.themes[0].replace(/^\//,""),!0)||"",0,r)),i.style&&(d=function uw(n,r,t,o){return".bin"===r.slice(-4)?function lC(n,r,t){var o={NumberFmt:[]};for(var i in we)o.NumberFmt[i]=we[i];o.CellXf=[],o.Fonts=[];var a=[],s=!1;return Wn(n,function(c,d,_){switch(_){case 44:o.NumberFmt[c[0]]=c[1],En(c[1],c[0]);break;case 43:o.Fonts.push(c),null!=c.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Dr(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==a[a.length-1]&&o.CellXf.push(c);break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(_),s=!0;break;case 38:a.pop(),s=!1;break;default:if(d.T>0)a.push(_);else if(d.T<0)a.pop();else if(!s||t.WTF&&37!=a[a.length-1])throw new Error("Unexpected record 0x"+_.toString(16))}}),o}(n,t,o):zv(n,t,o)}(Ct(n,Tn(i.style)),i.style,c,r))}i.links.map(function(pe){try{return ko(ln(n,Do(Tn(pe))),pe),function xw(n,r,t,o){return".bin"===t.slice(-4)?function WC(n,r,t,o){if(!n)return n;var i=o||{},a=!1;Wn(n,function(c,d,_){switch(_){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!d.T&&(!a||i.WTF))throw new Error("Unexpected record 0x"+_.toString(16))}},i)}(n,0,0,o):void 0}(Ct(n,Tn(pe)),0,pe,r)}catch(ve){}});var _=function lw(n,r,t){return".bin"===r.slice(-4)?function nw(n,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},o=[],i=!1;r||(r={}),r.biff=12;var a=[],s=[[]];return s.SheetNames=[],s.XTI=[],Ho[16]={n:"BrtFRTArchID$",f:ew},Wn(n,function(c,d,_){switch(_){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:null!=c.Sheet&&(r.SID=c.Sheet),c.Ref=Kt(c.Ptg,0,null,s,r),delete r.SID,delete c.Ptg,a.push(c);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([_,c]):s[0]=[_,c],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 35:case 37:o.push(_),i=!0;break;case 36:case 38:o.pop(),i=!1;break;default:if(!d.T&&(!i||r.WTF&&37!=o[o.length-1]&&35!=o[o.length-1]))throw new Error("Unexpected record 0x"+_.toString(16))}},r),xd(t),t.Names=a,t.supbooks=s,t}(n,t):function W6(n,r){if(!n)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},o=!1,i="xmlns",a={},s=0;if(n.replace(Rt,function(c,d){var _=Ae(c);switch(Zn(_[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":c.match(K6)&&(i="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=_[i];break;case"<fileVersion":delete _[0],t.AppVersion=_;break;case"<workbookPr":case"<workbookPr/>":Ga.forEach(function(u){if(null!=_[u[0]])switch(u[2]){case"bool":t.WBProps[u[0]]=tt(_[u[0]]);break;case"int":t.WBProps[u[0]]=parseInt(_[u[0]],10);break;default:t.WBProps[u[0]]=_[u[0]]}}),_.codeName&&(t.WBProps.CodeName=Xe(_.codeName));break;case"<workbookView":case"<workbookView/>":delete _[0],t.WBView.push(_);break;case"<sheet":switch(_.state){case"hidden":_.Hidden=1;break;case"veryHidden":_.Hidden=2;break;default:_.Hidden=0}delete _.state,_.name=Qe(Xe(_.name)),delete _[0],t.Sheets.push(_);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":o=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":o=!1;break;case"<definedName":(a={}).Name=Xe(_.name),_.comment&&(a.Comment=_.comment),_.localSheetId&&(a.Sheet=+_.localSheetId),tt(_.hidden||"0")&&(a.Hidden=!0),s=d+c.length;break;case"</definedName>":a.Ref=Qe(Xe(n.slice(s,d))),t.Names.push(a);break;case"<calcPr":case"<calcPr/>":delete _[0],t.CalcPr=_;break;default:if(!o&&r.WTF)throw new Error("unrecognized "+_[0]+" in workbook")}return c}),-1===li.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return xd(t),t}(n,t)}(Ct(n,Tn(i.workbooks[0])),i.workbooks[0],r),u={},f="";i.coreprops.length&&((f=Ct(n,Tn(i.coreprops[0]),!0))&&(u=Wl(f)),0!==i.extprops.length&&(f=Ct(n,Tn(i.extprops[0]),!0))&&function jg(n,r,t){var o={};r||(r={}),n=Xe(n),Di.forEach(function(i){var a=(n.match(wo(i[0]))||[])[1];switch(i[2]){case"string":a&&(r[i[1]]=Qe(a));break;case"bool":r[i[1]]="true"===a;break;case"raw":var s=n.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(o[i[1]]=s[1])}}),o.HeadingPairs&&o.TitlesOfParts&&Xl(o.HeadingPairs,o.TitlesOfParts,r,t)}(f,u,r));var m={};(!r.bookSheets||r.bookProps)&&0!==i.custprops.length&&(f=ln(n,Tn(i.custprops[0]),!0))&&(m=function tx(n,r){var t={},o="",i=n.match(ex);if(i)for(var a=0;a!=i.length;++a){var s=i[a],l=Ae(s);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":o=Qe(l.name);break;case"</property>":o=null;break;default:if(0===s.indexOf("<vt:")){var c=s.split(">"),d=c[0].slice(4),_=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[o]=Qe(_);break;case"bool":t[o]=tt(_);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[o]=parseInt(_,10);break;case"r4":case"r8":case"decimal":t[o]=parseFloat(_);break;case"filetime":case"date":t[o]=at(_);break;default:if("/"==d.slice(-1))break;r.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",s,d,c)}}else if("</"!==s.slice(0,2)&&r.WTF)throw new Error(s)}}return t}(f,r));var h={};if((r.bookSheets||r.bookProps)&&(_.Sheets?s=_.Sheets.map(function(ie){return ie.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),r.bookProps&&(h.Props=u,h.Custprops=m),r.bookSheets&&void 0!==s&&(h.SheetNames=s),r.bookSheets?h.SheetNames:r.bookProps))return h;s={};var p={};r.bookDeps&&i.calcchain&&(p=function gw(n,r,t){return".bin"===r.slice(-4)?function KC(n,r,t){var o=[];return Wn(n,function(s,l,c){if(63===c)o.push(s);else if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}),o}(n):function VC(n){var r=[];if(!n)return r;var t=1;return(n.match(Rt)||[]).forEach(function(o){var i=Ae(o);switch(i[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i)}}),r}(n)}(Ct(n,Tn(i.calcchain)),i.calcchain));var x,C,g=0,v={},b=_.Sheets;u.Worksheets=b.length,u.SheetNames=[];for(var y=0;y!=b.length;++y)u.SheetNames[y]=b[y].name;var M=a?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),U=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");mn(n,U)||(U="xl/_rels/workbook."+M+".rels");var P=ko(ln(n,U,!0),U.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=function vw(n,r,t){return".bin"===r.slice(-4)?function QC(n,r,t){var o={Types:[],Cell:[],Value:[]},i=t||{},a=[],s=!1,l=2;return Wn(n,function(c,d,_){switch(_){case 335:o.Types.push({name:c.name});break;case 51:c.forEach(function(u){1==l?o.Cell.push({type:o.Types[u[0]-1].name,index:u[1]}):0==l&&o.Value.push({type:o.Types[u[0]-1].name,index:u[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:a.push(_),s=!0;break;case 36:a.pop(),s=!1;break;default:if(!d.T&&(!s||i.WTF&&35!=a[a.length-1]))throw new Error("Unexpected record 0x"+_.toString(16))}}),o}(n,0,t):function YC(n,r,t){var o={Types:[],Cell:[],Value:[]};if(!n)return o;var s,i=!1,a=2;return n.replace(Rt,function(l){var c=Ae(l);switch(Zn(c[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":o.Types.push({name:c.name});break;case"<futureMetadata":for(var d=0;d<o.Types.length;++d)o.Types[d].name==c.name&&(s=o.Types[d]);break;case"<rc":1==a?o.Cell.push({type:o.Types[c.t-1].name,index:+c.v}):0==a&&o.Value.push({type:o.Types[c.t-1].name,index:+c.v});break;case"<cellMetadata":a=1;break;case"</cellMetadata>":case"</valueMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),o}(n,0,t)}(Ct(n,Tn(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=function eT(n,r){var t=[],o=!1;return n.replace(Rt,function(a){var s=Ae(a);switch(Zn(s[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(!o&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return a}),t}(Ct(n,Tn(i.people[0])),r)),P&&(P=function P4(n,r){if(!n)return 0;try{n=r.map(function(o){return o.id||(o.id=o.strRelID),[o.name,n["!id"][o.id].Target,Z4(n["!id"][o.id].Type)]})}catch(t){return null}return n&&0!==n.length?n:null}(P,_.Sheets));var B=Ct(n,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=u.Worksheets;++g){var J="sheet";if(P&&P[g]?(x="xl/"+P[g][1].replace(/[\/]?xl\//,""),mn(n,x)||(x=P[g][1]),mn(n,x)||(x=U.replace(/_rels\/.*$/,"")+P[g][1]),J=P[g][2]):x=(x="xl/worksheets/sheet"+(g+1-B)+"."+M).replace(/sheet0\./,"sheet."),C=x.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(u.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var O=!1,ee=0;ee!=r.sheets.length;++ee)"number"==typeof r.sheets[ee]&&r.sheets[ee]==g&&(O=1),"string"==typeof r.sheets[ee]&&r.sheets[ee].toLowerCase()==u.SheetNames[g].toLowerCase()&&(O=1);if(!O)continue e}}O4(n,x,C,u.SheetNames[g],g,v,s,J,r,_,c,d)}return h={Directory:i,Workbook:_,Props:u,Custprops:m,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:Jo,Styles:d,Themes:c,SSF:je(we)},r&&r.bookFiles&&(n.files?(h.keys=o,h.files=n.files):(h.keys=[],h.files={},n.FullPaths.forEach(function(pe,ie){pe=pe.replace(/^Root Entry[\/]/,""),h.keys.push(pe),h.files[pe]=n.FileIndex[ie]}))),r&&r.bookVBA&&(i.vba.length>0?h.vbaraw=Ct(n,Tn(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(h.vbaraw=Ct(n,"xl/vbaProject.bin",!0))),h}function B4(n,r){var t=r||{},o="Workbook",i=Te.find(n,o);try{if(!(i=Te.find(n,o="/!DataSpaces/Version"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);if(function vv(n){var r={};r.id=n.read_shift(0,"lpp4"),r.R=Gn(n,4),r.U=Gn(n,4),r.W=Gn(n,4)}(i.content),!(i=Te.find(n,o="/!DataSpaces/DataSpaceMap"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);var a=function Tv(n){var r=[];n.l+=4;for(var t=n.read_shift(4);t-- >0;)r.push(Cv(n));return r}(i.content);if(1!==a.length||1!==a[0].comps.length||0!==a[0].comps[0].t||"StrongEncryptionDataSpace"!==a[0].name||"EncryptedPackage"!==a[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+o);if(!(i=Te.find(n,o="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);var s=function bv(n){var r=[];n.l+=4;for(var t=n.read_shift(4);t-- >0;)r.push(n.read_shift(0,"lpp4"));return r}(i.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+o);if(!(i=Te.find(n,o="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);!function Sv(n){var r=function wv(n){var r={};return n.read_shift(4),n.l+=4,r.id=n.read_shift(0,"lpp4"),r.name=n.read_shift(0,"lpp4"),r.R=Gn(n,4),r.U=Gn(n,4),r.W=Gn(n,4),r}(n);if(r.ename=n.read_shift(0,"8lpp4"),r.blksz=n.read_shift(4),r.cmode=n.read_shift(4),4!=n.read_shift(4))throw new Error("Bad !Primary record");return r}(i.content)}catch(c){}if(!(i=Te.find(n,o="/EncryptionInfo"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);var l=function Nv(n){var r=Gn(n);switch(r.Minor){case 2:return[r.Minor,Av(n)];case 3:return[r.Minor,yv()];case 4:return[r.Minor,Dv(n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}(i.content);if(!(i=Te.find(n,o="/EncryptedPackage"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+o);if(4==l[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(l[1],i.content,t.password||"",t);if(2==l[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(l[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function ls(n,r){var t="";switch((r||{}).type||"base64"){case"buffer":case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=rn(n.slice(0,12));break;case"binary":t=n;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Vd(n,r){var t=0;e:for(;t<n.length;)switch(n.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return ja(n.slice(t),r);default:break e}return eo.to_workbook(n,r)}function cs(n,r,t,o){return o?(t.type="string",eo.to_workbook(n,t)):eo.to_workbook(r,t)}function Pr(n,r){ar();var t=r||{};if("undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer)return Pr(new Uint8Array(n),((t=je(t)).type="array",t));"undefined"!=typeof Uint8Array&&n instanceof Uint8Array&&!t.type&&(t.type="undefined"!=typeof Deno?"buffer":"array");var i,o=n,a=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),oo={},t.dateNF&&(oo.dateNF=t.dateNF),t.type||(t.type=Ee&&Buffer.isBuffer(n)?"buffer":"base64"),"file"==t.type&&(t.type=Ee?"buffer":"binary",o=function $1(n){if("undefined"!=typeof Deno)return Deno.readFileSync(n);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var r=File(n);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("Cannot access file "+n)}(n),"undefined"!=typeof Uint8Array&&!Ee&&(t.type="array")),"string"==t.type&&(a=!0,t.type="binary",t.codepage=65001,o=function V4(n){return n.match(/[^\x00-\x7F]/)?Pn(n):n}(n)),"array"==t.type&&"undefined"!=typeof Uint8Array&&n instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return(t=je(t)).type="array",Pr(jr(o),t)}switch((i=ls(o,t))[0]){case 208:if(207===i[1]&&17===i[2]&&224===i[3]&&161===i[4]&&177===i[5]&&26===i[6]&&225===i[7])return function R4(n,r){return Te.find(n,"EncryptedPackage")?B4(n,r):Nd(n,r)}(Te.read(o,t),t);break;case 9:if(i[1]<=8)return Nd(o,t);break;case 60:return ja(o,t);case 73:if(73===i[1]&&42===i[2]&&0===i[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===i[1])return function nv(n,r){var t=r||{},o=!!t.WTF;t.WTF=!0;try{var i=Lc.to_workbook(n,t);return t.WTF=o,i}catch(a){if(t.WTF=o,!a.message.match(/SYLK bad record ID/)&&o)throw a;return eo.to_workbook(n,r)}}(o,t);break;case 84:if(65===i[1]&&66===i[2]&&76===i[3])return Ic.to_workbook(o,t);break;case 80:return 75===i[1]&&i[2]<9&&i[3]<9?function Q4(n,r){var o=n,i=r||{};return i.type||(i.type=Ee&&Buffer.isBuffer(n)?"buffer":"base64"),U4(dl(o,i),i)}(o,t):cs(n,o,t,a);case 239:return 60===i[3]?ja(o,t):cs(n,o,t,a);case 255:if(254===i[1])return function Y4(n,r){var t=n;return"base64"==r.type&&(t=rn(t)),t=Re.utils.decode(1200,t.slice(2),"str"),r.type="binary",Vd(t,r)}(o,t);if(0===i[1]&&2===i[2]&&0===i[3])return Li.to_workbook(o,t);break;case 0:if(0===i[1]&&(i[2]>=2&&0===i[3]||0===i[2]&&(8===i[3]||9===i[3])))return Li.to_workbook(o,t);break;case 3:case 131:case 139:case 140:return Oa.to_workbook(o,t);case 123:if(92===i[1]&&114===i[2]&&116===i[3])return Jc.to_workbook(o,t);break;case 10:case 13:case 32:return function H4(n,r){var t="",o=ls(n,r);switch(r.type){case"base64":t=rn(n);break;case"binary":t=n;break;case"buffer":t=n.toString("binary");break;case"array":t=Ci(n);break;default:throw new Error("Unrecognized type "+r.type)}return 239==o[0]&&187==o[1]&&191==o[2]&&(t=Xe(t)),r.type="binary",Vd(t,r)}(o,t);case 137:if(80===i[1]&&78===i[2]&&71===i[3])throw new Error("PNG Image File is not a spreadsheet")}return tv.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Oa.to_workbook(o,t):cs(n,o,t,a)}function zd(n,r,t,o,i,a,s,l){var c=pt(t),d=l.defval,_=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,f=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:t,enumerable:!1})}catch(g){f.__rowNum__=t}else f.__rowNum__=t;if(!s||n[t])for(var m=r.s.c;m<=r.e.c;++m){var h=s?n[t][m]:n[o[m]+c];if(void 0!==h&&void 0!==h.t){var p=h.v;switch(h.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+h.t)}if(null!=a[m]){if(null==p)if("e"==h.t&&null===p)f[a[m]]=null;else if(void 0!==d)f[a[m]]=d;else{if(!_||null!==p)continue;f[a[m]]=null}else f[a[m]]=_&&("n"!==h.t||"n"===h.t&&!1!==l.rawNumbers)?p:On(h,p,l);null!=p&&(u=!1)}}else{if(void 0===d)continue;null!=a[m]&&(f[a[m]]=d)}}return{row:f,isempty:u}}function Ur(n,r){if(null==n||null==n["!ref"])return[];var t={t:"n",v:0},o=0,i=1,a=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=r||{},_=null!=d.range?d.range:n["!ref"];switch(1===d.header?o=1:"A"===d.header?o=2:Array.isArray(d.header)?o=3:null==d.header&&(o=0),typeof _){case"string":c=Je(_);break;case"number":(c=Je(n["!ref"])).s.r=_;break;default:c=_}o>0&&(i=0);var u=pt(c.s.r),f=[],m=[],h=0,p=0,g=Array.isArray(n),v=c.s.r,x=0,C={};g&&!n[v]&&(n[v]=[]);var b=d.skipHidden&&n["!cols"]||[],y=d.skipHidden&&n["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(b[x]||{}).hidden)switch(f[x]=nt(x),t=g?n[v][x]:n[f[x]+u],o){case 1:a[x]=x-c.s.c;break;case 2:a[x]=f[x];break;case 3:a[x]=d.header[x-c.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),l=s=On(t,null,d),p=C[s]||0){do{l=s+"_"+p++}while(C[l]);C[s]=p,C[l]=1}else C[s]=1;a[x]=l}for(v=c.s.r+i;v<=c.e.r;++v)if(!(y[v]||{}).hidden){var M=zd(n,c,v,f,o,a,g,d);(!1===M.isempty||(1===o?!1!==d.blankrows:d.blankrows))&&(m[h++]=M.row)}return m.length=h,m}var Gd=/"/g;function Xd(n,r,t,o,i,a,s,l){for(var c=!0,d=[],_="",u=pt(t),f=r.s.c;f<=r.e.c;++f)if(o[f]){var m=l.dense?(n[t]||[])[f]:n[o[f]+u];if(null==m)_="";else if(null!=m.v){c=!1,_=""+(l.rawNumbers&&"n"==m.t?m.v:On(m,null,l));for(var h=0,p=0;h!==_.length;++h)if((p=_.charCodeAt(h))===i||p===a||34===p||l.forceQuotes){_='"'+_.replace(Gd,'""')+'"';break}"ID"==_&&(_='"ID"')}else null==m.f||m.F?_="":(c=!1,(_="="+m.f).indexOf(",")>=0&&(_='"'+_.replace(Gd,'""')+'"'));d.push(_)}return!1===l.blankrows&&c?null:d.join(s)}function ps(n,r){var t=[],o=null==r?{}:r;if(null==n||null==n["!ref"])return"";var i=Je(n["!ref"]),a=void 0!==o.FS?o.FS:",",s=a.charCodeAt(0),l=void 0!==o.RS?o.RS:"\n",c=l.charCodeAt(0),d=new RegExp(("|"==a?"\\|":a)+"+$"),_="",u=[];o.dense=Array.isArray(n);for(var f=o.skipHidden&&n["!cols"]||[],m=o.skipHidden&&n["!rows"]||[],h=i.s.c;h<=i.e.c;++h)(f[h]||{}).hidden||(u[h]=nt(h));for(var p=0,g=i.s.r;g<=i.e.r;++g)(m[g]||{}).hidden||null!=(_=Xd(n,i,g,u,s,c,a,o))&&(o.strip&&(_=_.replace(d,"")),(_||!1!==o.blankrows)&&t.push((p++?l:"")+_));return delete o.dense,t.join("")}function e_(n,r,t){var o=t||{},i=+!o.skipHeader,a=n||{},s=0,l=0;if(a&&null!=o.origin)if("number"==typeof o.origin)s=o.origin;else{var c="string"==typeof o.origin?st(o.origin):o.origin;s=c.r,l=c.c}var d,_={s:{c:0,r:0},e:{c:l,r:s+r.length-1+i}};if(a["!ref"]){var u=Je(a["!ref"]);_.e.c=Math.max(_.e.c,u.e.c),_.e.r=Math.max(_.e.r,u.e.r),-1==s&&(_.e.r=(s=u.e.r+1)+r.length-1+i)}else-1==s&&(s=0,_.e.r=r.length-1+i);var f=o.header||[],m=0;r.forEach(function(p,g){dt(p).forEach(function(v){-1==(m=f.indexOf(v))&&(f[m=f.length]=v);var x=p[v],C="z",b="",y=ye({c:l+m,r:s+g+i});d=$o(a,y),!x||"object"!=typeof x||x instanceof Date?("number"==typeof x?C="n":"boolean"==typeof x?C="b":"string"==typeof x?C="s":x instanceof Date?(C="d",o.cellDates||(C="n",x=At(x)),b=o.dateNF||we[14]):null===x&&o.nullError&&(C="e",x=0),d?(d.t=C,d.v=x,delete d.w,delete d.R,b&&(d.z=b)):a[y]=d={t:C,v:x},b&&(d.z=b)):a[y]=x})}),_.e.c=Math.max(_.e.c,l+f.length-1);var h=pt(s);if(i)for(m=0;m<f.length;++m)a[nt(m+l)+h]={t:"s",v:f[m]};return a["!ref"]=ke(_),a}function $o(n,r,t){if("string"==typeof r){if(Array.isArray(n)){var o=st(r);return n[o.r]||(n[o.r]=[]),n[o.r][o.c]||(n[o.r][o.c]={t:"z"})}return n[r]||(n[r]={t:"z"})}return $o(n,ye("number"!=typeof r?r:{r,c:t||0}))}function fs(n,r,t,o){var i=1;if(!t)for(;i<=65535&&-1!=n.SheetNames.indexOf(t="Sheet"+i);++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(o&&n.SheetNames.indexOf(t)>=0){var a=t.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||t;for(++i;i<=65535&&-1!=n.SheetNames.indexOf(t=s+i);++i);}if(function vd(n,r){if(n.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return V6.forEach(function(o){if(-1!=n.indexOf(o)){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=r,t}function t_(n,r,t){return r?(n.l={Target:r},t&&(n.l.Tooltip=t)):delete n.l,n}var rS={encode_col:nt,encode_row:pt,encode_cell:ye,encode_range:ke,decode_col:va,decode_row:xa,split_cell:function Sg(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:st,decode_range:dn,format_cell:On,sheet_add_aoa:Ul,sheet_add_json:e_,sheet_add_dom:Id,aoa_to_sheet:Xi,json_to_sheet:function X4(n,r){return e_(null,n,r)},table_to_sheet:Ed,table_to_book:function m4(n,r){return ci(Ed(n,r),r)},sheet_to_csv:ps,sheet_to_txt:function jd(n,r){r||(r={}),r.FS="\t",r.RS="\n";var t=ps(n,r);return t},sheet_to_json:Ur,sheet_to_html:function Ld(n,r){var t=r||{},i=null!=t.footer?t.footer:"</body></html>",a=[null!=t.header?t.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>'],s=dn(n["!ref"]);t.dense=Array.isArray(n),a.push(function Md(n,r,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var l=s.s.r;l<=s.e.r;++l)a.push(Dd(n,s,l,t));return a.push("</table>"+i),a.join("")},sheet_to_formulae:function G4(n){var t,r="",o="";if(null==n||null==n["!ref"])return[];var l,i=Je(n["!ref"]),a="",s=[],c=[],d=Array.isArray(n);for(l=i.s.c;l<=i.e.c;++l)s[l]=nt(l);for(var _=i.s.r;_<=i.e.r;++_)for(a=pt(_),l=i.s.c;l<=i.e.c;++l)if(r=s[l]+a,o="",void 0!==(t=d?(n[_]||[])[l]:n[r])){if(null!=t.F){if(r=t.F,!t.f)continue;o=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)o=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)o=""+t.v;else if("b"==t.t)o=t.v?"TRUE":"FALSE";else if(void 0!==t.w)o="'"+t.w;else{if(void 0===t.v)continue;o="s"==t.t?"'"+t.v:""+t.v}}c[c.length]=r+"="+o}return c},sheet_to_row_object_array:Ur,sheet_get_cell:$o,book_new:function us(){return{SheetNames:[],Sheets:{}}},book_append_sheet:fs,book_set_sheet_visibility:function eS(n,r,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var o=function j4(n,r){if("number"==typeof r){if(r>=0&&n.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=n.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(n,r);switch(n.Workbook.Sheets[o]||(n.Workbook.Sheets[o]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[o].Hidden=t},cell_set_number_format:function tS(n,r){return n.z=r,n},cell_set_hyperlink:t_,cell_set_internal_link:function nS(n,r,t){return t_(n,"#"+r,t)},cell_add_comment:function iS(n,r,t){n.c||(n.c=[]),n.c.push({t:r,a:t||"SheetJS"})},sheet_set_array_formula:function oS(n,r,t,o){for(var i="string"!=typeof r?r:Je(r),a="string"==typeof r?r:ke(r),s=i.s.r;s<=i.e.r;++s)for(var l=i.s.c;l<=i.e.c;++l){var c=$o(n,s,l);c.t="n",c.F=a,delete c.v,s==i.s.r&&l==i.s.c&&(c.f=t,o&&(c.D=!0))}return n},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function dS(n,r){1&n&&(e.TgZ(0,"button",30),e._uU(1,"Uploaded input files will shown here click upload file button."),e.qZA())}function _S(n,r){if(1&n&&(e.TgZ(0,"tr",38)(1,"th",39),e._uU(2),e.qZA(),e._UZ(3,"th"),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.fileName)}}function pS(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t["Field "]," ")}}function uS(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t["Data type"]," ")}}function fS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",40),e.NdJ("dragstart",function(i){return e.CHM(t),e.oxw(4).dragstart_handler(i)})("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).inputFileRowClicked(a)}),e.YNc(1,pS,2,1,"td",29),e.YNc(2,uS,2,1,"td",29),e.qZA()}if(2&n){const t=r.$implicit;e.uIk("data-drag-data",t.showFileFieldName),e.xp6(1),e.Q6J("ngIf",t.Description),e.xp6(1),e.Q6J("ngIf",t.Description)}}function mS(n,r){if(1&n&&(e.TgZ(0,"table",35)(1,"thead"),e.YNc(2,_S,4,1,"tr",36),e.qZA(),e.TgZ(3,"tbody"),e.YNc(4,fS,3,3,"tr",37),e.qZA()()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(2),e.Q6J("ngForOf",o),e.xp6(2),e.Q6J("ngForOf",t["Data Fields"])}}function hS(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",33),e.YNc(2,mS,5,2,"table",34),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngForOf",t)}}function gS(n,r){if(1&n&&(e.TgZ(0,"div",31),e.YNc(1,hS,3,1,"ng-container",32),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"json"),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.myFiles),e.xp6(2),e.Oqu(e.lcZ(4,2,t.invoiceForm1.value))}}function xS(n,r){if(1&n&&(e.TgZ(0,"option",41)(1,"a",42),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.name),e.xp6(2),e.Oqu(t.name)}}function vS(n,r){1&n&&(e.TgZ(0,"button",43),e._uU(1,"Create dataset by clicking on above Add Dataset button"),e.qZA())}function CS(n,r){if(1&n&&(e.TgZ(0,"option",41)(1,"a",61),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(2),e.Oqu(t.value)}}function TS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",47)(1,"td")(2,"input",55),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw().index;return e.oxw(2).captureDataSetField(a,"Field ",l,s)}),e.qZA()(),e.TgZ(3,"td")(4,"input",56),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw().index;return e.oxw(2).captureDataSetField(a,"Defination",l,s)}),e.qZA()(),e.TgZ(5,"td")(6,"select",57),e.NdJ("change",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).changeDatatype(i,"Datatype",l,s)}),e.TgZ(7,"option",21),e._uU(8,"Select "),e._UZ(9,"span",58),e.qZA(),e.YNc(10,CS,3,2,"option",22),e.qZA()(),e.TgZ(11,"td")(12,"div",59)(13,"span",60),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw().$implicit;return e.oxw(2).deleteDataSetRow(s.controls.datasetFieldDTOList,a)}),e.qZA()()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(2);e.Q6J("formGroupName",t),e.xp6(2),e.hYB("id","Field",o,"",t,""),e.xp6(2),e.hYB("id","Defination",o,"",t,""),e.xp6(6),e.Q6J("ngForOf",i.dataTypeList)}}function bS(n,r){if(1&n){const t=e.EpF();e.ynx(0,47),e.TgZ(1,"div",33)(2,"table",35)(3,"thead")(4,"tr",38)(5,"th",48),e._uU(6),e.qZA(),e._UZ(7,"th",49),e.TgZ(8,"th",50)(9,"button",51),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(2).addNewDataSetRow(a.controls.datasetFieldDTOList)}),e._uU(10,"+"),e.qZA()(),e.TgZ(11,"th",52),e.NdJ("click",function(){const a=e.CHM(t).index;return e.oxw(2).deleteDataSet(a)}),e._UZ(12,"span",53),e.qZA()()(),e.TgZ(13,"tbody",54),e.YNc(14,TS,14,6,"tr",46),e.qZA()()(),e.BQk()}if(2&n){const t=r.$implicit;e.Q6J("formGroupName",r.index),e.xp6(6),e.Oqu(t.value.datasetName),e.xp6(8),e.Q6J("ngForOf",t.get("datasetFieldDTOList").controls)}}function wS(n,r){if(1&n&&(e.TgZ(0,"form",44)(1,"div",45),e.YNc(2,bS,15,3,"ng-container",46),e.qZA()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.invoiceForm1),e.xp6(2),e.Q6J("ngForOf",t.invoiceForm1.get("DatasetDetailsList").controls)}}function SS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",62)(2,"div",63)(3,"div",64)(4,"h4",65),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form")(7,"div",66)(8,"div",67)(9,"label"),e._uU(10,"Enter DataSet Name"),e.qZA(),e._UZ(11,"input",68),e.qZA()(),e.TgZ(12,"div",69)(13,"button",70),e.NdJ("click",function(){return e.CHM(t),e.oxw().addNewDataSet()}),e._uU(14,"Add"),e.qZA(),e._uU(15," \xa0 \xa0 "),e.TgZ(16,"button",71),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopup=!1}),e._uU(17,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("formControl",t.dataSetNameControl)}}const NS=function(){return["/dashboard"]},AS=function(){return["solution-board-dashboard"]};let yS=(()=>{class n{constructor(t,o,i){this.fb=t,this.renderer=o,this.solService=i,this.whiteSpace={left:!0,right:!0},this.formUploadFiles=new w.cw({file:new w.NI("")}),this.tab1=!0,this.tab2=!1,this.tab3=!1,this.tab4=!1,this.selectedFormula="",this.excelErrorMsg={},this.myFiles=[],this.enableDataSetPopup=!1,this.dataSetNameControl=new w.NI(null),this.data={DatasetDetailsList:[{datasetName:"example comany",datasetFieldDTOList:[{"Field ":"example project",Defination:"","Data type":""}]}]},this.dataTypeList=[{id:0,value:"Text"},{id:1,value:"Number"},{id:2,value:"Date"}],this.formulasList=[{id:0,name:"APPROXIMATE DISTINCT COUNT",description:"Returns the approximate number of rows that contain distinct values in a column."},{id:1,name:"AVERAGE",description:"Returns the average (arithmetic mean) of all the numbers in a column."},{id:2,name:"COUNT",description:"Counts the number of rows in the specified column that contain non-blank values."},{id:3,name:"DISTINCT COUNT",description:"Counts the number of distinct values in a column."},{id:4,name:"MAX",description:"Returns the largest numeric value in a column, or between two scalar expressions."},{id:5,name:"MIN",description:"Returns the smallest numeric value in a column, or between two scalar expressions."},{id:6,name:"PRODUCT",description:"Returns the product of the numbers in a column."},{id:7,name:"SUM",description:"Adds all the numbers in a column."},{id:8,name:"DIVIDE",description:"Adds all the numbers in a column."},{id:9,name:"ROUND OFF",description:"Adds all the numbers in a column."},{id:10,name:"POWER",description:"Adds all the numbers in a column."},{id:11,name:"FLOOR",description:"Adds all the numbers in a column."},{id:12,name:"GCD",description:"Adds all the numbers in a column."},{id:13,name:"COUNT",description:"Adds all the numbers in a column."},{id:14,name:"QUOTIENT",description:"Adds all the numbers in a column."},{id:15,name:"PERCENTILE",description:"Adds all the numbers in a column."}],this.formFormula=this.fb.group({formula:[""]})}ngOnInit(){this.invoiceForm1=this.fb.group({DRows1:this.fb.array([]),items:new w.Oe([]),DatasetDetailsList:this.fb.array([])})}onFileChange(t){this.myFiles=[];for(var o=0;o<t.target.files.length;o++){let i=null,a=null;const s=new FileReader,l=t.target.files[o];l.name.split(".").pop(),s.onload=d=>{var _,u;i=Pr(s.result,{type:"binary"}),a=i.SheetNames.reduce((b,y)=>(b[y]=rS.sheet_to_json(i.Sheets[y]),b.fileName=l.name,b),{}),"Data Fields"in a||(this.excelErrorMsg.dataFields="Data Fields isnt there"),"Sheet1"in a||(this.excelErrorMsg.sheet1="Sheet1 isnt there"),null===(_=a["Data Fields"])||void 0===_||_.forEach((b,y)=>{if(null!=b.Description){b.fileName=l.name;let M=l.name.split(".").slice(0,-1).join("."),A=b["Field "];b.showFileFieldName=M.substring(0,4)+"."+A,b.fileFieldName=M+"."+A}else{let M=a["Data Fields"];M.splice(y,M.length-1)}});let p=null!=a["Data Fields"]?a["Data Fields"]:[],g=[...new Set(p)];p.length!=g.length&&(this.excelErrorMsg.duplicate="have duplicates");let v=null===(u=a["Data Fields"])||void 0===u?void 0:u.filter(b=>"Text"==b["Data type"]||"Number"==b["Data type"]||"Date"==b["Data type"]);v=null!=v?v:[],v.length!==p.length&&(this.excelErrorMsg.dataType="have duplicate data types"),console.log(this.excelErrorMsg);let x=JSON.stringify(a["Data Fields"]),C=new FormData;C.append("file",l),C.append("dataFields",x),C.append("processId","550B00B2-C9D6-437F-9080-4CA0AE63B2FB"),this.myFiles.push([a]),console.log(this.myFiles)},s.readAsBinaryString(l),this.whiteSpace.left=!1}}addNewDRow1(){this.invoiceForm1.get("DRows1").push(this.fb.group({"Field ":[""],Description:[""],"Data type":[""],defination:[""]}))}onSubmitDataSet1(){console.log(this.invoiceForm1.value)}getDropControls1(){return this.invoiceForm1.get("DRows1").controls}deleteDropRow1(t){this.invoiceForm1.get("DRows1").removeAt(t)}addRow1(t){return this.fb.group({"Field ":[t["Field "]],Description:[t.Description],"Data type":[t["Data type"]],fileName:[t.fileName],defination:[""]})}captureDataSetFields(t,o,i){let a=t.value[i];this.selectedDataSetField={},this.selectedDataSetField={indexValue:o,fieldValue:a,columnName:i.trim()},console.log(this.selectedDataSetField)}dragstart_handler(t){t.dataTransfer.setData("text/plain",t.target.dataset.dragData)}createDataSetFieldDTOList(){return this.fb.group({"Field ":[""],Defination:"","Data type":""})}addNewDataSet(){this.whiteSpace.right=!1,this.enableDataSetPopup=!1,this.dataSetName=this.dataSetNameControl.value,this.invoiceForm1.controls.DatasetDetailsList.push(this.fb.group({datasetName:this.dataSetName,datasetFieldDTOList:this.fb.array([this.createDataSetFieldDTOList()])}))}addNewDataSetRow(t){t.push(this.createDataSetFieldDTOList())}deleteDataSet(t){this.invoiceForm1.controls.DatasetDetailsList.removeAt(t)}deleteDataSetRow(t,o){t.removeAt(o)}saveDataSet(t){let o={processId:"550B00B2-C9D6-437F-9080-4CA0AE63B2FB"};o.DatasetDetailsList=t,this.solService.saveDataSetApi(o).subscribe(i=>{console.log(i)})}captureDataSetField(t,o,i,a){console.log(t,o,i,a);let s=this.invoiceForm1.get("DatasetDetailsList").controls[i].value.datasetFieldDTOList[a][o];this.selectedDataSetFieldValue={value:s,tableIndex:i,rowIndex:a,columnName:o}}changeDatatype(t,o,i,a){this.invoiceForm1.get("DatasetDetailsList").controls[i].controls.datasetFieldDTOList.controls[a].patchValue({"Data type":t.target.value})}inputFileRowClicked(t){let o=this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].controls.datasetFieldDTOList.controls[this.selectedDataSetFieldValue.rowIndex].controls[this.selectedDataSetFieldValue.columnName].value;if(this.invoiceForm1.get("DatasetDetailsList"),"Field "==this.selectedDataSetFieldValue.columnName){let a=o.concat(t[this.selectedDataSetFieldValue.columnName]);this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].get("datasetFieldDTOList").controls[this.selectedDataSetFieldValue.rowIndex].get(this.selectedDataSetFieldValue.columnName).reset(),this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].controls.datasetFieldDTOList.controls[this.selectedDataSetFieldValue.rowIndex].patchValue({[this.selectedDataSetFieldValue.columnName]:a})}if("Defination"==this.selectedDataSetFieldValue.columnName){let a=o.concat(t.showFileFieldName);this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].get("datasetFieldDTOList").controls[this.selectedDataSetFieldValue.rowIndex].get(this.selectedDataSetFieldValue.columnName).reset(),this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].controls.datasetFieldDTOList.controls[this.selectedDataSetFieldValue.rowIndex].patchValue({[this.selectedDataSetFieldValue.columnName]:a})}this.renderer.selectRootElement("#"+this.selectedDataSetFieldValue.columnName.trim()+this.selectedDataSetFieldValue.tableIndex+this.selectedDataSetFieldValue.rowIndex).focus()}changeFormula(t){let o=this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].controls.datasetFieldDTOList.controls[this.selectedDataSetFieldValue.rowIndex].controls[this.selectedDataSetFieldValue.columnName].value;this.selectedFormula=t.target.value;let i=o.concat(this.selectedFormula);this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].get("datasetFieldDTOList").controls[this.selectedDataSetFieldValue.rowIndex].get(this.selectedDataSetFieldValue.columnName).reset(),this.invoiceForm1.get("DatasetDetailsList").controls[this.selectedDataSetFieldValue.tableIndex].controls.datasetFieldDTOList.controls[this.selectedDataSetFieldValue.rowIndex].patchValue({[this.selectedDataSetFieldValue.columnName]:i}),this.renderer.selectRootElement("#"+this.selectedDataSetFieldValue.columnName.trim()+this.selectedDataSetFieldValue.tableIndex+this.selectedDataSetFieldValue.rowIndex).focus()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.qu),e.Y36(e.Qsj),e.Y36(Jt.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-new-solution"]],decls:63,vars:20,consts:[[1,"heading"],[3,"routerLink"],[1,"consen"],[1,"btnn"],["mat-button",""],[1,"main"],[1,"row","no-gutters",2,"padding-top","20px"],[1,"bottom"],[1,"left"],[1,"tip",3,"formGroup"],[2,"display","flex"],["for","inputfile",1,"btn"],["type","file","id","inputfile","formControlName","file","multiple","",2,"display","none",3,"change"],["class","first",4,"ngIf"],["class","col indust","style","margin-top:15px",4,"ngIf"],[1,"button"],[1,"right"],[1,"",2,"display","flex"],[3,"formGroup"],[1,"dropdown"],["formControlName","formula",1,"form-control",2,"width","400px","border-radius","0",3,"change"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],["mat-button","",1,"btn",3,"click"],["class","second ",4,"ngIf"],["class","col indust container scroll","style","margin-top:15px",3,"formGroup",4,"ngIf"],[1,"col-md-4",2,"margin","auto","margin-right","0"],["mat-button","","color","primary","routerLink","/user/admin1/solution-board-dashboard",1,"cD_btn",2,"width","auto","height","auto",3,"click"],["mat-button","","color","primary","routerLink","/user/admin1/powerbi-interface",1,"cD_btn",2,"width","auto","height","auto"],[4,"ngIf"],[1,"first"],[1,"col","indust",2,"margin-top","15px"],[4,"ngFor","ngForOf"],[1,"indust"],["class","table table-striped",4,"ngFor","ngForOf"],[1,"table","table-striped"],["style","background-color: #041E42; color:white",4,"ngFor","ngForOf"],["draggable","true",3,"dragstart","click",4,"ngFor","ngForOf"],[2,"background-color","#041E42","color","white"],["scope","col"],["draggable","true",3,"dragstart","click"],[3,"value"],["alt","formula.description"],[1,"second"],[1,"col","indust","container","scroll",2,"margin-top","15px",3,"formGroup"],["formArrayName","DatasetDetailsList"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["scope","col",1,"col-md-3"],[1,"col-md-7"],[1,"col-md-1"],["type","button",1,"btn","btn-primary",2,"margin","auto","margin-right","0%",3,"click"],[1,"col-md-1",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke"],["formArrayName","datasetFieldDTOList"],["formControlName","Field ",1,"form-control",3,"id","click"],["formControlName","Defination",1,"form-control",3,"id","click"],[1,"form-control",2,"width","88px","border-radius","0",3,"change"],[1,"dds-icon","dds-icon_arrow-down"],[1,"icn"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],["alt","item.value"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[1,"row","popup"],[1,"field"],["type","text",2,"height","35px","background-color","#eee","width","100%","border","1px solid #ccc","padding-left","5px",3,"formControl"],[1,"col-sm-3",2,"float","right","margin","5% 0 5% 0"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],["mat-button","",2,"color","#0076A8",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Solution Board"),e.qZA(),e.TgZ(3,"ul")(4,"li")(5,"a",1),e._uU(6,"Dashboard "),e.qZA(),e._uU(7,"/"),e.qZA(),e.TgZ(8,"li")(9,"a",1),e._uU(10,"Solution Board"),e.qZA(),e._uU(11,"/"),e.qZA(),e.TgZ(12,"li"),e._uU(13,"Add process"),e.qZA()()(),e.TgZ(14,"div",2)(15,"div",3)(16,"button",4),e._uU(17,"Flat File"),e.qZA(),e._uU(18," \xa0 "),e.TgZ(19,"button",4),e._uU(20,"SQL"),e.qZA(),e._uU(21,"\xa0 "),e.TgZ(22,"button",4),e._uU(23,"API"),e.qZA(),e._uU(24,"\xa0 "),e.TgZ(25,"button",4),e._uU(26,"No SQL"),e.qZA()(),e.TgZ(27,"mat-card",5),e._UZ(28,"div",6),e.TgZ(29,"div",7)(30,"div",8)(31,"form",9)(32,"div",10)(33,"h6"),e._uU(34,"Note: Exclude .JS and .EXE files"),e.qZA(),e.TgZ(35,"label",11),e._uU(36,"Upload File(s)"),e.qZA(),e.TgZ(37,"input",12),e.NdJ("change",function(a){return o.onFileChange(a)}),e.qZA()()(),e.YNc(38,dS,2,0,"button",13),e.YNc(39,gS,5,4,"div",14),e._UZ(40,"div",15),e.qZA(),e.TgZ(41,"div",16)(42,"div",17)(43,"form",18)(44,"div",19)(45,"select",20),e.NdJ("change",function(a){return o.changeFormula(a)}),e.TgZ(46,"option",21),e._uU(47,"Select A Function"),e.qZA(),e.YNc(48,xS,3,2,"option",22),e.qZA()()(),e.TgZ(49,"button",23),e.NdJ("click",function(){return o.dataSetNameControl.reset(),o.enableDataSetPopup=!0,o.dataSetName=""}),e._uU(50,"Add DataSet"),e.qZA()(),e.YNc(51,vS,2,0,"button",24),e.YNc(52,wS,3,2,"form",25),e.TgZ(53,"div",15),e._UZ(54,"br"),e.qZA()()(),e.TgZ(55,"div",26)(56,"button",27),e.NdJ("click",function(){return o.saveDataSet(o.invoiceForm1.controls.DatasetDetailsList.value)}),e._uU(57,"Save Dataset(s)"),e.qZA(),e._uU(58,"\xa0 \xa0 "),e.TgZ(59,"button",28),e._uU(60,"Save & Continue"),e.qZA(),e._uU(61,"\xa0 \xa0 "),e.qZA()()(),e.YNc(62,SS,18,1,"div",29)),2&t&&(e.xp6(5),e.Q6J("routerLink",e.DdM(18,NS)),e.xp6(4),e.Q6J("routerLink",e.DdM(19,AS)),e.xp6(7),e.ekj("active",o.tab1),e.xp6(3),e.ekj("active",o.tab2),e.xp6(3),e.ekj("active",o.tab3),e.xp6(3),e.ekj("active",o.tab4),e.xp6(6),e.Q6J("formGroup",o.formUploadFiles),e.xp6(7),e.Q6J("ngIf",o.whiteSpace.left),e.xp6(1),e.Q6J("ngIf",!o.whiteSpace.left),e.xp6(4),e.Q6J("formGroup",o.formFormula),e.xp6(5),e.Q6J("ngForOf",o.formulasList),e.xp6(3),e.Q6J("ngIf",o.whiteSpace.right),e.xp6(1),e.Q6J("ngIf",!o.whiteSpace.right),e.xp6(10),e.Q6J("ngIf",o.enableDataSetPopup))},directives:[fe.yS,Ze.lW,Se.a8,w._Y,w.JL,w.sg,w.Fj,w.JJ,w.u,be.O5,be.sg,w.EJ,w.YN,w.Kr,w.CE,w.x0,fe.rH,w.F,w.oH],pipes:[be.Ts],styles:['.btnn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #0076A8;display:inline;height:35px;width:10%;border-radius:0;background-color:#fff;color:#000;font-family:open_sans-regular}.btnn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#041E42;color:#fff}.cards[_ngcontent-%COMP%]{border-style:ridge;margin:20px 0;height:75%;padding:18px 30px}.cards[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], p[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;margin:auto}.first[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:400px;width:100%;color:#707070;margin:2% 1px 1px;border:none;padding:15px}.first[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.second[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:400px;width:100%;color:#707070;margin:2% 1px 1px;border:none;padding:15px}.second[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.bottom[_ngcontent-%COMP%]{width:100%;display:flex}.left[_ngcontent-%COMP%]{width:35%;padding:30px 20px;border-right:2px dotted;max-height:700px!important}.right[_ngcontent-%COMP%]{width:65%;padding:20px}.btn[_ngcontent-%COMP%]{height:40px;border-radius:0;background-color:#0076a8;color:#fff;width:auto;margin:auto 0% auto auto}.num[_ngcontent-%COMP%]{background-color:#0076a8;border-radius:50%;color:#fff;padding:2px 7px;width:15px}.dropdown[_ngcontent-%COMP%]{position:relative}.dropdown[_ngcontent-%COMP%]:after{content:"";position:absolute;right:10px;top:15px;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid #707070}.next[_ngcontent-%COMP%]{position:absolute;top:30%;left:96%;font-size:40px;color:#0076a8;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0}.rect[_ngcontent-%COMP%]{padding:5px}.verti[_ngcontent-%COMP%]{margin:auto;vertical-align:middle;height:100%}.popup[_ngcontent-%COMP%]{width:100%;margin:0}.field[_ngcontent-%COMP%]{padding:20px;margin:auto}.taxt_audit-report[_ngcontent-%COMP%]{background:#0000004D;height:100vh;width:100%;position:fixed;left:0;top:0;z-index:4}.cD_btn[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;border-radius:0;border:1px solid #ccc;margin-top:15px}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.indust[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.indust[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.indust[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.indust[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.indust[_ngcontent-%COMP%]{max-height:400px;overflow:auto;margin-bottom:10px;box-shadow:none}.indust[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}']}),n})();var ms=ce(9772),so=ce(6856);function DS(n,r){1&n&&e._UZ(0,"span",13)}function kS(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"button",11),e._uU(2),e.YNc(3,DS,1,0,"span",12),e.qZA(),e._uU(4," \xa0 "),e.BQk()),2&n){const t=r.$implicit,o=r.index,i=e.oxw();e.xp6(1),e.ekj("active",t.isActive),e.xp6(1),e.Oqu(t.value),e.xp6(1),e.Q6J("ngIf",i.tabs.length-1!=o)}}function FS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21)(2,"div")(3,"label",22)(4,"input",23),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._UZ(5,"span",24)(6,"br"),e.TgZ(7,"h5"),e._uU(8,"Upload Files"),e.qZA(),e.TgZ(9,"p",25),e._uU(10,"Note: Exclude .JS and .EXE files"),e.qZA()()()()()}}function MS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"span",26),e._uU(2,"Choose the sheets within the file(s)"),e.qZA(),e.TgZ(3,"div",27)(4,"h5"),e._uU(5,"Uploaded Files"),e.qZA()(),e.TgZ(6,"div",28)(7,"input",29),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(2).masterSelected=i})("change",function(){return e.CHM(t),e.oxw(2).checkUncheckAllUploadFiles()}),e.qZA(),e.TgZ(8,"label"),e._uU(9,"Select All"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("ngModel",t.masterSelected)}}function LS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSheetSelected=i})("change",function(){return e.CHM(t),e.oxw(3).isAllSelectedUploadFiles()}),e.qZA(),e._UZ(3,"img",33),e.TgZ(4,"label"),e._uU(5),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSheetSelected),e.xp6(3),e.Oqu(t.sheetName)}}function IS(n,r){1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",34),e.qZA()())}function ES(n,r){if(1&n&&(e.TgZ(0,"table",30)(1,"thead")(2,"tr")(3,"th"),e._UZ(4,"span",31),e._uU(5),e.qZA()()(),e.TgZ(6,"tbody"),e.YNc(7,LS,6,2,"tr",6),e.YNc(8,IS,3,0,"tr",7),e.qZA()()),2&n){const t=r.$implicit;e.xp6(5),e.Oqu(t.fileName),e.xp6(2),e.Q6J("ngForOf",t.totalSheetList),e.xp6(1),e.Q6J("ngIf",t.isProgressBar)}}function ZS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.showUploadFilesTab=!1,i.fileListt=[],i.masterSelected=!1}),e._uU(1,"Prev"),e.qZA()}}function PS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Next"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isUploadFilesNextBtnEnable)}}function OS(n,r){if(1&n&&(e.TgZ(0,"div")(1,"mat-card")(2,"div",14)(3,"div"),e.YNc(4,FS,11,0,"div",15),e.YNc(5,MS,10,1,"div",7),e.YNc(6,ES,9,3,"table",16),e.qZA(),e.TgZ(7,"div",17),e.YNc(8,ZS,2,0,"button",18),e.YNc(9,PS,2,1,"button",19),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",!t.showUploadFilesTab),e.xp6(1),e.Q6J("ngIf",t.showUploadFilesTab),e.xp6(1),e.Q6J("ngForOf",t.fileListt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListt.length>0)}}function US(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",42),e._UZ(2,"img",33),e.TgZ(3,"label"),e._uU(4),e.qZA(),e.TgZ(5,"span",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit,l=e.oxw(),c=l.index,d=l.$implicit;return e.oxw(2).previewPopup(a,s,c,d,"")}),e.qZA()()()}if(2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.sheetName,"")}}function BS(n,r){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,US,6,1,"tr",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.isSheetSelected)}}function JS(n,r){if(1&n&&(e.TgZ(0,"table",30)(1,"thead")(2,"tr")(3,"th"),e._UZ(4,"span",31),e._uU(5),e.qZA()()(),e.YNc(6,BS,2,1,"tbody",6),e.qZA()),2&n){const t=r.$implicit;e.xp6(5),e.hij("",t.fileName," "),e.xp6(1),e.Q6J("ngForOf",t.totalSheetList)}}function qS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:0})}),e._uU(1,"Prev"),e.qZA()}}function RS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.changeTabs({id:2}),i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1,"Next"),e.qZA()}}function QS(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-card",37)(2,"span",26),e._uU(3,"Click the view icon to see a preview of the filtered files' or sheets' information. "),e.qZA(),e.TgZ(4,"div",38)(5,"div",27)(6,"h5"),e._uU(7,"Selected Files "),e.TgZ(8,"span",39),e._uU(9,"Preview Data"),e.qZA()()(),e.TgZ(10,"div"),e.YNc(11,JS,7,2,"table",16),e.qZA(),e.TgZ(12,"div",40),e.YNc(13,qS,2,0,"button",41),e.YNc(14,RS,2,0,"button",41),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.fileListtt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function HS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",56)(1,"td")(2,"input",57),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw().index;return e.oxw(3).isAllSelected(i,s,c,l)}),e.qZA(),e._UZ(3,"span",58),e._uU(4),e.qZA(),e.TgZ(5,"td",59),e._UZ(6,"img",33),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"span",43),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw().index;return e.oxw(3).previewPopup(a,s,l,"","")}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(2),e.hij("",t.fileName," "),e.xp6(3),e.hij(" ",t.sheetName," ")}}function YS(n,r){if(1&n&&(e.TgZ(0,"div",60),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function VS(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Append Sheets"),e.qZA(),e.TgZ(3,"span",26),e._uU(4,"To append the sheets, please choose the ones with identical columns. Select atleast two sheets for appending "),e.qZA(),e.TgZ(5,"table",50)(6,"thead")(7,"tr")(8,"th",51),e._uU(9,"Filename"),e.qZA(),e.TgZ(10,"th",52),e._uU(11,"Sheetname"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Preview"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,HS,10,3,"tr",53),e.qZA()(),e.YNc(16,YS,2,1,"div",54),e.TgZ(17,"button",55),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).addAppendName()}),e._uU(18," Append"),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(15),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",o.submitted),e.xp6(1),e.Q6J("disabled",!o.hideCreateIdenticalBtnWithLength)}}function $S(n,r){if(1&n&&(e.ynx(0),e.YNc(1,VS,19,3,"ng-container",6),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.sortedList)}}function KS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1," Append"),e.qZA()}}function WS(n,r){if(1&n&&(e.TgZ(0,"div",71),e._UZ(1,"span",58),e._uU(2),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fileName," ")}}function zS(n,r){if(1&n&&(e.TgZ(0,"div",71),e._UZ(1,"img",33),e.TgZ(2,"label"),e._uU(3),e.qZA()()),2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.columnName)}}function GS(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",64)(2,"td",65),e._uU(3),e.qZA()(),e.TgZ(4,"tr",66)(5,"td"),e.YNc(6,WS,3,1,"div",67),e.qZA(),e.TgZ(7,"td",59),e.YNc(8,zS,4,1,"div",67),e.qZA(),e.TgZ(9,"td",68),e._UZ(10,"span",69),e.TgZ(11,"span",70),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l)}),e.qZA()()(),e.BQk()}if(2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.appendName),e.xp6(3),e.Q6J("ngForOf",t.appendDtos),e.xp6(2),e.Q6J("ngForOf",t.tableAppendFieldsDto)}}function XS(n,r){if(1&n&&(e.TgZ(0,"table",50)(1,"thead")(2,"tr")(3,"th",62),e._uU(4,"Append Set(s)"),e.qZA()()(),e.TgZ(5,"tbody",63),e.YNc(6,GS,12,3,"ng-container",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.appendFiles)}}function jS(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",72),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1,i.mergeCheckedList=[],i.sortedCheckedList=[]}),e._uU(1," Reset "),e.qZA()}}function eN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Prev"),e.qZA()}}function tN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(i){return e.CHM(t),e.oxw(2).saveAppendAPI(i)}),e._uU(1,"Save"),e.qZA()}}function nN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:3},"unChedkedList")}),e._uU(1,"Next"),e.qZA()}}function iN(n,r){if(1&n&&(e.TgZ(0,"div",45),e.YNc(1,$S,2,1,"ng-container",7),e.YNc(2,KS,2,0,"button",46),e.TgZ(3,"div",47),e.YNc(4,XS,7,1,"table",48),e.qZA(),e._UZ(5,"br"),e.YNc(6,jS,2,0,"button",49),e.TgZ(7,"div",39),e.YNc(8,eN,2,0,"button",41),e.YNc(9,tN,2,0,"button",41),e.YNc(10,nN,2,0,"button",41),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=t.sortedList[0].length),e.xp6(1),e.Q6J("ngIf",t.hideCreateIdenticalBtn),e.xp6(2),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function oN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",78)(1,"td")(2,"input",79),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).checkedInJoin(i,s,l)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(1),e.hij(" ",t.showAppendName," ")}}function rN(n,r){if(1&n&&(e.TgZ(0,"table",76)(1,"tbody"),e.YNc(2,oN,4,2,"tr",77),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.sortedCheckedList)}}function aN(n,r){if(1&n&&(e.TgZ(0,"div",60),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function sN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).join2Sheets()}),e._uU(1,"Join"),e.qZA()}}function lN(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",102),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value," ")}}function cN(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function dN(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",102),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij("",t.value," ")}}function _N(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",103),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index;return e.oxw(3).addTableJoins(i)}),e._uU(1," Table"),e.qZA()}if(2&n){const t=e.oxw(2).index,o=e.oxw(3);e.Q6J("disabled",null==o.mergeCheckedList[t]?null:o.mergeCheckedList[t].allTablesSelected)}}function pN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",104),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).removeTable(a,i)}),e.qZA()}}function uN(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.columnName," ")}}function fN(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.columnName," ")}}function mN(n,r){if(1&n&&(e.ynx(0),e.YNc(1,fN,2,2,"mat-option",97),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw().index,i=e.oxw().index,a=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].foreignTableList?null:a.mergeCheckedList[i].dropDownList[o].foreignTableList.foreignKeyList[t])}}function hN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",110),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index,a=e.oxw().index;return e.oxw(3).addColumnJoin(a,i)}),e._uU(1,"Column "),e.qZA()}}function gN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",104),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index,s=e.oxw().index;return e.oxw(3).removeCol(s,a,i)}),e.qZA()}}function xN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",87)(1,"div",14),e._UZ(2,"div",92),e.TgZ(3,"div",93)(4,"mat-form-field",94)(5,"mat-select",105),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(5).selectPrimarykey(i,s)}),e.YNc(6,uN,2,2,"mat-option",97),e.qZA()()(),e._UZ(7,"div",92),e.TgZ(8,"div",93)(9,"mat-form-field",94)(10,"mat-select",106),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(5).selectForeignKey(i,s)}),e.YNc(11,mN,2,1,"ng-container",7),e.qZA()()(),e.TgZ(12,"div",107),e.YNc(13,hN,2,0,"button",108),e.YNc(14,gN,1,0,"button",109),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw().index,a=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(6),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].primaryTableList?null:a.mergeCheckedList[i].dropDownList[o].primaryTableList.primaryKeyList[t]),e.xp6(5),e.Q6J("ngIf",null!=(null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]?null:a.mergeCheckedList[i].dropDownList[o].foreignTableList)),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function vN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",91)(1,"div",14),e._UZ(2,"div",92),e.TgZ(3,"div",93)(4,"mat-form-field",94)(5,"mat-select",95),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectPrimaryTable(i,s,l)}),e.YNc(6,lN,3,2,"ng-container",6),e.qZA()()(),e.TgZ(7,"div",92)(8,"mat-form-field",94)(9,"mat-select",96),e.YNc(10,cN,2,2,"mat-option",97),e.qZA()()(),e.TgZ(11,"div",93)(12,"mat-form-field",94)(13,"mat-select",98),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectForeignTable(i,s,l)}),e.YNc(14,dN,3,2,"ng-container",6),e.qZA()()(),e.TgZ(15,"div",92),e.YNc(16,_N,2,1,"button",99),e.YNc(17,pN,1,0,"button",100),e.qZA()(),e.TgZ(18,"div",101),e.YNc(19,xN,15,5,"div",86),e.qZA()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(5),e.Q6J("placeholder",i.placetable),e.xp6(1),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].primaryTableList),e.xp6(4),e.Q6J("ngForOf",i.joinType),e.xp6(4),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].foreignTableList),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t),e.xp6(2),e.Q6J("ngForOf",i.columnArr(o,t).controls)}}function CN(n,r){if(1&n&&(e.TgZ(0,"div",87)(1,"div",88),e._uU(2),e.qZA(),e.TgZ(3,"div",89),e.YNc(4,vN,20,8,"div",90),e.qZA()()),2&n){const t=r.index,o=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(2),e.hij("Join Table Name : ",o.mergeCheckedList[t].mergeName," "),e.xp6(2),e.Q6J("ngForOf",o.TableArr(t).controls)}}function TN(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",80)(2,"div",81)(3,"div",82),e._uU(4,"Join Set "),e.qZA(),e._UZ(5,"div",83)(6,"div",83)(7,"div",83)(8,"div",84),e.qZA(),e.TgZ(9,"div",85),e.YNc(10,CN,5,3,"div",86),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.joinSetForm),e.xp6(9),e.Q6J("ngForOf",t.MergeArr().controls)}}function bN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",111),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).resetMerge()}),e._uU(1,"Reset"),e.qZA()}}function wN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:2},"prevInMerge")}),e._uU(1,"Prev"),e.qZA()}}function SN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).MergeSubmit()}),e._uU(1,"Save"),e.qZA()}}function NN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:4},"appendList")}),e._uU(1,"Next"),e.qZA()}}function AN(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"span",114),e._uU(9,"\xa0"),e.qZA()()()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(2),e.Oqu(o.mergeName),e.xp6(2),e.Oqu(t.primaryTableName),e.xp6(2),e.Oqu(t.secondaryTableName)}}function yN(n,r){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,AN,10,3,"tr",6),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t.templatesMergeList)}}function DN(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",112)(2,"div",14)(3,"table",113)(4,"thead")(5,"tr")(6,"th"),e._uU(7,"Join Table Name"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Primary Table "),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Secondary Table"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"ACtions"),e.qZA()()(),e.YNc(14,yN,2,1,"tbody",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(14),e.Q6J("ngForOf",t.mergeList)}}function kN(n,r){if(1&n&&(e.TgZ(0,"div",45),e.ynx(1),e.TgZ(2,"span",26),e._uU(3,"Select the files, then join them based on common columns "),e.qZA(),e.TgZ(4,"div",27)(5,"h5"),e._uU(6,"Files"),e.qZA()(),e.YNc(7,rN,3,1,"table",73),e.YNc(8,aN,2,1,"div",54),e.YNc(9,sN,2,0,"button",41),e.YNc(10,TN,11,2,"div",7),e.TgZ(11,"div",14),e.YNc(12,bN,2,0,"button",74),e.TgZ(13,"div",75),e.YNc(14,wN,2,0,"button",41),e.YNc(15,SN,2,0,"button",41),e.YNc(16,NN,2,0,"button",41),e.qZA()(),e.TgZ(17,"div",14),e.YNc(18,DN,15,1,"ng-container",7),e.qZA(),e.BQk(),e.qZA()),2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(1),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(2),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(2),e.Q6J("ngIf",t.mergeList.length>0)}}function FN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",125),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw().$implicit;return e.oxw(2).showTargetFileTableColumns(a,i.showAppendName,"mergeCheckedList",i)}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.ekj("active",1==t.tabActiveInTargetFiles),e.xp6(1),e.hij(" ",t.showAppendName," ")}}function MN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",125),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,a=e.oxw().$implicit;return e.oxw(2).showTargetFileTableColumns(a,i.showAppendName,"mergeCheckedList",i)}),e._uU(1),e.TgZ(2,"span",126),e._UZ(3,"span",127),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.ekj("active",1==t.tabActiveInTargetFiles),e.xp6(1),e.hij(" ",t.showAppendName," "),e.xp6(1),e.s9C("matTooltip",t.hOverf_SName)}}function LN(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,FN,2,3,"td",124),e.YNc(2,MN,4,4,"td",124),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",null==t.isAppend||null==t.isAppend||0==t.isAppend),e.xp6(1),e.Q6J("ngIf",1==t.isAppend)}}function IN(n,r){if(1&n&&(e.TgZ(0,"table",122)(1,"thead")(2,"tr")(3,"th"),e._UZ(4,"img",123),e.TgZ(5,"label"),e._uU(6),e.qZA()()()(),e.TgZ(7,"tbody"),e.YNc(8,LN,3,2,"tr",6),e.qZA()()),2&n){const t=r.$implicit;e.xp6(6),e.Oqu(t.mergeName),e.xp6(2),e.Q6J("ngForOf",t.mergeList)}}function EN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",125),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).showTargetFileTableColumns(i,i.showAppendName,"sortedCheckedList","")}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.ekj("active",1==t.tabActiveInTargetFiles),e.xp6(1),e.hij(" ",t.showAppendName," ")}}function ZN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"td",125),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).showTargetFileTableColumns(i,i.showAppendName,"sortedCheckedList","")}),e._uU(1),e.TgZ(2,"span",126),e._UZ(3,"span",128),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.ekj("active",1==t.tabActiveInTargetFiles),e.xp6(1),e.hij(" ",t.showAppendName," "),e.xp6(1),e.s9C("matTooltip",t.hOverf_SName)}}function PN(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,EN,2,3,"td",124),e.YNc(2,ZN,4,4,"td",124),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",null==t.isAppend||null==t.isAppend||0==t.isAppend),e.xp6(1),e.Q6J("ngIf",1==t.isAppend)}}function ON(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",142),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function UN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",134)(2,"input",135),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isChecked=i}),e.qZA()(),e.TgZ(3,"td",136)(4,"span",137)(5,"div"),e._uU(6),e.qZA()()(),e.TgZ(7,"td",138),e.ynx(8),e.TgZ(9,"select",139),e.NdJ("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(4).changeDataTypeTF(i,s,l)}),e.TgZ(10,"option",140),e._uU(11),e._UZ(12,"span",141),e.qZA(),e.YNc(13,ON,3,2,"option",97),e.qZA(),e.BQk(),e.qZA()()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.xp6(2),e.Q6J("ngModel",t.isChecked),e.xp6(2),e.s9C("matTooltip",t.columnName),e.xp6(2),e.Oqu(t.columnName),e.xp6(5),e.Oqu(t.generatedDataType),e.xp6(2),e.Q6J("ngForOf",o.dataType)}}function BN(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"table",130)(2,"thead")(3,"tr")(4,"th",131),e._uU(5,"#"),e.qZA(),e.TgZ(6,"th",132),e._uU(7,"Column Name"),e.qZA(),e.TgZ(8,"th",133),e._uU(9,"Data Type"),e.qZA()()(),e.TgZ(10,"tbody"),e.YNc(11,UN,14,5,"tr",6),e.qZA()(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(11),e.Q6J("ngForOf",t.showTargetFilesColumnss)}}function JN(n,r){if(1&n&&(e.TgZ(0,"div",129),e.YNc(1,BN,12,1,"ng-container",7),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0!=t.showTargetFilesColumnss.length)}}function qN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",115)(1,"span",116),e._uU(2,"Here is the complete list of files that are appended, joined, and other individual files that can be used to build the datasets. "),e.qZA(),e.TgZ(3,"button",117),e.NdJ("click",function(){return e.CHM(t),e.oxw().showTargetFilePopup=!0}),e._uU(4,"Preview"),e.qZA(),e.TgZ(5,"div",118),e.YNc(6,IN,9,2,"table",119),e.TgZ(7,"table",120)(8,"thead")(9,"tr")(10,"th"),e._uU(11,"Files"),e.qZA()()(),e.TgZ(12,"tbody"),e.YNc(13,PN,3,2,"tr",6),e.qZA()()(),e.YNc(14,JN,2,1,"div",121),e.qZA()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.mergeCheckedList),e.xp6(7),e.Q6J("ngForOf",t.sortedCheckedList),e.xp6(1),e.Q6J("ngIf",4==t.tabs[4].id&&1==t.tabs[4].isActive)}}function RN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:3})}),e._uU(1,"Prev"),e.qZA()}}function QN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:5})}),e._uU(1,"Next"),e.qZA()}}function HN(n,r){if(1&n&&(e.TgZ(0,"div",39),e.YNc(1,RN,2,0,"button",41),e.YNc(2,QN,2,0,"button",41),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function YN(n,r){1&n&&(e.TgZ(0,"div",27)(1,"h5"),e._uU(2,"Joined Files"),e.qZA()())}function VN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion")(1,"div",157),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"JF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.columnName,"")}}function $N(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",155),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",156),e._uU(2),e.qZA(),e.YNc(3,VN,3,1,"mat-accordion",6),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(2),e.hij(" ",t.mergeName," "),e.xp6(1),e.Q6J("ngForOf",t.columnList)}}function KN(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",153),e.YNc(1,$N,4,3,"mat-expansion-panel",154),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.mergeCheckedList)}}function WN(n,r){1&n&&(e.TgZ(0,"div",27)(1,"h5"),e._uU(2,"Append Files"),e.qZA()())}function zN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion")(1,"div",157),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"AF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.columnName,"")}}function GN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",155),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",156),e._uU(2),e.qZA(),e.YNc(3,zN,3,1,"mat-accordion",6),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(2),e.hij(" ",t.showAppendName," "),e.xp6(1),e.Q6J("ngForOf",t.columnList)}}function XN(n,r){if(1&n&&(e.ynx(0),e.YNc(1,GN,4,3,"mat-expansion-panel",154),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.appendListInMCL)}}function jN(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion")(1,"div",157),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"AF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.columnName,"")}}function eA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",155),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",156),e._uU(2),e.qZA(),e.YNc(3,jN,3,1,"mat-accordion",6),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(2),e.hij(" ",t.showAppendName," "),e.xp6(1),e.Q6J("ngForOf",t.columnList)}}function tA(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",153),e.YNc(2,eA,4,3,"mat-expansion-panel",154),e.qZA(),e.BQk()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t.appendListInSCL)}}function nA(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",153),e.YNc(1,XN,2,1,"ng-container",7),e.YNc(2,tA,3,1,"ng-container",7),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",0!=t.appendListInMCL.length),e.xp6(1),e.Q6J("ngIf",0!=t.appendListInSCL.length)}}function iA(n,r){1&n&&(e.TgZ(0,"div",27)(1,"h5"),e._uU(2,"Source Files"),e.qZA()())}function oA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion")(1,"div",157),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"SF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.columnName,"")}}function rA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",155),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",156),e._uU(2),e.qZA(),e.YNc(3,oA,3,1,"mat-accordion",6),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(2),e.hij(" ",t.showAppendName," "),e.xp6(1),e.Q6J("ngForOf",t.columnList)}}function aA(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",153),e.YNc(1,rA,4,3,"mat-expansion-panel",154),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.sheetsListInSCL)}}function sA(n,r){1&n&&(e.TgZ(0,"div",158),e._uU(1,"No files found"),e.qZA())}function lA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion")(1,"div",157),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fieldName,"")}}function cA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",155),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",156)(2,"p",159),e._uU(3),e.qZA(),e.TgZ(4,"div",160)(5,"span",161),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup("","","","",a.datasetName)}),e.qZA(),e.TgZ(6,"span",162),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).editDatasetFile(a)}),e.qZA(),e.TgZ(7,"span",163),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).callGetViewscript(a)}),e.qZA()()(),e.YNc(8,lA,3,1,"mat-accordion",6),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.datasetName),e.xp6(5),e.Q6J("ngForOf",t.datasetFieldDTOList)}}function dA(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",153),e.YNc(1,cA,9,3,"mat-expansion-panel",154),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function _A(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value,"")}}function pA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value,"")}}function uA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",94)(2,"mat-select",186),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw().index;return e.oxw(3).changeDateTimeinCreateExpression(i,a)}),e.YNc(3,pA,2,2,"mat-option",97),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("ngForOf",t.dateTimeFormats)}}function fA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",188)(1,"div",157),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).accordionExpValue(a,a.Component)}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionType,"")}}function mA(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",156),e._uU(2),e.qZA(),e.YNc(3,fA,3,1,"mat-accordion",187),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionName," "),e.xp6(1),e.Q6J("ngForOf",t.funcDescritptionsList)}}function hA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function gA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function xA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function vA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",182)(2,"mat-form-field",94)(3,"mat-select",189),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeOperator(i,s,l,d,_)}),e.YNc(4,gA,2,2,"mat-option",97),e.qZA()(),e.TgZ(5,"mat-form-field",94)(6,"mat-select",190),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeSignOperator(i,s,l,d,_,"child")}),e.YNc(7,xA,2,2,"mat-option",97),e.qZA()(),e.TgZ(8,"input",184),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.TgZ(9,"span",191),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(),c=l.index,d=l.$implicit;return e.oxw(3).delOpearatorValueFields(a,s,c,d)}),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.xp6(3),e.Q6J("value",t.operator),e.xp6(1),e.Q6J("ngForOf",o.opearatorList),e.xp6(2),e.Q6J("value",t.signOperator),e.xp6(1),e.Q6J("ngForOf",o.signOperatorList),e.xp6(1),e.Q6J("ngModel",t.value)}}function CA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"SAVE"),e.qZA()}}function TA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",193),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"ADD"),e.qZA()}}function bA(n,r){if(1&n&&(e.ynx(0),e.YNc(1,CA,2,0,"button",41),e.YNc(2,TA,2,0,"button",192),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",0==t.isEdit)}}function wA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"table",166)(1,"tbody")(2,"tr")(3,"td",167)(4,"input",168),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)}),e.qZA(),e.TgZ(5,"mat-form-field",94)(6,"mat-select",169),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(3).changeDTinCreateExpression(i,s)}),e.TgZ(7,"mat-option"),e._uU(8),e.qZA(),e.YNc(9,_A,2,2,"mat-option",97),e.qZA()(),e.YNc(10,uA,4,1,"ng-container",7),e.TgZ(11,"mat-form-field",94)(12,"mat-label"),e._uU(13,"Choose a date"),e.qZA(),e._UZ(14,"input",170)(15,"mat-datepicker-toggle",171)(16,"mat-datepicker",null,172),e.qZA()(),e.TgZ(18,"td",173)(19,"div",174)(20,"img",175),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.isOpenAccordion=0==i.isOpenAccordion}),e.qZA(),e.TgZ(21,"div",176)(22,"div",177)(23,"input",178),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i)}),e.qZA(),e._UZ(24,"span",179),e.qZA(),e.TgZ(25,"mat-accordion",153),e.YNc(26,mA,4,2,"mat-expansion-panel",6),e.qZA()()()(),e.TgZ(27,"td",180)(28,"textarea",181),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)}),e._uU(29,"                                        "),e.qZA(),e.TgZ(30,"div",182)(31,"mat-form-field",94)(32,"mat-select",183),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit;return e.oxw(3).changeSignOperator(i,"","",s,l,"parent")}),e.YNc(33,hA,2,2,"mat-option",97),e.qZA()(),e.TgZ(34,"input",184),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.TgZ(35,"span",185),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit;return e.oxw(3).addOpearatorValueFields(a,s)}),e.qZA(),e._UZ(36,"br"),e.qZA(),e.YNc(37,vA,10,5,"ng-container",6),e.qZA()()(),e.YNc(38,bA,3,2,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=e.MAs(17),i=e.oxw(3);e.xp6(4),e.Q6J("value",t.sourceFieldName),e.xp6(4),e.Oqu(t.selectedDataType),e.xp6(1),e.Q6J("ngForOf",i.dataTypee),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(4),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o),e.xp6(11),e.Q6J("ngForOf",i.fx),e.xp6(2),e.Q6J("value",t.expression),e.xp6(4),e.Q6J("value",t.signOperator),e.xp6(1),e.Q6J("ngForOf",i.signOperatorList),e.xp6(1),e.Q6J("ngModel",t.value),e.xp6(3),e.Q6J("ngForOf",null==t?null:t.whereList),e.xp6(1),e.Q6J("ngIf",i.fileListtt.length>0)}}function SA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",75)(6,"span",203),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).editRowInDataSet(l,a,s)}),e.qZA(),e.TgZ(7,"span",204),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).deleteRowInDataset(l,a,s)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.sourceFieldName),e.xp6(2),e.Oqu(t.selectedDataType)}}function NA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fileColumnName," ")}}function AA(n,r){if(1&n&&(e.TgZ(0,"mat-option",102),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fileColumnName," ")}}function yA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",193),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2),a=i.$implicit,s=i.index;return e.oxw(3).saveDataSet(a,s)}),e._uU(1,"Save Dataset"),e.qZA()}}function DA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",47)(2,"table",122)(3,"thead")(4,"tr")(5,"th",194),e._uU(6),e.qZA(),e._UZ(7,"th",195),e.TgZ(8,"th",196),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteDataSet(i)}),e._UZ(9,"span",197),e.qZA()(),e.TgZ(10,"tr")(11,"th"),e._uU(12,"Column Name"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Column Type"),e.qZA(),e.TgZ(15,"th",75),e._uU(16,"View Expression"),e.qZA()()(),e.TgZ(17,"tbody"),e.YNc(18,SA,8,2,"tr",6),e.qZA(),e._UZ(19,"div"),e.TgZ(20,"div",198)(21,"label",199),e._uU(22,"Having"),e.qZA(),e.TgZ(23,"input",200),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.having=i}),e.qZA()()()(),e.TgZ(24,"mat-form-field",94)(25,"mat-select",201),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"groupby")}),e.YNc(26,NA,2,2,"mat-option",97),e.qZA()(),e.TgZ(27,"mat-form-field",94)(28,"mat-select",202),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"orderby")}),e.YNc(29,AA,2,2,"mat-option",97),e.qZA()(),e.YNc(30,yA,2,0,"button",192),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(6),e.Oqu(t.datasetName),e.xp6(12),e.Q6J("ngForOf",t.datasetFieldDTOList),e.xp6(5),e.Q6J("ngModel",t.having),e.xp6(3),e.Q6J("ngForOf",t.groupBy),e.xp6(3),e.Q6J("ngForOf",t.orderBy),e.xp6(1),e.Q6J("ngIf",o.fileListtt.length>0)}}function kA(n,r){if(1&n&&(e.ynx(0),e.YNc(1,DA,31,6,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isDatasetTableExpand)}}function FA(n,r){if(1&n&&(e.TgZ(0,"div",164)(1,"div",27)(2,"h5"),e._uU(3,"Create Expression"),e.qZA()(),e.YNc(4,wA,39,13,"table",165),e.YNc(5,kA,2,1,"ng-container",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",t.createExpressionList),e.xp6(1),e.Q6J("ngForOf",t.datasetDetailsList)}}function MA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:4})}),e._uU(1,"Prev"),e.qZA()}}function LA(n,r){1&n&&(e.TgZ(0,"button",205),e._uU(1,"Continue"),e.qZA())}function IA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"mat-card")(2,"span",26),e._uU(3,"Use the column names from the files listed below to create the dataset(s), then define the dataset columns using analytical operations or by using the column name directly."),e.qZA(),e.TgZ(4,"div")(5,"button",143),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!0}),e._uU(6,"Expand All "),e.qZA(),e.TgZ(7,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!1}),e._uU(8,"Collapse All "),e.qZA(),e.TgZ(9,"button",144),e.NdJ("click",function(){return e.CHM(t),e.oxw().createDataSetinDM()}),e._uU(10," Create DataSet"),e.qZA(),e.TgZ(11,"button",144),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.enableUploadSQLPopup=!0,i.sqlScriptForm.reset()}),e._uU(12," Upload SQL Script"),e.qZA(),e.TgZ(13,"button",144),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.enableUploadPhytonPopup=!0,i.sqlScriptForm.reset()}),e._uU(14," upload python"),e.qZA()(),e.TgZ(15,"div",145)(16,"div",14)(17,"div",146),e.YNc(18,YN,3,0,"div",147),e.YNc(19,KN,2,1,"mat-accordion",148),e.YNc(20,WN,3,0,"div",147),e.YNc(21,nA,3,2,"mat-accordion",148),e.YNc(22,iA,3,0,"div",147),e.YNc(23,aA,2,1,"mat-accordion",148),e.TgZ(24,"div",27)(25,"h5"),e._uU(26,"DataSet Files "),e.TgZ(27,"span",39),e._uU(28,"Actions"),e.qZA()()(),e.YNc(29,sA,2,0,"div",149),e.YNc(30,dA,2,1,"mat-accordion",148),e.qZA(),e.YNc(31,FA,6,2,"div",150),e.TgZ(32,"div",151),e.YNc(33,MA,2,0,"button",41),e.TgZ(34,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeProject()}),e._uU(35,"Execute"),e.qZA(),e.YNc(36,LA,2,0,"button",152),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(18),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(1),e.Q6J("ngIf",0!=t.appendListInMCL.length||0!=t.appendListInSCL.length),e.xp6(1),e.Q6J("ngIf",0!=t.appendListInMCL.length||0!=t.appendListInSCL.length),e.xp6(1),e.Q6J("ngIf",0!=t.sheetsListInSCL.length),e.xp6(1),e.Q6J("ngIf",0!=t.sheetsListInSCL.length),e.xp6(6),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)),e.xp6(1),e.Q6J("ngIf",0!=t.createExpressionList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(3),e.Q6J("ngIf",t.fileListtt.length>0)}}const n_=function(n){return{"is-invalid":n}};function EA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",206)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"Append Name"),e.qZA()(),e.TgZ(6,"form",210)(7,"div",211)(8,"div",212)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",213),e.qZA()(),e.TgZ(12,"div",214)(13,"button",215),e.NdJ("click",function(){return e.CHM(t),e.oxw().createAppendSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.appendForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,n_,t.submited&&t.appendForm.controls.appendNameControl.errors))}}function ZA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",206)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"Join Name"),e.qZA()(),e.TgZ(6,"form",210)(7,"div",211)(8,"div",212)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",213),e.qZA()(),e.TgZ(12,"div",214)(13,"button",217),e.NdJ("click",function(){return e.CHM(t),e.oxw().mergeSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableMergeNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.joinForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,n_,t.submited&&t.joinForm.controls.appendNameControl.errors))}}function PA(n,r){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function OA(n,r){if(1&n&&(e.TgZ(0,"td",222),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t],"")}}function UA(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,OA,2,1,"td",221),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.columnsArr)}}function BA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",206)(2,"div",218),e._UZ(3,"div",208),e.TgZ(4,"form")(5,"table",122)(6,"thead")(7,"tr"),e.YNc(8,PA,2,1,"th",6),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,UA,2,1,"tr",6),e.qZA()()(),e.TgZ(11,"div",219)(12,"button",220),e.NdJ("click",function(){return e.CHM(t),e.oxw().showTargetFilePopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.columnsArr),e.xp6(2),e.Q6J("ngForOf",t.selectedM_A_S)}}function JA(n,r){1&n&&(e.TgZ(0,"div",60),e._uU(1,"DataSet Name cannot be blank!"),e.qZA())}function qA(n,r){1&n&&(e.TgZ(0,"div",60),e._uU(1,"DataSet Name exists already!"),e.qZA())}function RA(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",206)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form")(7,"div",211)(8,"div",212)(9,"label"),e._uU(10,"Enter DataSet Name"),e.qZA(),e._UZ(11,"input",223),e.qZA()(),e.YNc(12,JA,2,0,"div",54),e.YNc(13,qA,2,0,"div",54),e.TgZ(14,"div",214)(15,"button",224),e.NdJ("click",function(){return e.CHM(t),e.oxw().createNewDataSet()}),e._uU(16,"Add"),e.qZA(),e.TgZ(17,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopUp=!1}),e._uU(18,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("formControl",t.appendNameControl),e.xp6(1),e.Q6J("ngIf",t.appendNameControl.errors&&t.appendNameControl.errors.invalid),e.xp6(1),e.Q6J("ngIf",t.appendNameControl.errors&&t.appendNameControl.errors.exists),e.xp6(2),e.Q6J("disabled",t.appendNameControl.errors&&t.appendNameControl.errors.invalid||t.appendNameControl.errors&&t.appendNameControl.errors.exists||null==t.appendNameControl.value||0==t.appendNameControl.value.trim().length)}}function QA(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",230),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.fileName),e.xp6(2),e.Oqu(t.fileName)}}function HA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",229),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changePrimaryTableInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,QA,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedPrimaryTable),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.primaryTableList)}}function YA(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",232),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.columnName),e.xp6(2),e.Oqu(t.columnName)}}function VA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changePrimaryKeyInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,YA,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedPrimaryKey),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.primaryKeyList)}}function $A(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",142),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(2),e.Oqu(t)}}function KA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changeJoinTypeInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,$A,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("value",t.selectedMergeType),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",o.joinType)}}function WA(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",233),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.fileName),e.xp6(2),e.Oqu(t.fileName)}}function zA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changeSecondaryTableInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,WA,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedForeignTable),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.foreignTableList)}}function GA(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",234),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.columnName),e.xp6(2),e.Oqu(t.columnName)}}function XA(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changeSecondaryKeyInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,GA,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedForeignKey),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.foreignKeyList)}}function jA(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",230),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.fileName),e.xp6(2),e.Oqu(t.fileName)}}function ey(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changePrimaryTableInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,jA,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedSecondaryTable),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.secondaryTableList)}}function ty(n,r){if(1&n&&(e.TgZ(0,"option",102)(1,"a",235),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.Q6J("value",t.columnName),e.xp6(2),e.Oqu(t.columnName)}}function ny(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"select",231),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(2).changePrimaryKeyInDS(i,d,s,l,_)}),e.TgZ(2,"option",140),e._uU(3),e._UZ(4,"span",141),e.qZA(),e.YNc(5,ty,3,2,"option",97),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t.selectedSecondaryKey),e.xp6(2),e.Oqu(t.optionValue),e.xp6(2),e.Q6J("ngForOf",t.secondaryKeyList)}}function iy(n,r){if(1&n&&(e.ynx(0),e.YNc(1,HA,6,3,"ng-container",7),e.YNc(2,VA,6,3,"ng-container",7),e.YNc(3,KA,6,3,"ng-container",7),e.YNc(4,zA,6,3,"ng-container",7),e.YNc(5,XA,6,3,"ng-container",7),e.YNc(6,ey,6,3,"ng-container",7),e.YNc(7,ny,6,3,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","select Primary Table"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Primary Key"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Join Type"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Foreign Table"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Foreign Key"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Secondary Table"==t.optionValue),e.xp6(1),e.Q6J("ngIf","select Secondary Key"==t.optionValue)}}function oy(n,r){if(1&n&&(e.ynx(0),e.YNc(1,iy,8,7,"ng-container",6),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t.pkFKs)}}function ry(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",206)(2,"div",225)(3,"div",208)(4,"h4",209),e._uU(5,"Save Dataset "),e.TgZ(6,"button",226),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetPopup=!1}),e.TgZ(7,"span",227),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form")(10,"div",211),e.YNc(11,oy,2,1,"ng-container",6),e.qZA(),e.TgZ(12,"div",214)(13,"button",228),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetDropdowns()}),e._uU(14,"Save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.dropDownsInDS)}}function ay(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",236)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"View Script"),e.qZA()(),e.TgZ(6,"form",210),e._UZ(7,"textarea",237),e.qZA(),e.TgZ(8,"div",214)(9,"button",217),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.updateScriptByDatasetId(i.viewscriptForm)}),e._uU(10,"Save"),e.qZA(),e.TgZ(11,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptPopup=!1}),e._uU(12,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.viewscriptForm)}}function sy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",236)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"Uplaod Script"),e.qZA()(),e.TgZ(6,"form",210),e._UZ(7,"input",238)(8,"textarea",239),e.qZA(),e.TgZ(9,"div",214)(10,"button",217),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetApi()}),e._uU(11,"Save"),e.qZA(),e.TgZ(12,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQLPopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.sqlScriptForm)}}function ly(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",236)(2,"div",207)(3,"div",208)(4,"h4",209),e._uU(5,"Uplaod Script"),e.qZA()(),e.TgZ(6,"form",210),e._UZ(7,"input",238)(8,"textarea",239),e.qZA(),e.TgZ(9,"div",214)(10,"button",11),e._uU(11,"Save"),e.qZA(),e.TgZ(12,"button",216),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadPhytonPopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.sqlScriptForm)}}let cy=(()=>{class n{constructor(t,o,i,a,s,l,c,d){this.formBuilder=t,this.toast=o,this.loader=i,this.fb=a,this.popup=s,this.renderer=l,this.solService=c,this.dialog=d,this.submited=!1,this.submit=!1,this.fileListt=[],this.sortedList=[],this.sortedCheckedList=[],this.mergeCheckedList=[],this.appendUnchechedList=[],this.enableDataSetPopUp=!1,this.datasetDetailsList=[],this.createExpressionList=[],this.filesList=[],this.columnsArr=[],this.showUploadFilesTab=!1,this.masterSelected=!1,this.tabs=[{id:0,value:"Upload Files",isActive:!0},{id:1,value:"Filtered FIles",isActive:!1},{id:2,value:"Append",isActive:!1},{id:3,value:"Join",isActive:!1},{id:4,value:"Target Files",isActive:!1},{id:5,value:"Data Modelling",isActive:!1}],this.enableAppendNamePopup=!1,this.enableMergeNamePopup=!1,this.enableUploadPhytonPopup=!1,this.submitted=!1,this.submittedErrorMsg="",this.targetFileRowEdit=-1,this.hideCreateIdenticalBtnWithLength=!0,this.hideCreateIdenticalBtn=!0,this.selectedM_A_S=[],this.showTargetFilePopup=!1,this.cursorPosition=0,this.appendNameControl=new w.NI(null),this.opearatorList=[{id:0,value:"AND"},{id:1,value:"OR"}],this.signOperatorList=[],this.isOpenAccordion=!1,this.messages=[{Fueling_Position:"Conditional Functions",Components:[{Component:"IF c THEN t ELSE f ENDIF"},{Component:"IF c THEN t ELSEIF c2 THEN t2 ELSE f ENDIF"},{Component:"IIF(bool, x, y)"},{Component:"NOT(<logical>)"},{Component:"AND(<logical1>,<logical2>)"},{Component:"OR(<logical1>,<logical2>)"},{Component:"IFERROR(value, value_if_error)"},{Component:"Switch(Value,Default,Case1,Result1,...,CaseN,ResultN)"}]},{Fueling_Position:"Conversion",Components:[{Component:"BinToInt(s)"},{Component:"CharFromInt(x)"},{Component:"CharToInt(s)"},{Component:"ConvertFromCodePage(s, codePage)"},{Component:"ConvertToCodePage(s, codePage)"},{Component:"HexToNumber(x)"},{Component:"IntToBin(x)"},{Component:"IntToHex(x)"},{Component:"ToNumber(x, [bIgnoreErrors], [keepNulls], [decimalSeparator])"},{Component:"ToString(x, numDec, [addThousandsSeparator], [decimalSeparator])"}]},{Fueling_Position:"DateTime",Components:[{Component:"DateTimeAdd"},{Component:"DateTimeDay"},{Component:"DateTimeDiff"},{Component:"DateTimeFirstOfMonth"},{Component:"DateTimeFormat"},{Component:"DateTimeHour"},{Component:"DateTimeLastOfMonth"},{Component:"DateTimeMinutes"},{Component:"DateTimeMonth"},{Component:"DateTimeNow"},{Component:"DateTimeParse"},{Component:"DateTimeSeconds"},{Component:"DateTimeStart"},{Component:"DateTimeToday"},{Component:"DateTimeToLocal"},{Component:"DateTimeToUTC"},{Component:"DateTimeTrim"},{Component:"DateTimeYear"},{Component:"ToDate"},{Component:"ToDateTime"}]},{Fueling_Position:"File",Components:[{Component:"FileAddPaths"},{Component:"FileExists"},{Component:"FileGetDir"},{Component:"FileGetExt"},{Component:"FileGetFileName"}]},{Fueling_Position:"Finance",Components:[{Component:"FinanceCAGR"},{Component:"FinanceEffectiveRate"},{Component:"FinanceFV"},{Component:"FinanceFVSchedule"},{Component:"FinanceIRR"},{Component:"FinanceMIRR"},{Component:"FinanceMXIRR"},{Component:"FinanceNominalRate"},{Component:"FinanceNPER"},{Component:"FinanceNPV"},{Component:"FinancePMT"},{Component:"FinancePV"},{Component:"FinanceRate"},{Component:"FinanceXIRR"},{Component:"FinanceXNPV"}]},{Fueling_Position:"Math",Components:[{Component:"ABS"},{Component:"ACOS"},{Component:"ASIN"},{Component:"ATAN"},{Component:"ATAN2"},{Component:"Average"},{Component:"CEIL"},{Component:"COS"},{Component:"COSH"},{Component:"EXP"},{Component:"FLOOR"},{Component:"LOG"},{Component:"LOG10"},{Component:"Median"},{Component:"Mod"},{Component:"PI"},{Component:"POW"},{Component:"RAND"},{Component:"RandInt"},{Component:"Round"},{Component:"SIN"},{Component:"SINH"},{Component:"SmartRound"},{Component:"SQRT"},{Component:"TAN"},{Component:"TANH"}]},{Fueling_Position:"Math: Bitwise",Components:[{Component:"BinaryAnd"},{Component:"BinaryNot"},{Component:"BinaryOr"},{Component:"BinaryXOR"},{Component:"ShiftLeft"},{Component:"ShiftRight"}]},{Fueling_Position:"Min/Max",Components:[{Component:"Bound"},{Component:"Max"},{Component:"MaxIDX"},{Component:"Min"},{Component:"MinIDX"}]},{Fueling_Position:"Operators",Components:[{Component:"Block Comment(/* */)"},{Component:"Single Line Comment(//)"},{Component:"Addition"},{Component:"Boolean AND &&"},{Component:"Boolean AND - Keyword"},{Component:"Boolean NOT !"},{Component:"Boolean OR - Keyword"},{Component:"Boolean OR ||"},{Component:"Close Parenthesis)"},{Component:"Division"},{Component:"Equal To"},{Component:">: Greater Than"},{Component:">=: Greater Than Or Equal To"},{Component:"<: Less Than"},{Component:"<=: Less Than Or Equal"},{Component:"Multiplication"},{Component:"Not Equal To"},{Component:"Open Parenthesis"},{Component:"Subtraction"},{Component:"Value IN (...) - Keyword"},{Component:"Value NOT IN (...) - Keyword"}]},{Fueling_Position:"Spatial",Components:[{Component:"ST_Area"},{Component:"ST_Boundary"},{Component:"ST_BoundingRectangle"},{Component:"ST_Centroid"},{Component:"ST_CentroidX"},{Component:"ST_CentroidY"},{Component:"ST_Combine"},{Component:"ST_Contains"},{Component:"ST_ConvexHull"},{Component:"ST_CreateLine"},{Component:"ST_CreatePoint"},{Component:"ST_CreatePolygon"},{Component:"ST_Cut"},{Component:"ST_Dimension"},{Component:"ST_Distance"},{Component:"ST_EndPoint"},{Component:"ST_Intersection"},{Component:"ST_Intersects"},{Component:"ST_InverseIntersection"},{Component:"ST_Length"},{Component:"ST_MD5"},{Component:"ST_MaxX"},{Component:"ST_MaxY"},{Component:"ST_MinX"},{Component:"ST_MinY"},{Component:"ST_NumParts"},{Component:"ST_NumPoints"},{Component:"ST_ObjectType"},{Component:"ST_PointN"},{Component:"ST_RandomPoint"},{Component:"ST_Relate"},{Component:"ST_StartPoint"},{Component:"ST_Touches"},{Component:"ST_TouchesOrIntersects"},{Component:"ST_Within"}]},{Fueling_Position:"Specialized",Components:[{Component:"EscapeXMLMetacharacters"},{Component:"GetVal"},{Component:"GetEnvironmentVariable"},{Component:"NULL"},{Component:"RangeMedian"},{Component:"ReadRegistryString"},{Component:"Soundex_Digits"},{Component:"TOPNIDX"},{Component:"UrlEncode"},{Component:"Message"},{Component:"Soundex"}]},{Fueling_Position:"String",Components:[{Component:"Contains"},{Component:"CountWords"},{Component:"DecomposeUnicodeForMatch"},{Component:"EndsWith"},{Component:"FindString"},{Component:"GetWord"},{Component:"Left"},{Component:"Length"},{Component:"LowerCase"},{Component:"MD5_ASCII"},{Component:"MD5_UNICODE"},{Component:"MD5_UTF8"},{Component:"PadLeft"},{Component:"PadRight"},{Component:"REGEX_CountMatches"},{Component:"REGEX_Match"},{Component:"REGEX_Replace"},{Component:"Replace"},{Component:"ReplaceChar"},{Component:"ReplaceFirst"},{Component:"ReverseString"},{Component:"Right"},{Component:"StartsWith"},{Component:"STRCSPN"},{Component:"StripQuotes"},{Component:"STRSPN"},{Component:"Substring"},{Component:"TitleCase"},{Component:"Trim"},{Component:"TrimLeft"},{Component:"TrimRight"},{Component:"UpperCase"},{Component:"UuidCreate"}]},{Fueling_Position:"Test",Components:[{Component:"CompareDictionary"},{Component:"CompareDigits"},{Component:"CompareEpsilon"},{Component:"IsEmpty"},{Component:"IsInteger"},{Component:"IsNull"},{Component:"IsNumber"},{Component:"IsSpatialObj"},{Component:"IsString"}]}],this.tableData=new Ne.by(this.messages),this.appendListInMCL=[],this.appendListInSCL=[],this.sheetsListInSCL=[],this.allExpandState=!1,this.panelOpenState=!1,this.dataType=["Int","Float","Char","Varchar","Date time","Money","Text"],this.dataTypee=[{id:0,value:"Int"},{id:1,value:"Float"},{id:2,value:"Char"},{id:3,value:"Varchar"},{id:4,value:"Text"},{id:5,value:"Money"},{id:6,value:"DateTime"}],this.dateTimeFormats=[{id:0,value:"M/dd/yyyy"},{id:1,value:"M-dd-yyyy"},{id:2,value:"MM/dd/yyyy"},{id:3,value:"MM-dd-yyyy"},{id:4,value:"dd/MM/yyyy"},{id:5,value:"dd-MM-yyyy"},{id:6,value:"yyyy/MM/dd"},{id:7,value:"yyyy-MM-dd"},{id:8,value:"yyyy/dd/MM"},{id:9,value:"yyyy-dd-MM"},{id:10,value:"dd-M-yyyy"},{id:11,value:"dd/M/yyyy"}],this.joinType=["Inner Join","Left Join","Outer Join","Full Join","Cross Join"],this.unCheckedListAddToMergeList=[],this.targetFilesCheckedList=[],this.allDatasetDetailsList=[],this.enableUploadSQLPopup=!1,this.messagesSearch=[{Fueling_Position:"Conditional Functions",Components:[{Component:"IF c THEN t ELSE f ENDIF"},{Component:"IF c THEN t ELSEIF c2 THEN t2 ELSE f ENDIF"},{Component:"IIF(bool, x, y)"},{Component:"NOT(<logical>)"},{Component:"AND(<logical1>,<logical2>)"},{Component:"OR(<logical1>,<logical2>)"},{Component:"IFERROR(value, value_if_error)"},{Component:"Switch(Value,Default,Case1,Result1,...,CaseN,ResultN)"}]},{Fueling_Position:"Conversion",Components:[{Component:"BinToInt(s)"},{Component:"CharFromInt(x)"},{Component:"CharToInt(s)"},{Component:"ConvertFromCodePage(s, codePage)"},{Component:"ConvertToCodePage(s, codePage)"},{Component:"HexToNumber(x)"},{Component:"IntToBin(x)"},{Component:"IntToHex(x)"},{Component:"ToNumber(x, [bIgnoreErrors], [keepNulls], [decimalSeparator])"},{Component:"ToString(x, numDec, [addThousandsSeparator], [decimalSeparator])"}]},{Fueling_Position:"DateTime",Components:[{Component:"DateTimeAdd"},{Component:"DateTimeDay"},{Component:"DateTimeDiff"},{Component:"DateTimeFirstOfMonth"},{Component:"DateTimeFormat"},{Component:"DateTimeHour"},{Component:"DateTimeLastOfMonth"},{Component:"DateTimeMinutes"},{Component:"DateTimeMonth"},{Component:"DateTimeNow"},{Component:"DateTimeParse"},{Component:"DateTimeSeconds"},{Component:"DateTimeStart"},{Component:"DateTimeToday"},{Component:"DateTimeToLocal"},{Component:"DateTimeToUTC"},{Component:"DateTimeTrim"},{Component:"DateTimeYear"},{Component:"ToDate"},{Component:"ToDateTime"}]},{Fueling_Position:"File",Components:[{Component:"FileAddPaths"},{Component:"FileExists"},{Component:"FileGetDir"},{Component:"FileGetExt"},{Component:"FileGetFileName"}]},{Fueling_Position:"Finance",Components:[{Component:"FinanceCAGR"},{Component:"FinanceEffectiveRate"},{Component:"FinanceFV"},{Component:"FinanceFVSchedule"},{Component:"FinanceIRR"},{Component:"FinanceMIRR"},{Component:"FinanceMXIRR"},{Component:"FinanceNominalRate"},{Component:"FinanceNPER"},{Component:"FinanceNPV"},{Component:"FinancePMT"},{Component:"FinancePV"},{Component:"FinanceRate"},{Component:"FinanceXIRR"},{Component:"FinanceXNPV"}]},{Fueling_Position:"Math",Components:[{Component:"ABS"},{Component:"ACOS"},{Component:"ASIN"},{Component:"ATAN"},{Component:"ATAN2"},{Component:"Average"},{Component:"CEIL"},{Component:"COS"},{Component:"COSH"},{Component:"EXP"},{Component:"FLOOR"},{Component:"LOG"},{Component:"LOG10"},{Component:"Median"},{Component:"Mod"},{Component:"PI"},{Component:"POW"},{Component:"RAND"},{Component:"RandInt"},{Component:"Round"},{Component:"SIN"},{Component:"SINH"},{Component:"SmartRound"},{Component:"SQRT"},{Component:"TAN"},{Component:"TANH"}]},{Fueling_Position:"Math: Bitwise",Components:[{Component:"BinaryAnd"},{Component:"BinaryNot"},{Component:"BinaryOr"},{Component:"BinaryXOR"},{Component:"ShiftLeft"},{Component:"ShiftRight"}]},{Fueling_Position:"Min/Max",Components:[{Component:"Bound"},{Component:"Max"},{Component:"MaxIDX"},{Component:"Min"},{Component:"MinIDX"}]},{Fueling_Position:"Operators",Components:[{Component:"Block Comment(/* */)"},{Component:"Single Line Comment(//)"},{Component:"Addition"},{Component:"Boolean AND &&"},{Component:"Boolean AND - Keyword"},{Component:"Boolean NOT !"},{Component:"Boolean OR - Keyword"},{Component:"Boolean OR ||"},{Component:"Close Parenthesis)"},{Component:"Division"},{Component:"Equal To"},{Component:">: Greater Than"},{Component:">=: Greater Than Or Equal To"},{Component:"<: Less Than"},{Component:"<=: Less Than Or Equal"},{Component:"Multiplication"},{Component:"Not Equal To"},{Component:"Open Parenthesis"},{Component:"Subtraction"},{Component:"Value IN (...) - Keyword"},{Component:"Value NOT IN (...) - Keyword"}]},{Fueling_Position:"Spatial",Components:[{Component:"ST_Area"},{Component:"ST_Boundary"},{Component:"ST_BoundingRectangle"},{Component:"ST_Centroid"},{Component:"ST_CentroidX"},{Component:"ST_CentroidY"},{Component:"ST_Combine"},{Component:"ST_Contains"},{Component:"ST_ConvexHull"},{Component:"ST_CreateLine"},{Component:"ST_CreatePoint"},{Component:"ST_CreatePolygon"},{Component:"ST_Cut"},{Component:"ST_Dimension"},{Component:"ST_Distance"},{Component:"ST_EndPoint"},{Component:"ST_Intersection"},{Component:"ST_Intersects"},{Component:"ST_InverseIntersection"},{Component:"ST_Length"},{Component:"ST_MD5"},{Component:"ST_MaxX"},{Component:"ST_MaxY"},{Component:"ST_MinX"},{Component:"ST_MinY"},{Component:"ST_NumParts"},{Component:"ST_NumPoints"},{Component:"ST_ObjectType"},{Component:"ST_PointN"},{Component:"ST_RandomPoint"},{Component:"ST_Relate"},{Component:"ST_StartPoint"},{Component:"ST_Touches"},{Component:"ST_TouchesOrIntersects"},{Component:"ST_Within"}]},{Fueling_Position:"Specialized",Components:[{Component:"EscapeXMLMetacharacters"},{Component:"GetVal"},{Component:"GetEnvironmentVariable"},{Component:"NULL"},{Component:"RangeMedian"},{Component:"ReadRegistryString"},{Component:"Soundex_Digits"},{Component:"TOPNIDX"},{Component:"UrlEncode"},{Component:"Message"},{Component:"Soundex"}]},{Fueling_Position:"String",Components:[{Component:"Contains"},{Component:"CountWords"},{Component:"DecomposeUnicodeForMatch"},{Component:"EndsWith"},{Component:"FindString"},{Component:"GetWord"},{Component:"Left"},{Component:"Length"},{Component:"LowerCase"},{Component:"MD5_ASCII"},{Component:"MD5_UNICODE"},{Component:"MD5_UTF8"},{Component:"PadLeft"},{Component:"PadRight"},{Component:"REGEX_CountMatches"},{Component:"REGEX_Match"},{Component:"REGEX_Replace"},{Component:"Replace"},{Component:"ReplaceChar"},{Component:"ReplaceFirst"},{Component:"ReverseString"},{Component:"Right"},{Component:"StartsWith"},{Component:"STRCSPN"},{Component:"StripQuotes"},{Component:"STRSPN"},{Component:"Substring"},{Component:"TitleCase"},{Component:"Trim"},{Component:"TrimLeft"},{Component:"TrimRight"},{Component:"UpperCase"},{Component:"UuidCreate"}]},{Fueling_Position:"Test",Components:[{Component:"CompareDictionary"},{Component:"CompareDigits"},{Component:"CompareEpsilon"},{Component:"IsEmpty"},{Component:"IsInteger"},{Component:"IsNull"},{Component:"IsNumber"},{Component:"IsSpatialObj"},{Component:"IsString"}]}],this.placetable="Select Primary Table",this.fx=[],this.appendFiles=[],this.mergeList=[],this.selectedColumnsOfDS=[],this.saveDataSetPopup=!1,this.dropDownsInDS=[],this.textAreaIndexinCE={},this.AJFDlist=[],this.aJFDAllFilesList=[],this.fileListtt=[],this.templatesMergeObj={},this.mergeCheckedListForDM=[],this.secndAPIResp={},this.isUploadFilesNextBtnEnable=!1,this.showTargetFilesColumnss=[],this.viewScriptFromApi="",this.enableViewScriptPopup=!1,this.appendAPIResp={}}ngOnInit(){this.joinSetForm=this.formBuilder.group({Merg:this.formBuilder.array([])}),this.process={processId:"3900A4B8-4A36-4619-B8E1-2EED5A4C03E4"},this.appendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.joinForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.displayedRows$=(0,xt.of)(this.messages),this.createExpressionList=[],this.invoiceForm1=this.fb.group({DRows1:this.fb.array([])}),this.viewscriptForm=this.fb.group({sqlScript:[""],datasetId:[""]}),this.sqlScriptForm=this.fb.group({datasetName:[""],sqlScript:[""]}),console.log(this.joinSetForm)}Merg(){return this.formBuilder.group({tableControl:this.formBuilder.array([])})}addTable(){return this.formBuilder.group({table1:["",w.kI.required],join:["",w.kI.required],table2:["",w.kI.required],column:this.formBuilder.array([])})}addColumn(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}MergeArr(){return this.joinSetForm.get("Merg")}TableArr(t){return this.MergeArr().controls[t].get("tableControl")}columnArr(t,o){return this.TableArr(t).controls[o].get("column")}addMergeJoin(){this.MergeArr().push(this.Merg());let t=this.MergeArr().length;this.TableArr(t-1).push(this.addTable());let o=this.TableArr(t-1).length;this.columnArr(t-1,o-1).push(this.addColumn())}addTableJoins(t){this.TableArr(t).push(this.addTable());let o=this.TableArr(t).length;this.columnArr(t,o-1).push(this.addColumn())}addColumnJoin(t,o){this.columnArr(t,o).push(this.addColumn())}removeTable(t,o){this.TableArr(t).removeAt(o)}removeCol(t,o,i){this.columnArr(t,o).removeAt(i)}ngAfterViewInit(){}isValidName(){return t=>{var o;let i=!0;return""==(null===(o=this.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value)&&(i=!1),(0,xt.of)(i?null:{invalid:!0})}}isAllSelectedUploadFiles(){let t=1;this.fileListt.forEach(o=>{o.totalSheetList.forEach(i=>{0!=i.isSheetSelected||(t=0)})}),this.masterSelected=0!=t,this.nextBtnEnableInUF()}changePrimaryTable(t,o,i){let a=t.target.value,l="";l=i.mergeList.filter(_=>_.showAppendName==a)[0].tableList[0].templateId;let d=i.templatesMergeList[i.pkFkMergeTypeList[o].order-1];if(0==o){let u=i.mergeList.filter(m=>m.showAppendName==a)[0].columnList.map(m=>m.columnName);i.pkFkMergeTypeList[0].selectedPrimaryTable=a,i.pkFkMergeTypeList[0].primaryTemplateId=l,i.pkFkMergeTypeList[1].primaryKeyList=u;let f=JSON.parse(JSON.stringify(i.showMergeSheetNames));f.forEach((m,h)=>{m==a&&f.splice(h,1)}),i.pkFkMergeTypeList[3].foreignTableList=f,d.primaryTemplateId=l,a.includes("-")||(d.primaryTableName=a)}if(3==o){i.pkFkMergeTypeList[o].selectedForeignTable=a;const u=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.columnName);i.pkFkMergeTypeList[4].foreignKeyList=u,i.pkFkMergeTypeList[o].secondaryTemplateId=l,d.secondaryTemplateId=l,a.includes("-")||(d.secondaryTableName=a)}if(4==o&&(console.log("unnecessary"),i.pkFkMergeTypeList[4].selectedForeignKey=a),o>5){i.pkFkMergeTypeList[o].selectedForeignTable=a;const u=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.columnName);i.pkFkMergeTypeList[o+1].foreignKeyList=u,i.pkFkMergeTypeList[o].secondaryTemplateId=l,d.secondaryTemplateId=l}}changeSecondaryTable(t,o,i){const a=t.target.value;i.pkFkMergeTypeList[o].selectedSecondaryTable=a;const l=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.columnName);i.pkFkMergeTypeList[o+1].secondaryKeyList=l;let d="";d=i.mergeList.filter(f=>f.showAppendName==a)[0].tableList[0].templateId,i.pkFkMergeTypeList[o].primaryTemplateId=d;let u=i.templatesMergeList[i.pkFkMergeTypeList[o].order-1];u.primaryTemplateId=d,a.includes("-")||(u.primaryTableName=a)}changeSecondaryKey(t,o,i){i.pkFkMergeTypeList[o].selectedSecondaryKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedSecondaryTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.columnName==t.target.value),i.pkFkMergeTypeList[o].primaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].primaryKeyId=l[0].columnId}changePrimaryKey(t,o,i){i.pkFkMergeTypeList[o].selectedPrimaryKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedPrimaryTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.columnName==t.target.value),i.pkFkMergeTypeList[o].primaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].primaryKeyId=l[0].columnId}changeForeignKey(t,o,i){i.pkFkMergeTypeList[o].selectedForeignKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedForeignTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.columnName==t.target.value),i.pkFkMergeTypeList[o].secondaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].secondaryKeyId=l[0].columnId}changeMergeType(t,o,i){const a=t.target.value;i.pkFkMergeTypeList[o].selectedMergeType=a,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].joinType=a.slice(0,1)}checkUncheckAllUploadFiles(){this.fileListt.forEach(t=>{var o;null===(o=null==t?void 0:t.totalSheetList)||void 0===o||o.forEach(i=>{i.isSheetSelected=this.masterSelected})}),this.nextBtnEnableInUF()}getAllFunctions(){this.solService.getAllFunctions().subscribe(t=>{this.fx=t.responseData,console.log(t),this.loader.hide()},t=>{this.loader.hide()})}saveiputFiles(t){this.showUploadFilesTab=!0;let o=this.process.processId;const i=new FormData;i.append("processId",o);for(let a=0;a<t.target.files.length;a++)i.append("file",t.target.files[a]);for(let a=0;a<t.target.files.length;a++)this.fileListt.push({fileName:t.target.files[a].name.split(".").slice(0,-1).join("."),isProgressBar:!0});this.solService.postInputFiles(i).subscribe(a=>{if(200==a.statusCode){const s=JSON.parse(a.responseData.sheetMetaData);s.forEach(l=>{l.fileExtention=l.fileName.split(".").slice(1,2).join(""),l.fileName=l.fileName.split(".").slice(0,-1).join("."),l.totalSheetList.forEach(c=>{c.isSheetSelected=!1;const d=c.sheetName;c.sheet.forEach(_=>{_.isChecked=!1,_.tableName=c.tableName,_.fs_A_JcolName=l.fileName+"-"+d+"["+_.columnName+"]"})})}),this.fileListt=s,console.log(this.fileListt)}})}addOpearatorValueFields(t,o){o.whereList.push({signOperatorList:o.signOperatorList,opearatorList:this.opearatorList,value:""})}delOpearatorValueFields(t,o,i,a){this.createExpressionList[i].whereList.splice(t,1)}changeSignOperator(t,o,i,a,s,l){const c=t.value;"parent"==l?this.createExpressionList[a].signOperator=c:i.signOperator=c}changeOperator(t,o,i,a,s){i.operator=t.value}textAreaSlice(t){const o=this.textAreaIndexinCE.value,i=this.textAreaIndexinCE.cursorPosition,a=[o.slice(0,i),t,o.slice(i)].join("");this.createExpressionList[this.textAreaIndexinCE.index].expression=a}createNewDataSet(){var t;if(this.createExpressionList=[{sourceFieldName:"",columnFormat:"",signOperatorList:"",expression:"",isEdit:!1,selectedDataType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],0==this.datasetDetailsList.filter(o=>{var i;return o.datasetName==(null===(i=this.appendNameControl)||void 0===i?void 0:i.value.trim())}).length){this.enableDataSetPopUp=!1;const o={isDatasetTableExpand:!0,having:null,groupBytoDB:"",orderBytoDB:"",datasetName:null===(t=this.appendNameControl)||void 0===t?void 0:t.value.trim(),datasetFieldDTOList:[],orderBy:[],groupBy:[]};this.datasetDetailsList.push(o)}}saveDataSetDropdowns(){this.saveDataSetApi()}saveDataSet(t,o){if(this.selectedColumnsOfDS=[],null==t||t.datasetFieldDTOList.forEach(i=>{var a;const s=i.sourceFieldName.trim();if(s.includes("[")){const l=s.split(/[[]+/),c=l[0];l[1].slice(0,-1),null===(a=this.AJFDlist)||void 0===a||a.forEach(_=>{c==_.fileName&&0==this.selectedColumnsOfDS.filter(u=>u.fileName==c).length&&this.selectedColumnsOfDS.push(_)})}}),this.selectedColumnsOfDS.length<2)"source file"==this.selectedColumnsOfDS[0].fileType&&(t.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].tableList[0].templateId}]),this.saveDataSetApi();else{if(null==t.pkFKs){const i=[{type:null,primaryTableList:this.selectedColumnsOfDS,selectedPrimaryTable:"",optionValue:"select Primary Table",order:1},{type:null,primaryKeyList:[],selectedPrimaryKey:"",optionValue:"select Primary Key",order:1},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:1},{type:null,foreignTableList:[],selectedForeignTable:"",optionValue:"select Foreign Table",order:1},{type:null,foreignKeyList:[],selectedForeignKey:"",optionValue:"select Foreign Key",order:1}],a=[{order:1}];for(let s=2;s<this.selectedColumnsOfDS.length;s++)i.push({type:null,secondaryTableList:[],selectedSecondaryTable:"",optionValue:"select Secondary Table",order:s},{type:null,secondaryKeyList:[],selectedSecondaryKey:"",optionValue:"select Secondary Key",order:s},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:s},{type:null,foreignTableList:[],selectedForeignTable:"",optionValue:"select Foreign Table",order:s},{type:null,foreignKeyList:[],selectedForeignKey:"",optionValue:"select Foreign Key",order:s}),a.push({order:s});t.pkFKs=i,t.dataSetMergeListDTOs=a}this.dropDownsInDS=[t],this.saveDataSetPopup=!0}}changePrimaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,u,d=JSON.parse(JSON.stringify(s.pkFKs[0].primaryTableList)),_=null==i.secondaryTableList?[]:JSON.parse(JSON.stringify(i.secondaryTableList));if(l.includes("-")){let m=l.split("-")[0],h=l.split("-")[1];this.fileListt.filter(p=>{p.fileName==m&&(null==p||p.totalSheetList.forEach(g=>{g.sheetName==h&&(c=g.templateId)}))})}else u=0==a?i.primaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType):i.secondaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType),"append file"==u&&(c=this.appendAPIResp.appendSheetList.filter(m=>m.appendName==l)[0].appendID),"join file"==u&&(c=this.mergeCheckedList.filter(m=>m.mergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].primaryTableName=l;if(0==a){if(i.primaryTableList.filter(h=>h.fileName==t.target.value),i.selectedPrimaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const h=this.mergeCheckedList.filter(p=>p.mergeName==l);s.pkFKs[a+1].primaryKeyList=h[0].mergeFieldListDTOFromAPI}else{const h=i.primaryTableList.filter(p=>p.fileName==l);s.pkFKs[a+1].primaryKeyList=h[0].columnList}i.primaryTableList.forEach((h,p)=>{h.fileName==l&&d.splice(p,1)}),s.pkFKs[a+3].foreignTableList=d}let f=[];if(a>4){if(i.selectedSecondaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const m=this.mergeCheckedList.filter(h=>h.mergeName==l);s.pkFKs[a+1].secondaryKeyList=m[0].mergeFieldListDTOFromAPI}else{const m=i.secondaryTableList.filter(h=>h.fileName==l);s.pkFKs[a+1].secondaryKeyList=m[0].columnList}d.forEach(m=>{_.map(h=>h.fileName).includes(m.fileName)||f.push(m)}),s.pkFKs[a+3].foreignTableList=f}}changePrimaryKeyInDS(t,o,i,a,s){const l=t.target.value;let d;1==a?(i.selectedPrimaryKey=l,i.primaryKeyList.forEach(_=>{_.columnName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d):(i.selectedSecondaryKey=l,i.secondaryKeyList.forEach(_=>{_.columnName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d)}changeJoinTypeInDS(t,o,i,a,s){const l=t.target.value;i.selectedMergeType=l,s.dataSetMergeListDTOs[i.order-1].joinType=l.slice(0,1)}changeSecondaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,d;if(l.includes("-")){let p=l.split("-")[0],g=l.split("-")[1];this.fileListt.filter(v=>{v.fileName==p&&(null==v||v.totalSheetList.forEach(x=>{x.sheetName==g&&(c=x.templateId)}))})}else d=i.foreignTableList.filter(p=>p.fileName==l).map(p=>p.fileType),"append file"==d&&(c=this.appendAPIResp.appendSheetList.filter(p=>p.appendName==l)[0].appendID),"join file"==d&&(c=this.mergeCheckedList.filter(p=>p.mergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].secondaryTableName=l;if(i.selectedForeignTable=l,i.secondaryTemplateId=c,"join file"==d){const p=this.mergeCheckedList.filter(g=>g.mergeName==l);s.pkFKs[a+1].foreignKeyList=p[0].mergeFieldListDTOFromAPI}else{const p=i.foreignTableList.filter(g=>g.fileName==l);s.pkFKs[a+1].foreignKeyList=p[0].columnList}const m=[...s.pkFKs.filter(p=>p.selectedPrimaryTable).map(p=>p.selectedPrimaryTable),...s.pkFKs.filter(p=>p.selectedForeignTable).map(p=>p.selectedForeignTable)],h=[];s.pkFKs[0].primaryTableList.forEach(p=>{m.includes(p.fileName)&&h.push(p)}),null!=s.pkFKs[a+2]&&(s.pkFKs[a+2].secondaryTableList=h),s.dataSetMergeListDTOs[i.order-1].secondaryTemplateId=c}changeSecondaryKeyInDS(t,o,i,a,s){const l=t.target.value;i.selectedForeignKey=l;const c=i.foreignKeyList.filter(d=>d.columnName==l);i.secondaryKeyId=c[0].columnId,s.dataSetMergeListDTOs[i.order-1].secondaryKeyId=c[0].columnId}accordionFilesRowClicked(t,o,i,a,s){const l="JF"==s?t.mergeName+"["+i.columnName+"]":"AF"==s?t.showAppendName+"["+i.columnName+"]":"SF"==s?i.fileSheet+"["+i.columnName+"]":i.fs_A_JcolName;"textArea"==this.textAreaIndexinCE.tagType&&this.textAreaSlice(l),"input"==this.textAreaIndexinCE.tagType&&(this.createExpressionList[this.textAreaIndexinCE.index].sourceFieldName=l,this.createExpressionList[this.textAreaIndexinCE.index].selectedDataType=i.generatedDataType,this.createExpressionList[this.textAreaIndexinCE.index].sqlColumn=i.sqlColumn)}inputInCreateExpression(t,o){this.createExpressionList[o].sourceFieldName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"input"}}textAreaInCreateExpression(t,o){this.createExpressionList[o].expression=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"textArea"}}createDataSetinDM(){var t;1!=this.datasetDetailsList.filter(i=>1==i.isDatasetTableExpand).length&&(this.enableDataSetPopUp=!0,null===(t=this.appendForm.get("appendNameControl"))||void 0===t||t.reset())}accordionExpValue(t,o){this.textAreaSlice(o),this.isOpenAccordion=!1}changeDTinCreateExpression(t,o){this.createExpressionList[o].selectedDataType=t.value.value,6==t.value.id?(this.createExpressionList[o].isColumnType=!0,this.signOperatorList=[{id:0,value:"NULL"},{id:1,value:"NOT NULL"},{id:2,value:"ON"},{id:3,value:"AFTER (ABSOLUTE)"},{id:4,value:"BEFORE (ABSOLUTE)"},{id:5,value:"AFTER (RELATIVE)"},{id:6,value:"BEFORE (RELATIVE)"},{id:7,value:"NOT"},{id:8,value:"TODAY"},{id:9,value:"YESTERDAY"},{id:10,value:"THIS WEEK"},{id:11,value:"LAST WEEK"},{id:12,value:"THIS MONTH"},{id:12,value:"LAST MONTH"}]):this.createExpressionList[o].isColumnType=!1,(2==t.value.id||3==t.value.id||4==t.value.id||5==t.value.id)&&(this.signOperatorList=[{id:0,value:"NULL"},{id:1,value:"NOT NULL"},{id:2,value:"PRESENT"},{id:3,value:"BLANK"},{id:4,value:"LIKE"},{id:5,value:"NOT LIKE"},{id:6,value:"IS"},{id:7,value:"NOT"},{id:8,value:"STARTS WITH"},{id:9,value:"ENDS WITH"},{id:10,value:"IN"},{id:11,value:"CONTAINS"}]),(0==t.value.id||1==t.value.id)&&(this.signOperatorList=[{id:0,value:"NULL"},{id:1,value:"NOT NULL"},{id:2,value:"IN"},{id:3,value:"="},{id:4,value:"!="},{id:5,value:"&gt;="},{id:6,value:"&gt;"},{id:7,value:"&lt;"},{id:8,value:"&lt;="}]),this.createExpressionList[o].whereList=[]}changeDateTimeinCreateExpression(t,o){this.createExpressionList[o].columnFormat=t.value.value}add_SaveCreateExpression(t){var o,i;let a,s;if(t.sourceFieldName.includes("-")){s=t.sourceFieldName.split("[")[0],a=t.sourceFieldName.split("[")[1].split("]")[0],t.tableNameInDataset=s;const f=s.split("-"),m=f[0],h=f[1],p=this.fileListtt.filter(g=>g.fileName==m);t.tableName=p[0].totalSheetList.filter(g=>g.sheetName==h)[0].tableName,t.fieldName=a}else t.tableName=t.sourceFieldName.split("[")[0];if(""==t.expression||0==(null===(o=t.expression)||void 0===o?void 0:o.length))t.expression=t.sqlColumn;else if(t.expression.includes("-")){let f=t.sourceFieldName.split("[")[0],m=t.sourceFieldName.split("[")[1].split("]")[0];t.tableNameInDataset=f;const h=f.split("-"),p=h[0],g=h[1],v=this.fileListt.filter(b=>b.fileName==p),x=v[0].totalSheetList.filter(b=>b.sheetName==g)[0].tableName,C=v[0].totalSheetList.filter(b=>b.sheetName==g)[0].sheet.filter(b=>b.columnName==m)[0].sqlColumn;t.expression=x+"."+C}if(""!=t.value&&""!=t.signOperator){const f=[t.sqlColumn+" "+t.signOperator+" "+t.value];t.whereList.forEach(m=>{f.push(m.operator+" "+t.sqlColumn+" "+m.signOperator+" "+m.value)}),t.where=f.join(" ")}const c=null===(i=this.datasetDetailsList.filter(f=>1==f.isDatasetTableExpand)[0])||void 0===i?void 0:i.datasetFieldDTOList;this.datasetDetailsList[0].datasetFieldDTOList.map(f=>f.sourceFieldName);let _=this.aJFDAllFilesList.filter(f=>f.fileColumnName==t.sourceFieldName)[0],u={};u=null==_?{fileColumnName:t.sourceFieldName,dbtableColumnName:t.sourceFieldName}:{fileColumnName:_.fileColumnName,dbtableColumnName:_.dbtableColumnName},this.datasetDetailsList[0].orderBy.push(u),this.datasetDetailsList[0].groupBy.push(u),0==(null==c?void 0:c.length)?c.push(t):t.isEdit?c.forEach((f,m)=>{f.isEdit&&(t.isEdit=!1,c.splice(m,1,t))}):c.push(t),this.createExpressionList=[{sourceFieldName:"",expression:"",columnFormat:"",signOperatorList:"",isEdit:!1,selectedDataType:"",where:"",or:"",groupBy:"",value:"",signOperator:"",whereList:[]}]}datasetTableExpand(t,o){this.datasetDetailsList[o].isDatasetTableExpand=!0,t.isDatasetTableExpand=t.isDatasetTableExpand=!0}editRowInDataSet(t,o,i){i.isEdit=!0,this.createExpressionList=[],this.createExpressionList.push(JSON.parse(JSON.stringify(i)))}deleteRowInDataset(t,o,i){var a,s,l;null===(a=this.datasetDetailsList[t])||void 0===a||a.datasetFieldDTOList.splice(o,1),null===(s=this.datasetDetailsList[t])||void 0===s||s.orderBy.forEach((c,d)=>{var _;i.sourceFieldName==c.fileColumnName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.orderBy.splice(d,1))}),null===(l=this.datasetDetailsList[t])||void 0===l||l.groupBy.forEach((c,d)=>{var _;i.sourceFieldName==c.fileColumnName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.groupBy.splice(d,1))})}getAllDataSetNameAPI(){this.solService.getAllDatasetName(this.process.processId).subscribe(t=>{t.responseData.forEach(o=>{o.datasetFieldDTOList.forEach(i=>{i.fs_A_JcolName=o.datasetName+"["+i.fieldName+"]"})}),this.loader.hide()},t=>{this.loader.hide()})}nextBtnEnableInUF(){this.isUploadFilesNextBtnEnable=0==this.fileListt.filter(o=>{var i;return null===(i=o.totalSheetList)||void 0===i?void 0:i.some(a=>1==a.isSheetSelected)}).map(o=>Object.assign({},o,{totalSheetList:o.totalSheetList.filter(i=>1==i.isSheetSelected)})).length}deleteDataSet(t){this.datasetDetailsList.splice(t,1)}aJFDlistForeach(t,o,i){this.AJFDlist.push({fileName:o,columnList:t.columnList,fileType:i,tableList:t.tableList})}changeTabs(t,o){var i,a,s,l,c,d,_,u;if(this.getAllFunctions(),1==t.id){if(this.fileListtt=[],this.nextBtnEnableInUF(),1==this.isUploadFilesNextBtnEnable)return;this.fileListt.forEach(f=>{0!=f.totalSheetList.filter(m=>m.isSheetSelected).length&&this.fileListtt.push(f)})}if(this.submitted=!1,this.submittedErrorMsg="",4==t.id&&(this.loader.show(),this.getAllDataSetNameAPI()),5==t.id){this.mergeCheckedListForDM=[],this.appendListInMCL=[],this.appendListInSCL=[],this.sheetsListInSCL=[],this.selected_filename=null;const f=[];this.mergeCheckedList.forEach(b=>{b.mergeList.filter(M=>!M.showAppendName.join().includes("-")).forEach(M=>{f.push(JSON.parse(JSON.stringify(M)))})});const m=JSON.parse(JSON.stringify(this.sortedCheckedList.filter(b=>!b.showAppendName.join().includes("-")))),h=JSON.parse(JSON.stringify(this.sortedCheckedList.filter(b=>b.showAppendName.join().includes("-"))));let p=h.filter(b=>b.columnList.some(y=>1==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>1==y.isChecked)})),g=h.filter(b=>b.columnList.some(y=>0==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>0==y.isChecked)}));this.sheetsListInSCL=[...p,...g],p=m.filter(b=>b.columnList.some(y=>1==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>1==y.isChecked)})),g=m.filter(b=>b.columnList.some(y=>0==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>0==y.isChecked)})),this.appendListInSCL=[...p,...g],p=f.filter(b=>b.columnList.some(y=>1==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>1==y.isChecked)})),g=f.filter(b=>b.columnList.some(y=>0==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>0==y.isChecked)})),this.appendListInMCL=[...p,...g],p=this.mergeCheckedList.filter(b=>b.columnList.some(y=>1==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>1==y.isChecked)})),g=this.mergeCheckedList.filter(b=>b.columnList.some(y=>0==y.isChecked)).map(b=>Object.assign({},b,{columnList:b.columnList.filter(y=>0==y.isChecked)})),this.mergeCheckedListForDM=[...p,...g],this.AJFDlist=[],this.aJFDAllFilesList=[];const v=JSON.parse(JSON.stringify(this.mergeCheckedList));null==v||v.forEach(b=>{const y=b.mergeName;b.columnList.forEach(M=>M.fileType="join file"),this.AJFDlist.push({fileName:y,columnList:b.columnList,fileType:"join file",tableList:b.mergedTableList}),b.columnList.forEach(M=>{this.aJFDAllFilesList.push(Object.assign(Object.assign({},M),{fileColumnName:y+"["+M.columnName+"]",fileType:"join file",dbtableColumnName:M.tableName+"."+M.sqlColumn,columnList:b.columnList}))})}),null===(i=this.appendListInMCL)||void 0===i||i.forEach(b=>{const y=b.showAppendName.join("");b.columnList.forEach(M=>M.fileType="append file"),this.AJFDlist.push({fileName:y,columnList:b.columnList,fileType:"append file",tableList:b.tableList}),b.columnList.forEach(M=>{this.aJFDAllFilesList.push(Object.assign(Object.assign({},M),{fileColumnName:y+"["+M.columnName+"]",fileType:"append file",dbtableColumnName:M.tableName+"."+M.sqlColumn,columnList:b.columnList}))})});const x=[];null===(a=this.appendListInSCL)||void 0===a||a.forEach(b=>{const y=b.showAppendName.join("");b.columnList.forEach(M=>M.fileType="append file"),this.AJFDlist.push({fileName:y,columnList:b.columnList,fileType:"append file",tableList:b.tableList}),b.columnList.forEach(M=>{this.aJFDAllFilesList.push(Object.assign(Object.assign({},M),{fileColumnName:y+"["+M.columnName+"]",fileType:"append file",dbtableColumnName:M.tableName+"."+M.sqlColumn,columnList:b.columnList}))})}),null===(s=this.appendListInSCL)||void 0===s||s.forEach(b=>{const y=[];b.tableList.forEach(A=>{y.push(A.templateId)});const M={appendName:b.showAppendName.join(),sheets:y};x.push(M)}),null===(l=this.appendListInMCL)||void 0===l||l.forEach(b=>{const y=[];b.tableList.forEach(A=>{y.push(A.templateId)});const M={appendName:b.showAppendName.join(),sheets:y};x.push(M)}),null===(c=this.sheetsListInSCL)||void 0===c||c.forEach(b=>{const y=b.showAppendName.join("");b.columnList.forEach(M=>M.fileType="source file"),this.AJFDlist.push({fileName:y,columnList:b.columnList,fileType:"source file",tableList:b.tableList}),b.columnList.forEach(M=>{this.aJFDAllFilesList.push(Object.assign(Object.assign({},M),{fileColumnName:y+"["+M.columnName+"]",fileType:"source file",dbtableColumnName:M.tableName+"."+M.sqlColumn}))})}),JSON.parse(JSON.stringify(this.allDatasetDetailsList)).forEach(b=>{const y=b.datasetName;this.AJFDlist.push({fileName:y,columnList:b.datasetFieldDTOList,fileType:"dataset file"}),b.datasetFieldDTOList.forEach(M=>{this.aJFDAllFilesList.push(Object.assign(Object.assign({},M),{fileName:y,fileType:"dataset file"}))})})}if("unChedkedList"==o&&0!=(null===(d=this.sortedList[0])||void 0===d?void 0:d.length)&&(this.unCheckedListAddToMergeList=this.sortedList[0].filter(f=>0==f.isSelected),this.unCheckedListAddToMergeList.forEach(f=>{const m=[f].map(v=>[v.fileName,v.sheetName].join("-")),p=[];f.sheet.forEach(v=>{const x=Object.assign(Object.assign({},v),{isChecked:!1,dataType:"Select Data Type",newColumnName:"",isRowEdit:!1,fileSheet:m,tableName:f.tableName});p.push(x)}),this.sortedCheckedList.push({columnList:p,showAppendName:m,fileName_SheetName:m,tableList:[f],isSelected:!1}),this.appendUnchechedList=[],this.appendUnchechedList=JSON.parse(JSON.stringify(this.sortedCheckedList))})),"prevInMerge"==o&&0!=(null===(_=this.sortedList[0])||void 0===_?void 0:_.length)){let f=null===(u=this.sortedList[0])||void 0===u?void 0:u.length;this.sortedCheckedList.splice(this.sortedCheckedList.length-f,this.unCheckedListAddToMergeList.length)}this.tabs.forEach(f=>{f.isActive=t.id==f.id}),this.filesList.forEach(f=>{f.checkedSheetList=f.sheetList.filter(m=>m.isSelected)})}MergeSubmit(){this.loader.show(),console.log(this.joinSetForm.value,this.process.processId);let t={};t.processId=this.process.processId,t.templatesMergeDetailsList=[{}],this.MergeArr().controls.forEach((o,i)=>{console.log(this.mergeCheckedList[i].showMergeName),t.templatesMergeDetailsList[i].mergeName=this.mergeCheckedList[i].showMergeName,t.templatesMergeDetailsList[i].templatesMergeList=[{}],this.TableArr(i).controls.forEach((a,s)=>{console.log(a),t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTemplateId=a.value.table1.templateId,t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTemplateId=a.value.table2.templateId,t.templatesMergeDetailsList[i].templatesMergeList[s].joinType=a.value.join[0],t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTableName="",t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTableName="",t.templatesMergeDetailsList[i].templatesMergeList[s].order=0==s?1:2,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList=[{}],this.columnArr(i,s).controls.forEach((l,c)=>{console.log(l),t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[c].primaryKeyId=l.value.column1.columnId,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[c].secondaryKeyId=l.value.column2.columnId})})}),console.log(t),this.solService.addJoinFiles(t).subscribe(o=>{console.log(o);let i=[];const a=o.responseData.templatesMergeDetailsList;a.forEach(s=>{s.templatesMergeList.forEach(l=>{l.columnArrayList.forEach(c=>{i.push({joinType:l.joinType,primaryTemplateId:l.primaryTemplateId,secondaryTemplateId:l.secondaryTemplateId,primaryKeyId:c.primaryKeyId,secondaryKeyId:c.secondaryKeyId}),this.toast.success({title:"Success",message:"Saved Successfully !"})})}),console.log(i),a.forEach(l=>{this.mergeCheckedList.forEach(c=>{l.mergeName==c.showMergeName&&(c.mergeIdFromAPI=l.mergeId,c.templatesMergeIdsListFromAPI=i,c.mergeFieldListDTOFromAPI=l.mergeFieldListDTO)})})}),this.loader.hide()},o=>{this.loader.hide()})}isAllSelected(t,o,i,a){this.submitted=!1,this.submittedErrorMsg="",this.hideCreateIdenticalBtnWithLength=!0,this.sortedList.forEach((s,l)=>{l==i&&s.forEach((c,d)=>{d==a&&(c.isSelected=t.target.checked)})})}createIdentical(t){var o;if(console.log("index: ",t),-1==t){this.sortedList=this.sortedList.splice(1,1);let i=[];this.fileListtt.forEach(a=>{a.totalSheetList.forEach(s=>{if(s.isSheetSelected){const l=s.sheet.map(d=>d.columnName);let c=Object.assign(Object.assign({fileName:a.fileName,isSelected:!1},s),{[s.sheetName]:s.sheetData,columnNames:l,[s.sheetName+"columnList"]:l});i.push(c)}})}),this.sortedList.push(i)}if(0==t){this.sortedList[t].filter(c=>0==c.isSelected);let a=this.sortedList[t].filter(c=>1==c.isSelected);console.log("checkedList: ",a);let s=[],l=0;if(a.forEach(c=>{const _=c.sheetName;if(console.log("sName: ",_),0==s.length)s=c[_+"columnList"];else{let u=c[_+"columnList"];console.log("columnsList: ",u),s.forEach(f=>{console.log("value: ",f),u.includes(f)||(l=1)})}}),console.log("checkedSheetColumns: ",s),console.log("k==",l),1==l)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");this.enableAppendNamePopup=!0,null===(o=this.appendForm.get("appendNameControl"))||void 0===o||o.reset()}2==t&&(this.appendUnchechedList.forEach(i=>{i.isSelected=!1}),this.sortedCheckedList=this.appendUnchechedList)}join2Sheets(){var t;if(this.sortedCheckedList.filter(i=>1==i.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Please select atleast two sheets");this.enableMergeNamePopup=!0,null===(t=this.joinForm.get("appendNameControl"))||void 0===t||t.reset()}mergeSet(){var t,o;this.submit=!0,this.addMergeJoin(),console.log(this.joinForm);let i=[],a=[];console.log("this.sortedCheckedList: ",this.sortedCheckedList);let s=this.sortedCheckedList.filter(h=>1==h.isSelected);console.log("checkedSortedList: ",s);let l=[],c=[];const d=[];s.forEach(h=>{h.fileName_SheetName.forEach(p=>{l.push(p)}),h.tableList.forEach(p=>{i.push(p)}),h.showAppendName.forEach(p=>{c.push(p)}),h.columnList.forEach(p=>{var g,v;(p=JSON.parse(JSON.stringify(p))).fs_A_JcolName=(null===(g=this.joinForm.get("appendNameControl"))||void 0===g?void 0:g.value.trim())+"["+p.columnName+"]",d.push(Object.assign(Object.assign({},p),{joinName:null===(v=this.joinForm.get("appendNameControl"))||void 0===v?void 0:v.value.trim()}))})}),i.forEach(h=>{a.push({value:h.fileName+" - "+h.sheetName,templateId:h.templateId,sheet:h.sheet,isSelected:!1})}),a.primaryKeyList=[];const _=[{type:null,primaryTableList:c,selectedPrimaryTable:"",optionValue:"select Primary Table",order:1},{type:null,primaryKeyList:[],selectedPrimaryKey:"",optionValue:"select Primary Key",order:1},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:1}];let u={type:null,foreignTableList:[],selectedForeignTable:"",optionValue:"select Foreign Table",order:1};_.push(u),u={},u.type=null,u.foreignKeyList=[],u.selectedForeignKey="",u.optionValue="select Foreign Key",u.order=1,_.push(u);let f=[];f.foreignKeyList=[];let m={dropDownList:[{primaryTableList:a,foreignTableList:f}],columnList:d,mergeList:s,mergeName:null===(t=this.joinForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),mergedTableList:i,showMergeSheetNames:c,pkFkMergeTypeList:_,templatesMergeList:[{order:1,mergeName:null===(o=this.joinForm.get("appendNameControl"))||void 0===o?void 0:o.value.trim()}]};this.mergeCheckedList.push(m),this.enableMergeNamePopup=!1,this.sortedCheckedList.forEach(h=>{h.isSelected=!1}),console.log("joinSetForm after merge: ",this.joinSetForm)}resetMerge(){this.mergeCheckedList=[];const t=this.appendUnchechedList.filter(i=>1==i.isAppend),o=this.appendUnchechedList.filter(i=>null==i.isAppend);if(t.length>0&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),0==t.length&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),o.length>0){const i=o.map(a=>a.tableList[0]);this.sortedList[0]=JSON.parse(JSON.stringify(i))}this.changeTabs({id:3},"unChedkedList"),this.MergeArr().clear()}addAppendName(){if(this.sortedList[0].filter(o=>1==o.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="please select atleast 2 checkboxes");this.createIdentical(0)}createAppendSet(){var t=this;return(0,$e.Z)(function*(){var o;if(t.submited=!0,console.log(t.appendForm),console.log("sortedCheckedList: ",t.sortedCheckedList),t.appendForm.invalid)return;console.log("form validated!");let i=t.sortedList[0].filter(d=>d.isSelected);t.sortedList[0].forEach(d=>d.isSelected=!1);const a=i.map(d=>[d.fileName,d.sheetName].join("-")),l=[];i[0].sheet.forEach(d=>{var _,u,f;(d=JSON.parse(JSON.stringify(d))).fs_A_JcolName=(null===(_=t.appendForm.get("appendNameControl"))||void 0===_?void 0:_.value.trim())+"["+d.columnName+"]";const m=Object.assign(Object.assign({},d),{isChecked:!1,dataType:"Select Data Type",newColumnName:"",isRowEdit:!1,fileSheet:[null===(u=t.appendForm.get("appendNameControl"))||void 0===u?void 0:u.value.trim()],appendName:null===(f=t.appendForm.get("appendNameControl"))||void 0===f?void 0:f.value.trim()});l.push(m)});const c={columnList:l,showAppendName:[null===(o=t.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value.trim()],fileName_SheetName:a,tableList:i,isSelected:!1,isAppend:!0};t.sortedCheckedList.push(c),console.log("sortedCheckedList after: ",t.sortedCheckedList),yield t.saveAppendAPI(t.sortedCheckedList)})()}showTargetFileTableColumns(t,o,i,a){if(this.showTargetFilesColumnss=[],this.selectedM_A_S=[],this.selected_filename=o,this.sortedCheckedList.forEach(s=>{s.tabActiveInTargetFiles=!1}),this.mergeCheckedList.forEach(s=>{s.mergeList.forEach(l=>{l.tabActiveInTargetFiles=!1})}),"sortedCheckedList"==i){if(this.sortedCheckedList.forEach(s=>{s.tabActiveInTargetFiles=s.showAppendName==o}),o.join().includes("-")){const s=o.join().split("-")[1];this.selectedM_A_S=t.tableList[0][s]}else this.appendUnchechedList.filter(l=>l.showAppendName==o.join())[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})});this.showTargetFilesColumnss=t.columnList}"mergeCheckedList"==i&&(t.mergeList.forEach(s=>{s.tabActiveInTargetFiles=s.showAppendName==o}),o.join().includes("-")?t.mergeList.filter(l=>l.fileName_SheetName==o)[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})}):t.mergeList.filter(l=>l.showAppendName==o)[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})}),this.showTargetFilesColumnss=a.columnList),this.preview()}rowEdit(t,o,i){const a=i.fileSheet,l=this.sortedCheckedList.filter(c=>c.showAppendName==a||this.sortedCheckedList.filter(d=>d.showAppendName==a.join()))[0].columnList[t];"edit"==o&&(l.isRowEdit=!0,i.isRowEdit=!0),"checkMark"==o&&(l.isRowEdit=!1,i.isRowEdit=!1,l.newColumnName=l.temporaryColumnName,i.newColumnName=i.temporaryColumnName),"cancel"==o&&(l.temporaryColumnName=l.newColumnName,i.temporaryColumnName=i.newColumnName,i.isRowEdit=!1)}checkedInJoin(t,o,i){this.submitted=!1,this.submittedErrorMsg="",o.isSelected=t.target.checked}changeDataTypeTF(t,o,i){const a=o.fileSheet;this.sortedCheckedList.filter(c=>c.showAppendName==a||this.sortedCheckedList.filter(d=>d.showAppendName==a.join()))[0].columnList[i].dataType=t.target.value,o.dataType=t.target.value}createSecondaryDropdown(t,o){const i=o.pkFkMergeTypeList.length;if(o.pkFkMergeTypeList[i-2].foreignTableList.length<2)return;let a=i/5+1;o.templatesMergeList.push({order:a,mergeName:o.mergeName});let c=[...o.pkFkMergeTypeList.filter(u=>u.selectedPrimaryTable).map(u=>u.selectedPrimaryTable),...o.pkFkMergeTypeList.filter(u=>u.selectedForeignTable).map(u=>u.selectedForeignTable)],d=o.pkFkMergeTypeList[0].primaryTableList;d=d.filter(u=>!c.includes(u)),[{type:null,secondaryTableList:c,selectedSecondaryTable:"",optionValue:"select Secondary Table",order:a},{type:null,secondaryKeyList:[],selectedSecondaryKey:"",optionValue:"select Secondary Key",order:a},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:a},{type:null,foreignTableList:d,selectedForeignTable:"",optionValue:"select Foreign Table",order:a},{type:null,foreignKeyList:[],selectedForeignKey:"",optionValue:"select Foreign Key",order:a}].forEach(u=>{o.pkFkMergeTypeList.push(u)})}saveDataSetApi(){this.loader.show();let t={};if(t.processId=this.process.processId,this.enableUploadSQLPopup)t.datasetName=this.sqlScriptForm.value.datasetName,t.sqlScript=this.sqlScriptForm.value.sqlScript,this.solService.addDataset(t).subscribe(o=>{this.getAllDataSetNameAPI(),this.loader.hide()},o=>{this.loader.hide()});else{const o=[],i=this.datasetDetailsList.filter(a=>a.isDatasetTableExpand);i[0].datasetFieldDTOList.forEach(a=>{o.push({tableName:a.tableName,columnFormat:a.columnFormat,fieldName:a.fieldName,expression:a.expressionToDB,dataType:a.selectedDataType,where:a.where,or:a.or,groupBy:"",sourceFieldName:a.sourceFieldName})}),t.datasetFieldDTOList=o,t.dataSetMergeListDTOs=i[0].dataSetMergeListDTOs,t.datasetName=i[0].datasetName,t.groupBy=i[0].groupBytoDB,t.orderBy=i[0].orderBytoDB,t.having=i[0].having,this.solService.addDataset(t).subscribe(a=>{this.getAllDataSetNameAPI(),this.loader.hide()},a=>{this.loader.hide()}),i[0].isDatasetTableExpand=!1,this.saveDataSetPopup=!1}}callGetViewscript(t){this.loader.show(),this.solService.getViewScript({datasetId:t.datasetId}).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.sqlScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptPopup=!0,this.loader.hide()},i=>{this.loader.hide()})}applyFilter(t){this.messagesSearch=this.messages.filter(o=>this.containsValue(o,t.target.value.trim().toLowerCase()))}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}selectuser(t,o){}groupbyOrderby(){var t;const o=this.datasetDetailsList.filter(i=>1==i.isDatasetTableExpand);this.selectedColumnsOfDS=[],null===(t=o[0])||void 0===t||t.datasetFieldDTOList.forEach(i=>{var a;const s=i.columnName.trim();if(s.includes("[")){const l=s.split(/[[]+/),c=l[0];l[1].slice(0,-1),null===(a=this.AJFDlist)||void 0===a||a.forEach(_=>{c==_.fileName&&0==this.selectedColumnsOfDS.filter(u=>u.fileName==c).length&&this.selectedColumnsOfDS.push(_)})}})}updateScriptByDatasetId(t){this.loader.show();const o={datasetId:t.value.datasetId,newScript:t.value.sqlScript.trim()};this.solService.updateScriptByDatasetId(o).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.newScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.loader.hide()},i=>{this.loader.hide()})}editDatasetFile(t){this.createExpressionList=[{sourceFieldName:"",expression:"",isEdit:!1,selectedDataType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],t.isDatasetTableExpand=!0,this.datasetDetailsList[0]=t}saveAppendAPI(t){var o=this;return(0,$e.Z)(function*(){const i=[];t.forEach(s=>{const l=[];s.tableList.forEach(c=>{l.push({sheetId:c.templateId,fileName:c.fileName})}),i.push({appendDtos:l,appendName:s.showAppendName.join()})}),o.solService.addAppendFiles({processId:o.process.processId,appendSheetList:i}).subscribe(function(){var s=(0,$e.Z)(function*(l){o.appendAPIResp=l.responseData,t.forEach(c=>{c.isPreviewEnable=!0}),o.toast.success({title:"Success",message:"Saved Successfully !"}),o.loader.hide(),o.enableAppendNamePopup=!1,yield o.getAppendFiles()});return function(l){return s.apply(this,arguments)}}(),s=>{o.loader.hide()})})()}getAppendFiles(){var t=this;return(0,$e.Z)(function*(){t.solService.getAppendFiles(t.process.processId).subscribe(o=>{console.log(o),t.appendFiles=o.responseData.appendSheetList})})()}selectPrimaryTable(t,o,i){var a;let l=this.mergeCheckedList[i].dropDownList[o];0==o&&(l.primaryTableList.forEach(c=>c.isSelected=!1),t.value.isSelected=!0,l.foreignTableList=l.primaryTableList.filter(c=>!c.isSelected),l.foreignTableList.foreignKeyList=[],l.primaryTableList.primaryKeyList=[],l.primaryTableList.primaryKeyList.push(t.value.sheet)),console.log(null===(a=this.mergeCheckedList[i])||void 0===a?void 0:a.dropDownList[o])}selectForeignTable(t,o,i){let s=this.mergeCheckedList[i].dropDownList[o];this.mergeCheckedList[i].dropDownList[o].foreignTableList.forEach(d=>d.isSelected=!1),t.value.isSelected=!0,s.foreignTableList.foreignKeyList=[],s.foreignTableList.foreignKeyList.push(t.value.sheet);let l=[],c=[];if(0==o){const d=this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>1==h.isSelected)[0];l.push(d);const _=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>1==h.isSelected)[0];l.push(_),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>0==h.isSelected).forEach(h=>c.push(h)),this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>0==h.isSelected).forEach(h=>c.push(h));let m=[];m=c.filter((h,p,g)=>g.findIndex(v=>["templateId"].every(x=>v[x]===h[x]))===p),m.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:m},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}else{this.mergeCheckedList[i].dropDownList[o].primaryTableList.forEach(f=>l.push(f));const d=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>1==f.isSelected)[0];l.push(d),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>0==f.isSelected).forEach(f=>c.push(f));let u=c.filter((f,m,h)=>h.findIndex(p=>["templateId"].every(g=>p[g]===f[g]))===m);u.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:u},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}console.log(this.mergeCheckedList[i].dropDownList[o+1])}selectPrimarykey(t,o){}selectForeignKey(t,o){}previewPopup(t,o,i,a,s){""!=s||0!=(null==s?void 0:s.length)?(this.loader.show(),this.solService.viewTableDetails(s).subscribe(l=>{this.selectedM_A_S=l.responseData,this.preview(),this.showTargetFilePopup=!0,this.loader.hide()},l=>{this.loader.hide()})):(this.showTargetFilePopup=!0,this.selectedM_A_S=o.sheetData,this.showTargetFilePopup=!0,this.preview())}preview(){for(var t in this.columnsArr=[],this.selectedM_A_S[0])this.selectedM_A_S[0].hasOwnProperty(t)&&this.columnsArr.push(t)}selectgroupByOrderByInDM(t,o,i,a){let l=t.value.map(c=>c.dbtableColumnName).join();"groupby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].groupBytoDB=l),"orderby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].orderBytoDB=l)}executeProject(){this.loader.show(),this.solService.executeProject(this.process.processId).subscribe(t=>{this.loader.hide()},t=>{this.loader.hide()})}deleteTables(t,o,i){console.log("e: ",t),console.log("item: ",o),this.solService.deleteTables({id:o.appendID,type:"append",operation:"delete"}).subscribe(a=>{console.log(a),this.appendFiles.splice(this.appendFiles.findIndex(s=>s.id===o.id),1)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.qu),e.Y36(ti.q),e.Y36(Nn.D),e.Y36(w.qu),e.Y36(Fn.q),e.Y36(e.Qsj),e.Y36(Jt.e),e.Y36(co.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-new-solution2"]],decls:27,vars:16,consts:[[1,"heading"],[2,"margin","0 0 5px"],[2,"color","#0076A8"],[1,"consen"],[2,"padding","10px"],[1,"bttn",2,"display","flex"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","combination",4,"ngIf"],["class","row targetFileRow",4,"ngIf"],["style","float: right;",4,"ngIf"],["mat-button",""],["class","dds-icon dds-icon_chevron_right__l__stroke next",4,"ngIf"],[1,"dds-icon","dds-icon_chevron_right__l__stroke","next"],[1,"row"],["style","float:left ; width:100%",4,"ngIf"],["class","createNewSoltionsTable",4,"ngFor","ngForOf"],[2,"text-align","right","margin","20px 0 0 0"],["mat-button","","class","btnn","style","border:1px solid #0076A8; background: #fff; color: #0076A8;",3,"click",4,"ngIf"],["mat-button","","class","btnn",3,"disabled","click",4,"ngIf"],[2,"float","left","width","100%"],[1,"but"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],[1,"note","required-field"],[1,"header"],[1,"selectCheck"],["type","checkbox","name","list_name","value","m1",3,"ngModel","ngModelChange","change"],[1,"createNewSoltionsTable"],[1,"dds-icon","dds-icon_file_xls__l__filled"],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","ngModelChange","change"],["src","../../../../assets/images/xls_sheet.png","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["src","../../assets/images/loading.gif","alt","","width","20px","height","20px",2,"margin-top","-4px","margin-left","100px"],["mat-button","",1,"btnn",2,"border","1px solid #0076A8","background","#fff","color","#0076A8",3,"click"],["mat-button","",1,"btnn",3,"disabled","click"],[2,"padding-bottom","70px"],[1,"sheet"],[2,"float","right"],[2,"float","right","margin-top","20px"],["mat-button","","class","btnn",3,"click",4,"ngIf"],[2,"padding-left","50px"],[1,"dds-icon","dds-icon_eyeopen",2,"float","right",3,"click"],["mat-button","",1,"btnn",3,"click"],[1,"combination"],["mat-button","","class","btnn","style","margin: 30px;",3,"click",4,"ngIf"],[1,"scroll"],["class","createNewSoltionsTable appendTable",4,"ngIf"],["mat-button","","class","btnn","style","margin: 25px;",3,"click",4,"ngIf"],[1,"createNewSoltionsTable","appendTable"],[2,"padding-left","78px !important"],[2,"padding-left","53px !important"],["class","trrr",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["mat-button","",1,"btnn",2,"margin","30px",3,"disabled","click"],[1,"trrr"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"color","#26890d"],[2,"width","50%"],[1,"error"],["mat-button","",1,"btnn",2,"margin","30px",3,"click"],["colspan","3",2,"text-align","left"],[1,"append"],[2,"padding-left","60px","height","auto","padding","10px 60px","border-bottom","0px none"],["colspan","3",2,"width","50px","vertical-align","baseline","font-weight","bold"],[2,"border-bottom","1px solid"],["style","margin:0 0 5px 0",4,"ngFor","ngForOf"],[2,"width","110px","text-align","center"],[1,"dds-icon","dds-icon_eyeopen"],[1,"dds-icon","dds-icon_delete",3,"click"],[2,"margin","0 0 5px 0"],["mat-button","",1,"btnn",2,"margin","25px",3,"click"],["class","table table-striped createNewSoltionsTable",4,"ngIf"],["mat-button","","class","btnn","style","float: left;",3,"click",4,"ngIf"],[2,"text-align","right"],[1,"table","table-striped","createNewSoltionsTable"],["class","",4,"ngFor","ngForOf"],[1,""],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","change"],[2,"border","1px #000 solid",3,"formGroup"],[1,"row",2,"background-color","#0076A8","color","#fff","width","100%","margin","auto"],[1,"col-md-2",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-3",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-1",2,"font-weight","600","background-color","#0076A8","color","#fff"],["formArrayName","Merg"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"",2,"padding","7px"],["formArrayName","tableControl"],["class","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"",3,"formGroupName"],[1,"col-md-2"],[1,"col-md-3"],["appearance","fill"],["formControlName","table1",1,"form-control",3,"placeholder","selectionChange"],["placeholder","Select Join","formControlName","join",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Foreign Table","formControlName","table2",1,"form-control",3,"selectionChange"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style"," line-height:14px;color: #fff;font-size: 14px;",3,"disabled","click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["formArrayName","column"],[3,"value"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"disabled","click"],["mat-button","",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"selectionChange"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"selectionChange"],[1,"col-md-2",2,"border-bottom","1px solid"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],["mat-button","",1,"btnn",2,"float","left",3,"click"],[1,"container","text-left","scroll"],[1,"table"],[1,"dds-icon","dds-icon_delete"],[1,"row","targetFileRow"],[1,"note","required-field",2,"margin","10px 0 0 0","width","calc(100% - 120px)"],["mat-button","",1,"btnn","preview",3,"click"],[1,"col-md-6","combination",2,"margin-top","0"],["class","table table-striped",4,"ngFor","ngForOf"],[1,"table","table-striped",2,"margin-top","0px"],["class","col-md-6 combination scroll ","style","margin-top:0 ;",4,"ngIf"],[1,"table","table-striped"],["src","../../../../assets/images/merge-icon.png","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["style","width: 1%;border: 0;",3,"active","click",4,"ngIf"],[2,"width","1%","border","0",3,"click"],["mat-raised-button","","matTooltipPosition","right","matTooltipClass","allow-cr","aria-tooltip","Button that displays and hides a tooltip triggered by other buttons",3,"matTooltip"],[1,"dds-icon","dds-icon_info__l__stroke",2,"color","#26890d"],[1,"dds-icon","dds-icon_info__l__stroke",2,"color","#26890d","float","right"],[1,"col-md-6","combination","scroll",2,"margin-top","0"],[1,"table","table-striped",2,"margin-top","15px"],["scope","col",2,"margin","auto","color","#fff","width","10%"],["scope","col",2,"margin","auto","color","#fff","width","25%"],["scope","col",2,"margin","auto","color","#fff","width","20%"],["scope","row",2,"width","10%"],["type","checkbox",3,"ngModel","ngModelChange"],[2,"width","25%"],["mat-raised-button","","matTooltipPosition","above","matTooltipClass","allow-cr","aria-label","Button that displays a tooltip in various positions",3,"matTooltip"],[2,"width","20%"],[1,"dds-icon","dds-icon_chevron_down__l__stroke",3,"change"],["value","","disabled","","selected","","hidden",""],[1,"dds-icon","dds-icon_arrow-down"],["alt","value"],["mat-button","",1,"btnn",2,"margin-left","0px !important",3,"click"],["mat-button","",1,"btnn",2,"width","135px","float","right",3,"click"],[1,"dataModeling"],[1,"col-md-5","combination"],["class","header",4,"ngIf"],["multi","","class","mat-table","is-open","true",4,"ngIf"],["class","mat-table","style","text-align: center; font-size:13px",4,"ngIf"],["class","col-md-7 combination expTable",4,"ngIf"],[2,"text-align","right","float","right"],["mat-button","","class","btnn","routerLink","/user/admin1/powerbi-interface","style","width:140px",4,"ngIf"],["multi","","is-open","true",1,"mat-table"],[3,"expanded","opened","closed",4,"ngFor","ngForOf"],[3,"expanded","opened","closed"],[1,"mat-row"],[3,"click"],[1,"mat-table",2,"text-align","center","font-size","13px"],[1,"dataP"],[1,"rightIcons"],["title","View Dataset",1,"dds-icon","dds-icon_eyeopen",3,"click"],["title","Edit Dataset",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],["title","View Script",1,"dds-icon","dds-icon_file",3,"click"],[1,"col-md-7","combination","expTable"],["class","table table-striped","style","margin-bottom:60px ;",4,"ngFor","ngForOf"],[1,"table","table-striped",2,"margin-bottom","60px"],[2,"width","15%","text-align","left"],["placeholder","Column Name",1,"form-control",3,"value","select","click","keyup"],["placeholder","Select DataType",1,"form-control",3,"selectionChange"],["matInput","",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[2,"vertical-align","top","padding-top","22px"],[1,"dropdown"],["src","../../assets/images/fx.png","alt","","width","15px","height","15px","id","menu",2,"margin-top","-4px",3,"click"],[1,"dropdown-content","scroll"],[1,"search"],["id","form1","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],[2,"width","85%","vertical-align","top"],["cols","20","rows","10","placeholder","Expression","name","Expression","id","",1,"form-control",2,"width","100%",3,"value","select","click","keyup"],[1,"addRow"],["placeholder","Select Opearator",1,"form-control",3,"value","selectionChange"],["placeholder","Value",1,"form-control",3,"ngModel","ngModelChange"],[1,"dds-icon","border","dds-icon_plus__l__stroke",3,"click"],["placeholder","Select DateFormat",1,"form-control",3,"selectionChange"],["style","border-bottom: 1px solid #000; border-radius: 0;padding: 0;",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #000","border-radius","0","padding","0"],["placeholder","Select AND/OR",1,"form-control",3,"value","selectionChange"],["placeholder","Select Operator",1,"form-control",3,"value","selectionChange"],[1,"dds-icon","border","dds-icon_delete__l__stroke",3,"click"],["mat-button","","class","btnn","style","float:right ;",3,"click",4,"ngIf"],["mat-button","",1,"btnn",2,"float","right",3,"click"],[2,"margin","auto"],["colspan","1"],[1,"col-md-3",2,"text-align","right",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke"],[2,"display","flex"],[2,"margin-left","38px"],["matInput","","placeholder","Having",1,"form-control",2,"margin-left","38px",3,"ngModel","ngModelChange"],["multiple","","placeholder","Select groupBy",1,"form-control",3,"selectionChange"],["multiple","","placeholder","Select orderBy",1,"form-control",3,"selectionChange"],[1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],["mat-button","","routerLink","/user/admin1/powerbi-interface",1,"btnn",2,"width","140px"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[3,"formGroup"],[1,"row","popup"],[1,"field"],["type","text","formControlName","appendNameControl",3,"ngClass"],[1,"col-sm-12",2,"float","right","text-align","right"],["mat-button","","type","submit",3,"click"],["mat-button","",2,"color","#0076A8","background","#fff",3,"click"],["mat-button","",3,"click"],[1,"taxt-audit-popup","preview",2,"width","1000px"],[1,"col-sm-3",2,"float","right","text-align","right"],["mat-button","",2,"border","1px solid #0076A8","background","none","color","#0076A8",3,"click"],["style","width:120px; word-break: break-all;",4,"ngFor","ngForOf"],[2,"width","120px","word-break","break-all"],["type","text",3,"formControl"],["mat-button","",2,"background-color","#0076A8","color","white",3,"disabled","click"],[1,"taxt-audit-popup",2,"width","1200px"],[2,"background-color","#0076A8","color","white","float","right",3,"click"],["aria-hidden","true"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],[1,"dds-icon","dds-icon_chevron_down__l__stroke",2,"width","200px","height","45px","margin","10px 20px",3,"value","change"],["alt","pt.fileName"],[1,"dds-icon","dds-icon_chevron_down__l__stroke",2,"width","200px","margin","10px 20px",3,"value","change"],["alt","pt.columnName"],["alt","ft.fileName"],["alt","sk.columnName"],["alt","pk.columnName"],[1,"taxt_audit-report","enableUploadSQLPopup"],["mat-input","","type","name","cols","50","formControlName","sqlScript","name","s",1,"form-control",2,"min-height","60vh","width","100%"],["type","text","formControlName","datasetName","placeholder","DataSet Name"],["mat-input","","type","name","formControlName","sqlScript","name","s",1,"form-control"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"New Solution"),e.qZA(),e.TgZ(3,"h5")(4,"span",2),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6,"Solution Board / New Solution"),e.qZA()(),e.TgZ(7,"div",3)(8,"h5",4),e._uU(9,"Dataset(s) Preparation:"),e.qZA(),e.TgZ(10,"div",5),e.YNc(11,kS,5,4,"ng-container",6),e.qZA(),e.YNc(12,OS,10,5,"div",7),e.YNc(13,QS,15,3,"ng-container",7),e.YNc(14,iN,11,7,"div",8),e.YNc(15,kN,19,9,"div",8),e.YNc(16,qN,15,3,"div",9),e.YNc(17,HN,3,2,"div",10),e.YNc(18,IA,37,11,"div",7),e.qZA(),e.YNc(19,EA,17,4,"div",7),e.YNc(20,ZA,17,4,"div",7),e.YNc(21,BA,14,2,"div",7),e.YNc(22,RA,19,4,"div",7),e.YNc(23,ry,15,1,"div",7),e.YNc(24,ay,13,1,"div",7),e.YNc(25,sy,14,1,"div",7),e.YNc(26,ly,14,1,"div",7)),2&t&&(e.xp6(11),e.Q6J("ngForOf",o.tabs),e.xp6(1),e.Q6J("ngIf",0==o.tabs[0].id&&1==o.tabs[0].isActive),e.xp6(1),e.Q6J("ngIf",1==o.tabs[1].id&&1==o.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",2==o.tabs[2].id&&1==o.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",3==o.tabs[3].id&&1==o.tabs[3].isActive),e.xp6(1),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",5==o.tabs[5].id&&1==o.tabs[5].isActive),e.xp6(1),e.Q6J("ngIf",o.enableAppendNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableMergeNamePopup),e.xp6(1),e.Q6J("ngIf",o.showTargetFilePopup),e.xp6(1),e.Q6J("ngIf",o.enableDataSetPopUp),e.xp6(1),e.Q6J("ngIf",o.saveDataSetPopup),e.xp6(1),e.Q6J("ngIf",o.enableViewScriptPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQLPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadPhytonPopup))},directives:[be.sg,Ze.lW,be.O5,Se.a8,w.Wl,w.JJ,w.On,w._Y,w.JL,w.sg,w.CE,w.x0,Ln.KE,hi.gD,w.u,Et.ey,ms.gM,w.YN,w.Kr,lt.pp,lt.ib,lt.yz,Ln.hX,Qi.Nt,so.hl,so.nW,so.Mq,w.Fj,fe.rH,be.mk,w.F,w.oH],styles:['.mat-card[_ngcontent-%COMP%]{margin-top:2%;float:left;width:100%}.btn[_ngcontent-%COMP%]{height:37px;border-radius:0;background-color:#0076a8;color:#fff;width:auto}h3[_ngcontent-%COMP%]{font-size:25px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}.btnn[_ngcontent-%COMP%]{border-radius:0;margin:14px 0 14px 20px!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;transition:all .5s cubic-bezier(.77,0,.175,1)}.btnn.preview[_ngcontent-%COMP%]{float:right;margin:10px 0 0!important}.btnn[_ngcontent-%COMP%]:hover{box-shadow:inset 135px 0 #041e42;color:#fff!important;border:1px solid #041E42}.btnnn[_ngcontent-%COMP%]{height:50px;border:1px solid #cccaca;text-align:left;width:100%;border-radius:0;background-color:#fff;color:#000;font-size:17px}.btnnn[_ngcontent-%COMP%]:nth-child(odd){background-color:#eee}.btnnn[_ngcontent-%COMP%]:hover, .btnnn[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.scroll[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll1[_ngcontent-%COMP%]{max-height:200px!important;margin-bottom:10px}.scroll2[_ngcontent-%COMP%]{max-height:400px!important;margin-bottom:10px}.scroll1[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .scroll2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.select[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:220px;border-radius:0;font-size:12px;border:1px solid #cccaca;font-family:open_sans-regular!important;padding:5px 8px}.dds-icon_file_xls__l__filled[_ngcontent-%COMP%]:before{padding-right:10px}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.sheet[_ngcontent-%COMP%]{border:2px solid #eee}table[_ngcontent-%COMP%]{width:100%;margin:0%}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#eeeeee}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#000;height:24px;padding:0 20px;font-family:open_sans-medium;font-size:14px;line-height:16px}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{color:#5aa448;font-size:19px}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#041E42!important}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px!important;color:#fff!important;font-family:open_sans-regular!important;font-weight:400}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;text-align:center}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#fff}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:28px;padding:2px 53px!important;border-bottom:1px solid #eee;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px}.selectCheck[_ngcontent-%COMP%]{float:left;width:100%;margin:0 0 10px}.selectCheck[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{vertical-align:middle;width:16px;height:16px;margin:0 5px 0 0}.selectCheck[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span.dds-icon[_ngcontent-%COMP%]{height:auto;vertical-align:middle}table[_ngcontent-%COMP%]   td.active[_ngcontent-%COMP%]{background-color:#87ceeb!important}h6[_ngcontent-%COMP%]{float:left;width:100%;padding:10px 0 0 65px}.append[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]{display:block;position:relative;padding:16px;border-radius:4px;box-shadow:0 0 6px 1px #cccaca;margin-top:10px;float:left;width:100%}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even)   td[_ngcontent-%COMP%]{background:#eee!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]{background-color:#fff;width:inherit;display:table-row;height:40px}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#fff!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px;margin:0 10px 0 0;vertical-align:middle}.header[_ngcontent-%COMP%]{width:100%;background:#0076A8;float:left;margin:0 0 15px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:8px 12px;color:#fff;font-family:open_sans-regular;font-size:14px;line-height:19px;float:left;width:100%;margin:0}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:14% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:159px;width:440px;border-style:dotted;border-width:1px solid;color:#0076a8;margin:auto;padding:30px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.taxt-audit-popup[_ngcontent-%COMP%]{background:#fff;width:700px;position:absolute;top:50%;left:50%;transform:translate(-50%,-40%)}.taxt-audit-popup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{float:left;width:100%}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{border-radius:0;border:0;margin:14px 20px 25px 0!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;float:right;transition:all .5s cubic-bezier(.77,0,.175,1)}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important;border:1px solid #041E42}.taxt-audit-popup[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#d8000c;position:absolute;font-size:12px;line-height:15px;font-family:open_sans-regular;bottom:71px;right:20px;font-size:11px}.taxt-audit-popup.preview[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:400px;overflow-y:auto}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.allow-cr[_ngcontent-%COMP%]{white-space:pre-line}.mat-accordion[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:2rem;border-bottom:none}.mat-expansion-panel-header.mat-row[_ngcontent-%COMP%]{border-bottom:none}p.dataP[_ngcontent-%COMP%]{float:left;width:calc(100% - 90px);margin:0;height:auto;line-height:20px;color:#000;line-height:36px}.rightIcons[_ngcontent-%COMP%]{float:right}.rightIcons[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 3px;float:left;height:auto}.mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000}.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0}.mat-table[_ngcontent-%COMP%]{display:block}.mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{min-height:33px}.mat-row[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;padding:0 24px;box-sizing:border-box}.mat-row[_ngcontent-%COMP%]:after, .mat-header-row[_ngcontent-%COMP%]:after{display:inline-block;min-height:inherit;content:""}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;position:relative}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{float:right;position:absolute;right:0}.dataModeling[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{float:left;width:100%;box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;margin:0 0 15px}.dataModeling[_ngcontent-%COMP%]   .mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:25px}.dataModeling[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:1px solid #D6D6D6;border-radius:0}.dataModeling[_ngcontent-%COMP%]   .combination[_ngcontent-%COMP%]{box-shadow:none}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-5[_ngcontent-%COMP%]{width:45%;padding:0}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-7[_ngcontent-%COMP%]{width:53%;padding:0;margin-left:2%}.dataModeling[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%], .dataModeling[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:0}.targetFileRow[_ngcontent-%COMP%]   .combination.col-md-6[_ngcontent-%COMP%]{width:50%;box-shadow:none}.row.popup[_ngcontent-%COMP%]{margin:0;float:left;width:100%}.row.popup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{float:left;width:100%}.row.popup[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{float:left;width:100%;padding:20px}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px #0003;padding:12px 16px;z-index:1;width:250px}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{height:24px!important;min-height:24px!important}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{top:0!important}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;margin:0 0 8px}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:none}.dropdown-content[_ngcontent-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:12px;margin-bottom:8px;width:100%;float:left;word-break:break-all}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dds-icon.border[_ngcontent-%COMP%]{border:2px solid #000;padding:5px;border-radius:50%;margin-top:2px}.error[_ngcontent-%COMP%]{color:#d8000c;font-size:12px;line-height:15px;font-family:open_sans-regular}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}form[_ngcontent-%COMP%]   .col-md-2[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{margin:1px 0 10px 10px!important;height:auto}.search[_ngcontent-%COMP%]{width:25%;float:right;border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF;margin:0 0 20px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12px;border-radius:0;border:0px none;padding:0;margin:0 3px 0 0;width:calc(100% - 30px);float:left}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none}.search[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;padding:3px 0 0;font-size:17px;height:auto}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px!important}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]{margin:2px 0;float:left;width:100%}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30%;float:left;margin:0 5px 0 0}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;margin:6px 0 0;cursor:pointer;font-size:16px;padding:3px}.dds-icon[_ngcontent-%COMP%]{color:#707070;font-size:19px}.note[_ngcontent-%COMP%]{font-size:13px;line-height:17px;font-family:open_sans-regular;color:#000;float:left;margin:0 0 10px;width:100%}.required-field[_ngcontent-%COMP%]:before{content:"*";color:red}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   .taxt-audit-popup[_ngcontent-%COMP%]{width:80%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:10px}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:0;width:100%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:50vh;width:100%}']}),n})();function dy(n,r){1&n&&e._UZ(0,"span",11)}function _y(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"button",9),e._uU(2),e.YNc(3,dy,1,0,"span",10),e.qZA(),e._uU(4," \xa0 "),e.BQk()),2&n){const t=r.$implicit,o=r.index,i=e.oxw();e.xp6(1),e.ekj("active",t.isActive),e.xp6(1),e.Oqu(t.value),e.xp6(1),e.Q6J("ngIf",i.tabs.length-1!=o)}}function py(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div")(3,"label",20)(4,"input",21),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._UZ(5,"span",22)(6,"br"),e.TgZ(7,"h5"),e._uU(8,"Upload Files"),e.qZA(),e.TgZ(9,"p",23),e._uU(10,"Note: Exclude .JS and .EXE files"),e.qZA()()()()()}}function uy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"span",24),e._uU(2,"Choose the sheets within the file(s)"),e.qZA(),e.TgZ(3,"div",25)(4,"h5"),e._uU(5,"Uploaded Files"),e.qZA()(),e.TgZ(6,"div",26)(7,"input",27),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(2).masterSelected=i})("change",function(){return e.CHM(t),e.oxw(2).checkUncheckAllUploadFiles()}),e.qZA(),e.TgZ(8,"label"),e._uU(9,"Select All"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("ngModel",t.masterSelected)}}function fy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",30),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSheetSelected=i})("change",function(){return e.CHM(t),e.oxw(3).isAllSelectedUploadFiles()}),e.qZA(),e._UZ(3,"img",31),e.TgZ(4,"label"),e._uU(5),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSheetSelected),e.xp6(3),e.Oqu(t.sheetName)}}function my(n,r){1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",32),e.qZA()())}function hy(n,r){if(1&n&&(e.TgZ(0,"table",28)(1,"thead")(2,"tr")(3,"th"),e._UZ(4,"span",29),e._uU(5),e.qZA()()(),e.TgZ(6,"tbody"),e.YNc(7,fy,6,2,"tr",6),e.YNc(8,my,3,0,"tr",7),e.qZA()()),2&n){const t=r.$implicit;e.xp6(5),e.Oqu(t.fileName),e.xp6(2),e.Q6J("ngForOf",t.totalSheetList),e.xp6(1),e.Q6J("ngIf",t.isProgressBar)}}function gy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.showUploadFilesTab=!1,i.fileListt=[],i.masterSelected=!1}),e._uU(1,"Prev"),e.qZA()}}function xy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Next"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isUploadFilesNextBtnEnable)}}function vy(n,r){if(1&n&&(e.TgZ(0,"div")(1,"mat-card")(2,"div",12)(3,"div"),e.YNc(4,py,11,0,"div",13),e.YNc(5,uy,10,1,"div",7),e.YNc(6,hy,9,3,"table",14),e.qZA(),e.TgZ(7,"div",15),e.YNc(8,gy,2,0,"button",16),e.YNc(9,xy,2,1,"button",17),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",!t.showUploadFilesTab),e.xp6(1),e.Q6J("ngIf",t.showUploadFilesTab),e.xp6(1),e.Q6J("ngForOf",t.fileListt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListt.length>0)}}function Cy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",40),e._UZ(2,"img",31),e.TgZ(3,"label"),e._uU(4),e.qZA(),e.TgZ(5,"span",41),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).previewPopup("","","","",i.tableName)}),e.qZA()()()}if(2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.sheetName,"")}}function Ty(n,r){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,Cy,6,1,"tr",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.isSheetSelected)}}function by(n,r){if(1&n&&(e.TgZ(0,"table",28)(1,"thead")(2,"tr")(3,"th"),e._UZ(4,"span",29),e._uU(5),e.qZA()()(),e.YNc(6,Ty,2,1,"tbody",6),e.qZA()),2&n){const t=r.$implicit;e.xp6(5),e.hij("",t.fileName," "),e.xp6(1),e.Q6J("ngForOf",t.totalSheetList)}}function wy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:0})}),e._uU(1,"Prev"),e.qZA()}}function Sy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.changeTabs({id:2}),i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1,"Next"),e.qZA()}}function Ny(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-card",35)(2,"span",24),e._uU(3,"Click the view icon to see a preview of the filtered files' or sheets' information. "),e.qZA(),e.TgZ(4,"div",36)(5,"div",25)(6,"h5"),e._uU(7,"Selected Files "),e.TgZ(8,"span",37),e._uU(9,"Preview Data"),e.qZA()()(),e.TgZ(10,"div"),e.YNc(11,by,7,2,"table",14),e.qZA(),e.TgZ(12,"div",38),e.YNc(13,wy,2,0,"button",39),e.YNc(14,Sy,2,0,"button",39),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.fileListtt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function Ay(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",54)(1,"td")(2,"input",55),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw().index;return e.oxw(3).isAllSelected(i,s,c,l)}),e.qZA(),e._UZ(3,"span",56),e._uU(4),e.qZA(),e.TgZ(5,"td",57),e._UZ(6,"img",31),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"span",41),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(2),e.hij("",t.fileName," "),e.xp6(3),e.hij(" ",t.sheetName," ")}}function yy(n,r){if(1&n&&(e.TgZ(0,"div",58),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function Dy(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Append Sheets"),e.qZA(),e.TgZ(3,"span",24),e._uU(4,"To append the sheets, please choose the ones with identical columns. Select atleast two sheets for appending "),e.qZA(),e.TgZ(5,"table",47)(6,"thead",48)(7,"tr")(8,"th",49),e._uU(9,"Filename"),e.qZA(),e.TgZ(10,"th",50),e._uU(11," Sheetname"),e.qZA(),e.TgZ(12,"th",48),e._uU(13,"Preview"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,Ay,10,3,"tr",51),e.qZA()(),e.YNc(16,yy,2,1,"div",52),e.TgZ(17,"button",53),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).addAppendName()}),e._uU(18," Append"),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(15),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",o.submitted),e.xp6(1),e.Q6J("disabled",!o.hideCreateIdenticalBtnWithLength)}}function ky(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Dy,19,3,"ng-container",6),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.sortedList)}}function Fy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1," Append"),e.qZA()}}function My(n,r){if(1&n&&(e.TgZ(0,"div",68),e._UZ(1,"span",56),e._uU(2),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fileName," ")}}function Ly(n,r){if(1&n&&(e.TgZ(0,"div",68),e._UZ(1,"img",31),e.TgZ(2,"label"),e._uU(3),e.qZA()()),2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.sheetName)}}function Iy(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"tr",62)(2,"td",63),e._uU(3),e.qZA()(),e.TgZ(4,"tr",64)(5,"td"),e.YNc(6,My,3,1,"div",65),e.qZA(),e.TgZ(7,"td",57),e.YNc(8,Ly,4,1,"div",65),e.qZA(),e.TgZ(9,"td",66),e._UZ(10,"span",67),e.qZA()(),e.BQk()),2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.showAppendName),e.xp6(3),e.Q6J("ngForOf",t.tableList),e.xp6(2),e.Q6J("ngForOf",t.tableList)}}function Ey(n,r){if(1&n&&(e.TgZ(0,"table",47)(1,"thead")(2,"tr")(3,"th",60),e._uU(4,"Append Set(s)"),e.qZA()()(),e.TgZ(5,"tbody",61),e.YNc(6,Iy,11,3,"ng-container",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.sortedCheckedList)}}function Zy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",69),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1,i.mergeCheckedList=[],i.sortedCheckedList=[]}),e._uU(1," Reset "),e.qZA()}}function Py(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Prev"),e.qZA()}}function Oy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).saveAppendAPI()}),e._uU(1,"Save"),e.qZA()}}function Uy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:3},"unChedkedList")}),e._uU(1,"Next"),e.qZA()}}function By(n,r){if(1&n&&(e.TgZ(0,"div",43),e.YNc(1,ky,2,1,"ng-container",7),e.YNc(2,Fy,2,0,"button",44),e.YNc(3,Ey,7,1,"table",45),e._UZ(4,"br"),e.YNc(5,Zy,2,0,"button",46),e.TgZ(6,"div",37),e.YNc(7,Py,2,0,"button",39),e.YNc(8,Oy,2,0,"button",39),e.YNc(9,Uy,2,0,"button",39),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=t.sortedList[0].length),e.xp6(1),e.Q6J("ngIf",t.hideCreateIdenticalBtn),e.xp6(1),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function Jy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",75)(1,"td")(2,"input",76),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).checkedInJoin(i,s,l)}),e.qZA(),e._uU(3),e.TgZ(4,"div",77),e._UZ(5,"span",67),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(1),e.hij(" ",t.showAppendName," ")}}function qy(n,r){if(1&n&&(e.TgZ(0,"table",73)(1,"tbody"),e.YNc(2,Jy,6,2,"tr",74),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.sortedCheckedList)}}function Ry(n,r){if(1&n&&(e.TgZ(0,"div",58),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function Qy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).join2Sheets()}),e._uU(1,"Join"),e.qZA()}}function Hy(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",100),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value," ")}}function Yy(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function Vy(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",100),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij("",t.value," ")}}function $y(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",101),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).addTableJoins(a,i)}),e.qZA()}if(2&n){const t=e.oxw(2).index,o=e.oxw(3);e.Q6J("disabled",null==o.mergeCheckedList[t]?null:o.mergeCheckedList[t].allTablesSelected)}}function Ky(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",102),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).removeTable(a,i)}),e.qZA()}}function Wy(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function zy(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function Gy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",108),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index,a=e.oxw().index;return e.oxw(3).addColumnJoin(a,i)}),e.qZA()}}function Xy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",102),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index,s=e.oxw().index;return e.oxw(3).removeCol(s,a,i)}),e.qZA()}}function jy(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",85)(1,"div",12),e._UZ(2,"div",90),e.TgZ(3,"div",91)(4,"mat-form-field",92)(5,"mat-select",103),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectPrimarykey(i,s,l,c)}),e.YNc(6,Wy,2,2,"mat-option",95),e.qZA()()(),e._UZ(7,"div",90),e.TgZ(8,"div",91)(9,"mat-form-field",92)(10,"mat-select",104),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectForeignKey(i,s,l,c)}),e.YNc(11,zy,2,2,"mat-option",95),e.qZA()()(),e.TgZ(12,"div",105),e.YNc(13,Gy,1,0,"button",106),e.YNc(14,Xy,1,0,"button",107),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw().index,a=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(6),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].columns[t]?null:a.mergeCheckedList[i].dropDownList[o].columns[t].primaryKeyList),e.xp6(5),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].columns[t]?null:a.mergeCheckedList[i].dropDownList[o].columns[t].foreignKeyList),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function eD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",89)(1,"div",12),e._UZ(2,"div",90),e.TgZ(3,"div",91)(4,"mat-form-field",92)(5,"mat-select",93),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectPrimaryTable(i,s,l)}),e.YNc(6,Hy,3,2,"ng-container",6),e.qZA()()(),e.TgZ(7,"div",90)(8,"mat-form-field",92)(9,"mat-select",94),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectJoin(i,s,l)}),e.YNc(10,Yy,2,2,"mat-option",95),e.qZA()()(),e.TgZ(11,"div",91)(12,"mat-form-field",92)(13,"mat-select",96),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectForeignTable(i,s,l)}),e.YNc(14,Vy,3,2,"ng-container",6),e.qZA()()(),e.TgZ(15,"div",90),e.YNc(16,$y,1,1,"button",97),e.YNc(17,Ky,1,0,"button",98),e.qZA()(),e.TgZ(18,"div",99),e.YNc(19,jy,15,5,"div",84),e.qZA()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(5),e.Q6J("placeholder",i.placetable),e.xp6(1),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].primaryTableList),e.xp6(4),e.Q6J("ngForOf",i.joinType),e.xp6(4),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].foreignTableList),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t),e.xp6(2),e.Q6J("ngForOf",i.columnArr(o,t).controls)}}function tD(n,r){if(1&n&&(e.TgZ(0,"div",85)(1,"div",86),e._uU(2),e.qZA(),e.TgZ(3,"div",87),e.YNc(4,eD,20,8,"div",88),e.qZA()()),2&n){const t=r.index,o=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(2),e.hij("Join Table Name : ",o.mergeCheckedList[t].showMergeName," "),e.xp6(2),e.Q6J("ngForOf",o.TableArr(t).controls)}}function nD(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",78)(2,"div",79)(3,"div",80),e._uU(4,"Join Set "),e.qZA(),e._UZ(5,"div",81)(6,"div",81)(7,"div",81)(8,"div",82),e.qZA(),e.TgZ(9,"div",83),e.YNc(10,tD,5,3,"div",84),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.joinSetForm),e.xp6(9),e.Q6J("ngForOf",t.MergeArr().controls)}}function iD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",109),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).resetMerge()}),e._uU(1,"Reset"),e.qZA()}}function oD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:2},"prevInMerge")}),e._uU(1,"Prev"),e.qZA()}}function rD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).MergeSubmit()}),e._uU(1,"Save"),e.qZA()}}function aD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:4},"appendList")}),e._uU(1,"Next"),e.qZA()}}function sD(n,r){if(1&n&&(e.TgZ(0,"div",43),e.ynx(1),e.TgZ(2,"span",24),e._uU(3,"Select the files, then join them based on common columns "),e.qZA(),e.TgZ(4,"div",25)(5,"h5"),e._uU(6,"Files "),e.TgZ(7,"div",70),e._uU(8,"Preview"),e.qZA()()(),e.YNc(9,qy,3,1,"table",71),e.YNc(10,Ry,2,1,"div",52),e.YNc(11,Qy,2,0,"button",39),e.YNc(12,nD,11,2,"div",7),e.YNc(13,iD,2,0,"button",72),e.TgZ(14,"div",37),e.YNc(15,oD,2,0,"button",39),e.YNc(16,rD,2,0,"button",39),e.YNc(17,aD,2,0,"button",39),e.qZA(),e.BQk(),e.qZA()),2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(1),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function lD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",118),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",41),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.appendName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.appendName," ")}}function cD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",116)(2,"table",117)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Append Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,lD,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function dD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",118),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",41),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.mergeName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.mergeName," ")}}function _D(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",116)(2,"table",117)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Join Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,dD,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function pD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td",118),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(3),e.TgZ(4,"span",41),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.fileName," ")}}function uD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",116)(2,"table",117)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Source Files"),e.qZA()()(),e.YNc(7,pD,5,3,"tbody",6),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(7),e.Q6J("ngForOf",t.sheetList)}}function fD(n,r){if(1&n&&(e.ynx(0),e.YNc(1,cD,9,1,"ng-container",7),e.YNc(2,_D,9,1,"ng-container",7),e.YNc(3,uD,8,1,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","append"==t.fileType),e.xp6(1),e.Q6J("ngIf","join"==t.fileType),e.xp6(1),e.Q6J("ngIf","files"==t.fileType)}}function mD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span",128)(2,"div"),e._uU(3),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.s9C("matTooltip",t.fieldName),e.xp6(2),e.Oqu(t.fieldName)}}function hD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function gD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",123)(2,"input",124),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isChecked=i}),e.qZA()(),e.TgZ(3,"td",125),e.YNc(4,mD,4,2,"ng-container",7),e.qZA(),e.TgZ(5,"td",126)(6,"mat-form-field",92)(7,"mat-select",127),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.columnType=i}),e.YNc(8,hD,2,2,"mat-option",95),e.qZA()()()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngModel",t.isChecked),e.xp6(2),e.Q6J("ngIf","files"==o.fileTypeInTF||"append"==o.fileTypeInTF||"join"==o.fileTypeInTF),e.xp6(3),e.Q6J("ngModel",t.columnType),e.xp6(1),e.Q6J("ngForOf",o.dataTypee)}}function xD(n,r){if(1&n&&(e.TgZ(0,"table",117)(1,"thead")(2,"tr",119)(3,"th",120),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",121),e._uU(6,"Column Name"),e.qZA(),e.TgZ(7,"th",122),e._uU(8,"Data Type"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,gD,9,4,"tr",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",t.clickedRowDataInTF)}}function vD(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",110)(2,"span",111),e._uU(3,"Here is the complete list of files that are appended, joined, and other individual files that can be used to build the datasets. "),e.qZA(),e.TgZ(4,"div",112),e.YNc(5,fD,4,3,"ng-container",6),e.qZA(),e.TgZ(6,"div",113),e.YNc(7,xD,11,1,"table",114),e.qZA(),e.TgZ(8,"div",115)(9,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3})}),e._uU(10,"Prev"),e.qZA(),e.TgZ(11,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:5})}),e._uU(12,"Next"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.targetFiles),e.xp6(2),e.Q6J("ngIf",0!=(null==t.clickedRowDataInTF?null:t.clickedRowDataInTF.length))}}function CD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",149)(1,"div",150),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"AF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fieldName,"")}}function TD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",143),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",144)(2,"p",145),e._uU(3),e.qZA(),e.TgZ(4,"div",146)(5,"span",147),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.appendName)}),e.qZA()()(),e.YNc(6,CD,3,1,"mat-accordion",148),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.appendName),e.xp6(3),e.Q6J("ngForOf",t.tableAppendFieldsDto)}}function bD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",134)(2,"h5"),e._uU(3,"Append Files"),e.qZA()(),e.TgZ(4,"mat-accordion",141),e.YNc(5,TD,7,3,"mat-expansion-panel",142),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function wD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",152)(1,"div",150),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"JF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fieldName,"")}}function SD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",143),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",144)(2,"p",145),e._uU(3),e.qZA(),e.TgZ(4,"div",146)(5,"span",147),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.mergeName)}),e.qZA()()(),e.YNc(6,wD,3,1,"mat-accordion",151),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.mergeName),e.xp6(3),e.Q6J("ngForOf",t.mergeFieldListDTO)}}function ND(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",134)(2,"h5"),e._uU(3,"Join Files"),e.qZA()(),e.TgZ(4,"mat-accordion",141),e.YNc(5,SD,7,3,"mat-expansion-panel",142),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function AD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",149)(1,"div",150),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"SF")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fieldName,"")}}function yD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",143),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",144)(2,"p",145),e._uU(3),e.qZA(),e.TgZ(4,"div",146)(5,"span",147),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()(),e.YNc(6,AD,3,1,"mat-accordion",148),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.Q6J("expanded",o.allExpandState),e.xp6(3),e.Oqu(t.fileName),e.xp6(3),e.Q6J("ngForOf",t.sheet)}}function DD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",134)(2,"h5"),e._uU(3,"Source Files"),e.qZA()(),e.TgZ(4,"mat-accordion",141),e.YNc(5,yD,7,3,"mat-expansion-panel",142),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function kD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",140),e.YNc(2,bD,6,1,"ng-container",7),e.qZA(),e.TgZ(3,"div",140),e.YNc(4,ND,6,1,"ng-container",7),e.qZA(),e.TgZ(5,"div",140),e.YNc(6,DD,6,1,"ng-container",7),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngIf","append"==t.fileType),e.xp6(2),e.Q6J("ngIf","join"==t.fileType),e.xp6(2),e.Q6J("ngIf","files"==t.fileType)}}function FD(n,r){1&n&&(e.TgZ(0,"div",153),e._uU(1,"No files found"),e.qZA())}function MD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",149)(1,"div",150),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.fieldName,"")}}function LD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",143),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",154)(2,"input",155),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).onCheck(a)}),e.qZA(),e._uU(3,"\xa0 "),e.TgZ(4,"p",145),e._uU(5),e.qZA(),e.TgZ(6,"div",77)(7,"span",156),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup("","","","",a.datasetName)}),e.qZA(),e.TgZ(8,"span",157),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).editDatasetFile(a)}),e.qZA(),e.TgZ(9,"span",158),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).callGetViewscript(a)}),e.qZA(),e.TgZ(10,"span",159),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"dataset")}),e.qZA()()(),e.YNc(11,MD,3,1,"mat-accordion",148),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.Q6J("expanded",o.allExpandState),e.xp6(5),e.Oqu(t.datasetName),e.xp6(6),e.Q6J("ngForOf",t.datasetFieldDTOList)}}function ID(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",141),e.YNc(1,LD,12,3,"mat-expansion-panel",142),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function ED(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function ZD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function PD(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",184)(2,"mat-select",185),e.YNc(3,ZD,2,2,"mat-option",95),e.qZA()(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("ngForOf",t.dateTimeFormats)}}function OD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",187)(1,"div",150),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).accordionExpValue(a,a.Component)}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionType,"")}}function UD(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",144),e._uU(2),e.qZA(),e.YNc(3,OD,3,1,"mat-accordion",186),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionName," "),e.xp6(1),e.Q6J("ngForOf",t.funcDescritptionsList)}}function BD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}const Pi=function(n){return{"is-invalid":n}};function JD(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"input",188),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.value=i}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngModel",t.value)("ngClass",e.VKq(2,Pi,o.submited&&o.createExpressionForm.controls.value.errors))}}function qD(n,r){if(1&n&&(e.TgZ(0,"mat-form-field",189),e._UZ(1,"input",190)(2,"mat-datepicker-toggle",191)(3,"mat-datepicker",null,192),e.qZA()),2&n){const t=e.MAs(4);e.xp6(1),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t)}}function RD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function QD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function HD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",85)(1,"div",178)(2,"mat-form-field",92)(3,"mat-select",193),e.YNc(4,RD,2,2,"mat-option",95),e.qZA()(),e.TgZ(5,"mat-form-field",92)(6,"mat-select",194),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw(),c=l.index,d=l.$implicit;return e.oxw(3).changeSignOperator(i,s,"",c,d,"child")}),e.YNc(7,QD,2,2,"mat-option",95),e.qZA()(),e._UZ(8,"input",195),e.TgZ(9,"span",196),e.NdJ("click",function(){const a=e.CHM(t).index,s=e.oxw(),l=s.index,c=s.$implicit;return e.oxw(3).delOpearatorValueFields(a,"",l,c)}),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw(4);e.Q6J("formGroupName",t),e.xp6(4),e.Q6J("ngForOf",o.opearatorList),e.xp6(3),e.Q6J("ngForOf",o.signOperatorList)}}function YD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"SAVE"),e.qZA()}}function VD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",197),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"ADD"),e.qZA()}}function $D(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"table",163)(1,"tbody")(2,"tr")(3,"td",164)(4,"input",165),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)}),e.qZA(),e.TgZ(5,"div",166)(6,"mat-form-field",167)(7,"mat-select",168),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(3).changeDTinCreateExpression(i,s)}),e.YNc(8,ED,2,2,"mat-option",95),e.qZA()(),e.YNc(9,PD,4,1,"ng-container",7),e.qZA(),e.TgZ(10,"div",166)(11,"div",169)(12,"div")(13,"img",170),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.isOpenAccordion=0==i.isOpenAccordion}),e.qZA()(),e.TgZ(14,"div",171)(15,"div",172)(16,"input",173),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i)}),e.qZA(),e._UZ(17,"span",174),e.qZA(),e.TgZ(18,"mat-accordion",141),e.YNc(19,UD,4,2,"mat-expansion-panel",6),e.qZA()()(),e.TgZ(20,"div",175)(21,"textarea",176),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)}),e._uU(22,"                                                "),e.qZA()()(),e.TgZ(23,"label",177),e._uU(24,"Where Criteria:"),e.qZA(),e.TgZ(25,"div",178)(26,"mat-form-field",92)(27,"mat-select",179),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit;return e.oxw(3).changeSignOperator(i,"","",s,l,"parent")}),e.YNc(28,BD,2,2,"mat-option",95),e.qZA()(),e.YNc(29,JD,2,4,"ng-container",7),e.YNc(30,qD,5,2,"mat-form-field",180),e.TgZ(31,"span",181),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit;return e.oxw(3).addOpearatorValueFields(a,s)}),e.qZA(),e._UZ(32,"br"),e.qZA(),e.TgZ(33,"div",182),e.YNc(34,HD,10,3,"div",84),e.qZA()()()(),e.ynx(35),e.YNc(36,YD,2,0,"button",39),e.YNc(37,VD,2,0,"button",183),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(4),e.Q6J("value",t.sourceFieldName)("ngClass",e.VKq(17,Pi,o.submited&&o.createExpressionForm.controls.sourceFieldName.errors)),e.xp6(3),e.Q6J("value",t.columnType)("ngClass",e.VKq(19,Pi,o.submited&&o.createExpressionForm.controls.columnType.errors)),e.xp6(1),e.Q6J("ngForOf",o.dataTypee),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(10),e.Q6J("ngForOf",o.searchfx),e.xp6(2),e.Q6J("ngClass",e.VKq(21,Pi,o.submited&&o.createExpressionForm.controls.expression.errors))("value",t.sourceExpressionName),e.xp6(6),e.Q6J("value",t.signOperator)("ngClass",e.VKq(23,Pi,o.submited&&o.createExpressionForm.controls.signOperator.errors)),e.xp6(1),e.Q6J("ngForOf",o.signOperatorList),e.xp6(1),e.Q6J("ngIf",!t.isISNULLorNOTNULL),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(4),e.Q6J("ngForOf",o.whereArr().controls),e.xp6(2),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",0==t.isEdit)}}function KD(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.ynx(1),e.TgZ(2,"td",211),e._uU(3),e.qZA(),e.TgZ(4,"td",211),e._uU(5),e.qZA(),e.TgZ(6,"td",212)(7,"span",213),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).editRowInDataSet(l,a,s)}),e.qZA(),e.TgZ(8,"span",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).deleteRowInDataset(l,a,s)}),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.sourceFieldName,""),e.xp6(1),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.columnType,""),e.xp6(1),e.ekj("active",t.isEdit)}}function WD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function zD(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function GD(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",133)(2,"table",117)(3,"thead")(4,"tr",48)(5,"th",198),e._uU(6),e.qZA(),e._UZ(7,"th",199),e.TgZ(8,"th",200),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteDataSet(i)}),e._UZ(9,"span",201),e.qZA()(),e.TgZ(10,"tr",48)(11,"th"),e._uU(12,"Column Name"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Column Type"),e.qZA(),e.TgZ(15,"th",202),e._uU(16,"View Expression"),e.qZA()()(),e.TgZ(17,"tbody"),e.ynx(18),e.YNc(19,KD,9,8,"tr",6),e.BQk(),e.qZA(),e._UZ(20,"div"),e.qZA()(),e.TgZ(21,"div",203)(22,"label",204),e._uU(23,"Having"),e.qZA(),e.TgZ(24,"input",205),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.having=i}),e.qZA()(),e.TgZ(25,"form",161)(26,"div",203)(27,"label",204),e._uU(28,"Group By"),e.qZA(),e.TgZ(29,"mat-form-field",206)(30,"mat-select",207),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"groupby")}),e.YNc(31,WD,2,2,"mat-option",95),e.qZA()()(),e.TgZ(32,"div",203)(33,"label",208),e._uU(34,"Order By"),e.qZA(),e.TgZ(35,"mat-form-field",209)(36,"mat-select",210),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"orderby")}),e.YNc(37,zD,2,2,"mat-option",95),e.qZA()()()(),e.TgZ(38,"button",197),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index;return e.oxw(3).saveDataSet(a,s)}),e._uU(39,"Save Dataset"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(6),e.hij("Dataset Name :\xa0",t.datasetName,""),e.xp6(13),e.Q6J("ngForOf",t.datasetFieldDTOList),e.xp6(5),e.Q6J("ngModel",t.having),e.xp6(1),e.Q6J("formGroup",o.datasetTableForm),e.xp6(6),e.Q6J("ngForOf",t.groupBytoDB),e.xp6(6),e.Q6J("ngForOf",t.orderBytoDB)}}function XD(n,r){if(1&n&&(e.ynx(0),e.YNc(1,GD,40,6,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isDatasetTableExpand)}}function jD(n,r){if(1&n&&(e.TgZ(0,"div",160)(1,"div",25)(2,"h5"),e._uU(3,"Create Expression"),e.qZA()(),e.TgZ(4,"form",161),e.YNc(5,$D,38,25,"table",162),e.qZA(),e.YNc(6,XD,2,1,"ng-container",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("formGroup",t.createExpressionForm),e.xp6(1),e.Q6J("ngForOf",t.createExpressionList),e.xp6(1),e.Q6J("ngForOf",t.datasetDetailsList)}}function ek(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"mat-card")(2,"span",24),e._uU(3,"Use the column names from the files listed below to create the dataset(s), then define the dataset columns using analytical operations or by using the column name directly."),e.qZA(),e.TgZ(4,"div")(5,"button",129),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!0}),e._uU(6,"Expand All "),e.qZA(),e.TgZ(7,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!1}),e._uU(8,"Collapse All "),e.qZA(),e.TgZ(9,"button",130),e.NdJ("click",function(){return e.CHM(t),e.oxw().createDataSetinDM()}),e._uU(10," Create DataSet"),e.qZA(),e.TgZ(11,"button",130),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.enableUploadSQLPopup=!0,i.sqlScriptForm.reset()}),e._uU(12," Upload SQL Script"),e.qZA()(),e.TgZ(13,"div",131)(14,"div",12)(15,"div",132),e.YNc(16,kD,7,3,"ng-container",6),e.TgZ(17,"div",133)(18,"div",134)(19,"h5"),e._uU(20,"DataSet Files "),e.TgZ(21,"span",37),e._uU(22,"Actions"),e.qZA()()(),e.YNc(23,FD,2,0,"div",135),e.YNc(24,ID,2,1,"mat-accordion",136),e.qZA()(),e.YNc(25,jD,7,3,"div",137),e.TgZ(26,"div",138)(27,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:4},"prev")}),e._uU(28,"Prev"),e.qZA(),e.TgZ(29,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeProject()}),e._uU(30,"Execute"),e.qZA(),e.TgZ(31,"button",139),e.NdJ("click",function(){return e.CHM(t),e.oxw().SaveContinue()}),e._uU(32,"Continue"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(16),e.Q6J("ngForOf",t.targetFiles),e.xp6(7),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)),e.xp6(1),e.Q6J("ngIf",0!=t.createExpressionList.length)}}function tk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",214)(2,"div",215)(3,"div",216)(4,"h4",217),e._uU(5,"Append Name"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",218)(8,"div",219)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",220),e.qZA()(),e.TgZ(12,"div",221)(13,"button",222),e.NdJ("click",function(){return e.CHM(t),e.oxw().createAppendSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",223),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.appendForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,Pi,t.submited&&t.appendForm.controls.appendNameControl.errors))}}function nk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",214)(2,"div",215)(3,"div",216)(4,"h4",217),e._uU(5,"Join Name"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",218)(8,"div",219)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",220),e.qZA()(),e.TgZ(12,"div",221)(13,"button",224),e.NdJ("click",function(){return e.CHM(t),e.oxw().mergeSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",223),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableMergeNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.joinForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,Pi,t.submited&&t.joinForm.controls.appendNameControl.errors))}}function ik(n,r){if(1&n&&(e.TgZ(0,"th"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function ok(n,r){if(1&n&&(e.TgZ(0,"td",230),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t],"")}}function rk(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,ok,2,1,"td",229),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.columnsArr)}}function ak(n,r){if(1&n&&(e.TgZ(0,"div",231),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Row Count: ",t.rowCount,"")}}function sk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",214)(2,"div",225),e._UZ(3,"div",216),e.TgZ(4,"form")(5,"table",117)(6,"thead")(7,"tr"),e.YNc(8,ik,2,1,"th",6),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,rk,2,1,"tr",6),e.qZA()()(),e.YNc(11,ak,2,1,"div",226),e.TgZ(12,"div",227)(13,"button",228),e.NdJ("click",function(){return e.CHM(t),e.oxw().showTargetFilePopup=!1}),e._uU(14,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.columnsArr),e.xp6(2),e.Q6J("ngForOf",t.selectedM_A_S),e.xp6(1),e.Q6J("ngIf",t.rowCount)}}function lk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",214)(2,"div",215)(3,"div",216)(4,"h4",217),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",218)(8,"div",219)(9,"label"),e._uU(10,"Enter DataSet Name"),e.qZA(),e.TgZ(11,"input",232),e.NdJ("change",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA()()(),e.TgZ(12,"div",221)(13,"button",233),e.NdJ("click",function(){return e.CHM(t),e.oxw().createNewDataSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",223),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopUp=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetForm)}}function ck(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",100),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableName," ")}}function dk(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",100),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function _k(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",100),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableName," ")}}function pk(n,r){if(1&n&&(e.TgZ(0,"mat-option",100),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function uk(n,r){if(1&n&&(e.TgZ(0,"mat-option",246),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function fk(n,r){if(1&n&&(e.ynx(0),e.YNc(1,uk,2,2,"mat-option",245),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw().index,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].foreignKeyList)}}function mk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",247),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).addcolumnRowInDS(i,a)}),e._uU(1,"Column "),e.qZA()}}function hk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",102),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).deletecolumnRowInDS(i,a)}),e.qZA()}}function gk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",85)(1,"div",166)(2,"div",243)(3,"mat-form-field",92)(4,"mat-select",103),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectPrimaryKeyInDS(i,s,l)}),e.YNc(5,pk,2,2,"mat-option",95),e.qZA()()(),e.TgZ(6,"div",243)(7,"mat-form-field",92)(8,"mat-select",104),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectForeignKeyInDS(i,s,l)}),e.YNc(9,fk,2,1,"ng-container",7),e.qZA()()(),e.TgZ(10,"div",90),e.YNc(11,mk,2,0,"button",244),e.YNc(12,hk,1,0,"button",107),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(2);e.Q6J("formGroupName",t),e.xp6(5),e.Q6J("ngForOf",null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].primaryKeyList),e.xp6(4),e.Q6J("ngIf",null!=(null==i.dataSetData[o]?null:i.dataSetData[o].foreignTableList)),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function xk(n,r){if(1&n){const t=e.EpF();e.ynx(0,85),e.TgZ(1,"div",12)(2,"mat-form-field",238)(3,"mat-select",239),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectPrimaryTableInDS(i,s)}),e.YNc(4,ck,3,2,"ng-container",6),e.qZA()(),e.TgZ(5,"mat-form-field",238)(6,"mat-select",240),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectJoinTypeInDS(i,s)}),e.YNc(7,dk,3,2,"ng-container",6),e.qZA()(),e.TgZ(8,"mat-form-field",238)(9,"mat-select",241),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectForeignTableInDS(i,s)}),e.YNc(10,_k,3,2,"ng-container",6),e.qZA()(),e.TgZ(11,"div",242),e.YNc(12,gk,13,5,"div",84),e.qZA()(),e.BQk()}if(2&n){const t=r.index,o=e.oxw(2);e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("placeholder",o.placetable),e.xp6(1),e.Q6J("ngForOf",null==o.dataSetData[t]?null:o.dataSetData[t].primaryTableList),e.xp6(3),e.Q6J("ngForOf",o.joinType),e.xp6(3),e.Q6J("ngForOf",null==o.dataSetData[t]?null:o.dataSetData[t].foreignTableList),e.xp6(2),e.Q6J("ngForOf",o.columnArrInDS(t).controls)}}function vk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",214)(2,"div",234)(3,"div",216)(4,"h4",217),e._uU(5,"Save Dataset "),e.TgZ(6,"button",235),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeDatasetPopup()}),e.TgZ(7,"span",236),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form",161)(10,"div",237),e._UZ(11,"div"),e.YNc(12,xk,13,6,"ng-container",84),e.qZA(),e.TgZ(13,"div",221)(14,"button",233),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetDropdowns()}),e._uU(15,"Save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.dataSetForm),e.xp6(3),e.Q6J("ngForOf",t.DataSetArr().controls)}}function Ck(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",248)(2,"div",215)(3,"div",216)(4,"h4",217),e._uU(5,"View Script"),e.qZA()(),e.TgZ(6,"form",161),e._UZ(7,"textarea",249),e.qZA(),e.TgZ(8,"div",221)(9,"button",224),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.updateScriptByDatasetId(i.viewscriptForm)}),e._uU(10,"Save"),e.qZA(),e.TgZ(11,"button",223),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptPopup=!1}),e._uU(12,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.viewscriptForm)}}function Tk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",248)(2,"div",215)(3,"div",216)(4,"h4",217),e._uU(5,"Uplaod Script"),e.qZA()(),e.TgZ(6,"form",161)(7,"input",250),e.NdJ("change",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA(),e._UZ(8,"textarea",251),e.qZA(),e.TgZ(9,"div",221)(10,"button",224),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetApi()}),e._uU(11,"Save"),e.qZA(),e.TgZ(12,"button",223),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQLPopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.sqlScriptForm)}}let bk=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_){this.popup=t,this.router=o,this.formBuilder=i,this.toast=a,this.loader=s,this.fb=l,this.renderer=c,this.solService=d,this.dialog=_,this.submited=!1,this.submit=!1,this.fileListt=[],this.sortedList=[],this.sortedCheckedList=[],this.mergeCheckedList=[],this.appendUnchechedList=[],this.enableDataSetPopUp=!1,this.datasetDetailsList=[],this.createExpressionList=[],this.filesList=[],this.columnsArr=[],this.showUploadFilesTab=!1,this.masterSelected=!1,this.tabs=[{id:0,value:"Upload Files",isActive:!0},{id:1,value:"Filtered FIles",isActive:!1},{id:2,value:"Append",isActive:!1},{id:3,value:"Join",isActive:!1},{id:4,value:"Target Files",isActive:!1},{id:5,value:"Data Modelling",isActive:!1}],this.enableAppendNamePopup=!1,this.enableMergeNamePopup=!1,this.submitted=!1,this.submittedErrorMsg="",this.targetFileRowEdit=-1,this.hideCreateIdenticalBtnWithLength=!0,this.hideCreateIdenticalBtn=!0,this.selectedM_A_S=[],this.showTargetFilePopup=!1,this.cursorPosition=0,this.appendNameControl=new w.NI(null),this.opearatorList=[{id:0,value:"AND"},{id:1,value:"OR"}],this.signOperatorList=[],this.isOpenAccordion=!1,this.fx=[],this.appendListInMCL=[],this.appendListInSCL=[],this.sheetsListInSCL=[],this.allExpandState=!1,this.panelOpenState=!1,this.dataType=["int","float","char","varchar","dateTime","money","text","decimal","datetime2","decimal","nvarchar","bigint"],this.dataTypee=[{id:0,value:"int"},{id:1,value:"float"},{id:2,value:"char"},{id:3,value:"varchar"},{id:4,value:"text"},{id:5,value:"money"},{id:6,value:"dateTime"},{id:7,value:"date"},{id:8,value:"datetime2"},{id:9,value:"decimal"},{id:10,value:"nvarchar"},{id:11,value:"bigint"}],this.dateTimeFormats=[{id:0,value:"MM/dd/yyyy"},{id:1,value:"MM-dd-yyyy"},{id:2,value:"dd/MM/yyyy"},{id:3,value:"dd-MM-yyyy"},{id:4,value:"yyyy/MM/dd"},{id:5,value:"yyyy-MM-dd"},{id:6,value:"yyyy/dd/MM"},{id:7,value:"yyyy-dd-MM"},{id:8,value:"MMddyyyy"},{id:9,value:"ddMMyyyy"},{id:10,value:"yyyyMMdd"},{id:11,value:"yyyyddMM"}],this.joinType=["Inner Join","Left Join","Outer Join","Right Join","Full Join","Cross Join"],this.unCheckedListAddToMergeList=[],this.allDatasetDetailsList=[],this.enableUploadSQLPopup=!1,this.placetable="Select Primary Table",this.dataSetData=[],this.iscreatesolutionEdit=!1,this.textAreaIndexInDM={},this.textAreaIndexinCE={},this.tablecolNameList=[],this.AJFDlist=[],this.aJFDAllFilesList=[],this.fileListtt=[],this.templatesMergeObj={},this.mergeCheckedListForDM=[],this.secndAPIResp={},this.isUploadFilesNextBtnEnable=!1,this.targetFiles=[],this.xyz=[],this.fileSheetList=[],this.enableViewScriptPopup=!1,this.appendAPIResp={},this.searchfx=[],this.clickedRowDataInTF=[],this.fileTypeInTF="",this.allTableListInDM=[],this.selectedColumnsOfDS=[],this.saveDataSetPopup=!1,this.dropDownsInDS=[]}ngOnInit(){this.joinSetForm=this.formBuilder.group({Merg:this.formBuilder.array([])}),this.process={processId:"E3E81B0D-2025-4C4B-AFE6-B26BF4C31F5F"},this.getAllFileTemplateListByProcessID(),this.appendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.joinForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionList=[],this.invoiceForm1=this.fb.group({DRows1:this.fb.array([])}),this.dataSetForm=this.fb.group({DSetRows:this.fb.array([])}),this.viewscriptForm=this.fb.group({sqlScript:[""],datasetId:[""]}),this.sqlScriptForm=this.fb.group({datasetName:[""],sqlScript:[""]}),this.datasetTableForm=this.fb.group({groupBy:[""],orderBy:[""]}),this.datasetForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionForm=this.fb.group({sourceFieldName:["",w.kI.required],columnType:[[],w.kI.required],dateTimeFormats:[[],w.kI.required],sourceExpressionName:["",w.kI.required],signOperator:["",w.kI.required],value:["",w.kI.required],whereList:this.fb.array([])})}Merg(){return this.formBuilder.group({tableControl:this.formBuilder.array([])})}addTable(){return this.formBuilder.group({table1:["",w.kI.required],join:["",w.kI.required],table2:["",w.kI.required],column:this.formBuilder.array([])})}addColumn(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}DataSetArr(){return this.dataSetForm.get("DSetRows")}MergeArr(){return this.joinSetForm.get("Merg")}TableArr(t){return this.MergeArr().controls[t].get("tableControl")}columnArr(t,o){return this.TableArr(t).controls[o].get("column")}addMergeJoin(){this.MergeArr().push(this.Merg());let t=this.MergeArr().length;this.TableArr(t-1).push(this.addTable());let o=this.TableArr(t-1).length;this.columnArr(t-1,o-1).push(this.addColumn())}addTableJoins(t,o){this.mergeCheckedList[t].dropDownList[o+1].columns=[{primaryKeyList:[],foreignKeyList:[]}],this.TableArr(t).push(this.addTable());let i=this.TableArr(t).length;this.columnArr(t,i-1).push(this.addColumn())}addColumnJoin(t,o){this.columnArr(t,o).push(this.addColumn())}removeTable(t,o){this.TableArr(t).removeAt(o)}removeCol(t,o,i){this.columnArr(t,o).removeAt(i)}DataSetRow(){return this.formBuilder.group({Ptable:["",w.kI.required],join:["",w.kI.required],Ftable:["",w.kI.required],Pcolumn:["",w.kI.required],Fcolumn:["",w.kI.required],columns:this.formBuilder.array([this.addColumnInDS()])})}addColumnInDS(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}addWhereRowInCE(){return this.formBuilder.group({value:["",w.kI.required],operator:["",w.kI.required],signOperator:["",w.kI.required]})}whereArr(){return this.createExpressionForm.get("whereList")}columnArrInDS(t){return this.DataSetArr().controls[t].get("columns")}ngAfterViewInit(){}isValidName(){return t=>{var o;let i=!0;return""==(null===(o=this.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value)&&(i=!1),(0,xt.of)(i?null:{invalid:!0})}}isAllSelectedUploadFiles(){let t=1;this.fileListt.forEach(o=>{o.totalSheetList.forEach(i=>{0!=i.isSheetSelected||(t=0)})}),this.masterSelected=0!=t,this.nextBtnEnableInUF()}changePrimaryTable(t,o,i){let a=t.target.value,l="";l=i.mergeList.filter(_=>_.showAppendName==a)[0].tableList[0].templateId;let d=i.templatesMergeList[i.pkFkMergeTypeList[o].order-1];if(0==o){let u=i.mergeList.filter(m=>m.showAppendName==a)[0].columnList.map(m=>m.fieldName);i.pkFkMergeTypeList[0].selectedPrimaryTable=a,i.pkFkMergeTypeList[0].primaryTemplateId=l,i.pkFkMergeTypeList[1].primaryKeyList=u;let f=JSON.parse(JSON.stringify(i.showMergeSheetNames));f.forEach((m,h)=>{m==a&&f.splice(h,1)}),i.pkFkMergeTypeList[3].foreignTableList=f,d.primaryTemplateId=l,a.includes("-")||(d.primaryTableName=a)}if(3==o){i.pkFkMergeTypeList[o].selectedForeignTable=a;const u=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.fieldName);i.pkFkMergeTypeList[4].foreignKeyList=u,i.pkFkMergeTypeList[o].secondaryTemplateId=l,d.secondaryTemplateId=l,a.includes("-")||(d.secondaryTableName=a)}if(4==o&&(console.log("unnecessary"),i.pkFkMergeTypeList[4].selectedForeignKey=a),o>5){i.pkFkMergeTypeList[o].selectedForeignTable=a;const u=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.fieldName);i.pkFkMergeTypeList[o+1].foreignKeyList=u,i.pkFkMergeTypeList[o].secondaryTemplateId=l,d.secondaryTemplateId=l}}changeSecondaryTable(t,o,i){const a=t.target.value;i.pkFkMergeTypeList[o].selectedSecondaryTable=a;const l=i.mergeList.filter(f=>f.showAppendName==a)[0].columnList.map(f=>f.fieldName);i.pkFkMergeTypeList[o+1].secondaryKeyList=l;let d="";d=i.mergeList.filter(f=>f.showAppendName==a)[0].tableList[0].templateId,i.pkFkMergeTypeList[o].primaryTemplateId=d;let u=i.templatesMergeList[i.pkFkMergeTypeList[o].order-1];u.primaryTemplateId=d,a.includes("-")||(u.primaryTableName=a)}changeSecondaryKey(t,o,i){i.pkFkMergeTypeList[o].selectedSecondaryKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedSecondaryTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.fieldName==t.target.value),i.pkFkMergeTypeList[o].primaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].primaryKeyId=l[0].columnId}changePrimaryKey(t,o,i){i.pkFkMergeTypeList[o].selectedPrimaryKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedPrimaryTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.fieldName==t.target.value),i.pkFkMergeTypeList[o].primaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].primaryKeyId=l[0].columnId}changeForeignKey(t,o,i){i.pkFkMergeTypeList[o].selectedForeignKey=t.target.value;let l,a=i.pkFkMergeTypeList[o-1].selectedForeignTable;l=i.mergeList.filter(_=>_.showAppendName==a)[0].columnList.filter(_=>_.fieldName==t.target.value),i.pkFkMergeTypeList[o].secondaryKeyId=l[0].columnId,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].secondaryKeyId=l[0].columnId}changeMergeType(t,o,i){const a=t.target.value;i.pkFkMergeTypeList[o].selectedMergeType=a,i.templatesMergeList[i.pkFkMergeTypeList[o].order-1].joinType=a.slice(0,1)}checkUncheckAllUploadFiles(){this.fileListt.forEach(t=>{var o;null===(o=null==t?void 0:t.totalSheetList)||void 0===o||o.forEach(i=>{i.isSheetSelected=this.masterSelected})}),this.nextBtnEnableInUF()}getAllFunctions(){this.solService.getAllFunctions().subscribe(t=>{this.fx=t.responseData,this.searchfx=t.responseData,console.log(t),this.loader.hide()},t=>{this.loader.hide()})}getAllFileTemplateListByProcessID(){this.loader.show(),this.solService.getAllFileTemplateListByProcessID(this.process.processId).subscribe(t=>{this.showUploadFilesTab=!0;const o=t.responseData.totalfileDetails;0==o.length?this.showUploadFilesTab=!1:(this.iscreatesolutionEdit=!0,o.forEach(i=>{i.totalSheetList.forEach(a=>{a.isSheetSelected=!1;const s=a.sheetName;a.sheet.forEach(l=>{l.isChecked=!1,l.tableName=a.tableName,l.showTabColName=i.fileName+"-"+s+"["+l.fieldName+"]"})})}),o.forEach(i=>{this.fileListt.push(i)})),this.loader.hide()},t=>{this.loader.hide()})}saveiputFiles(t){this.showUploadFilesTab=!0;let o=this.process.processId;const i=new FormData;i.append("processId",o);for(let a=0;a<t.target.files.length;a++)i.append("file",t.target.files[a]);for(let a=0;a<t.target.files.length;a++)this.fileListt.push({fileName:t.target.files[a].name.split(".").slice(0,-1).join("."),isProgressBar:!0});this.solService.postInputFiles(i).subscribe(a=>{this.getAllFileTemplateListByProcessID()},a=>{this.loader.hide()})}addOpearatorValueFields(t,o){this.whereArr().push(this.addWhereRowInCE())}delOpearatorValueFields(t,o,i,a){this.whereArr().removeAt(t)}changeSignOperator(t,o,i,a,s,l){const c=t.value;"parent"==l&&(this.createExpressionList[a].isISNULLorNOTNULL="IS NULL"==c||"NOT NULL"==c)}changeOperator(t,o,i,a,s){i.operator=t.value}rowClickedDataModeling(t,o,i,a){this.textAreaSlice("["+o.fieldName+"]")}textAreaSlice(t){const o=this.textAreaIndexinCE.value,i=this.textAreaIndexinCE.cursorPosition,a=[o.slice(0,i),t,o.slice(i)].join("");this.createExpressionList[this.textAreaIndexinCE.index].sourceExpressionName=a}textAreaInDataModeling(t,o){const i=t.target.selectionStart;t.target.value.substr(i,t.target.selectionEnd-i),this.textAreaIndexInDM={index:o,cursorPosition:i,value:t.target.value}}createNewDataSet(){var t;this.createExpressionForm.reset(),this.createExpressionForm.controls.whereList=this.fb.array([]),this.createExpressionList=[{sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.enableDataSetPopUp=!1;const o={isDatasetTableExpand:!0,having:"",groupBytoDB:[],orderBytoDB:[],datasetName:null===(t=this.datasetForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),datasetFieldDTOList:[],orderBy:"",groupBy:""};this.datasetDetailsList.push(o)}saveDataSetDropdowns(){this.saveDataSetApi()}changePrimaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,u,d=JSON.parse(JSON.stringify(s.pkFKs[0].primaryTableList)),_=null==i.secondaryTableList?[]:JSON.parse(JSON.stringify(i.secondaryTableList));if(l.includes("-")){let m=l.split("-")[0],h=l.split("-")[1];this.fileListt.filter(p=>{p.fileName==m&&(null==p||p.totalSheetList.forEach(g=>{g.sheetName==h&&(c=g.templateId)}))})}else u=0==a?i.primaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType):i.secondaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType),"append file"==u&&(c=this.appendAPIResp.appendSheetList.filter(m=>m.appendName==l)[0].appendID),"join file"==u&&(c=this.mergeCheckedList.filter(m=>m.showMergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].primaryTableName=l;if(0==a){if(i.primaryTableList.filter(h=>h.fileName==t.target.value),i.selectedPrimaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const h=this.mergeCheckedList.filter(p=>p.showMergeName==l);s.pkFKs[a+1].primaryKeyList=h[0].mergeFieldListDTOFromAPI}else{const h=i.primaryTableList.filter(p=>p.fileName==l);s.pkFKs[a+1].primaryKeyList=h[0].columnList}i.primaryTableList.forEach((h,p)=>{h.fileName==l&&d.splice(p,1)}),s.pkFKs[a+3].foreignTableList=d}let f=[];if(a>4){if(i.selectedSecondaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const m=this.mergeCheckedList.filter(h=>h.showMergeName==l);s.pkFKs[a+1].secondaryKeyList=m[0].mergeFieldListDTOFromAPI}else{const m=i.secondaryTableList.filter(h=>h.fileName==l);s.pkFKs[a+1].secondaryKeyList=m[0].columnList}d.forEach(m=>{_.map(h=>h.fileName).includes(m.fileName)||f.push(m)}),s.pkFKs[a+3].foreignTableList=f}}changePrimaryKeyInDS(t,o,i,a,s){const l=t.target.value;let d;1==a?(i.selectedPrimaryKey=l,i.primaryKeyList.forEach(_=>{_.fieldName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d):(i.selectedSecondaryKey=l,i.secondaryKeyList.forEach(_=>{_.fieldName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d)}changeJoinTypeInDS(t,o,i,a,s){const l=t.target.value;i.selectedMergeType=l,s.dataSetMergeListDTOs[i.order-1].joinType=l.slice(0,1)}changeSecondaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,d;if(l.includes("-")){let p=l.split("-")[0],g=l.split("-")[1];this.fileListt.filter(v=>{v.fileName==p&&(null==v||v.totalSheetList.forEach(x=>{x.sheetName==g&&(c=x.templateId)}))})}else d=i.foreignTableList.filter(p=>p.fileName==l).map(p=>p.fileType),"append file"==d&&(c=this.appendAPIResp.appendSheetList.filter(p=>p.appendName==l)[0].appendID),"join file"==d&&(c=this.mergeCheckedList.filter(p=>p.showMergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].secondaryTableName=l;if(i.selectedForeignTable=l,i.secondaryTemplateId=c,"join file"==d){const p=this.mergeCheckedList.filter(g=>g.showMergeName==l);s.pkFKs[a+1].foreignKeyList=p[0].mergeFieldListDTOFromAPI}else{const p=i.foreignTableList.filter(g=>g.fileName==l);s.pkFKs[a+1].foreignKeyList=p[0].columnList}const m=[...s.pkFKs.filter(p=>p.selectedPrimaryTable).map(p=>p.selectedPrimaryTable),...s.pkFKs.filter(p=>p.selectedForeignTable).map(p=>p.selectedForeignTable)],h=[];s.pkFKs[0].primaryTableList.forEach(p=>{m.includes(p.fileName)&&h.push(p)}),null!=s.pkFKs[a+2]&&(s.pkFKs[a+2].secondaryTableList=h),s.dataSetMergeListDTOs[i.order-1].secondaryTemplateId=c}changeSecondaryKeyInDS(t,o,i,a,s){const l=t.target.value;i.selectedForeignKey=l;const c=i.foreignKeyList.filter(d=>d.fieldName==l);i.secondaryKeyId=c[0].columnId,s.dataSetMergeListDTOs[i.order-1].secondaryKeyId=c[0].columnId}accordionFilesRowClicked(t,o,i,a,s){const l=i.showTabColName,c=i.columnType;"textArea"==this.textAreaIndexinCE.tagType&&this.textAreaSlice(l),"input"==this.textAreaIndexinCE.tagType&&(this.createExpressionList[this.textAreaIndexinCE.index].fileType=s,this.createExpressionList[this.textAreaIndexinCE.index].sourceFieldName=l,this.createExpressionList[this.textAreaIndexinCE.index].columnType=c,this.createExpressionList[this.textAreaIndexinCE.index].sqlColumn=i.sqlColumn,"date"==c||"datetime2"==c||"dateTime"==c?(this.createExpressionList[0].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]):this.createExpressionList[0].isColumnType=!1,("char"==c||"varchar"==c||"text"==c||"nvarchar"==c)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]),("int"==c||"float"==c||"money"==c||"decimal"==c||"bigint"==c)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]))}inputInCreateExpression(t,o){this.createExpressionList[o].sourceFieldName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"input"}}textAreaInCreateExpression(t,o){this.createExpressionList[o].sourceExpressionName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"textArea"}}createDataSetinDM(){var t;1!=this.datasetDetailsList.filter(i=>1==i.isDatasetTableExpand).length&&(this.enableDataSetPopUp=!0,null===(t=this.datasetForm.get("appendNameControl"))||void 0===t||t.reset())}accordionExpValue(t,o){this.textAreaSlice(t.functionType),this.isOpenAccordion=!1}changeDTinCreateExpression(t,o){this.createExpressionList[o].columnType=t.value,"date"==t.value||"datetime2"==t.value||"dateTime"==t.value?(this.createExpressionList[o].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"ON"},{id:3,value:"AFTER (ABSOLUTE)"},{id:4,value:"BEFORE (ABSOLUTE)"},{id:5,value:"AFTER (RELATIVE)"},{id:6,value:"BEFORE (RELATIVE)"},{id:7,value:"NOT"},{id:8,value:"NOT IN"},{id:9,value:"TODAY"},{id:10,value:"YESTERDAY"},{id:11,value:"THIS WEEK"},{id:12,value:"LAST WEEK"},{id:13,value:"THIS MONTH"},{id:14,value:"LAST MONTH"}]):this.createExpressionList[o].isColumnType=!1,("char"==t.value||"varchar"==t.value||"text"==t.value||"nvarchar"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"PRESENT"},{id:3,value:"BLANK"},{id:4,value:"LIKE"},{id:5,value:"NOT LIKE"},{id:6,value:"IS"},{id:7,value:"NOT"},{id:8,value:"NOT IN"},{id:9,value:"STARTS WITH"},{id:10,value:"ENDS WITH"},{id:11,value:"IN"},{id:12,value:"CONTAINS"},{id:13,value:""}]),("int"==t.value||"float"==t.value||"money"==t.value||"decimal"==t.value||"bigint"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:"&gt;="},{id:7,value:"&gt;"},{id:8,value:"&lt;"},{id:9,value:"&lt;="}]),this.createExpressionList[o].whereList=[]}changeDateTimeinCreateExpression(t,o){this.createExpressionList[o].columnFormat=t.value.value}datasetTableExpand(t,o){this.datasetDetailsList[o].isDatasetTableExpand=!0,t.isDatasetTableExpand=t.isDatasetTableExpand=!0}editRowInDataSet(t,o,i){var a,s,l,c,d,_;this.datasetDetailsList[t].datasetFieldDTOList.forEach(u=>u.isEdit=!1),i.isEdit=!0,this.createExpressionForm.reset(),this.createExpressionForm.controls.whereList=this.fb.array([]),this.createExpressionList=[],this.createExpressionList.push(JSON.parse(JSON.stringify(i))),null===(a=this.createExpressionForm.get("sourceFieldName"))||void 0===a||a.patchValue(i.sourceFieldName),null===(s=this.createExpressionForm.get("columnType"))||void 0===s||s.patchValue(i.columnType),i.isColumnType&&(null===(l=this.createExpressionForm.get("dateTimeFormats"))||void 0===l||l.patchValue(i.columnFormat)),null===(c=this.createExpressionForm.get("sourceExpressionName"))||void 0===c||c.patchValue(i.sourceExpressionName),null===(d=this.createExpressionForm.get("signOperator"))||void 0===d||d.patchValue(i.signOperator),null===(_=this.createExpressionForm.get("value"))||void 0===_||_.patchValue(i.value),i.whereList.forEach((u,f)=>{this.whereArr().push(this.addWhereRowInCE()),this.whereArr().controls[f].patchValue({value:u.value,operator:u.operator,signOperator:u.signOperator})})}deleteRowInDataset(t,o,i){var a,s,l;1==this.datasetDetailsList[t].datasetFieldDTOList[o].isEdit&&(this.createExpressionList=[{sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}]),null===(a=this.datasetDetailsList[t])||void 0===a||a.datasetFieldDTOList.splice(o,1),null===(s=this.datasetDetailsList[t])||void 0===s||s.orderBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.orderBytoDB.splice(d,1))}),null===(l=this.datasetDetailsList[t])||void 0===l||l.groupBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.groupBytoDB.splice(d,1))})}getAllDataSetNameAPI(){this.solService.getAllDatasetName(this.process.processId).subscribe(t=>{null!=t&&(t.responseData.forEach(o=>{const i=[];o.datasetFieldDTOList.forEach(a=>{a.showTabColName=o.datasetName+"["+a.fieldName+"]",a.groupBy="",a.isColumnType=!1,a.isEdit=!1,a.or="",a.orderBy="",a.whereList=[];const l=a.tableName+"."+a.columnName,c=a.where.split(" ").join().split(l).join().split(",");c.forEach(u=>{}),""==c.join()&&i.push({filefieldName:a.sourceFieldName,dbtablefieldName:a.tableName+"."+a.columnName})}),o.isDatasetTableExpand=!1,o.orderBytoDB=i,o.groupBytoDB=i}),this.allDatasetDetailsList=t.responseData,t.responseData.forEach(o=>{o.datasetFieldDTOList.forEach(i=>{i.fileType="dataset",i.fieldIDforExpn=i.datasetFieldId}),this.allTableListInDM.push({fileType:"dataset",tableName:o.datasetName,idName:"datasetId",ID:o.datasetId,columnList:o.datasetFieldDTOList,isSelecteddl:!1})})),this.tablecolNameList=[],this.tablecolNameList=this.allTableListInDM.map(o=>o.columnList.map(i=>({tableName:o.tableName,fileType:o.fileType,fieldID:o.fieldID,showTabColName:i.showTabColName,fieldIDforExpn:i.fieldIDforExpn,tableColumnName:i.tableColumnName}))).reduce((o,i)=>o.concat(i),[]),this.loader.hide()},t=>{this.loader.hide()})}nextBtnEnableInUF(){this.isUploadFilesNextBtnEnable=0==this.fileListt.filter(o=>{var i;return null===(i=o.totalSheetList)||void 0===i?void 0:i.some(a=>1==a.isSheetSelected)}).map(o=>Object.assign({},o,{totalSheetList:o.totalSheetList.filter(i=>1==i.isSheetSelected)})).length}deleteDataSet(t){this.datasetDetailsList.splice(t,1),this.createExpressionList=[],this.datasetDetailsList=[],this.createExpressionForm.reset()}changeTabs(t,o){var i,a,s;if(1==t.id){if(this.fileListtt=[],this.nextBtnEnableInUF(),1==this.isUploadFilesNextBtnEnable)return;this.fileListt.forEach(l=>{0!=l.totalSheetList.filter(c=>c.isSheetSelected).length&&this.fileListtt.push(l)})}if(2==t.id&&this.sortedCheckedList.forEach(l=>l.isSelected=!1),3==t.id&&this.sortedList[0].forEach(l=>l.isSelected=!1),this.submitted=!1,this.submittedErrorMsg="",4==t.id&&(this.sortedCheckedList.forEach(l=>l.isSelected=!1),this.getTargetFileList()),4==t.id&&"prev"==o&&(this.createExpressionList=[],this.datasetDetailsList=[]),5==t.id&&(this.getAllFunctions(),this.allTableListInDM=[],this.allList(),this.getAllDataSetNameAPI()),"unChedkedList"==o&&(console.log("only reset"),0!=(null===(i=this.sortedList[0])||void 0===i?void 0:i.length)&&(this.unCheckedListAddToMergeList=this.sortedList[0].filter(l=>0==l.isSelected),this.unCheckedListAddToMergeList.forEach(l=>{const c=[l].map(f=>[f.fileName,f.sheetName].join("-")),_=[];l.sheet.forEach(f=>{const h=Object.assign(Object.assign({},f),{isChecked:!1,dataType:"Select Data Type",newfieldName:"",isRowEdit:!1,fileSheet:c,generatedDataType:"",tableName:l.tableName});_.push(h)}),this.sortedCheckedList.push({columnList:_,showAppendName:c,fileName_SheetName:c,tableList:[l],isSelected:!1}),this.appendUnchechedList=[],this.appendUnchechedList=JSON.parse(JSON.stringify(this.sortedCheckedList))}))),"prevInMerge"==o&&0!=(null===(a=this.sortedList[0])||void 0===a?void 0:a.length)){let l=null===(s=this.sortedList[0])||void 0===s?void 0:s.length;this.sortedCheckedList.splice(this.sortedCheckedList.length-l,this.unCheckedListAddToMergeList.length)}this.tabs.forEach(l=>{l.isActive=t.id==l.id}),this.filesList.forEach(l=>{l.checkedSheetList=l.sheetList.filter(c=>c.isSelected)})}MergeSubmit(){this.loader.show(),console.log(this.joinSetForm.value,this.process.processId);let t={};t.processId=this.process.processId,t.templatesMergeDetailsList=[],this.MergeArr().controls.forEach((o,i)=>{t.templatesMergeDetailsList[i]={},t.templatesMergeDetailsList[i].mergeName=this.mergeCheckedList[i].showMergeName,t.templatesMergeDetailsList[i].templatesMergeList=[],t.templatesMergeDetailsList[i].mergeTableDetails=[],this.mergeCheckedList.forEach(()=>{this.mergeCheckedList[i].dropDownList[0].primaryTableList.forEach((a,s)=>{t.templatesMergeDetailsList[i].mergeTableDetails[s]={},a.value.join().includes("-")?(t.templatesMergeDetailsList[i].mergeTableDetails[s].id=a.templateId,t.templatesMergeDetailsList[i].mergeTableDetails[s].type="T"):this.appendAPIResp.appendSheetList.forEach(l=>{l.appendName==a.value.join()&&(t.templatesMergeDetailsList[i].mergeTableDetails[s].id=l.appendID,t.templatesMergeDetailsList[i].mergeTableDetails[s].type="A")})})}),this.TableArr(i).controls.forEach((a,s)=>{t.templatesMergeDetailsList[i].templatesMergeList[s]={};let d,_,l=a.value.table1.templateId,c=a.value.table2.templateId;null==l?this.appendAPIResp.appendSheetList.forEach(u=>{u.appendName==a.value.table1.value.join()&&(t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTemplateId=u.appendID,t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTableName=u.appendName,d=u.appendName)}):(t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTemplateId=l,t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTableName=a.value.table1.tableName),null==c?this.appendAPIResp.appendSheetList.forEach(u=>{u.appendName==a.value.table2.value.join()&&(t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTemplateId=u.appendID,t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTableName=u.appendName,_=u.appendName)}):(t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTemplateId=c,t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTableName=a.value.table2.tableName),t.templatesMergeDetailsList[i].templatesMergeList[s].joinType=a.value.join[0],t.templatesMergeDetailsList[i].templatesMergeList[s].order=0==s?1:2,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList=[],this.columnArr(i,s).controls.forEach((u,f)=>{t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f]={},null==l?this.appendAPIResp.appendSheetList.forEach(m=>{m.appendName==d&&m.tableAppendFieldsDto.forEach(h=>{h.columnName==u.value.column1.columnName&&(t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryKeyId=h.fieldID)})}):t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryKeyId=u.value.column1.columnId,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryFieldName=u.value.column1.columnName,null==c?this.appendAPIResp.appendSheetList.forEach(m=>{m.appendName==_&&m.tableAppendFieldsDto.forEach(h=>{h.columnName==u.value.column2.columnName&&(t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryKeyId=h.fieldID)})}):t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryKeyId=u.value.column2.columnId,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryFieldName=u.value.column2.columnName})})}),console.log(t),this.solService.addJoinFiles(t).subscribe(o=>{console.log(o);let i=[];const a=o.responseData.templatesMergeDetailsList;a.forEach(s=>{s.templatesMergeList.forEach(l=>{l.columnArrayList.forEach(c=>{i.push({joinType:l.joinType,primaryTemplateId:l.primaryTemplateId,secondaryTemplateId:l.secondaryTemplateId,primaryKeyId:c.primaryKeyId,secondaryKeyId:c.secondaryKeyId}),this.toast.success({title:"Success",message:"Saved Successfully !"})})}),console.log(i),a.forEach(l=>{this.mergeCheckedList.forEach(c=>{l.mergeName==c.showMergeName&&(c.mergeIdFromAPI=l.mergeId,c.templatesMergeIdsListFromAPI=i,c.mergeFieldListDTOFromAPI=l.mergeFieldListDTO)})})}),this.loader.hide()},o=>{this.loader.hide()})}isAllSelected(t,o,i,a){this.submitted=!1,this.submittedErrorMsg="",this.hideCreateIdenticalBtnWithLength=!0,this.sortedList.forEach((s,l)=>{l==i&&s.forEach((c,d)=>{d==a&&(c.isSelected=t.target.checked)})})}createIdentical(t){var o;if(-1==t){this.sortedList=this.sortedList.splice(1,1);let i=[];this.fileListtt.forEach(s=>{s.totalSheetList.forEach(l=>{if(l.isSheetSelected){const c=l.sheet.map(_=>_.fieldName);let d=Object.assign(Object.assign({fileName:s.fileName,isSelected:!1},l),{[l.sheetName]:l.sheetData,fieldNames:c,[l.sheetName+"columnList"]:c});i.push(d)}})}),this.sortedList.push(i);const a=[];this.fileListtt.forEach(s=>{s.totalSheetList.forEach(l=>{l.isSheetSelected&&a.push(Object.assign({fileName:s.fileName},l))})}),JSON.parse(JSON.stringify(this.fileListtt)).forEach(s=>{s.totalSheetList.forEach(l=>{l.isSheetSelected&&this.fileSheetList.push(Object.assign({fileName:s.fileName+"-"+l.sheetName},l))})})}if(0==t){this.sortedList[t].filter(c=>0==c.isSelected);let a=this.sortedList[t].filter(c=>1==c.isSelected),s=[],l=0;if(a.forEach(c=>{const _=c.sheetName;if(0==s.length)s=c[_+"columnList"];else{let u=c[_+"columnList"];s.forEach(f=>{u.includes(f)||(l=1)})}}),1==l)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");this.enableAppendNamePopup=!0,null===(o=this.appendForm.get("appendNameControl"))||void 0===o||o.reset()}2==t&&(this.appendUnchechedList.forEach(i=>{i.isSelected=!1}),this.sortedCheckedList=this.appendUnchechedList)}join2Sheets(){var t;if(this.sortedCheckedList.filter(i=>1==i.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Please select atleast two sheets");this.enableMergeNamePopup=!0,null===(t=this.joinForm.get("appendNameControl"))||void 0===t||t.reset()}mergeSet(){var t,o;this.submit=!0,this.addMergeJoin();let i=[],a=[],s=this.sortedCheckedList.filter(p=>p.isSelected),l=[],c=[];const d=[],_=[];s.forEach(p=>{p.fileName_SheetName.forEach(g=>{l.push(g)}),p.tableList.forEach(g=>{i.push(g)}),p.showAppendName.forEach(g=>{c.push(g)}),p.columnList.forEach(g=>{var v,x;(g=JSON.parse(JSON.stringify(g))).showTabColName=(null===(v=this.joinForm.get("appendNameControl"))||void 0===v?void 0:v.value.trim())+"["+g.fieldName+"]",d.push(Object.assign(Object.assign({},g),{joinName:null===(x=this.joinForm.get("appendNameControl"))||void 0===x?void 0:x.value.trim()}))}),p.columnList.forEach(g=>{_.push(g)}),p.columnListtt=_}),s.forEach(p=>{let g,v;p.showAppendName.join().includes("-")&&(g=p.tableList[0].templateId,v=p.tableList[0].tableName),a.push({value:p.showAppendName,templateId:g,tableName:v,sheet:p.columnList,isSelected:!1})}),a.primaryKeyList=[];const u=[{type:null,primaryTableList:c,selectedPrimaryTable:"",optionValue:"select Primary Table",order:1},{type:null,primaryKeyList:[],selectedPrimaryKey:"",optionValue:"select Primary Key",order:1},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:1}];let f={type:null,foreignTableList:[],selectedForeignTable:"",optionValue:"select Foreign Table",order:1};u.push(f),f={},f.type=null,f.foreignKeyList=[],f.selectedForeignKey="",f.optionValue="select Foreign Key",f.order=1,u.push(f);let m=[];m.foreignKeyList=[];let h={dropDownList:[{primaryTableList:a,foreignTableList:m,columns:[{primaryKeyList:[],foreignKeyList:[]}]}],columnList:d,mergeList:s,showMergeName:null===(t=this.joinForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),mergedTableList:i,showMergeSheetNames:c,pkFkMergeTypeList:u,templatesMergeList:[{order:1,mergeName:null===(o=this.joinForm.get("appendNameControl"))||void 0===o?void 0:o.value.trim()}]};this.mergeCheckedList.push(h),this.enableMergeNamePopup=!1,this.sortedCheckedList.forEach(p=>{p.isSelected=!1})}resetMerge(){this.mergeCheckedList=[];const t=this.appendUnchechedList.filter(i=>1==i.isAppend),o=this.appendUnchechedList.filter(i=>null==i.isAppend);if(console.log(this.sortedCheckedList,"reset merge"),t.length>0&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),0==t.length&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),o.length>0){const i=o.map(a=>a.tableList[0]);this.sortedList[0]=JSON.parse(JSON.stringify(i))}this.changeTabs({id:3},"unChedkedList"),this.MergeArr().clear()}addAppendName(){if(this.sortedList[0].filter(o=>1==o.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="please select atleast 2 checkboxes");this.createIdentical(0)}createAppendSet(){var t;if(this.submited=!0,console.log(this.appendForm),this.appendForm.invalid)return;let o=this.sortedList[0].filter(c=>c.isSelected);this.sortedList[0].forEach(c=>c.isSelected=!1);const i=o.map(c=>[c.fileName,c.sheetName].join("-")),s=[];o[0].sheet.forEach(c=>{var d,_,u;(c=JSON.parse(JSON.stringify(c))).showTabColName=(null===(d=this.appendForm.get("appendNameControl"))||void 0===d?void 0:d.value.trim())+"["+c.fieldName+"]";const f=Object.assign(Object.assign({},c),{isChecked:!1,dataType:"Select Data Type",newfieldName:"",isRowEdit:!1,fileSheet:[null===(_=this.appendForm.get("appendNameControl"))||void 0===_?void 0:_.value.trim()],appendName:null===(u=this.appendForm.get("appendNameControl"))||void 0===u?void 0:u.value.trim()});s.push(f)});const l={columnList:s,showAppendName:[null===(t=this.appendForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim()],fileName_SheetName:i,tableList:o,isSelected:!1,isAppend:!0};this.sortedCheckedList.push(l),this.enableAppendNamePopup=!1}checkedInJoin(t,o,i){this.submitted=!1,this.submittedErrorMsg="",o.isSelected=t.target.checked}saveDataSetApi(){let t={};if(t.processId=this.process.processId,this.enableUploadSQLPopup)t.datasetName=this.sqlScriptForm.value.datasetName,t.sqlScript=this.sqlScriptForm.value.sqlScript,this.solService.addDataset(t).subscribe(o=>{this.allTableListInDM.forEach((i,a)=>{"dataset"==i.fileType&&this.allTableListInDM.splice(a,1)}),this.getAllDataSetNameAPI(),this.loader.hide()},o=>{this.loader.hide()});else{t.dataSetMergeListDTOs=[],this.DataSetArr().controls.forEach((a,s)=>{t.dataSetMergeListDTOs[s]={},("append"==a.value.Ptable.fileType||"join"==a.value.Ptable.fileType||"files"==a.value.Ptable.fileType||"dataset"==a.value.Ptable.fileType)&&(t.dataSetMergeListDTOs[s].primaryTemplateId=a.value.Ptable.ID),("append"==a.value.Ftable.fileType||"join"==a.value.Ftable.fileType||"files"==a.value.Ftable.fileType||"dataset"==a.value.Ftable.fileType)&&(t.dataSetMergeListDTOs[s].secondaryTemplateId=a.value.Ftable.ID),t.dataSetMergeListDTOs[s].primaryTableName="files"==a.value.Ptable.fileType?a.value.Ptable.tableNameDB:a.value.Ptable.tableName,t.dataSetMergeListDTOs[s].secondaryTableName="files"==a.value.Ftable.fileType?a.value.Ftable.tableNameDB:a.value.Ftable.tableName,t.dataSetMergeListDTOs[s].columnArrayList=[],this.columnArrInDS(s).controls.forEach((l,c)=>{t.dataSetMergeListDTOs[s].columnArrayList[c]={},"append"==l.value.column1.fileType?t.dataSetMergeListDTOs[s].columnArrayList[c].primaryKeyId=l.value.column1.fieldID:"join"==l.value.column1.fileType||"files"==l.value.column1.fileType?t.dataSetMergeListDTOs[s].columnArrayList[c].primaryKeyId=l.value.column1.columnId:"dataset"==l.value.column1.fileType&&(t.dataSetMergeListDTOs[s].columnArrayList[c].primaryKeyId=l.value.column1.datasetFieldId),"append"==l.value.column2.fileType?t.dataSetMergeListDTOs[s].columnArrayList[c].secondaryKeyId=l.value.column2.fieldID:"join"==l.value.column2.fileType||"files"==l.value.column2.fileType?t.dataSetMergeListDTOs[s].columnArrayList[c].secondaryKeyId=l.value.column2.columnId:"dataset"==l.value.column2.fileType&&(t.dataSetMergeListDTOs[s].columnArrayList[c].secondaryKeyId=l.value.column2.datasetFieldId),t.dataSetMergeListDTOs[s].columnArrayList[c].primaryFieldName=l.value.column1.columnName,t.dataSetMergeListDTOs[s].columnArrayList[c].secondaryFieldName=l.value.column2.columnName}),t.dataSetMergeListDTOs[s].joinType=a.value.join.slice(0,1),t.dataSetMergeListDTOs[s].order=s,console.log(a.value,a),console.log(a.controls.Ptable.value)});const o=[],i=this.datasetDetailsList.filter(a=>a.isDatasetTableExpand);i[0].datasetFieldDTOList.forEach(a=>{null!=a.sourceExpressionName&&(""==a.sourceExpressionName.trim()||0==a.sourceExpressionName.trim().length)&&(a.sourceExpressionName=null);let s=a.sourceExpressionName;null!=s&&this.tablecolNameList.forEach(l=>{s.includes(l.showTabColName)&&(s=JSON.parse(JSON.stringify(s.split(l.showTabColName).join(l.tableColumnName))))}),o.push({tableName:a.tableName,columnFormat:a.columnFormat,columnName:a.columnName,fieldName:a.fieldName,sourceExpressionName:a.sourceExpressionName,expression:s,columnType:a.columnType,where:a.where,or:a.or,groupBy:"",sourceFieldName:a.sourceFieldName})}),t.datasetFieldDTOList=o,t.datasetName=i[0].datasetName,null!=i[0].groupBy&&(t.groupBy=""==i[0].groupBy.trim()||0==i[0].groupBy.trim().length?null:i[0].groupBy),null!=i[0].orderBy&&(t.orderBy=""==i[0].orderBy.trim()||0==i[0].orderBy.trim().length?null:i[0].orderBy),null!=i[0].having&&(t.having=""==i[0].having.trim()||0==i[0].having.trim().length?null:i[0].having),t.calender="",i[0].datasetId&&(t.datasetId=i[0].datasetId),this.solService.addDataset(t).subscribe(a=>{this.allTableListInDM.forEach((s,l)=>{"dataset"==s.fileType&&this.allTableListInDM.splice(l,1)}),this.tablecolNameList.forEach((s,l)=>{"dataset"==s.fileType&&this.tablecolNameList.splice(l,1)}),this.getAllDataSetNameAPI(),this.loader.hide(),this.saveDataSetPopup=!1,this.createExpressionList=[],this.datasetDetailsList=[]},a=>{this.loader.hide()})}}callGetViewscript(t){this.loader.show(),this.solService.getViewScript(t.datasetId).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.sqlScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptPopup=!0,this.loader.hide()},i=>{this.loader.hide()})}updateScriptByDatasetId(t){this.loader.show();const o={datasetId:t.value.datasetId,newScript:t.value.sqlScript.trim()};this.solService.updateScriptByDatasetId(o).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.newScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.loader.hide()},i=>{this.loader.hide()})}editDatasetFile(t){var o,i;this.createExpressionList=[{sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],t.isDatasetTableExpand=!0,this.datasetDetailsList[0]=t;let a=[],s=[];null!=t.orderBy&&(a=t.orderBy.split(",")),null!=t.groupBy&&(s=t.groupBy.split(",")),null===(o=this.datasetTableForm.get("orderBy"))||void 0===o||o.patchValue(a),null===(i=this.datasetTableForm.get("groupBy"))||void 0===i||i.patchValue(s)}saveAppendAPI(){const t=[];this.sortedCheckedList.forEach(i=>{const a=[];i.tableList.forEach(s=>{a.push({sheetId:s.templateId})}),t.push({appendDtos:a,appendName:i.showAppendName.join()})}),this.solService.addAppendFiles({processId:this.process.processId,appendSheetList:t}).subscribe(i=>{this.appendAPIResp=i.responseData,this.sortedCheckedList.forEach(a=>{a.isPreviewEnable=!0}),this.toast.success({title:"Success",message:"Saved Successfully !"}),this.loader.hide()},i=>{this.loader.hide()})}applyFilter(t){this.searchfx=this.fx.filter(o=>this.containsValue(o,t.target.value.trim().toLowerCase()))}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}selectuser(t,o){}selectPrimaryTable(t,o,i){var a;let l=this.mergeCheckedList[i].dropDownList[o];l.columns[0].primaryKeyList=t.value.sheet,0==o&&(l.primaryTableList.forEach(c=>JSON.parse(JSON.stringify(c)).isSelected=!1),t.value.isSelected=!0,l.foreignTableList=l.primaryTableList.filter(c=>!c.isSelected)),console.log(null===(a=this.mergeCheckedList[i])||void 0===a?void 0:a.dropDownList[o])}selectForeignTable(t,o,i){let s=this.mergeCheckedList[i].dropDownList[o];this.mergeCheckedList[i].dropDownList[o].foreignTableList.forEach(d=>JSON.parse(JSON.stringify(d)).isSelected=!1),t.value.isSelected=!0,s.columns[0].foreignKeyList=t.value.sheet;let l=[],c=[];if(0==o){const d=this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>1==JSON.parse(JSON.stringify(h)).isSelected)[0];l.push(d);const _=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>1==JSON.parse(JSON.stringify(h)).isSelected)[0];l.push(_),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>0==JSON.parse(JSON.stringify(h)).isSelected).forEach(h=>c.push(h)),this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>0==JSON.parse(JSON.stringify(h)).isSelected).forEach(h=>c.push(h));let m=[];m=c.filter((h,p,g)=>g.findIndex(v=>["templateId"].every(x=>v[x]===h[x]))===p),m.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:m},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}else{this.mergeCheckedList[i].dropDownList[o].primaryTableList.forEach(f=>l.push(f));const d=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>1==f.isSelected)[0];l.push(d),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>0==f.isSelected).forEach(f=>c.push(f));let u=c.filter((f,m,h)=>h.findIndex(p=>["templateId"].every(g=>p[g]===f[g]))===m);u.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:u},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}console.log(this.mergeCheckedList[i].dropDownList[o+1])}selectPrimarykey(t,o,i,a){let l=JSON.parse(JSON.stringify(this.mergeCheckedList[a].dropDownList[i].columns[o].primaryKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.mergeCheckedList[a].dropDownList[i].columns[o+1]?this.mergeCheckedList[a].dropDownList[i].columns.push({primaryKeyList:l}):this.mergeCheckedList[a].dropDownList[i].columns[o+1].primaryKeyList=l}selectForeignKey(t,o,i,a){let l=JSON.parse(JSON.stringify(this.mergeCheckedList[a].dropDownList[i].columns[o].foreignKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.mergeCheckedList[a].dropDownList[i].columns[o+1]?this.mergeCheckedList[a].dropDownList[i].columns.push({foreignKeyList:l}):this.mergeCheckedList[a].dropDownList[i].columns[o+1].foreignKeyList=l}selectJoin(t,o,i){this.mergeCheckedList[i].dropDownList[o].joinType=t.value}previewPopup(t,o,i,a,s){this.rowCount="",""!=s||0!=(null==s?void 0:s.length)?(this.loader.show(),this.solService.viewTableDetails(s).subscribe(l=>{null!=l.responseData?(this.selectedM_A_S=l.responseData.tableDetails,this.rowCount=l.responseData.count,this.preview(),this.showTargetFilePopup=!0):this.toast.error({title:"Error",message:l.statusMessage}),this.loader.hide()},l=>{this.loader.hide()})):(this.showTargetFilePopup=!0,this.selectedM_A_S=o.sheetData,this.showTargetFilePopup=!0,this.preview())}preview(){for(var t in this.columnsArr=[],this.selectedM_A_S[0])this.selectedM_A_S[0].hasOwnProperty(t)&&this.columnsArr.push(t)}selectgroupByOrderByInDM(t,o,i,a){const s=t.value;"groupby"==a&&(this.datasetDetailsList.filter(l=>1==l.isDatasetTableExpand)[0].groupBy=s.join()),"orderby"==a&&(this.datasetDetailsList.filter(l=>1==l.isDatasetTableExpand)[0].orderBy=s.join())}executeProject(){this.loader.show(),this.solService.execSolutionScript(this.process.processId).subscribe(t=>{this.loader.hide()},t=>{this.loader.hide()})}fileClickedinTF(t,o,i,a){this.targetFiles.forEach(s=>{s.sheetList.forEach(l=>{l.isRowTabAvtive=!1})}),i.isRowTabAvtive=!0,this.fileTypeInTF=a,0==o?this.clickedRowDataInTF=i.tableAppendFieldsDto:1==o?this.clickedRowDataInTF=i.mergeFieldListDTO:2==o&&(this.clickedRowDataInTF=i.sheet)}getTargetFileList(){this.loader.show(),this.solService.getTargetFileList(this.process.processId).subscribe(t=>{t.responseData.appendSheetListDto.appendSheetList.forEach(o=>{o.tableAppendFieldsDto.forEach(i=>{i.showTabColName=o.appendName+"["+i.fieldName+"]"})}),t.responseData.templateMergeListDTO.templatesMergeDetailsList.forEach(o=>{o.mergeFieldListDTO.forEach(i=>{i.showTabColName=o.mergeName+"["+i.fieldName+"]"})}),this.targetFiles=[{fileType:"append",sheetList:t.responseData.appendSheetListDto.appendSheetList},{fileType:"join",sheetList:t.responseData.templateMergeListDTO.templatesMergeDetailsList},{fileType:"files",sheetList:this.fileSheetList}],this.loader.hide()},t=>{this.loader.hide()})}allList(){this.targetFiles.forEach((t,o)=>{0==o?t.sheetList.forEach(i=>{i.tableAppendFieldsDto.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.fieldID}),this.allTableListInDM.push({fileType:t.fileType,tableName:i.appendName,idName:"appendID",ID:i.appendID,appendID:i.appendID,columnList:i.tableAppendFieldsDto,isSelecteddl:!1})}):1==o?t.sheetList.forEach(i=>{i.mergeFieldListDTO.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableName:i.mergeName,idName:"mergeId",ID:i.mergeId,mergeId:i.mergeId,columnList:i.mergeFieldListDTO,isSelecteddl:!1})}):2==o&&t.sheetList.forEach(i=>{i.sheet.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableName:i.fileName,tableNameDB:i.tableName,idName:"templateId",ID:i.templateId,templateId:i.templateId,columnList:i.sheet,isSelecteddl:!1})})})}closeDatasetPopup(){this.dataSetForm.controls.DSetRows=this.fb.array([]),this.saveDataSetPopup=!1}saveDataSet(t,o){if(this.selectedColumnsOfDS=[],null==t||t.datasetFieldDTOList.forEach(i=>{let a;a=i.sourceFieldName.includes("-")?i.sourceFieldName.split("[")[0]:i.tableName,this.allTableListInDM.forEach(l=>{l.tableName==a&&0==this.selectedColumnsOfDS.filter(d=>d.tableName==l.tableName).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},l),{isSelecteddl:!1}))})}),this.selectedColumnsOfDS.length<2){let i={};i.processId=this.process.processId,1==this.selectedColumnsOfDS.length?"append"==this.selectedColumnsOfDS[0].fileType||"join"==this.selectedColumnsOfDS[0].fileType?i.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableName}]:"files"==this.selectedColumnsOfDS[0].fileType?i.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableNameDB}]:"dataset"==this.selectedColumnsOfDS[0].fileType&&(i.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableName}]):0==this.selectedColumnsOfDS.length&&(i.dataSetMergeListDTOs=[]);const a=[],s=this.datasetDetailsList.filter(l=>l.isDatasetTableExpand);s[0].datasetFieldDTOList.forEach(l=>{null!=l.sourceExpressionName&&(""==l.sourceExpressionName.trim()||0==l.sourceExpressionName.trim().length)&&(l.sourceExpressionName=null);let c=l.sourceExpressionName;null!=c&&this.tablecolNameList.forEach(d=>{c.includes(d.showTabColName)&&(c=JSON.parse(JSON.stringify(c.split(d.showTabColName).join(d.tableColumnName))))}),a.push({tableName:l.tableName,columnFormat:l.columnFormat,columnName:l.columnName,fieldName:l.fieldName,sourceExpressionName:l.sourceExpressionName,expression:c,columnType:l.columnType,where:l.where,or:l.or,groupBy:"",sourceFieldName:l.sourceFieldName})}),i.datasetFieldDTOList=a,i.datasetName=s[0].datasetName,null!=s[0].groupBy&&(i.groupBy=""==s[0].groupBy.trim()||0==s[0].groupBy.trim().length?null:s[0].groupBy),null!=s[0].orderBy&&(i.orderBy=""==s[0].orderBy.trim()||0==s[0].orderBy.trim().length?null:s[0].orderBy),null!=s[0].having&&(i.having=""==s[0].having.trim()||0==s[0].having.trim().length?null:s[0].having),i.calender="",s[0].datasetId&&(i.datasetId=s[0].datasetId),this.solService.addDataset(i).subscribe(l=>{console.log("call addDS"),this.allTableListInDM.forEach((c,d)=>{"dataset"==c.fileType&&(console.log("splice ds"),this.allTableListInDM.splice(d,1))}),this.getAllDataSetNameAPI(),this.loader.hide(),this.createExpressionList=[],this.datasetDetailsList=[]},l=>{this.loader.hide()})}else{this.dataSetForm.controls.DSetRows=this.fb.array([]),this.dataSetData=[];let i=[];i.primaryKeyList=[];let a=[];a.foreignKeyList=[],this.selectedColumnsOfDS.forEach(l=>{i.push(l)});let s={primaryTableList:i,foreignTableList:a,order:1,columns:[{primaryKeyList:[],foreignKeyList:[]}]};for(let l=0;l<this.selectedColumnsOfDS.length-1;l++)0==l?this.dataSetData.push(s):(i=[],i.primaryKeyList=[],this.dataSetData.push({primaryTableList:i,foreignTableList:a,columns:[{primaryKeyList:[],foreignKeyList:[]}],order:l+2})),this.DataSetArr().controls.push(this.DataSetRow());this.saveDataSetPopup=!0}this.DataSetArr().controls.forEach(i=>{console.log(i.value,i),console.log(i.controls.Ptable.value)})}selectPrimaryTableInDS(t,o){if(this.dataSetData[o].primaryTableList.forEach(i=>{JSON.parse(JSON.stringify(i)).isSelecteddl=!1}),t.value.isSelecteddl=!0,this.dataSetData[o].columns[0].primaryKeyList=t.value.columnList,0==o){let i=JSON.parse(JSON.stringify(this.dataSetData[o].primaryTableList.filter(a=>!a.isSelecteddl)));this.dataSetData[o].foreignTableList=i}else{let i=this.dataSetData[o-1].foreignTableList.filter(a=>!a.isSelecteddl);this.dataSetData[o].foreignTableList=i}}selectJoinTypeInDS(t,o){this.dataSetData[o].Join=t.value}selectForeignTableInDS(t,o){if(this.dataSetData[o].foreignTableList.forEach(i=>JSON.parse(JSON.stringify(i)).isSelecteddl=!1),t.value.isSelecteddl=!0,this.dataSetData[o].columns[0].foreignKeyList=t.value.columnList,0==o){let i=this.dataSetData[o].primaryTableList.filter(l=>l.isSelecteddl),a=this.dataSetData[o].foreignTableList.filter(l=>l.isSelecteddl),s=[];i.forEach(l=>s.push(l)),a.forEach(l=>s.push(l)),s.forEach(l=>JSON.parse(JSON.stringify(l)).isSelecteddl=!1),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=s)}else{let i=this.dataSetData[o].primaryTableList,a=this.dataSetData[o].foreignTableList.filter(l=>l.isSelecteddl),s=[];i.forEach(l=>s.push(l)),a.forEach(l=>s.push(l)),s.forEach(l=>JSON.parse(JSON.stringify(l)).isSelecteddl=!1),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=s)}}selectPrimaryKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].primaryKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({primaryKeyList:a}):this.dataSetData[i].columns[o+1].primaryKeyList=a}selectForeignKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].foreignKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({foreignKeyList:a}):this.dataSetData[i].columns[o+1].foreignKeyList=a}addcolumnRowInDS(t,o){this.columnArrInDS(o).push(this.addColumnInDS())}deletecolumnRowInDS(t,o){this.columnArrInDS(o).removeAt(t)}add_SaveCreateExpression(t){var o,i,a,s,l,c,d,_,u;if(0==t.sourceFieldName.trim().length||""==t.sourceFieldName.trim())return;const f=this.datasetDetailsList.filter(B=>1==B.isDatasetTableExpand),m=null===(o=f[0])||void 0===o?void 0:o.datasetFieldDTOList;let p,g,x,C,b,y,h=0;if(0!=m.length&&m.forEach(B=>{t.isEdit&&B.isEdit||B.sourceFieldName==t.sourceFieldName.trim()&&(h=1)}),1==h)return;if(t.sourceFieldName.includes("-")){g=t.sourceFieldName.split("[")[0],p=t.sourceFieldName.split("[")[1].split("]")[0],t.tableNameInDataset=g;const B=g.split("-"),J=B[0],O=B[1],ee=this.fileListtt.filter(pe=>pe.fileName==J);t.tableName=ee[0].totalSheetList.filter(pe=>pe.sheetName==O)[0].tableName}else t.sourceFieldName.includes("[")&&(t.tableName=t.sourceFieldName.split("[")[0]);this.datasetDetailsList[0].datasetFieldDTOList.map(B=>B.sourceFieldName),x=this.allTableListInDM.filter(B=>B.columnList.some(J=>J.showTabColName==t.sourceFieldName)).map(B=>Object.assign({},B,{columnList:B.columnList.filter(J=>J.showTabColName==t.sourceFieldName)})),0!=x.length&&(C=x[0].columnList[0].columnName,y=x[0].columnList[0].fieldName,b="files"==x[0].fileType?x[0].tableNameDB:x[0].tableName);let M=b+"."+C,A={};0==x.length?(A={filefieldName:t.sourceFieldName,dbtablefieldName:t.sourceFieldName},t.columnName=t.sourceFieldName,t.fieldName=t.sourceFieldName):(A={filefieldName:t.sourceFieldName,dbtablefieldName:M},t.columnName=C,t.fieldName=y),t.isEdit||(f[0].orderBytoDB.push(A),f[0].groupBytoDB.push(A)),t.isColumnType&&(t.columnFormat=null===(i=this.createExpressionForm.get("dateTimeFormats"))||void 0===i?void 0:i.value),t.signOperator=null===(a=this.createExpressionForm.get("signOperator"))||void 0===a?void 0:a.value,t.value=null===(s=this.createExpressionForm.get("value"))||void 0===s?void 0:s.value.trim();const U=[];let P;if(this.whereArr().controls.forEach((B,J)=>{U.push(B.value)}),t.whereList=U,P=null==b||null==C?t.sourceFieldName:b+"."+C,""!=t.signOperator||0!=t.signOperator.length){let B=[];""!=t.value&&""!=t.signOperator?(B=[P+" "+t.signOperator+" "+t.value],t.whereList.forEach(J=>{let O;O="IS NULL"==J.signOperator||"NOT NULL"==J.signOperator?J.operator+" "+P+" "+J.signOperator:J.operator+" "+P+" "+J.signOperator+" "+J.value,B.push(O)})):("IS NULL"==t.signOperator||"NOT NULL"==t.signOperator)&&(B=[P+" "+t.signOperator],t.whereList.forEach(J=>{let O;O="IS NULL"==J.signOperator||"NOT NULL"==J.signOperator?J.operator+" "+P+" "+J.signOperator:J.operator+" "+P+" "+J.signOperator+" "+J.value,B.push(O)})),t.where=B.join(" ")}0==(null==m?void 0:m.length)?m.push(t):t.isEdit?m.forEach((B,J)=>{B.isEdit&&(t.isEdit=!1,m.splice(J,1,t))}):m.push(t),this.createExpressionList=[{sourceFieldName:"",sourceExpressionName:"",columnId:"",columnFormat:"",signOperatorList:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",value:"",signOperator:"",whereList:[]}],null===(l=this.createExpressionForm.get("sourceFieldName"))||void 0===l||l.reset(),null===(c=this.createExpressionForm.get("columnType"))||void 0===c||c.reset(),null===(d=this.createExpressionForm.get("dateTimeFormats"))||void 0===d||d.reset(),null===(_=this.createExpressionForm.get("sourceExpressionName"))||void 0===_||_.reset(),null===(u=this.createExpressionForm.get("signOperator"))||void 0===u||u.reset(),this.createExpressionForm.controls.whereList=this.fb.array([])}deleteTables(t,o,i,a){console.log("e: ",t),console.log("item: ",o),this.solService.deleteTables({id:o.datasetId,type:a,operation:"delete"}).subscribe(s=>{console.log(s),this.allDatasetDetailsList.splice(this.allDatasetDetailsList.findIndex(l=>l.datasetId===o.datasetId),1)})}onCheck(t){console.log(t),this.allDatasetDetailsList.forEach(o=>{t.datasetId==o.datasetId&&(o.selected=!o.selected)}),console.log(this.allDatasetDetailsList)}SaveContinue(){let t=[];this.allDatasetDetailsList.forEach(i=>{i.selected&&t.push(i.datasetName)});let o={tables:t,processId:this.process.processId};console.log(o),this.solService.postPushDataSets(o).subscribe(i=>{console.log(i.responseData),this.router.navigate(["/user/admin1/powerbi-interface",{dataset:JSON.stringify(i.responseData)}])})}existDataset(){console.log(this.sqlScriptForm.value.datasetName),this.solService.getExistDataset(this.appendNameControl.value,"").subscribe(t=>{console.log(t)},t=>{this.toast.error({title:"Error",message:"Dataset Name Already Exists"})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(fe.F0),e.Y36(w.qu),e.Y36(ti.q),e.Y36(Nn.D),e.Y36(w.qu),e.Y36(e.Qsj),e.Y36(Jt.e),e.Y36(co.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-new-solution4"]],decls:25,vars:14,consts:[[1,"heading"],[2,"margin","0 0 5px"],[2,"color","#0076A8"],[1,"consen"],[2,"padding","10px"],[1,"bttn",2,"display","flex"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","combination",4,"ngIf"],["mat-button",""],["class","dds-icon dds-icon_chevron_right__l__stroke next",4,"ngIf"],[1,"dds-icon","dds-icon_chevron_right__l__stroke","next"],[1,"row"],["style","float:left ; width:100%",4,"ngIf"],["class","createNewSoltionsTable",4,"ngFor","ngForOf"],[2,"text-align","right","margin","20px 0 0 0"],["mat-button","","class","btnn","style","border:1px solid #0076A8; background: #fff; color: #0076A8;",3,"click",4,"ngIf"],["mat-button","","class","btnn",3,"disabled","click",4,"ngIf"],[2,"float","left","width","100%"],[1,"but"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],[1,"note","required-field"],[1,"header"],[1,"selectCheck"],["type","checkbox","name","list_name","value","m1",3,"ngModel","ngModelChange","change"],[1,"createNewSoltionsTable"],[1,"dds-icon","dds-icon_file_xls__l__filled"],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","ngModelChange","change"],["src","../../../../assets/images/xls_sheet.png","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["src","../../assets/images/loading.gif","alt","","width","20px","height","20px",2,"margin-top","-4px","margin-left","100px"],["mat-button","",1,"btnn",2,"border","1px solid #0076A8","background","#fff","color","#0076A8",3,"click"],["mat-button","",1,"btnn",3,"disabled","click"],[2,"padding-bottom","70px"],[1,"sheet"],[2,"float","right"],[2,"float","right","margin-top","20px"],["mat-button","","class","btnn",3,"click",4,"ngIf"],[2,"padding-left","50px"],[1,"dds-icon","dds-icon_eyeopen",2,"float","right",3,"click"],["mat-button","",1,"btnn",3,"click"],[1,"combination"],["mat-button","","class","btnn","style","margin: 30px;",3,"click",4,"ngIf"],["class","createNewSoltionsTable appendTable",4,"ngIf"],["mat-button","","class","btnn","style","margin: 25px;",3,"click",4,"ngIf"],[1,"createNewSoltionsTable","appendTable"],[2,"background-color","#0076A8"],[2,"padding-left","78px !important","background-color","#0076A8"],[2,"padding-left","53px !important","background-color","#0076A8"],["class","trrr",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["mat-button","",1,"btnn",2,"margin","30px",3,"disabled","click"],[1,"trrr"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"color","#26890d"],[2,"width","50%"],[1,"error"],["mat-button","",1,"btnn",2,"margin","30px",3,"click"],["colspan","3",2,"text-align","left","background-color","#0076A8"],[1,"append"],[2,"padding-left","60px","height","auto","padding","10px 60px","border-bottom","0px none"],["colspan","3",2,"width","50px","vertical-align","baseline","font-weight","bold"],[2,"border-bottom","1px solid"],["style","margin:0 0 5px 0",4,"ngFor","ngForOf"],[2,"width","110px","text-align","center"],[1,"dds-icon","dds-icon_eyeopen"],[2,"margin","0 0 5px 0"],["mat-button","",1,"btnn",2,"margin","25px",3,"click"],[2,"float","right","margin-right","28px"],["class","table table-striped createNewSoltionsTable",4,"ngIf"],["mat-button","","class","btnn","style","float: left;",3,"click",4,"ngIf"],[1,"table","table-striped","createNewSoltionsTable"],["class","",4,"ngFor","ngForOf"],[1,""],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","change"],[1,"rightIcons"],[2,"border","1px #000 solid",3,"formGroup"],[1,"row",2,"background-color","#0076A8","color","#fff","width","100%","margin","auto"],[1,"col-md-2",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-3",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-1",2,"font-weight","600","background-color","#0076A8","color","#fff"],["formArrayName","Merg"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"",2,"padding","7px"],["formArrayName","tableControl"],["class","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"",3,"formGroupName"],[1,"col-md-2"],[1,"col-md-3"],["appearance","fill"],["formControlName","table1",1,"form-control",3,"placeholder","selectionChange"],["placeholder","Select Join","formControlName","join",1,"form-control",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Foreign Table","formControlName","table2",1,"form-control",3,"selectionChange"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style"," line-height:14px;color: #fff;font-size: 14px;","title","Table",3,"disabled","click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["formArrayName","column"],[3,"value"],["mat-button","","title","Table",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"disabled","click"],["mat-button","",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"selectionChange"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"selectionChange"],[1,"col-md-2",2,"border-bottom","1px solid"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;","title","Column",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","","title","Column",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],["mat-button","",1,"btnn",2,"float","left",3,"click"],[1,"row","targetFileRow"],[1,"note","required-field",2,"margin","10px 0 0 0","width","calc(100% - 120px)"],[1,"col-md-6"],[1,"col-md-6","scroll",2,"margin-top","10px","padding","0"],["class","table table-striped",4,"ngIf"],[2,"margin-left","83%","width","auto"],[1,"col-md-12","combination","scroll",2,"padding","0px"],[1,"table","table-striped"],[2,"width","1%","border","0","cursor","pointer",3,"click"],[2,"background-color","#0076A8","z-index","1"],["scope","col",2,"margin","auto","color","#fff","width","10%"],["scope","col",2,"margin","auto","color","#fff","width","25%"],["scope","col",2,"margin","auto","color","#fff","width","20%"],["scope","row",2,"width","10%"],["type","checkbox",3,"ngModel","ngModelChange"],[2,"width","25%"],[2,"width","20%"],["placeholder","Select DataType",1,"form-control",3,"ngModel","ngModelChange"],["mat-raised-button","","matTooltipPosition","above","matTooltipClass","allow-cr","aria-label","Button that displays a tooltip in various positions",3,"matTooltip"],["mat-button","",1,"btnn",2,"margin-left","0px !important",3,"click"],["mat-button","",1,"btnn",2,"width","135px","float","right",3,"click"],[1,"dataModeling"],[1,"col-md-5","combination"],[1,"scroll"],[1,"header",2,"position","sticky","top","0","z-index","1"],["class","mat-table","style","text-align: center; font-size:13px",4,"ngIf"],["multi","","class","mat-table","is-open","true",4,"ngIf"],["class","col-md-7 combination expTable",4,"ngIf"],[2,"text-align","right","float","right"],["mat-button","",1,"btnn",2,"width","140px",3,"click"],[1,"scroll",2,"margin-bottom","10px"],["multi","","is-open","true",1,"mat-table"],[3,"expanded","opened","closed",4,"ngFor","ngForOf"],[3,"expanded","opened","closed"],[1,"mat-row"],[1,"dataP"],[1,"rightIcons1"],[1,"dds-icon","dds-icon_eyeopen",3,"click"],["style","cursor: pointer;",4,"ngFor","ngForOf"],[2,"cursor","pointer"],[3,"click"],["class","scroll","style","cursor: pointer;",4,"ngFor","ngForOf"],[1,"scroll",2,"cursor","pointer"],[1,"mat-table",2,"text-align","center","font-size","13px"],[1,"mat-row",2,"margin-top","30px"],["type","checkbox",1,"form-check-input",3,"click"],["title","View Dataset",1,"dds-icon","dds-icon_eyeopen",3,"click"],["title","Edit Dataset",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],["title","View Script",1,"dds-icon","dds-icon_file",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[1,"col-md-7","combination","expTable"],[3,"formGroup"],["class","table table-striped","style","margin-bottom:60px ;",4,"ngFor","ngForOf"],[1,"table","table-striped",2,"margin-bottom","60px"],[2,"width","100%","text-align","left"],["formControlName","sourceFieldName","placeholder","Column Name","maxlength","50",1,"form-control",3,"value","ngClass","select","click","keyup"],[1,"row",2,"margin-top","10px"],["appearance","fill",1,"col-md-6",2,"padding-left","1px"],["placeholder","Select DataType","formControlName","columnType",1,"form-control",3,"value","ngClass","selectionChange"],[1,"dropdown","col-md-1"],["src","../../assets/images/fx.png","alt","","id","menu",2,"vertical-align","middle","margin","auto","width","28px","height","26px",3,"click"],[1,"dropdown-content","scroll"],[1,"search"],["id","form1","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],[1,"col-md-11"],["cols","20","rows","10","placeholder","Expression","formControlName","sourceExpressionName","name","Expression","id","",1,"form-control",2,"width","100%",3,"ngClass","value","select","click","keyup"],[2,"margin","10px"],[1,"addRow"],["placeholder","Select Opearator","formControlName","signOperator",1,"form-control",3,"value","ngClass","selectionChange"],["appearance","fill","class","col-md-3",4,"ngIf"],[1,"dds-icon","border","dds-icon_plus__l__stroke",3,"click"],["formArrayName","whereList"],["mat-button","","class","btnn","style","float:right ;",3,"click",4,"ngIf"],["appearance","fill",1,"col-md-6",2,"padding-right","1px"],["placeholder","Select DateFormat","formControlName","dateTimeFormats",1,"form-control"],["style","border-bottom: 1px solid #000; border-radius: 0;padding: 0;",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #000","border-radius","0","padding","0"],["placeholder","Value","formControlName","value",1,"form-control",3,"ngModel","ngClass","ngModelChange"],["appearance","fill",1,"col-md-3"],["matInput","",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["placeholder","Select AND/OR","formControlName","operator",1,"form-control"],["placeholder","Select Operator","formControlName","signOperator",1,"form-control",3,"selectionChange"],["placeholder","Value","formControlName","value",1,"form-control"],[1,"dds-icon","border","dds-icon_delete__l__stroke",3,"click"],["mat-button","",1,"btnn",2,"float","right",3,"click"],[2,"margin","auto"],["colspan","1"],[1,"col-md-3",2,"text-align","right",3,"click"],[1,"dds-icon","dds-icon_close__l__stroke",2,"color","#fff"],[2,"text-align","right"],[2,"display","flex","margin","10px 0"],[2,"margin-left","38px"],["matInput","","placeholder","Having",1,"form-control",2,"margin-left","38px",3,"ngModel","ngModelChange"],["appearance","fill",2,"margin-left","21px","width","706px"],["multiple","","placeholder","Select groupBy","formControlName","groupBy",1,"form-control",3,"selectionChange"],[2,"margin-left","35px"],["appearance","fill",2,"margin-left","26px","width","706px"],["multiple","","placeholder","Select orderBy","formControlName","orderBy",1,"form-control",3,"selectionChange"],[2,"width","1%","border","0"],[2,"text-align","right","width","1%","border","0"],[1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[1,"row","popup"],[1,"field"],["type","text","formControlName","appendNameControl",3,"ngClass"],[1,"col-sm-12",2,"float","right","text-align","right"],["mat-button","","type","submit",3,"click"],["mat-button","",2,"color","#0076A8","background","#fff",3,"click"],["mat-button","",3,"click"],[1,"taxt-audit-popup","preview",2,"width","1000px"],["style","float:left;margin: 22px;",4,"ngIf"],[1,"col-sm-3",2,"float","right","text-align","right"],["mat-button","",2,"border","1px solid #0076A8","background","none","color","#0076A8",3,"click"],["style","width:120px; word-break: break-all;",4,"ngFor","ngForOf"],[2,"width","120px","word-break","break-all"],[2,"float","left","margin","22px"],["type","text","formControlName","appendNameControl",3,"change"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],[1,"taxt-audit-popup",2,"width","1200px"],[2,"background-color","#0076A8","color","white","float","right",3,"click"],["aria-hidden","true"],["formArrayName","DSetRows",1,"row","popup",2,"margin-top","10px"],["appearance","fill",1,"col-md-4"],["formControlName","Ptable",1,"form-control",3,"placeholder","selectionChange"],["placeholder","Join Type","formControlName","join",1,"form-control",3,"selectionChange"],["placeholder","Foreign Table","formControlName","Ftable",1,"form-control",3,"selectionChange"],["formArrayName","columns"],[1,"col-md-4"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["selectForeignKeyInDS","",3,"value",4,"ngFor","ngForOf"],["selectForeignKeyInDS","",3,"value"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],[1,"taxt_audit-report","enableUploadSQLPopup"],["mat-input","","type","name","cols","50","formControlName","sqlScript","name","s",1,"form-control",2,"min-height","60vh","width","100%"],["type","text","formControlName","datasetName","placeholder","DataSet Name",3,"change"],["mat-input","","type","name","formControlName","sqlScript","name","s",1,"form-control"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"New Solution"),e.qZA(),e.TgZ(3,"h5")(4,"span",2),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6,"Solution Board / New Solution"),e.qZA()(),e.TgZ(7,"div",3)(8,"h5",4),e._uU(9,"Dataset(s) Preparation:"),e.qZA(),e.TgZ(10,"div",5),e.YNc(11,_y,5,4,"ng-container",6),e.qZA(),e.YNc(12,vy,10,5,"div",7),e.YNc(13,Ny,15,3,"ng-container",7),e.YNc(14,By,10,7,"div",8),e.YNc(15,sD,18,8,"div",8),e.YNc(16,vD,13,2,"ng-container",7),e.YNc(17,ek,33,4,"div",7),e.qZA(),e.YNc(18,tk,17,4,"div",7),e.YNc(19,nk,17,4,"div",7),e.YNc(20,sk,15,3,"div",7),e.YNc(21,lk,17,1,"div",7),e.YNc(22,vk,16,2,"div",7),e.YNc(23,Ck,13,1,"div",7),e.YNc(24,Tk,14,1,"div",7)),2&t&&(e.xp6(11),e.Q6J("ngForOf",o.tabs),e.xp6(1),e.Q6J("ngIf",0==o.tabs[0].id&&1==o.tabs[0].isActive),e.xp6(1),e.Q6J("ngIf",1==o.tabs[1].id&&1==o.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",2==o.tabs[2].id&&1==o.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",3==o.tabs[3].id&&1==o.tabs[3].isActive),e.xp6(1),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",5==o.tabs[5].id&&1==o.tabs[5].isActive),e.xp6(1),e.Q6J("ngIf",o.enableAppendNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableMergeNamePopup),e.xp6(1),e.Q6J("ngIf",o.showTargetFilePopup),e.xp6(1),e.Q6J("ngIf",o.enableDataSetPopUp),e.xp6(1),e.Q6J("ngIf",o.saveDataSetPopup),e.xp6(1),e.Q6J("ngIf",o.enableViewScriptPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQLPopup))},directives:[be.sg,Ze.lW,be.O5,Se.a8,w.Wl,w.JJ,w.On,w._Y,w.JL,w.sg,w.CE,w.x0,Ln.KE,hi.gD,w.u,Et.ey,ms.gM,lt.pp,lt.ib,lt.yz,w.Fj,w.nD,be.mk,Qi.Nt,so.hl,so.nW,so.Mq,w.F],styles:['.mat-card[_ngcontent-%COMP%]{margin-top:2%;float:left;width:100%}.btn[_ngcontent-%COMP%]{height:37px;border-radius:0;background-color:#0076a8;color:#fff;width:auto}h3[_ngcontent-%COMP%]{font-size:25px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}.btnn[_ngcontent-%COMP%]{border-radius:0;margin:14px 0 14px 20px!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;transition:all .5s cubic-bezier(.77,0,.175,1)}.btnn.preview[_ngcontent-%COMP%]{float:right;margin:10px 0 0!important}.btnn[_ngcontent-%COMP%]:hover{box-shadow:inset 135px 0 #041e42;color:#fff!important;border:1px solid #041E42}.btnnn[_ngcontent-%COMP%]{height:50px;border:1px solid #cccaca;text-align:left;width:100%;border-radius:0;background-color:#fff;color:#000;font-size:17px}.btnnn[_ngcontent-%COMP%]:nth-child(odd){background-color:#eee}.btnnn[_ngcontent-%COMP%]:hover, .btnnn[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.scroll[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll1[_ngcontent-%COMP%]{max-height:200px!important;margin-bottom:10px}.scroll2[_ngcontent-%COMP%]{max-height:400px!important;margin-bottom:10px}.scroll1[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .scroll2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.select[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:220px;border-radius:0;font-size:12px;border:1px solid #cccaca;font-family:open_sans-regular!important;padding:5px 8px}.dds-icon_file_xls__l__filled[_ngcontent-%COMP%]:before{padding-right:10px}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.sheet[_ngcontent-%COMP%]{border:2px solid #eee}table[_ngcontent-%COMP%]{width:100%;margin:0%}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#eeeeee}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#000;height:24px;padding:0 20px;font-family:open_sans-medium;font-size:14px;line-height:16px}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{color:#5aa448;font-size:19px}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#041E42!important}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px!important;color:#fff!important;font-family:open_sans-regular!important;font-weight:400}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;text-align:center}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#fff}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:28px;padding:2px 53px!important;border-bottom:1px solid #eee;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px}.selectCheck[_ngcontent-%COMP%]{float:left;width:100%;margin:0 0 10px}.selectCheck[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{vertical-align:middle;width:16px;height:16px;margin:0 5px 0 0}.selectCheck[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span.dds-icon[_ngcontent-%COMP%]{height:auto;vertical-align:middle}table[_ngcontent-%COMP%]   td.active[_ngcontent-%COMP%]{background-color:#87ceeb!important}h6[_ngcontent-%COMP%]{float:left;width:100%;padding:10px 0 0 65px}.append[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]{display:block;position:relative;padding:16px;border-radius:4px;box-shadow:0 0 6px 1px #cccaca;margin-top:10px;float:left;width:100%}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even)   td[_ngcontent-%COMP%]{background:#eee!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]{background-color:#fff;width:inherit;display:table-row;height:40px}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#fff!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px;margin:0 10px 0 0;vertical-align:middle}.header[_ngcontent-%COMP%]{width:100%;background:#0076A8;float:left;margin:0 0 15px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:8px 12px;color:#fff;font-family:open_sans-regular;font-size:14px;line-height:19px;float:left;width:100%;margin:0}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:14% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:159px;width:440px;border-style:dotted;border-width:1px solid;color:#0076a8;margin:auto;padding:30px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.taxt-audit-popup[_ngcontent-%COMP%]{background:#fff;width:700px;position:absolute;top:50%;left:50%;transform:translate(-50%,-40%)}.taxt-audit-popup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{float:left;width:100%}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{border-radius:0;border:0;margin:14px 20px 25px 0!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;float:right;transition:all .5s cubic-bezier(.77,0,.175,1)}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important;border:1px solid #041E42}.taxt-audit-popup[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#d8000c;position:absolute;font-size:12px;line-height:15px;font-family:open_sans-regular;bottom:71px;right:20px;font-size:11px}.taxt-audit-popup.preview[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:400px;overflow-y:auto}.allow-cr[_ngcontent-%COMP%]{white-space:pre-line}.mat-accordion[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:2rem;border-bottom:none}.mat-expansion-panel-header.mat-row[_ngcontent-%COMP%]{border-bottom:none}p.dataP[_ngcontent-%COMP%]{float:left;width:calc(100% - 130px);margin:0;height:auto;line-height:20px;color:#000;line-height:36px}.rightIcons[_ngcontent-%COMP%]{float:right}.rightIcons[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 3px;float:left;height:auto}.rightIcons1[_ngcontent-%COMP%]{float:right}.rightIcons1[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 50px;float:left;height:auto}.mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000}.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0}.mat-table[_ngcontent-%COMP%]{display:block}.mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{min-height:33px}.mat-row[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;padding:0 24px;box-sizing:border-box}.mat-row[_ngcontent-%COMP%]:after, .mat-header-row[_ngcontent-%COMP%]:after{display:inline-block;min-height:inherit;content:""}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;position:relative}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{float:right;position:absolute;right:0}.dataModeling[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{float:left;width:100%;box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;margin:0 0 15px}.dataModeling[_ngcontent-%COMP%]   .mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:25px}.dataModeling[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:1px solid #D6D6D6;border-radius:0}.dataModeling[_ngcontent-%COMP%]   .combination[_ngcontent-%COMP%]{box-shadow:none}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-5[_ngcontent-%COMP%]{width:45%;padding:0}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-7[_ngcontent-%COMP%]{width:53%;padding:0;margin-left:2%}.dataModeling[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%], .dataModeling[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:0}.targetFileRow[_ngcontent-%COMP%]   .combination.col-md-6[_ngcontent-%COMP%]{width:50%;box-shadow:none}.row.popup[_ngcontent-%COMP%]{margin:0;float:left;width:100%}.row.popup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{float:left;width:100%}.row.popup[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{float:left;width:100%;padding:20px}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px #0003;padding:12px 16px;z-index:1;width:250px}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{height:24px!important;min-height:24px!important}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{top:0!important}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;margin:0 0 8px}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:none}.dropdown-content[_ngcontent-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:12px;margin-bottom:8px;width:100%;float:left;word-break:break-all}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dds-icon.border[_ngcontent-%COMP%]{border:2px solid #000;padding:5px;border-radius:50%;margin-top:2px}.error[_ngcontent-%COMP%]{color:#d8000c;font-size:12px;line-height:15px;font-family:open_sans-regular}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}form[_ngcontent-%COMP%]   .col-md-2[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{margin:1px 0 10px 10px!important;height:auto}.search[_ngcontent-%COMP%]{width:25%;float:right;border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF;margin:0 0 20px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12px;border-radius:0;border:0px none;padding:0;margin:0 3px 0 0;width:calc(100% - 30px);float:left}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none}.search[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;padding:3px 0 0;font-size:17px;height:auto}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px!important}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]{margin:2px 0;float:left;width:100%}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30%;float:left;margin:0 5px 0 0}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;margin:6px 0 0;cursor:pointer;font-size:16px;padding:3px}.dds-icon[_ngcontent-%COMP%]{color:#707070;font-size:19px}.note[_ngcontent-%COMP%]{font-size:13px;line-height:17px;font-family:open_sans-regular;color:#000;float:left;margin:0 0 10px;width:100%}.required-field[_ngcontent-%COMP%]:before{content:"*";color:red}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   .taxt-audit-popup[_ngcontent-%COMP%]{width:80%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:10px}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:0;width:100%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:50vh;width:100%}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}']}),n})();var wk=ce(5140),It=ce(8551),hs=ce(3904),gs=ce(6087),Jr=ce(9201);const Sk=["subPaginator"],Nk=["workPaginator"],Ak=["projectPaginator"],yk=["userPaginator"];function Dk(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"h4"),e._uU(5,"Organization Details"),e.qZA()(),e.TgZ(6,"form")(7,"div",8)(8,"div",11)(9,"div",12)(10,"label"),e._uU(11,"Organization Name"),e.qZA(),e._UZ(12,"input",13),e.qZA()(),e.TgZ(13,"div",11)(14,"div",12)(15,"label"),e._uU(16,"Contact Person Email id"),e.qZA(),e._UZ(17,"input",13),e.qZA()(),e.TgZ(18,"div",11)(19,"label"),e._uU(20,"Contact Person Number"),e.qZA(),e.TgZ(21,"div",14)(22,"span",15),e._uU(23,"+91"),e.qZA(),e._UZ(24,"input",13),e.qZA()()(),e.TgZ(25,"div",8)(26,"div",11)(27,"div",12)(28,"label"),e._uU(29,"Organization Address"),e.qZA(),e._UZ(30,"textarea",16),e.qZA()()()()()()()),2&n){const t=e.oxw();e.xp6(12),e.Q6J("value",null==t.orgdetail?null:t.orgdetail.organizationName),e.xp6(5),e.Q6J("value",null==t.orgdetail?null:t.orgdetail.spocEmailId),e.xp6(7),e.Q6J("value",null==t.orgdetail?null:t.orgdetail.spocphoneNo),e.xp6(6),e.Q6J("value",null==t.orgdetail?null:t.orgdetail.address)}}function kk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," S.No "),e.qZA())}function Fk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.index;e.xp6(1),e.hij(" ",t+1," ")}}function Mk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," User Name "),e.qZA())}function Lk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.userName," ")}}function Ik(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," User Role "),e.qZA())}function Ek(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.roleName," ")}}function Zk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Designation "),e.qZA())}function Pk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.designation," ")}}function Ok(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Contact Number "),e.qZA())}function Uk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.contactNo," ")}}function Bk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Email Id "),e.qZA())}function Jk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.emailId," ")}}function qk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Status "),e.qZA())}function Rk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.status," ")}}function Qk(n,r){1&n&&e._UZ(0,"tr",40)}function Hk(n,r){1&n&&e._UZ(0,"tr",41)}function Yk(n,r){if(1&n&&(e.TgZ(0,"tr",42)(1,"td",43),e._uU(2," No data found "),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",t.displayedColumns1.length)}}const qr=function(){return[10,20,50]};function Vk(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"h4"),e._uU(5,"Users"),e.qZA()(),e.TgZ(6,"div",17)(7,"div",18)(8,"input",19),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter1(i)}),e.qZA(),e.TgZ(9,"button",20),e._UZ(10,"span",21),e.qZA()()(),e.TgZ(11,"div",22)(12,"table",23),e.ynx(13,24),e.YNc(14,kk,2,0,"th",25),e.YNc(15,Fk,2,1,"td",26),e.BQk(),e.ynx(16,27),e.YNc(17,Mk,2,0,"th",25),e.YNc(18,Lk,2,1,"td",26),e.BQk(),e.ynx(19,28),e.YNc(20,Ik,2,0,"th",25),e.YNc(21,Ek,2,1,"td",26),e.BQk(),e.ynx(22,29),e.YNc(23,Zk,2,0,"th",25),e.YNc(24,Pk,2,1,"td",26),e.BQk(),e.ynx(25,30),e.YNc(26,Ok,2,0,"th",25),e.YNc(27,Uk,2,1,"td",26),e.BQk(),e.ynx(28,31),e.YNc(29,Bk,2,0,"th",25),e.YNc(30,Jk,2,1,"td",26),e.BQk(),e.ynx(31,32),e.YNc(32,qk,2,0,"th",25),e.YNc(33,Rk,2,1,"td",26),e.BQk(),e.YNc(34,Qk,1,0,"tr",33),e.YNc(35,Hk,1,0,"tr",34),e.YNc(36,Yk,3,1,"tr",35),e.qZA()(),e._UZ(37,"mat-paginator",36,37),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(12),e.Q6J("dataSource",t.userSearch),e.xp6(22),e.Q6J("matHeaderRowDef",t.displayedColumns1),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns1),e.xp6(2),e.Q6J("length",null==t.userSearch?null:t.userSearch.data.length)("pageSizeOptions",e.DdM(5,qr))}}function $k(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Subscription Name "),e.qZA())}function Kk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.processName," ")}}function Wk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Start Date "),e.qZA())}function zk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.startDate," ")}}function Gk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," End Date "),e.qZA())}function Xk(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.endDate," ")}}function jk(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Number of Runs "),e.qZA())}function eF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.runCount," ")}}function tF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Status "),e.qZA())}function nF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.status," ")}}function iF(n,r){1&n&&e._UZ(0,"tr",40)}function oF(n,r){1&n&&e._UZ(0,"tr",41)}function rF(n,r){if(1&n&&(e.TgZ(0,"tr",42)(1,"td",43),e._uU(2," No data found "),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",t.displayedColumns2.length)}}function aF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"h4"),e._uU(5,"Subscriptions"),e.qZA()(),e.TgZ(6,"div",17)(7,"div",44)(8,"input",19),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter2(i)}),e.qZA(),e.TgZ(9,"button",20),e._UZ(10,"span",21),e.qZA()()(),e.TgZ(11,"div",22)(12,"table",23),e.ynx(13,45),e.YNc(14,$k,2,0,"th",25),e.YNc(15,Kk,2,1,"td",26),e.BQk(),e.ynx(16,46),e.YNc(17,Wk,2,0,"th",25),e.YNc(18,zk,2,1,"td",26),e.BQk(),e.ynx(19,47),e.YNc(20,Gk,2,0,"th",25),e.YNc(21,Xk,2,1,"td",26),e.BQk(),e.ynx(22,48),e.YNc(23,jk,2,0,"th",25),e.YNc(24,eF,2,1,"td",26),e.BQk(),e.ynx(25,32),e.YNc(26,tF,2,0,"th",25),e.YNc(27,nF,2,1,"td",26),e.BQk(),e.YNc(28,iF,1,0,"tr",33),e.YNc(29,oF,1,0,"tr",34),e.YNc(30,rF,3,1,"tr",35),e.qZA()(),e._UZ(31,"mat-paginator",36,49),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(12),e.Q6J("dataSource",t.subSearch),e.xp6(16),e.Q6J("matHeaderRowDef",t.displayedColumns2),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns2),e.xp6(2),e.Q6J("length",null==t.subSearch?null:t.subSearch.data.length)("pageSizeOptions",e.DdM(5,qr))}}function sF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Subscription Name "),e.qZA())}function lF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.processName," ")}}function cF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Start Date "),e.qZA())}function dF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.startDate," ")}}function _F(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," End Date "),e.qZA())}function pF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.endDate," ")}}function uF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Status "),e.qZA())}function fF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.status," ")}}function mF(n,r){1&n&&e._UZ(0,"tr",40)}function hF(n,r){1&n&&e._UZ(0,"tr",41)}function gF(n,r){if(1&n&&(e.TgZ(0,"tr",42)(1,"td",43),e._uU(2," No data found "),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",t.displayedColumns3.length)}}function xF(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"mat-paginator",36,51),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("length",null==t.workSearch?null:t.workSearch.data.length)("pageSizeOptions",e.DdM(2,qr))}}function vF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"h4"),e._uU(5,"Workspace"),e.qZA()(),e.TgZ(6,"div",17)(7,"div",50)(8,"input",19),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter3(i)}),e.qZA(),e.TgZ(9,"button",20),e._UZ(10,"span",21),e.qZA()()(),e.TgZ(11,"div",22)(12,"table",23),e.ynx(13,45),e.YNc(14,sF,2,0,"th",25),e.YNc(15,lF,2,1,"td",26),e.BQk(),e.ynx(16,46),e.YNc(17,cF,2,0,"th",25),e.YNc(18,dF,2,1,"td",26),e.BQk(),e.ynx(19,47),e.YNc(20,_F,2,0,"th",25),e.YNc(21,pF,2,1,"td",26),e.BQk(),e.ynx(22,32),e.YNc(23,uF,2,0,"th",25),e.YNc(24,fF,2,1,"td",26),e.BQk(),e.YNc(25,mF,1,0,"tr",33),e.YNc(26,hF,1,0,"tr",34),e.YNc(27,gF,3,1,"tr",35),e.qZA()(),e.YNc(28,xF,3,3,"ng-container",7),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(12),e.Q6J("dataSource",t.workSearch),e.xp6(13),e.Q6J("matHeaderRowDef",t.displayedColumns3),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns3),e.xp6(2),e.Q6J("ngIf",0!=t.workdetail.length)}}function CF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," S.No "),e.qZA())}function TF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.index;e.xp6(1),e.hij(" ",t+1," ")}}function bF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Project Name "),e.qZA())}function wF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.projectName," ")}}function SF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Process "),e.qZA())}function NF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.processName," ")}}function AF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Created Date & Time "),e.qZA())}function yF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.creationDate,"d-M-yy, h:mm a")," ")}}function DF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Created By "),e.qZA())}function kF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.userName," ")}}function FF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Status "),e.qZA())}function MF(n,r){if(1&n&&(e.TgZ(0,"td",39),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.statusName," ")}}function LF(n,r){1&n&&(e.TgZ(0,"th",38),e._uU(1," Actions "),e.qZA())}function IF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",59),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).projectCompleted(i)}),e.qZA()}}function EF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",60),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).failedproject(i)}),e.qZA()}}function ZF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",60),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).failedproject(i)}),e.qZA()}}function PF(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"--"),e.qZA())}function OF(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"--"),e.qZA())}function UF(n,r){if(1&n&&(e.TgZ(0,"td",39),e.YNc(1,IF,1,0,"span",57),e.YNc(2,EF,1,0,"span",58),e.YNc(3,ZF,1,0,"span",58),e.YNc(4,PF,2,0,"span",7),e.YNc(5,OF,2,0,"span",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Success"==t.statusName),e.xp6(1),e.Q6J("ngIf","Failed"==t.statusName),e.xp6(1),e.Q6J("ngIf","PBI-Failed"==t.statusName),e.xp6(1),e.Q6J("ngIf","Executing"==t.statusName),e.xp6(1),e.Q6J("ngIf","Draft"==t.statusName)}}function BF(n,r){1&n&&e._UZ(0,"tr",40)}function JF(n,r){1&n&&e._UZ(0,"tr",41)}function qF(n,r){if(1&n&&(e.TgZ(0,"tr",42)(1,"td",43),e._uU(2," No data found "),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",t.displayedColumns.length)}}function RF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"h4"),e._uU(5,"Projects"),e.qZA()(),e.TgZ(6,"div",17)(7,"div",44)(8,"input",19),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().applyFilter(i)}),e.qZA(),e.TgZ(9,"button",20),e._UZ(10,"span",21),e.qZA()()(),e.TgZ(11,"div",22)(12,"table",23),e.ynx(13,24),e.YNc(14,CF,2,0,"th",25),e.YNc(15,TF,2,1,"td",26),e.BQk(),e.ynx(16,52),e.YNc(17,bF,2,0,"th",25),e.YNc(18,wF,2,1,"td",26),e.BQk(),e.ynx(19,45),e.YNc(20,SF,2,0,"th",25),e.YNc(21,NF,2,1,"td",26),e.BQk(),e.ynx(22,53),e.YNc(23,AF,2,0,"th",25),e.YNc(24,yF,3,4,"td",26),e.BQk(),e.ynx(25,27),e.YNc(26,DF,2,0,"th",25),e.YNc(27,kF,2,1,"td",26),e.BQk(),e.ynx(28,54),e.YNc(29,FF,2,0,"th",25),e.YNc(30,MF,2,1,"td",26),e.BQk(),e.ynx(31,55),e.YNc(32,LF,2,0,"th",25),e.YNc(33,UF,6,5,"td",26),e.BQk(),e.YNc(34,BF,1,0,"tr",33),e.YNc(35,JF,1,0,"tr",34),e.YNc(36,qF,3,1,"tr",35),e.qZA()(),e._UZ(37,"mat-paginator",36,56),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(12),e.Q6J("dataSource",t.projectSearch),e.xp6(22),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(2),e.Q6J("length",null==t.projectSearch?null:t.projectSearch.data.length)("pageSizeOptions",e.DdM(5,qr))}}function QF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",61)(2,"div",62)(3,"div",63)(4,"h3"),e._uU(5,"PowerBI Report "),e.qZA(),e.TgZ(6,"button",64)(7,"i",65),e.NdJ("click",function(){return e.CHM(t),e.oxw().hideViewReport()}),e.qZA()()(),e.TgZ(8,"div",66),e._UZ(9,"powerbi-report",67),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("embedConfig",t.reportViewConfig)}}function HF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",68)(2,"div",69)(3,"div",63)(4,"h3"),e._uU(5,"Failure"),e.qZA(),e.TgZ(6,"button",64)(7,"i",70),e.NdJ("click",function(){return e.CHM(t),e.oxw().CloseModal()}),e.qZA()()(),e.TgZ(8,"div",71)(9,"p",72),e._uU(10),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Oqu(t.failed.errorMessage)}}let YF=(()=>{class n{constructor(t,o,i,a,s,l,c){this.Users_service=t,this.Master=o,this.router=i,this.route=a,this.userService=s,this.httpService=l,this.solService=c,this.tab1=!1,this.tab2=!1,this.tab3=!1,this.tab4=!1}set subPaginator(t){this.subSearch&&(this.subSearch.paginator=t)}set workPaginator(t){this.workSearch&&(this.workSearch.paginator=t)}set projectPaginator(t){this.projectSearch&&(this.projectSearch.paginator=t)}set userPaginator(t){this.userSearch&&(this.userSearch.paginator=t)}ngOnInit(){this.orgid=this.route.snapshot.paramMap.get("orgId"),this.getallusers(),this.getprojectDetails(),this.getallsubscription(),this.displayedColumns=["sno","projectName","processName","creationDate","userName","statusName","action"],this.displayedColumns1=["sno","userName","roleName","designation","contactNo","emailId","status"],this.displayedColumns2=["processName","startDate","endDate","runCount","status"],this.displayedColumns3=["processName","startDate","endDate","status"]}changetab(t){1==t?(this.tab1=!0,this.tab2=!1,this.tab3=!1,this.tab4=!1):2==t?(console.log("tab2"),this.tab1=!1,this.tab2=!0,this.tab3=!1,this.tab4=!1):3==t?(console.log("tab3"),this.tab1=!1,this.tab2=!1,this.tab3=!0,this.tab4=!1):4==t&&(console.log("tab4"),this.tab1=!1,this.tab2=!1,this.tab3=!1,this.tab4=!0)}getallusers(){this.userService.getallusers(this.orgid).subscribe(t=>{var o;this.userdetail=t.responseData[0].userMstDto,this.userSearch=new Ne.by(null===(o=t.responseData[0])||void 0===o?void 0:o.userMstDto),this.userSearch.MatPaginator=this.userPaginator,this.changetab(1),this.orgdetail=t.responseData[0].organizationMstDto,console.log("orgdetal",this.orgdetail)})}getprojectDetails(){this.httpService.getprojectDetails(this.orgid).subscribe(t=>{this.projectdetail=t.responseData.projectList,this.projectSearch=new Ne.by(t.responseData.projectList),this.projectSearch.MatPaginator=this.projectPaginator,this.projectSearch.sort=this.sort,console.log("projectdetail",this.projectdetail),console.log("projectdetail",this.projectSearch),this.getAllProcess()})}getallsubscription(){this.userService.getallsubscription(this.orgid).subscribe(t=>{this.subdetail=t.responseData.subscriptionDto,this.subSearch=new Ne.by(t.responseData.subscriptionDto),this.subSearch.MatPaginator=this.subPaginator,this.subSearch.sort=this.sort,this.workdetail=t.responseData.subsciptionTypeDetailsDto,this.workSearch=new Ne.by(t.responseData.subsciptionTypeDetailsDto),this.workSearch.MatPaginator=this.workPaginator,this.workSearch.sort=this.sort,console.log("subdetail",this.subdetail),this.getAllProcess(),this.getSubscription()})}getAllProcess(){this.Master.getAllProcessByType(1).subscribe(t=>{this.GprocData=t.responseData,console.log("process",this.GprocData),this.Master.getAllProcessByType(2).subscribe(o=>{console.log("process",o),this.CprocData=o.responseData,this.getNames(),this.getProcess()})})}getSubscription(){this.Users_service.getSubscription().subscribe(t=>{console.log("subscription",t),this.subs=t.responseData,this.getWorkNames()})}getWorkNames(){this.workdetail.forEach(t=>{this.subs.forEach(o=>{t.subscriptionTypeId==o.subscriptionTypeId&&(t.subscriptionType=o.subscriptionType,console.log(t))})}),console.log(this.workdetail)}getNames(){var t;null===(t=this.subdetail)||void 0===t||t.forEach(o=>{this.GprocData.forEach(i=>{o.processID==i.processId&&(o.processName=i.processName,console.log(o))}),this.CprocData.forEach(i=>{o.processID==i.processId&&(o.processName=i.processName,console.log(o))})}),console.log(this.subdetail)}getProcess(){var t;null===(t=this.projectdetail.projectList)||void 0===t||t.forEach(o=>{this.GprocData.forEach(i=>{o.processId==i.processId&&(o.processName=i.processName,console.log(o))}),this.CprocData.forEach(i=>{o.processId==i.processId&&(o.processName=i.processName,console.log(o))})}),console.log(this.subdetail)}failedproject(t){this.failed=t,console.log(t),this.AddEventProceeding2=!0}edit(t){this.AddEventProceeding=!0}CloseModal(){this.AddEventProceeding=!1,this.AddEventProceeding1=!1,this.AddEventProceeding2=!1}projectCompleted(t){var o,i;let a={embedtype:"RV",reportid:null===(o=t.reportResponse[0])||void 0===o?void 0:o.reportId,datasetid:null===(i=t.reportResponse[0])||void 0===i?void 0:i.datasetId};this.solService.viewReport(a).subscribe(s=>{var l,c,d;console.log(s),this.AddEventProceeding=!0,this.embedViewContainer=document.getElementById("embedView"),this.reportViewConfig={type:"report",tokenType:It.models.TokenType.Embed,accessToken:null===(l=s.responseData)||void 0===l?void 0:l.embedToken,embedUrl:null===(c=s.responseData)||void 0===c?void 0:c.embedUrl,id:null===(d=s.responseData)||void 0===d?void 0:d.reportId,filters:[],settings:{filterPaneEnabled:!0,navContentPaneEnabled:!0}},this.viewReport=this.powerbi.embed(this.embedViewContainer,this.reportViewConfig),this.viewReport.off("loaded"),this.viewReport.on("loaded",()=>{console.log("report loaded....")})})}projectScheduled(){this.AddEventProceeding1=!0}hideViewReport(){this.AddEventProceeding=!1}projectDraft(t){this.router.navigate(["/user/admin1/view-download1",{processId:t.registrationId}])}applyFilter(t){this.projectSearch=new Ne.by(this.projectdetail.filter(o=>this.containsValue(o,t.target.value.trim().toLowerCase()))),this.projectSearch.MatPaginator=this.projectPaginator,this.projectSearch.sort=this.sort}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}applyFilter1(t){this.userSearch=new Ne.by(this.userdetail.filter(o=>this.containsValue1(o,t.target.value.trim().toLowerCase()))),this.userSearch.MatPaginator=this.userPaginator,this.userSearch.sort=this.sort}containsValue1(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}applyFilter2(t){this.subSearch=new Ne.by(this.subdetail.filter(o=>this.containsValue2(o,t.target.value.trim().toLowerCase()))),this.subSearch.MatPaginator=this.subPaginator,this.subSearch.sort=this.sort}containsValue2(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}applyFilter3(t){this.workSearch=new Ne.by(this.workdetail.filter(o=>this.containsValue3(o,t.target.value.trim().toLowerCase()))),this.workSearch.MatPaginator3=this.workPaginator,this.workSearch.sort=this.sort}containsValue3(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Hi.f),e.Y36(Hn.R),e.Y36(fe.F0),e.Y36(fe.gz),e.Y36(Hi.f),e.Y36(hs.O),e.Y36(Jt.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-client-info2"]],viewQuery:function(t,o){if(1&t&&(e.Gf(Ri.YE,5),e.Gf(Sk,5),e.Gf(Nk,5),e.Gf(Ak,5),e.Gf(yk,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.sort=i.first),e.iGM(i=e.CRH())&&(o.subPaginator=i.first),e.iGM(i=e.CRH())&&(o.workPaginator=i.first),e.iGM(i=e.CRH())&&(o.projectPaginator=i.first),e.iGM(i=e.CRH())&&(o.userPaginator=i.first)}},decls:26,vars:14,consts:[[1,"heading"],[1,"page-title-wrapper"],[1,"consen","mainContainer"],[1,"inner-container"],[1,"toolbar-block","tabs-button-row"],[1,"tab-buttons"],["mat-button","",3,"click"],[4,"ngIf"],[1,"row"],[1,"col","fin"],[1,"heads"],[1,"col-sm-4"],[1,"input-group"],["type","text","disabled","",1,"form-control","reflect-model",3,"value"],[1,"input-group","prefix"],[1,"input-group-addon"],["rows","5","cols","50","type","text","disabled","",1,"form-control","reflect-model",3,"value"],[1,"toolbar-block","margin-top-65"],[1,"search"],["id","form1","value","","placeholder","Search",1,"form-control",3,"keyup"],["mat-button",""],[1,"dds-icon","dds-icon_search__l__stroke","icons"],[1,"table-container","max-height-scroll"],["mat-table","","matSort","",1,"table","table-striped",3,"dataSource"],["matColumnDef","sno"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","userName"],["matColumnDef","roleName"],["matColumnDef","designation"],["matColumnDef","contactNo"],["matColumnDef","emailId"],["matColumnDef","status"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page",3,"length","pageSizeOptions"],["userPaginator",""],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"],[1,"search",2,"margin-top","20px"],["matColumnDef","processName"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","runCount"],["subPaginator",""],[1,"search",2,"margin-top","50px"],["workPaginator",""],["matColumnDef","projectName"],["matColumnDef","creationDate"],["matColumnDef","statusName"],["matColumnDef","action"],["projectPaginator",""],["class","ico dds-icon dds-icon_eyeopen",3,"click",4,"ngIf"],["class","ico dds-icon dds-icon_alert__l__stroke","style","color: red !important;",3,"click",4,"ngIf"],[1,"ico","dds-icon","dds-icon_eyeopen",3,"click"],[1,"ico","dds-icon","dds-icon_alert__l__stroke",2,"color","red !important",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup",2,"width","1100px !important"],[1,"taxt-header","popup-header"],["mat-button","",1,"close"],[1,"report-modal-close","dds-icon","dds-icon_close__l__stroke",3,"click"],[1,"report-container","popup-body"],["id","embedView",2,"height","70vh",3,"embedConfig"],[1,"taxt_audit-report","error"],[1,"taxt-audit-popup"],[1,"report-modal-close","dds-icon","dds-icon_close__l__stroke",2,"margin-left","85%","padding","10px",3,"click"],[1,"popup-body"],[2,"margin-top","10%","text-align","center"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul")(3,"li"),e._uU(4,"Client"),e.qZA(),e.TgZ(5,"li"),e._uU(6),e.qZA()()()(),e.TgZ(7,"div",2)(8,"div",3)(9,"div",4)(10,"div",5)(11,"button",6),e.NdJ("click",function(){return o.changetab(1)}),e._uU(12,"Users"),e.qZA(),e._uU(13," \xa0 "),e.TgZ(14,"button",6),e.NdJ("click",function(){return o.changetab(2)}),e._uU(15,"Subscriptions"),e.qZA(),e._uU(16,"\xa0 "),e.TgZ(17,"button",6),e.NdJ("click",function(){return o.changetab(3)}),e._uU(18,"Projects"),e.qZA()()(),e.YNc(19,Dk,31,4,"div",7),e.YNc(20,Vk,39,6,"div",7),e.YNc(21,aF,33,6,"div",7),e.YNc(22,vF,29,4,"div",7),e.YNc(23,RF,39,6,"div",7),e.qZA()(),e.YNc(24,QF,10,1,"div",7),e.YNc(25,HF,11,1,"div",7)),2&t&&(e.xp6(6),e.Oqu(null==o.orgdetail?null:o.orgdetail.organizationName),e.xp6(5),e.ekj("active",o.tab1),e.xp6(3),e.ekj("active",o.tab2),e.xp6(3),e.ekj("active",o.tab3),e.xp6(2),e.Q6J("ngIf",o.tab1),e.xp6(1),e.Q6J("ngIf",o.tab1),e.xp6(1),e.Q6J("ngIf",o.tab2),e.xp6(1),e.Q6J("ngIf",o.tab2),e.xp6(1),e.Q6J("ngIf",o.tab3),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding2))},directives:[Ze.lW,be.O5,w._Y,w.JL,w.F,Ne.BZ,Ri.YE,Ne.w1,Ne.fO,Ne.ge,Ne.Dz,Ne.ev,Ne.as,Ne.XQ,Ne.nj,Ne.Gk,Ne.Ee,gs.NW,Jr.$i],pipes:[be.uU],styles:[""]}),n})();function VF(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().downloadTemplates()}),e.TgZ(2,"a"),e._uU(3,"Download"),e.qZA()(),e.TgZ(4,"div")(5,"a"),e._uU(6,"Upload Custom Data"),e.qZA()()()}}function $F(n,r){if(1&n&&(e.TgZ(0,"div",12)(1,"div",13),e._uU(2),e.qZA(),e.TgZ(3,"div",14)(4,"p"),e._uU(5),e.qZA()()()),2&n){const t=r.$implicit;e.xp6(2),e.hij("",t.analyticsName," "),e.xp6(3),e.Oqu(t.analyticsObjective)}}function KF(n,r){if(1&n&&(e.TgZ(0,"div",22)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.templateName)}}let WF=(()=>{class n{constructor(t,o,i,a,s,l,c,d){this.solService=t,this.Users_service=o,this.Master=i,this._sanitizer=a,this.toast=s,this.http=l,this.loader=c,this.router=d,this.panelOpenStateFive=!0,this.down=!0,this.tabs=[{id:0,value:"Download Files",isActive:!0},{id:1,value:"Execute Project",isActive:!1},{id:2,value:"Shedule Project",isActive:!1}]}ngOnInit(){this.processId=JSON.parse(localStorage.getItem("projectProcess")||""),this.getAllAnalyticsAndTemplates(),this.projectData=JSON.parse(localStorage.getItem("project")||""),this.processname=this.projectData.processName,this.projectname=this.projectData.projectName}getAllAnalyticsAndTemplates(){this.Users_service.getAllAnalyticsAndTemplates(this.processId).subscribe(o=>{this.anaytics=o.responseData.processAnalyticsDTOList,this.anayticfile=o.responseData.templateResponse,console.log("analytics",this.anaytics)})}downloadTemplates(){let t=this.processId;this.loader.show(),this.Master.downloadTemplates(t).subscribe(o=>{this.downloadt=o.responseData,this.downloadt.forEach(i=>{let a=i.fileName.split(".");if(console.log(a[1]),"jpg"==a[1]){let s=`data:image/jpg;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("xlsx"==a[1]||"xls"==a[1]){let s=`data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("pdf"==a[1]){let s=`data:application/pdf;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("png"==a[1]){let s=`data:image/png;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("csv"==a[1]){let s=`data:application/csv;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("txt"==a[1]){let s=`data:application/txt;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("zip"==a[1]){let s=`data:application/zip;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}}),this.loader.hide(),this.router.navigate(["/user/admin1/execute-process"])})}customPage(){}executePage(){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Jt.e),e.Y36(Hi.f),e.Y36(Hn.R),e.Y36(qi.H7),e.Y36(ti.q),e.Y36(Dt.eN),e.Y36(Nn.D),e.Y36(fe.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-download"]],decls:42,vars:6,consts:[[1,"heading"],[1,"consen"],[1,"pro"],[1,"info","row"],[1,"row","col","dis"],[1,"col","mini"],[1,"bton","col"],["class","cbtn",4,"ngIf"],[1,"seper"],["multi","",1,"accord"],[3,"expanded"],[1,"expansion","header"],[1,"row"],[1,"col-md-4"],[1,"col"],[1,"content"],["class","row",4,"ngFor","ngForOf"],[1,"file"],[1,"file-head"],["class","file-main",4,"ngFor","ngForOf"],[1,"cbtn"],[3,"click"],[1,"file-main"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Download & Upload Script"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"h4"),e._uU(9,"Project Name"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div",5)(13,"h4"),e._uU(14,"Process "),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()()(),e.TgZ(17,"div",6),e.YNc(18,VF,7,0,"div",7),e.qZA()(),e.TgZ(19,"div",8)(20,"mat-accordion",9)(21,"div")(22,"mat-expansion-panel",10)(23,"mat-expansion-panel-header")(24,"div",11)(25,"div",12)(26,"div",13)(27,"h4"),e._uU(28," Analytics Name "),e.qZA()(),e.TgZ(29,"div",14)(30,"h4"),e._uU(31," Analytics Objective "),e.qZA()()()()(),e.TgZ(32,"div",15)(33,"ul")(34,"li"),e.YNc(35,$F,6,2,"div",16),e.qZA()()()()()()(),e._UZ(36,"div"),e.TgZ(37,"div",17)(38,"div",18)(39,"h4"),e._uU(40,"Scripts / Templates to be downloaded"),e.qZA()(),e.YNc(41,KF,3,1,"div",19),e.qZA()()()),2&t&&(e.xp6(11),e.Oqu(o.projectname),e.xp6(5),e.Oqu(o.processname),e.xp6(2),e.Q6J("ngIf",o.down),e.xp6(4),e.Q6J("expanded",!0),e.xp6(13),e.Q6J("ngForOf",o.anaytics),e.xp6(6),e.Q6J("ngForOf",o.anayticfile))},directives:[be.O5,lt.pp,lt.ib,lt.yz,be.sg],styles:[".heading[_ngcontent-%COMP%]{background-color:#fff;color:#0076a8;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.pro[_ngcontent-%COMP%]{background-color:#fff;margin-top:20px;padding:20px 10px}.seper[_ngcontent-%COMP%]{padding:0;box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.info[_ngcontent-%COMP%]{padding:0}ul[_ngcontent-%COMP%]{padding:0;margin:0}li[_ngcontent-%COMP%]{padding:10px}.row[_ngcontent-%COMP%]{padding:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{display:none;font-size:0}li[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.bton[_ngcontent-%COMP%]{display:flex;margin:auto}.bton[_ngcontent-%COMP%]   .cbtn[_ngcontent-%COMP%], .bton[_ngcontent-%COMP%]   .ubtn[_ngcontent-%COMP%]{display:flex;margin-left:auto}.bton[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;padding:10px 20px;text-decoration:none;margin:auto 5px;cursor:pointer}.dis[_ngcontent-%COMP%]{padding:0;margin:auto}.mini[_ngcontent-%COMP%]{box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;margin:20px;padding:0}.mini[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px;margin:0;background-color:#041e42;color:#fff;padding:10px 15px}.mini[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:10px 15px;margin:0}.seper[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{padding:0}.seper[_ngcontent-%COMP%]   mat-expansion-panel.mat-expansion-panel.ng-tns-c197-0._mat-animation-noopable.ng-star-inserted[_ngcontent-%COMP%]{border-radius:0}h4[_ngcontent-%COMP%]{font-size:20px;margin:0}.accord[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:17px}.seper[_ngcontent-%COMP%]  .mat-expansion-panel-body{padding:0}.accord[_ngcontent-%COMP%]{margin-top:20px}.accord[_ngcontent-%COMP%]  .mat-content{display:block!important}.expansion.header[_ngcontent-%COMP%]{background-color:#041e42;color:#fff;padding:10px 15px}.file[_ngcontent-%COMP%]{margin-top:20px;border:2px #eee solid}.file-head[_ngcontent-%COMP%]{padding:10px 15px;background-color:#041e42;color:#fff}.file-head[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:17px;margin:0}.file-main[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px;padding:10px 15px;background-color:#f5f5f5;font-size:16px}.file-main[_ngcontent-%COMP%]{padding:10px;display:flex}.compliance-header[_ngcontent-%COMP%]   .compliance-report[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#fff;text-align:left;padding:0;border-bottom:1px solid #D0D0CE;background-color:#041e42;display:flex;align-items:center;height:36px}.compliance-header[_ngcontent-%COMP%]{float:left;width:100%;font-size:16px}.compliance-incom[_ngcontent-%COMP%]{width:30%;color:#fff;padding:10px;font-size:16px;text-align:justify}.compliance-incom1[_ngcontent-%COMP%]{width:30%;padding:10px;font-size:16px;text-align:justify}.compliance-expansion-main[_ngcontent-%COMP%]{display:flex;text-align:left;background:#F9F9F9;padding:20px 0}.accord[_ngcontent-%COMP%]  .mat-expansion-indicator{position:absolute;right:40px;top:9px;color:#fff}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}"]}),n})();var i_=ce(4834);function zF(n,r){1&n&&(e.TgZ(0,"div",1)(1,"div",5)(2,"div",6)(3,"div",7)(4,"div",8)(5,"h3",9),e._uU(6,"Setup Alert"),e.qZA()(),e.TgZ(7,"button",10),e._uU(8,"Add Alert Rule"),e.qZA()()()()())}function GF(n,r){1&n&&(e.TgZ(0,"div"),e._UZ(1,"input",18)(2,"input",18)(3,"input",19),e.qZA())}function XF(n,r){1&n&&(e.TgZ(0,"div"),e._UZ(1,"input",18)(2,"input",18)(3,"input",19),e.qZA())}function jF(n,r){1&n&&(e.TgZ(0,"div"),e._UZ(1,"input",18)(2,"input",18)(3,"input",19),e.qZA())}function eM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",11)(2,"div",6)(3,"div",12)(4,"h5"),e._uU(5,"Subscription Start Date: 01 June 2022"),e.qZA(),e.TgZ(6,"h5",13),e._uU(7,"Subscription End Date: 01 August 2022"),e.qZA()(),e.TgZ(8,"div",14)(9,"div",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(1)}),e.TgZ(10,"p"),e._uU(11,"Schedule Daily"),e.qZA()(),e.TgZ(12,"div",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(2)}),e.TgZ(13,"p"),e._uU(14,"Schedule Weekly"),e.qZA()(),e.TgZ(15,"div",15),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(3)}),e.TgZ(16,"p"),e._uU(17,"Schedule Monthly"),e.qZA()()(),e._UZ(18,"mat-divider"),e.YNc(19,GF,4,0,"div",16),e.YNc(20,XF,4,0,"div",16),e.YNc(21,jF,4,0,"div",16),e.TgZ(22,"button",17),e._uU(23,"Schedule"),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.ekj("active",t.subtab1),e.xp6(3),e.ekj("active",t.subtab2),e.xp6(3),e.ekj("active",t.subtab3),e.xp6(4),e.Q6J("ngIf",t.subtab1),e.xp6(1),e.Q6J("ngIf",t.subtab2),e.xp6(1),e.Q6J("ngIf",t.subtab3)}}let tM=(()=>{class n{constructor(){this.tab1=!0,this.tab2=!1,this.subtab1=!0,this.subtab2=!1,this.subtab3=!1}ngOnInit(){}changetab(t){1==t?(this.tab1=!0,this.tab2=!1):(this.tab1=!1,this.tab2=!0)}changesubtab(t){1==t?(this.subtab1=!0,this.subtab2=!1,this.subtab3=!1):2==t?(this.subtab1=!1,this.subtab2=!0,this.subtab3=!1):(this.subtab1=!1,this.subtab2=!1,this.subtab3=!0)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-schedule"]],decls:11,vars:6,consts:[[1,"heading"],[1,"container"],[1,"btnn"],["mat-button","",3,"click"],["class","container",4,"ngIf"],[1,"row","container",2,"height","700px"],[1,"col","fin"],[1,"container","scroll"],[2,"background-color","#041E42","color","white"],["scope","col"],[2,"background-color","#0076A8","float","right","color","white","border-color","#0076A8"],[1,"row","container"],[1,"heads",2,"background-color","#041E42","color","#fff","display","flex"],[2,"margin-left","50px"],[1,"row","container","no-gutters",2,"padding","20px 0 0 20px"],[1,"col","subheading",3,"click"],[4,"ngIf"],[2,"background-color","#0076A8","float","right","color","white","border-color","#0076A8","margin","37% 3% 3% 0","padding","12px"],["type","date",1,"date"],["type","number",1,"date"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Schedule"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"button",3),e.NdJ("click",function(){return o.changetab(1)}),e._uU(6,"Schedule Process"),e.qZA(),e.TgZ(7,"button",3),e.NdJ("click",function(){return o.changetab(2)}),e._uU(8,"Case Management"),e.qZA()()(),e.YNc(9,zF,9,0,"div",4),e.YNc(10,eM,24,9,"div",4)),2&t&&(e.xp6(5),e.ekj("active",o.tab1),e.xp6(2),e.ekj("active",o.tab2),e.xp6(2),e.Q6J("ngIf",o.tab2),e.xp6(1),e.Q6J("ngIf",o.tab1))},directives:[Ze.lW,be.O5,i_.d],styles:[".mat-card[_ngcontent-%COMP%]{height:90%;border-radius:0;margin-bottom:10px;padding:0;box-shadow:0 -1px 6px 1px #cccaca}.container[_ngcontent-%COMP%]{margin-top:1%}.fin[_ngcontent-%COMP%]{padding:0;border-radius:0;background-color:#fff;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.heads[_ngcontent-%COMP%]{padding:10px 0 10px 15px;background-color:#fff;color:#000}.heading[_ngcontent-%COMP%]{background-color:#fff;color:#000;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.row[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#0076a8}h3[_ngcontent-%COMP%]{height:40px;margin:0 -13px 16px;padding:8px 8px 8px 17px;font-size:20px}.form-check-input[_ngcontent-%COMP%]{font-size:25px;border-radius:0}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0076a8;border-color:#0076a8}form[_ngcontent-%COMP%]{padding:35px}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}.row[_ngcontent-%COMP%]{padding-bottom:20px}.row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-radius:0}select[_ngcontent-%COMP%]{width:100%;height:36px}.icon_style[_ngcontent-%COMP%]{color:#005587;font-size:26px;font-weight:700}.btnn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:1px solid #0076A8;display:inline;height:35px;width:15%;border-radius:0;background-color:#fff;color:#000}.btnn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.subheading[_ngcontent-%COMP%]{text-align:center}.subheading.active[_ngcontent-%COMP%]{border-bottom:5px solid #0076A8;width:100px}.status[_ngcontent-%COMP%]{display:flex}.success[_ngcontent-%COMP%]{color:#86bc25}.succ[_ngcontent-%COMP%]{color:#86bc25;font-size:20px;margin:auto}.pending[_ngcontent-%COMP%]{color:#e3c900}.scheduled[_ngcontent-%COMP%]{color:#007cb0}.failure[_ngcontent-%COMP%]{color:#da291c}.date[_ngcontent-%COMP%]{margin:20px}.date[_ngcontent-%COMP%]{color:#97999b;width:155px;border:2px solid #00000029}"]}),n})();var xs=ce(7536);function nM(n,r){1&n&&(e.TgZ(0,"div")(1,"div",19)(2,"div",20)(3,"div",21)(4,"h4",22),e._uU(5,"Project 01"),e.qZA()(),e.TgZ(6,"div",23)(7,"h6",24),e._uU(8,"Execution started you will be notified once the dashboard is generated"),e.qZA()(),e.TgZ(9,"div",25)(10,"button",26),e._uU(11,"Ok"),e.qZA()()()()())}let iM=(()=>{class n{constructor(t,o){this.shared=t,this.solService=o}ngOnInit(){this.projectData=JSON.parse(localStorage.getItem("project")||""),this.processname=this.projectData.processName,this.projectname=this.projectData.projectName,this.process=JSON.parse(localStorage.getItem("projectProcess")||""),this.fileElem=document.getElementById("browse"),this.shared.getClick()}success(t){this.solService.executeProject(this.process).subscribe(o=>{console.log(o),this.AddEventProceeding=!0,this.addEventIndex=t})}saveiputFiles(t){let o=this.process.processId;const i=new FormData;i.append("processId",o);for(let a=0;a<t.target.files.length;a++)i.append("file",t.target.files[a]);this.solService.uploadExcelToProjectExecution(i).subscribe(a=>{console.log(a)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(xs.F),e.Y36(Jt.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-execute-process"]],decls:41,vars:3,consts:[[1,"heading"],[1,"consen"],[1,"pro"],[1,"info","row"],[1,"row","col","dis"],[1,"col","mini"],["type","file","id","browse","multiple","",2,"display","none"],[1,"bton","col"],[1,"cbtn"],["routerLink","/user/admin1/schedule"],[3,"click"],[1,"middle"],[2,"padding","10px"],[1,"but"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],[4,"ngIf"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[2,"text-align","center","margin-top","20px"],[2,"padding","70px 20px 20px 20px"],[1,"col-sm-4",2,"float","right","margin","5% 22% 5% 0"],["mat-button","","routerLink","/user/admin1/dashboard",2,"width","40%","height","35px","background-color","#0076A8","color","white","border-radius","0"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Execute Process"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"h4"),e._uU(9,"Project Name"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div",5)(13,"h4"),e._uU(14,"Process "),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()()(),e._UZ(17,"input",6),e.TgZ(18,"div",7)(19,"div",8)(20,"div")(21,"a",9),e._uU(22,"Schedule"),e.qZA()(),e.TgZ(23,"div")(24,"a",10),e.NdJ("click",function(a){return o.success(a)}),e._uU(25,"Execute Now"),e.qZA()()()()(),e.TgZ(26,"div")(27,"mat-card",11)(28,"h5",12),e._uU(29,"Upload File:"),e.qZA(),e.TgZ(30,"div",13)(31,"div")(32,"label",14)(33,"input",15),e.NdJ("change",function(a){return o.saveiputFiles(a)}),e.qZA(),e._UZ(34,"span",16)(35,"br"),e.TgZ(36,"h5"),e._uU(37,"Upload Files"),e.qZA(),e.TgZ(38,"p",17),e._uU(39,"Note: Exclude .JS and .EXE files"),e.qZA()()()()()()()(),e.YNc(40,nM,12,0,"div",18)),2&t&&(e.xp6(11),e.Oqu(o.projectname),e.xp6(5),e.Oqu(o.processname),e.xp6(24),e.Q6J("ngIf",o.AddEventProceeding))},directives:[fe.yS,Se.a8,be.O5,Ze.lW,fe.rH],styles:[".heading[_ngcontent-%COMP%]{background-color:#fff;color:#0076a8;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.pro[_ngcontent-%COMP%]{background-color:#fff;margin-top:20px;padding:20px 10px}.bton[_ngcontent-%COMP%]{display:flex;margin:auto}.bton[_ngcontent-%COMP%]   .cbtn[_ngcontent-%COMP%], .bton[_ngcontent-%COMP%]   .ubtn[_ngcontent-%COMP%]{display:flex;margin-left:auto}.bton[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;padding:10px 20px;text-decoration:none;margin:auto 5px;cursor:pointer}.dis[_ngcontent-%COMP%]{padding:0;margin:auto}.mini[_ngcontent-%COMP%]{box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;margin:20px;padding:0}.mini[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px;margin:0;background-color:#041e42;color:#fff;padding:10px 15px}.mini[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:10px 15px;margin:0}.minfile[_ngcontent-%COMP%]{height:300px;overflow:auto}.minfile[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;font-size:17px}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.taxt-audit-popup[_ngcontent-%COMP%]{width:550px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:0% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:159px;width:440px;border-style:dotted;border-width:1px solid;color:#0076a8;margin:auto;padding:30px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}"]}),n})();var oM=ce(368);function rM(n,r){1&n&&(e.TgZ(0,"tr",13)(1,"th",14),e._uU(2,"File01"),e.qZA(),e._UZ(3,"th")(4,"th")(5,"th"),e.qZA())}function aM(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t["Field "]," ")}}function sM(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t["Data type"]," ")}}function lM(n,r){if(1&n&&(e.TgZ(0,"td"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.Description," ")}}function cM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.YNc(1,aM,2,1,"td",19),e.YNc(2,sM,2,1,"td",19),e.YNc(3,lM,2,1,"td",19),e.TgZ(4,"td")(5,"input",22),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2).index;return e.oxw().captureDataSetFieldss(a,s,l)}),e.qZA()()()}if(2&n){const t=r.$implicit,o=r.index;e.xp6(1),e.Q6J("ngIf",t.Description),e.xp6(1),e.Q6J("ngIf",t.Description),e.xp6(1),e.Q6J("ngIf",t.Description),e.xp6(2),e.MGl("id","defination",o,""),e.Q6J("value",t.defination)}}function dM(n,r){if(1&n&&(e.TgZ(0,"table",12)(1,"thead"),e.YNc(2,rM,6,0,"tr",21),e.qZA(),e.TgZ(3,"tbody"),e.YNc(4,cM,6,5,"tr",10),e.qZA()()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(2),e.Q6J("ngForOf",o),e.xp6(2),e.Q6J("ngForOf",t["Data Fields"])}}function _M(n,r){if(1&n&&(e.ynx(0),e.YNc(1,dM,5,2,"table",20),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function pM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",23),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().inputFileRowClickedd(a)}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e._UZ(3,"td"),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t["Field "]," ")}}function uM(n,r){1&n&&(e.TgZ(0,"div")(1,"div",24)(2,"div",25)(3,"div",26)(4,"h4",27),e._uU(5,"Project 01"),e.qZA()(),e.TgZ(6,"div",28)(7,"h6",29),e._uU(8,"Execution started you will be notified once the dashboard is generated"),e.qZA()(),e.TgZ(9,"div",30)(10,"button",31),e._uU(11,"Ok"),e.qZA()()()()())}let fM=(()=>{class n{constructor(t,o){this.fb=t,this.renderer=o,this.customDataFieldValue="",this.dummyDatas=[[{"Data Fields":[{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""}],fileName:"Invoice_Data.xlsx",Sheet1:[]}],[{"Data Fields":[{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""},{"Field ":"CompanyCode",Description:"Company reference invoice or credit note relates to","Data type":"Text",fileName:"Invoice_Data.xlsx",showFileFieldName:"Invo.CompanyCode",fileFieldName:"Invoice_Data.CompanyCode",defination:""}],fileName:"Invoice_Data.xlsx",Sheet1:[]}]],this.dummyCustomData=[{"Field ":"CompanyCode"},{"Field ":"CompanyName"},{"Field ":"Vendor"},{"Field ":"Vendor Name"},{"Field ":"Document Number"},{"Field ":"Currency"},{"Field ":"Payment Type"}]}ngOnInit(){}inputFileRowClickedd(t){this.customDataFieldValue=t["Field "]}captureDataSetFieldss(t,o,i){this.capturedTableField={item:t["Field "],indexNumber:o,tableNumber:i},this.dummyDatas.forEach((s,l)=>{this.capturedTableField.tableNumber==l&&s[0]["Data Fields"].forEach((c,d)=>{this.capturedTableField.indexNumber==d&&(c.defination=this.customDataFieldValue)})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.qu),e.Y36(e.Qsj))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-custom-data"]],decls:44,vars:3,consts:[[1,"heading"],[1,"consen"],[1,"pro","row"],[1,"info","row"],[1,"row","col","dis"],[1,"col","mini"],[1,"bton","col"],[1,"col-md-8"],[1,"middle"],[1,"col","container","scroll"],[4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"table","table-striped"],[2,"background-color","#041E42","color","white"],["scope","col"],[3,"click",4,"ngFor","ngForOf"],[1,"col-md-4",2,"margin","auto","margin-right","0"],["mat-button","","color","primary","routerLink","/user/admin1/solution-board-dashboard",1,"cD_btn",2,"width","100px","height","auto"],["mat-button","","color","primary","routerLink","/user/admin1/solution-board-dashboard",1,"cD_btn",2,"width","auto","height","auto"],[4,"ngIf"],["class","table table-striped",4,"ngFor","ngForOf"],["style","background-color: #041E42; color:white",4,"ngFor","ngForOf"],[1,"form-control",3,"id","value","click"],[3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[2,"text-align","center","margin-top","20px"],[2,"padding","70px 20px 20px 20px"],[1,"col-sm-4",2,"float","right","margin","5% 22% 5% 0"],["mat-button","","routerLink","/user/admin1/dashboard",2,"width","40%","height","35px","background-color","#0076A8","color","white","border-radius","0"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Custom Data Workspace"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"h4"),e._uU(9,"Project Name"),e.qZA(),e.TgZ(10,"p"),e._uU(11,"Project01"),e.qZA()(),e.TgZ(12,"div",5)(13,"h4"),e._uU(14,"Process "),e.qZA(),e.TgZ(15,"p"),e._uU(16,"Record to Report"),e.qZA()()(),e._UZ(17,"div",6),e.qZA(),e.TgZ(18,"div",7)(19,"mat-card",8)(20,"form",9),e.YNc(21,_M,2,1,"ng-container",10),e.qZA()()(),e.TgZ(22,"div",11)(23,"mat-card",8),e.ynx(24),e.TgZ(25,"table",12)(26,"thead")(27,"tr",13)(28,"th",14),e._uU(29,"Custom Data"),e.qZA(),e._UZ(30,"th"),e.qZA()(),e.TgZ(31,"tbody"),e.YNc(32,pM,4,1,"tr",15),e.qZA()(),e.BQk(),e.qZA()(),e.TgZ(33,"div",16)(34,"button",17),e._uU(35,"Save"),e.qZA(),e._uU(36,"\xa0 \xa0 "),e.TgZ(37,"button",18),e._uU(38,"Save & Execute"),e.qZA(),e._uU(39,"\xa0 \xa0 "),e.TgZ(40,"button",17),e._uU(41,"Schedule"),e.qZA(),e._uU(42,"\xa0 \xa0 "),e.qZA()()(),e.YNc(43,uM,12,0,"div",19)),2&t&&(e.xp6(21),e.Q6J("ngForOf",o.dummyDatas),e.xp6(11),e.Q6J("ngForOf",o.dummyCustomData),e.xp6(11),e.Q6J("ngIf",o.AddEventProceeding))},directives:[Se.a8,w._Y,w.JL,w.F,be.sg,be.O5,Ze.lW,fe.rH],styles:[".heading[_ngcontent-%COMP%]{background-color:#fff;color:#0076a8;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.pro[_ngcontent-%COMP%]{background-color:#fff;margin-top:20px;padding:20px 10px}.bton[_ngcontent-%COMP%]{display:flex;margin:auto}.bton[_ngcontent-%COMP%]   .cbtn[_ngcontent-%COMP%], .bton[_ngcontent-%COMP%]   .ubtn[_ngcontent-%COMP%]{display:flex;margin-left:auto}.bton[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;padding:10px 20px;text-decoration:none;margin:auto 5px;cursor:pointer}.dis[_ngcontent-%COMP%]{padding:0;margin:auto}.mini[_ngcontent-%COMP%]{box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;margin:20px;padding:0}.mini[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:18px;margin:0;background-color:#041e42;color:#fff;padding:5px 10px}.mini[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:5px 10px}.minfile[_ngcontent-%COMP%]{height:300px;overflow:auto}.minfile[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.taxt-audit-popup[_ngcontent-%COMP%]{width:550px}.middle[_ngcontent-%COMP%]{height:100%}.cD_btn[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;border-radius:0;border:1px solid #ccc;margin-top:15px}"]}),n})();var mM=ce(6011),hM=ce(4337),gM=ce(3989);function xM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw().publishSolution()}),e._uU(1,"Publish "),e._UZ(2,"span",13),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngClass",t.published?"disab":"enab")("disabled",t.published)}}function vM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(){return e.CHM(t),e.oxw().Submit()}),e._uU(1,"Submit "),e._UZ(2,"span",13),e.qZA()}}function CM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",15)(2,"div",16)(3,"div",17)(4,"h3"),e._uU(5,"PowerBI Report"),e.qZA(),e.TgZ(6,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().hideViewReport()}),e._uU(7,"\xd7"),e.qZA()(),e.TgZ(8,"div",19)(9,"div",8),e._UZ(10,"powerbi-report",20),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.Q6J("embedConfig",t.reportViewConfig)}}ce(6496);const TM=function(n){return{"is-invalid":n}};function bM(n,r){if(1&n&&e._UZ(0,"input",27),2&n){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(1,TM,t.submited&&t.saveas.controls.name.errors))}}function wM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",15)(2,"div",16)(3,"div",17)(4,"h3"),e._uU(5,"Scession End"),e.qZA(),e.TgZ(6,"button",18),e.NdJ("click",function(){return e.CHM(t),e.oxw().hideViewReport()}),e._uU(7,"\xd7"),e.qZA()(),e.TgZ(8,"form",21),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().ReportSave()}),e.TgZ(9,"div",22)(10,"p"),e._uU(11,"your power bi repot will be expired in 5 minutes "),e.qZA(),e.YNc(12,bM,1,3,"input",23),e.qZA(),e.TgZ(13,"div",24)(14,"button",2),e.NdJ("click",function(){return e.CHM(t),e.oxw().CloseModal()}),e._uU(15,"Cancel "),e._UZ(16,"span",25),e.qZA(),e.TgZ(17,"button",26),e._uU(18,"Save "),e.TgZ(19,"mat-icon"),e._uU(20,"save"),e.qZA()()()()()()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("formGroup",t.saveas),e.xp6(4),e.Q6J("ngIf",t.create)}}let SM=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u){this.router=t,this.httpService=o,this.fb=i,this.popup=a,this._element=s,this.loader=l,this.solService=c,this.Masters=d,this.route=_,this.toast=u,this.published=!1,this.reportClass="report-container ",this.isEditPowerBI=!1,this.milliSecondsInASecond=1e3,this.hoursInADay=24,this.minutesInAnHour=60,this.SecondsInAMinute=60,this.submited=!1,this.tokenpopup=!1,this.create=!1}get element(){return this._element}set element(t){this._element=t}ngOnInit(){var t=this;return(0,$e.Z)(function*(){var o;t.saveas=t.fb.group({name:[""]}),t.PBIdata=JSON.parse(localStorage.getItem("PBIdata")||"{}"),console.log(t.PBIdata),t.process=JSON.parse(localStorage.getItem("process")||"{}"),"Published"==t.process.statusName&&(console.log(t.process.statusName),t.published=!0),t.datasetid=t.PBIdata.dataSetResponse[0].dataSetId,t.assigned=t.PBIdata.created,t.powerbi=t.service?t.service:new It.service.Service(It.factories.hpmFactory,It.factories.wpmpFactory,It.factories.routerFactory),t.ReportList=t.PBIdata.dataSetResponse[0].reportList,t.viewEmbedConfig=t.ReportList[0],t.time=new Date,t.exptime=new Date(t.viewEmbedConfig.tokenExpiry),console.log(t.time,t.exptime),t.diff=t.exptime.getTime()-t.time.getTime(),Math.floor(t.diff/t.milliSecondsInASecond),(null===(o=t.ReportList)||void 0===o?void 0:o.length)>0&&null!=t.ReportList[0].reportId?(t.create=!1,t.reportId=t.ReportList[0].reportId,t.editReportData()):(t.create=!0,t.reportConfig={type:"report",tokenType:It.models.TokenType.Embed,accessToken:t.viewEmbedConfig.embedToken,datasetId:t.datasetid,embedUrl:t.viewEmbedConfig.embedUrl,permissions:It.models.Permissions.All,settings:{background:It.models.BackgroundType.Transparent,panes:{bookmarks:{visible:!0},Insights:{visible:!0}}}},t.embedContainer=document.getElementById("embed"),t.report=t.powerbi.createReport(t.embedContainer,t.reportConfig),t.report1=t.powerbi.createReport(t.embedContainer,t.reportConfig),t.report.off("saved"),t.report.on("saved",l=>{l.detail.saveAs?(console.log(l.detail,"\nIn order to interact with the new report, create a new token and load the new report"),t.newsaved({dataSetId:t.datasetid,reportName:l.detail,reportid:l.detail.reportObjectId})):console.log(l.detail)}))})()}editReportData(){this.isEditPowerBI=!0,console.log(this.viewEmbedConfig),this.reportEditConfig={type:"report",tokenType:It.models.TokenType.Embed,accessToken:this.viewEmbedConfig.embedToken,embedUrl:this.viewEmbedConfig.embedUrl,id:this.reportId,viewMode:It.models.ViewMode.Edit,permissions:It.models.Permissions.ReadWrite,settings:{background:It.models.BackgroundType.Transparent,filterPaneEnabled:!0,navContentPaneEnabled:!0,panes:{bookmarks:{visible:!0},Insights:{visible:!0}}}},this.embedContainer=document.getElementById("embedEdit"),this.report=this.powerbi.embed(this.embedContainer,this.reportEditConfig),console.log(this.report,this.reportConfig),this.report.off("saved"),this.report.on("saved",t=>{0==t.detail.saveAs?(this.published=!1,console.log(t.detail,"\nIn order to interact with the new report, create a new token and load the new report"),this.updatesaved(t.detail.reportObjectId)):console.log(t.detail)})}ReportSave(){this.report.off("saved"),this.create?null!=this.saveas.value.name?(this.report.saveAs({name:this.saveas.value.name}),this.tokenpopup=!1,this.saveas.reset()):this.popup.open(!1,"Enter report name to save report"):(this.report.save(),this.tokenpopup=!1,this.saveas.reset())}CloseModal(){this.tokenpopup=!1,this.saveas.reset()}newsaved(t){const o={embedtype:"RV",reportid:t.reportid,groupid:this.PBIdata.workSpaceId,datasetid:t.dataSetId,processId:this.process.processId,reportName:t.reportName.reportName};this.httpService.saveReport(o).subscribe(i=>{i&&(this.PBIdata.dataSetResponse[0].reportList[0].reportId=o.reportid,localStorage.setItem("PBIdata",JSON.stringify(this.PBIdata)),this.create=!1,this.viewEmbedConfig=i.responseData,this.reportId=o.reportid,this.editReportData())})}getAllDataSetNameAPI(){this.solService.getAllDatasetName(this.process.processId).subscribe(t=>{this.dataSets=t.responseData,this.loader.hide()},t=>{this.loader.hide()})}updatesaved(t){let o={reportId:t};console.log("hello",o),this.solService.updateAdminReports(o).subscribe(i=>{console.log(i)})}reportData(){this.AddEventProceeding=!0,this.embedViewContainer=document.getElementById("embedView"),this.reportViewConfig={type:"report",tokenType:It.models.TokenType.Embed,accessToken:this.viewEmbedConfig.embedToken,embedUrl:this.viewEmbedConfig.embedUrl,workSpaceId:this.viewEmbedConfig.workSpaceId,id:this.reportId,filters:[],settings:{filterPaneEnabled:!0,navContentPaneEnabled:!0}},this.viewReport=this.powerbi.embed(this.embedViewContainer,this.reportViewConfig),this.viewReport.off("loaded"),this.viewReport.on("loaded",()=>{console.log("report loaded....")})}hideViewReport(){this.AddEventProceeding=!1}publishSolution(){this.solService.publishSolution(this.process.processId).subscribe(t=>{this.toast.success({title:"Success",message:t.responseData}),this.router.navigate(["/user/admin1/solution-board-dashboard"])},t=>{this.toast.error({title:"Error",message:t.error.responseData})})}Submit(){this.Masters.updateStatus(this.process.processId,2).subscribe(t=>{this.toast.success({title:"Success",message:t.responseData}),this.router.navigate(["/user/admin1/solution-board-dashboard"])},t=>{this.toast.error({title:"Error",message:t.error.responseData})})}printReport(){try{this.editReport.print()}catch(t){console.log(t)}}ngDestroy(){clearInterval(this.inter)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(fe.F0),e.Y36(hs.O),e.Y36(w.qu),e.Y36(Fn.q),e.Y36(e.SBq),e.Y36(Nn.D),e.Y36(Jt.e),e.Y36(Hn.R),e.Y36(fe.gz),e.Y36(ti.q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-new-solution"]],inputs:{service:"service"},decls:16,vars:9,consts:[[1,"consen","mainContainer","full-container"],[1,"toolbar-block","button-group",2,"padding","0px !important"],["mat-button","",3,"click"],[1,"dds-icon","dds-icon_eyeopen"],["mat-button","","class","primary",3,"ngClass","disabled","click",4,"ngIf"],["mat-button","","class","primary",3,"click",4,"ngIf"],[1,"inner-container"],[1,"main"],[1,"report-container"],["id","embed",3,"ngClass","embedConfig"],["id","embedEdit",3,"ngClass","embedConfig"],[4,"ngIf"],["mat-button","",1,"primary",3,"ngClass","disabled","click"],[1,"dds-icon","dds-icon_arrow_right__l__stroke"],["mat-button","",1,"primary",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup","min-max-width90"],[1,"taxt-header","popup-header"],["mat-button","",1,"close",3,"click"],[1,"popup-body",2,"padding-bottom","0px"],["id","embedView",2,"height","70vh",3,"embedConfig"],[3,"formGroup","ngSubmit"],[1,"popup-body"],["type","text","class","form-control reflect-model","formControlName","name","maxlength","50",3,"ngClass",4,"ngIf"],[1,"popup-footer","button-group"],[1,"report-modal-close","dds-icon","dds-icon_close__l__stroke"],["mat-button","","type","submit",1,"primary"],["type","text","formControlName","name","maxlength","50",1,"form-control","reflect-model",3,"ngClass"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",1)(4,"button",2),e.NdJ("click",function(){return o.reportData()}),e._uU(5,"View Report "),e._UZ(6,"span",3),e.qZA(),e.YNc(7,xM,3,2,"button",4),e.YNc(8,vM,3,0,"button",5),e.qZA(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8),e._UZ(12,"powerbi-report",9)(13,"powerbi-report",10),e.qZA()()(),e.YNc(14,CM,11,1,"div",11),e.YNc(15,wM,21,2,"div",11),e.qZA()),2&t&&(e.xp6(2),e.hij("Process Name: ",o.process.processName,""),e.xp6(5),e.Q6J("ngIf",o.assigned),e.xp6(1),e.Q6J("ngIf",!o.assigned),e.xp6(4),e.Q6J("ngClass",o.create?"":"displ")("embedConfig",o.reportConfig),e.xp6(1),e.Q6J("ngClass",o.create?"displ":"")("embedConfig",o.reportEditConfig),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding),e.xp6(1),e.Q6J("ngIf",o.tokenpopup))},directives:[Ze.lW,be.O5,be.mk,Jr.$i,w._Y,w.JL,w.sg,w.Fj,w.JJ,w.u,w.nD,zr.Hw],styles:[".displ[_ngcontent-%COMP%]{display:none}.enab[_ngcontent-%COMP%]{background:#007cb0;color:#fff}.disab[_ngcontent-%COMP%]{background:#a5a7a8;color:#3d3c3c}"]}),n})(),NM=(()=>{class n{constructor(t,o,i){this.formbuilder=t,this.Master=o,this.router=i,this.submited=!1}ngOnInit(){}edit(t,o){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.qu),e.Y36(Hn.R),e.Y36(fe.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-approval"]],decls:0,vars:0,template:function(t,o){},styles:[""]}),n})();function AM(n,r){1&n&&e._UZ(0,"span",11)}function yM(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"button",9),e._uU(2),e.YNc(3,AM,1,0,"span",10),e.qZA(),e._uU(4," \xa0 "),e.BQk()),2&n){const t=r.$implicit,o=r.index,i=e.oxw();e.xp6(1),e.ekj("active",t.isActive),e.xp6(1),e.Oqu(t.value),e.xp6(1),e.Q6J("ngIf",i.tabs.length-1!=o)}}function DM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div")(3,"label",20)(4,"input",21),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._UZ(5,"span",22)(6,"br"),e.TgZ(7,"h5"),e._uU(8,"Upload Files"),e.qZA(),e.TgZ(9,"p",23),e._uU(10,"Note: Exclude .JS and .EXE files"),e.qZA()()()()()}}function kM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"span",24),e._uU(2,"Choose the sheets within the file(s)"),e.qZA(),e.TgZ(3,"div",25)(4,"h5"),e._uU(5,"Uploaded Files"),e.qZA()(),e.TgZ(6,"div",26)(7,"input",27),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(2).masterSelected=i})("change",function(){return e.CHM(t),e.oxw(2).checkUncheckAllUploadFiles()}),e.qZA(),e.TgZ(8,"label"),e._uU(9,"Select All"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("ngModel",t.masterSelected)}}function FM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",29),e.BQk())}function MM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",30),e.BQk())}function LM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",31),e.BQk())}function IM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSheetSelected=i})("change",function(){return e.CHM(t),e.oxw(3).isAllSelectedUploadFiles()}),e.qZA(),e._UZ(3,"img",33),e.TgZ(4,"label"),e._uU(5),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSheetSelected),e.xp6(3),e.Oqu(t.sheetName)}}function EM(n,r){1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",34),e.qZA()())}function ZM(n,r){if(1&n&&(e.TgZ(0,"table",28)(1,"thead")(2,"tr")(3,"th"),e.YNc(4,FM,2,0,"ng-container",7),e.YNc(5,MM,2,0,"ng-container",7),e.YNc(6,LM,2,0,"ng-container",7),e._uU(7),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,IM,6,2,"tr",6),e.YNc(10,EM,3,0,"tr",7),e.qZA()()),2&n){const t=r.$implicit;e.xp6(4),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.hij(" ",t.fileNameWithExt," "),e.xp6(2),e.Q6J("ngForOf",t.totalSheetList),e.xp6(1),e.Q6J("ngIf",t.isProgressBar)}}function PM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.showUploadFilesTab=!1,i.fileListt=[],i.masterSelected=!1}),e._uU(1,"Prev"),e.qZA()}}function OM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Next"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isUploadFilesNextBtnEnable)}}function UM(n,r){if(1&n&&(e.TgZ(0,"div")(1,"mat-card")(2,"div",12)(3,"div"),e.YNc(4,DM,11,0,"div",13),e.YNc(5,kM,10,1,"div",7),e.YNc(6,ZM,11,6,"table",14),e.qZA(),e.TgZ(7,"div",15),e.YNc(8,PM,2,0,"button",16),e.YNc(9,OM,2,1,"button",17),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",!t.showUploadFilesTab),e.xp6(1),e.Q6J("ngIf",t.showUploadFilesTab),e.xp6(1),e.Q6J("ngForOf",t.fileListt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListt.length>0)}}function BM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",29),e.BQk())}function JM(n,r){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"span",30),e.TgZ(2,"span",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).previewPopup("","","","",i.tableName)}),e.qZA(),e.BQk()}}function qM(n,r){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"span",31),e.TgZ(2,"span",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).previewPopup("","","","",i.tableName)}),e.qZA(),e.BQk()}}function RM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",43),e._UZ(2,"img",33),e.TgZ(3,"label"),e._uU(4),e.qZA(),e.TgZ(5,"span",42),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).previewPopup("","","","",i.tableName)}),e.qZA()()()}if(2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.sheetName,"")}}function QM(n,r){if(1&n&&(e.TgZ(0,"tbody"),e.YNc(1,RM,6,1,"tr",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",(null==t?null:t.isSheetSelected)&&"xlsx"==t.fileExt||(null==t?null:t.isSheetSelected)&&"xls"==t.fileExt)}}function HM(n,r){if(1&n&&(e.TgZ(0,"table",28)(1,"thead")(2,"tr")(3,"th"),e.YNc(4,BM,2,0,"ng-container",7),e.YNc(5,JM,3,0,"ng-container",7),e.YNc(6,qM,3,0,"ng-container",7),e._uU(7),e.qZA()()(),e.YNc(8,QM,2,1,"tbody",6),e.qZA()),2&n){const t=r.$implicit;e.xp6(4),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.hij(" ",t.fileNameWithExt," "),e.xp6(1),e.Q6J("ngForOf",t.totalSheetList)}}function YM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:0})}),e._uU(1,"Prev"),e.qZA()}}function VM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.changeTabs({id:2}),i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1,"Next"),e.qZA()}}function $M(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-card",37)(2,"span",24),e._uU(3,"Click the view icon to see a preview of the filtered files' or sheets' information. "),e.qZA(),e.TgZ(4,"div",38)(5,"div",25)(6,"h5"),e._uU(7,"Selected Files "),e.TgZ(8,"span",39),e._uU(9,"Preview Data"),e.qZA()()(),e.TgZ(10,"div"),e.YNc(11,HM,9,5,"table",14),e.qZA(),e.TgZ(12,"div",40),e.YNc(13,YM,2,0,"button",41),e.YNc(14,VM,2,0,"button",41),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.fileListtt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function KM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",59),e.BQk())}function WM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",60),e.BQk())}function zM(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",61),e.BQk())}function GM(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",29),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij("",t.sheetName," ")}}function XM(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",56)(1,"td")(2,"input",57),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw().index;return e.oxw(3).isAllSelected(i,s,c,l)}),e.qZA(),e.YNc(3,KM,2,0,"ng-container",7),e.YNc(4,WM,2,0,"ng-container",7),e.YNc(5,zM,2,0,"ng-container",7),e._uU(6),e.qZA(),e.TgZ(7,"td",58),e.YNc(8,GM,3,1,"ng-container",7),e.qZA(),e.TgZ(9,"td")(10,"span",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.hij(" ",t.fileNameWithExt," "),e.xp6(2),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt)}}function jM(n,r){if(1&n&&(e.TgZ(0,"div",62),e._uU(1),e.qZA()),2&n){const t=e.oxw(4);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function e5(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Append Sheets"),e.qZA(),e.TgZ(3,"span",24),e._uU(4,"To append the sheets, please choose the ones with identical columns. Select atleast two sheets for appending "),e.qZA(),e.TgZ(5,"table",49)(6,"thead",50)(7,"tr")(8,"th",51),e._uU(9,"Filename"),e.qZA(),e.TgZ(10,"th",52),e._uU(11," Sheetname"),e.qZA(),e.TgZ(12,"th",50),e._uU(13,"Preview"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,XM,11,6,"tr",53),e.qZA()(),e.YNc(16,jM,2,1,"div",54),e.TgZ(17,"button",55),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).addAppendName()}),e._uU(18," Append"),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(15),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",o.submitted),e.xp6(1),e.Q6J("disabled",!o.hideCreateIdenticalBtnWithLength)}}function t5(n,r){if(1&n&&(e.ynx(0),e.YNc(1,e5,19,3,"ng-container",6),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.sortedList)}}function n5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",63),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1}),e._uU(1," Append"),e.qZA()}}function i5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",59),e.BQk())}function o5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",60),e.BQk())}function r5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",61),e.BQk())}function a5(n,r){if(1&n&&(e.TgZ(0,"div",72),e.YNc(1,i5,2,0,"ng-container",7),e.YNc(2,o5,2,0,"ng-container",7),e.YNc(3,r5,2,0,"ng-container",7),e._uU(4),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.hij(" ",t.fileNameWithExt," ")}}function s5(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",33),e.TgZ(2,"label"),e._uU(3),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.sheetName)}}function l5(n,r){if(1&n&&(e.TgZ(0,"div",72),e.YNc(1,s5,4,1,"ng-container",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt)}}function c5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"tr",66)(2,"td",67),e._uU(3),e.qZA()(),e.TgZ(4,"tr",68)(5,"td"),e.YNc(6,a5,5,4,"div",69),e.qZA(),e.TgZ(7,"td",58),e.YNc(8,l5,2,1,"div",69),e.qZA(),e.TgZ(9,"td",70),e._UZ(10,"span",71),e.qZA()(),e.BQk()),2&n){const t=r.$implicit;e.xp6(3),e.Oqu(t.showAppendName),e.xp6(3),e.Q6J("ngForOf",t.tableList),e.xp6(2),e.Q6J("ngForOf",t.tableList)}}function d5(n,r){if(1&n&&(e.TgZ(0,"table",49)(1,"thead")(2,"tr")(3,"th",64),e._uU(4,"Append Set(s)"),e.qZA()()(),e.TgZ(5,"tbody",65),e.YNc(6,c5,11,3,"ng-container",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.sortedCheckedList)}}function _5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",73),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.createIdentical(-1),i.hideCreateIdenticalBtn=!1,i.mergeCheckedList=[],i.sortedCheckedList=[]}),e._uU(1," Reset "),e.qZA()}}function p5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1})}),e._uU(1,"Prev"),e.qZA()}}function u5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).saveAppendAPI()}),e._uU(1,"Save"),e.qZA()}}function f5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:3},"unChedkedList")}),e._uU(1,"Next"),e.qZA()}}function m5(n,r){if(1&n&&(e.TgZ(0,"div",45),e.YNc(1,t5,2,1,"ng-container",7),e.YNc(2,n5,2,0,"button",46),e.YNc(3,d5,7,1,"table",47),e._UZ(4,"br"),e.YNc(5,_5,2,0,"button",48),e.TgZ(6,"div",39),e.YNc(7,p5,2,0,"button",41),e.YNc(8,u5,2,0,"button",41),e.YNc(9,f5,2,0,"button",41),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=t.sortedList[0].length),e.xp6(1),e.Q6J("ngIf",t.hideCreateIdenticalBtn),e.xp6(1),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",0!=t.sortedCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function h5(n,r){1&n&&e.GkF(0)}function g5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",59),e.BQk())}function x5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",60),e.BQk())}function v5(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",61),e.BQk())}function C5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",79)(1,"td")(2,"input",80),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelected=i})("change",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).checkedInJoin(i,s,l)}),e.qZA(),e.YNc(3,h5,1,0,"ng-container",7),e.YNc(4,g5,2,0,"ng-container",7),e.YNc(5,x5,2,0,"ng-container",7),e.YNc(6,v5,2,0,"ng-container",7),e._uU(7),e.TgZ(8,"div",81),e._UZ(9,"span",71),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelected),e.xp6(1),e.Q6J("ngIf",1==t.isAppend),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.hij(" ",t.showAppendName," ")}}function T5(n,r){if(1&n&&(e.TgZ(0,"table",77)(1,"tbody"),e.YNc(2,C5,10,6,"tr",78),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.sortedCheckedList)}}function b5(n,r){if(1&n&&(e.TgZ(0,"div",62),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function w5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).join2Sheets()}),e._uU(1,"Join"),e.qZA()}}function S5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",104),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value," ")}}function N5(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function A5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",104),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij("",t.value," ")}}function y5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",105),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).addTableJoins(a,i)}),e.qZA()}if(2&n){const t=e.oxw(2).index,o=e.oxw(3);e.Q6J("disabled",null==o.mergeCheckedList[t]?null:o.mergeCheckedList[t].allTablesSelected)}}function D5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(3).removeTable(a,i)}),e.qZA()}}function k5(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function F5(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function M5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",112),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index,a=e.oxw().index;return e.oxw(3).addColumnJoin(a,i)}),e.qZA()}}function L5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index,s=e.oxw().index;return e.oxw(3).removeCol(s,a,i)}),e.qZA()}}function I5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",89)(1,"div",12),e._UZ(2,"div",94),e.TgZ(3,"div",95)(4,"mat-form-field",96)(5,"mat-select",107),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectPrimarykey(i,s,l,c)}),e.YNc(6,k5,2,2,"mat-option",99),e.qZA()()(),e._UZ(7,"div",94),e.TgZ(8,"div",95)(9,"mat-form-field",96)(10,"mat-select",108),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(3).selectForeignKey(i,s,l,c)}),e.YNc(11,F5,2,2,"mat-option",99),e.qZA()()(),e.TgZ(12,"div",109),e.YNc(13,M5,1,0,"button",110),e.YNc(14,L5,1,0,"button",111),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw().index,a=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(6),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].columns[t]?null:a.mergeCheckedList[i].dropDownList[o].columns[t].primaryKeyList),e.xp6(5),e.Q6J("ngForOf",null==a.mergeCheckedList[i]||null==a.mergeCheckedList[i].dropDownList[o]||null==a.mergeCheckedList[i].dropDownList[o].columns[t]?null:a.mergeCheckedList[i].dropDownList[o].columns[t].foreignKeyList),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function E5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",93)(1,"div",12),e._UZ(2,"div",94),e.TgZ(3,"div",95)(4,"mat-form-field",96)(5,"mat-select",97),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectPrimaryTable(i,s,l)}),e.YNc(6,S5,3,2,"ng-container",6),e.qZA()()(),e.TgZ(7,"div",94)(8,"mat-form-field",96)(9,"mat-select",98),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectJoin(i,s,l)}),e.YNc(10,N5,2,2,"mat-option",99),e.qZA()()(),e.TgZ(11,"div",95)(12,"mat-form-field",96)(13,"mat-select",100),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(3).selectForeignTable(i,s,l)}),e.YNc(14,A5,3,2,"ng-container",6),e.qZA()()(),e.TgZ(15,"div",94),e.YNc(16,y5,1,1,"button",101),e.YNc(17,D5,1,0,"button",102),e.qZA()(),e.TgZ(18,"div",103),e.YNc(19,I5,15,5,"div",88),e.qZA()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(5),e.Q6J("placeholder",i.placetable),e.xp6(1),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].primaryTableList),e.xp6(4),e.Q6J("ngForOf",i.joinType),e.xp6(4),e.Q6J("ngForOf",null==i.mergeCheckedList[o]?null:i.mergeCheckedList[o].dropDownList[t].foreignTableList),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t),e.xp6(2),e.Q6J("ngForOf",i.columnArr(o,t).controls)}}function Z5(n,r){if(1&n&&(e.TgZ(0,"div",89)(1,"div",90),e._uU(2),e.qZA(),e.TgZ(3,"div",91),e.YNc(4,E5,20,8,"div",92),e.qZA()()),2&n){const t=r.index,o=e.oxw(3);e.Q6J("formGroupName",t),e.xp6(2),e.hij("Join Table Name : ",o.mergeCheckedList[t].showMergeName," "),e.xp6(2),e.Q6J("ngForOf",o.TableArr(t).controls)}}function P5(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",82)(2,"div",83)(3,"div",84),e._uU(4,"Join Set "),e.qZA(),e._UZ(5,"div",85)(6,"div",85)(7,"div",85)(8,"div",86),e.qZA(),e.TgZ(9,"div",87),e.YNc(10,Z5,5,3,"div",88),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.joinSetForm),e.xp6(9),e.Q6J("ngForOf",t.MergeArr().controls)}}function O5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",113),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).resetMerge()}),e._uU(1,"Reset"),e.qZA()}}function U5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:2},"prevInMerge")}),e._uU(1,"Prev"),e.qZA()}}function B5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).MergeSubmit()}),e._uU(1,"Save"),e.qZA()}}function J5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:4},"appendList")}),e._uU(1,"Next"),e.qZA()}}function q5(n,r){if(1&n&&(e.TgZ(0,"div",45),e.ynx(1),e.TgZ(2,"span",24),e._uU(3,"Select the files, then join them based on common columns "),e.qZA(),e.TgZ(4,"div",25)(5,"h5"),e._uU(6,"Files "),e.TgZ(7,"div",74),e._uU(8,"Preview"),e.qZA()()(),e.YNc(9,T5,3,1,"table",75),e.YNc(10,b5,2,1,"div",54),e.YNc(11,w5,2,0,"button",41),e.YNc(12,P5,11,2,"div",7),e.YNc(13,O5,2,0,"button",76),e.TgZ(14,"div",39),e.YNc(15,U5,2,0,"button",41),e.YNc(16,B5,2,0,"button",41),e.YNc(17,J5,2,0,"button",41),e.qZA(),e.BQk(),e.qZA()),2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(1),e.Q6J("ngIf",t.sortedCheckedList.length>0),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(1),e.Q6J("ngIf",0!=t.mergeCheckedList.length),e.xp6(2),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0),e.xp6(1),e.Q6J("ngIf",t.fileListtt.length>0)}}function R5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",122),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.appendName," ")}}function Q5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",120)(2,"table",121)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Append Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,R5,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function H5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",122),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.mergeName," ")}}function Y5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",120)(2,"table",121)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Join Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,H5,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function V5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tbody")(1,"tr")(2,"td",122),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(3),e.TgZ(4,"span",42),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.fileName," ")}}function $5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",120)(2,"table",121)(3,"thead")(4,"tr",25)(5,"th"),e._uU(6,"Source Files"),e.qZA()()(),e.YNc(7,V5,5,3,"tbody",6),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(7),e.Q6J("ngForOf",t.sheetList)}}function K5(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Q5,9,1,"ng-container",7),e.YNc(2,Y5,9,1,"ng-container",7),e.YNc(3,$5,8,1,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","append"==t.fileType),e.xp6(1),e.Q6J("ngIf","join"==t.fileType),e.xp6(1),e.Q6J("ngIf","files"==t.fileType)}}function W5(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span",132)(2,"div"),e._uU(3),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.s9C("matTooltip",t.fieldName),e.xp6(2),e.Oqu(t.fieldName)}}function z5(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function G5(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",127)(2,"input",128),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isChecked=i}),e.qZA()(),e.TgZ(3,"td",129),e.YNc(4,W5,4,2,"ng-container",7),e.qZA(),e.TgZ(5,"td",130)(6,"mat-form-field",96)(7,"mat-select",131),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.columnType=i}),e.YNc(8,z5,2,2,"mat-option",99),e.qZA()()()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngModel",t.isChecked),e.xp6(2),e.Q6J("ngIf","files"==o.fileTypeInTF||"append"==o.fileTypeInTF||"join"==o.fileTypeInTF),e.xp6(3),e.Q6J("ngModel",t.columnType),e.xp6(1),e.Q6J("ngForOf",o.dataTypee)}}function X5(n,r){if(1&n&&(e.TgZ(0,"table",121)(1,"thead")(2,"tr",123)(3,"th",124),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",125),e._uU(6,"Column Name"),e.qZA(),e.TgZ(7,"th",126),e._uU(8,"Data Type"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,G5,9,4,"tr",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",t.clickedRowDataInTF)}}function j5(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",114)(2,"span",115),e._uU(3,"Here is the complete list of files that are appended, joined, and other individual files that can be used to build the datasets. "),e.qZA(),e.TgZ(4,"div",116),e.YNc(5,K5,4,3,"ng-container",6),e.qZA(),e.TgZ(6,"div",117),e.YNc(7,X5,11,1,"table",118),e.qZA(),e.TgZ(8,"div",119)(9,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3})}),e._uU(10,"Prev"),e.qZA(),e.TgZ(11,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:5})}),e._uU(12,"Next"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.targetFiles),e.xp6(2),e.Q6J("ngIf",0!=(null==t.clickedRowDataInTF?null:t.clickedRowDataInTF.length))}}function eL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",158)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function tL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,eL,4,2,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.tableAppendFieldsDto)}}function nL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",158)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function iL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,nL,4,2,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.filteredDataAppend)}}function oL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",147),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",148)(2,"p",149),e._uU(3),e.qZA(),e.TgZ(4,"div",150)(5,"span",151),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",152)(8,"input",153),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(2).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",154)(10,"input",155),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",156),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,tL,2,1,"ng-container",7),e.YNc(15,iL,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(4);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.appendName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterAppend),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterAppend)}}function rL(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",138)(2,"h5"),e._uU(3,"Append Files"),e.qZA()(),e.TgZ(4,"mat-accordion",145),e.YNc(5,oL,16,5,"mat-expansion-panel",146),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function aL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",161)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function sL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,aL,4,2,"mat-accordion",160),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.mergeFieldListDTO)}}function lL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",161)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function cL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,lL,4,2,"mat-accordion",160),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.filteredDataJoin)}}function dL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",147),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",148)(2,"p",149),e._uU(3),e.qZA(),e.TgZ(4,"div",150)(5,"span",151),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",152)(8,"input",153),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(2).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",154)(10,"input",155),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",156),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,sL,2,1,"ng-container",7),e.YNc(15,cL,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(4);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.mergeName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterJoin),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterJoin)}}function _L(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",138)(2,"h5"),e._uU(3,"Join Files"),e.qZA()(),e.TgZ(4,"mat-accordion",145),e.YNc(5,dL,16,5,"mat-expansion-panel",146),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function pL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",158)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function uL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,pL,4,2,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.sheet)}}function fL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",158)(1,"div",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(4).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(2).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function mL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,fL,4,2,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",t.filteredDataFiles)}}function hL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",147),e.NdJ("opened",function(){return e.CHM(t),e.oxw(4).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(4).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",148)(2,"p",149),e._uU(3),e.qZA(),e.TgZ(4,"div",150)(5,"span",151),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup("","","","",a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",152)(8,"input",153),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(2).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",154)(10,"input",155),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",156),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,uL,2,1,"ng-container",7),e.YNc(15,mL,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(4);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.fileName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterFiles),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterFiles)}}function gL(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",138)(2,"h5"),e._uU(3,"Source Files"),e.qZA()(),e.TgZ(4,"mat-accordion",145),e.YNc(5,hL,16,5,"mat-expansion-panel",146),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngForOf",t.sheetList)}}function xL(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",144),e.YNc(2,rL,6,1,"ng-container",7),e.qZA(),e.TgZ(3,"div",144),e.YNc(4,_L,6,1,"ng-container",7),e.qZA(),e.TgZ(5,"div",144),e.YNc(6,gL,6,1,"ng-container",7),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngIf","append"==t.fileType),e.xp6(2),e.Q6J("ngIf","join"==t.fileType),e.xp6(2),e.Q6J("ngIf","files"==t.fileType)}}function vL(n,r){1&n&&(e.TgZ(0,"div",162),e._uU(1,"No files found"),e.qZA())}function CL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",159),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isSelectAllChildInDM=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(3).selectAllChildInDM(i,"dataset",s,a)}),e.qZA(),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function TL(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",158),e.YNc(1,CL,4,2,"ng-container",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function bL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,TL,2,1,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.datasetFieldDTOList)}}function wL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",159),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"input",32),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isSelectAllChildInDM=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(3).selectAllChildInDM(i,"dataset",s,a)}),e.qZA(),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function SL(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",158),e.YNc(1,wL,4,2,"ng-container",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function NL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,SL,2,1,"mat-accordion",157),e.BQk()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",t.filteredDataDataset)}}function AL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",147),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",163)(2,"input",164),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).onCheck(a)}),e.qZA(),e._uU(3,"\xa0 "),e.TgZ(4,"p",149),e._uU(5),e.qZA(),e.TgZ(6,"div",165)(7,"span",166),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup("","","","",a.tableName)}),e.qZA(),e.TgZ(8,"span",167),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).editDatasetFile(a)}),e.qZA(),e.TgZ(9,"span",168),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).callGetViewscript(a)}),e.qZA(),e.TgZ(10,"span",169),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"dataset")}),e.qZA()()(),e.TgZ(11,"div",12)(12,"div",152)(13,"input",153),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).applyFilterForDMTables(i,s,l,"dataset")}),e.qZA()()(),e.TgZ(14,"div",154)(15,"input",155),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).selectAllParentInDM(i,"dataset",s)}),e.qZA(),e._uU(16,"\xa0 "),e.TgZ(17,"label",156),e._uU(18,"Select All"),e.qZA()(),e.YNc(19,bL,2,1,"ng-container",7),e.YNc(20,NL,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);e.Q6J("expanded",i.allExpandState),e.xp6(5),e.Oqu(t.datasetName),e.xp6(10),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterDataset),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterDataset)}}function yL(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",145),e.YNc(1,AL,21,5,"mat-expansion-panel",146),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function DL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function kL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.value,"")}}function FL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",189)(2,"mat-select",190),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw().index;return e.oxw(3).changeDateTimeinCreateExpression(i,a)}),e.YNc(3,kL,2,2,"mat-option",99),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("ngForOf",t.dateTimeFormats)}}function ML(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",192)(1,"div",159),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).accordionExpValue(a,a.Component)}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionType,"")}}function LL(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",148),e._uU(2),e.qZA(),e.YNc(3,ML,3,1,"mat-accordion",191),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionName," "),e.xp6(1),e.Q6J("ngForOf",t.funcDescritptionsList)}}function IL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function EL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function ZL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",193)(2,"mat-form-field",96)(3,"mat-select",194),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeOperator(i,s,l,d,_)}),e.YNc(4,IL,2,2,"mat-option",99),e.qZA()(),e.TgZ(5,"mat-form-field",96)(6,"mat-select",195),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeSignOperator(i,s,l,d,_,"child")}),e.YNc(7,EL,2,2,"mat-option",99),e.qZA()(),e.TgZ(8,"input",196),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.TgZ(9,"span",197),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(),c=l.index,d=l.$implicit;return e.oxw(3).delOpearatorValueFields(a,s,c,d)}),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.xp6(3),e.Q6J("value",t.operator),e.xp6(1),e.Q6J("ngForOf",o.opearatorList),e.xp6(2),e.Q6J("value",t.signOperator),e.xp6(1),e.Q6J("ngForOf",o.signOperatorList),e.xp6(1),e.Q6J("ngModel",t.value)}}function PL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"SAVE"),e.qZA()}}function OL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",198),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"ADD"),e.qZA()}}function UL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"table",172)(1,"tbody")(2,"tr")(3,"td",173)(4,"input",174),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)}),e.qZA(),e.TgZ(5,"div",175)(6,"input",176),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.excludeInSelect=i}),e.qZA(),e.TgZ(7,"label"),e._uU(8,"Exclude in select"),e.qZA()(),e.TgZ(9,"div",177)(10,"mat-form-field",178)(11,"mat-select",179),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(3).changeDTinCreateExpression(i,s)}),e.YNc(12,DL,2,2,"mat-option",99),e.qZA()(),e.YNc(13,FL,4,1,"ng-container",7),e.qZA(),e.TgZ(14,"div",177)(15,"div",180)(16,"div")(17,"img",181),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.isOpenAccordion=0==i.isOpenAccordion}),e.qZA()(),e.TgZ(18,"div",182)(19,"div",183)(20,"input",184),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i)}),e.qZA(),e._UZ(21,"span",185),e.qZA(),e.TgZ(22,"mat-accordion",145),e.YNc(23,LL,4,2,"mat-expansion-panel",6),e.qZA()()(),e.TgZ(24,"div",186)(25,"textarea",187),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)}),e._uU(26,"                                                "),e.qZA()()(),e.YNc(27,ZL,10,5,"ng-container",6),e.qZA()()(),e.ynx(28),e.YNc(29,PL,2,0,"button",41),e.YNc(30,OL,2,0,"button",188),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(4),e.Q6J("value",t.sourcecolumnName),e.xp6(2),e.Q6J("ngModel",t.excludeInSelect),e.xp6(5),e.Q6J("value",t.columnType),e.xp6(1),e.Q6J("ngForOf",o.dataTypee),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(10),e.Q6J("ngForOf",o.searchfx),e.xp6(2),e.Q6J("value",t.expression),e.xp6(2),e.Q6J("ngForOf",null==t?null:t.whereList),e.xp6(2),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",0==t.isEdit)}}function BL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.ynx(1),e.TgZ(2,"td",217),e._uU(3),e.qZA(),e.TgZ(4,"td",217),e._uU(5),e.qZA(),e.TgZ(6,"td",218)(7,"span",219),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).editRowInDataSet(l,a,s)}),e.qZA(),e.TgZ(8,"span",169),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).deleteRowInDataset(l,a,s)}),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.sourcecolumnName,""),e.xp6(1),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.columnType,""),e.xp6(1),e.ekj("active",t.isEdit)}}function JL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function qL(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",222)(2,"mat-select",227),e.YNc(3,JL,2,2,"mat-option",99),e.qZA()(),e.BQk()),2&n){const t=e.oxw(6);e.xp6(3),e.Q6J("ngForOf",t.opearatorList)}}function RL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.filefieldName,"")}}function QL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t.value," ")}}function HL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,QL,2,2,"mat-option",99),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",o.signOperatorWhereInDS[t])}}function YL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",228),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).addOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function VL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",197),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).delOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function $L(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",220)(1,"div",221),e.YNc(2,qL,4,1,"ng-container",7),e.TgZ(3,"mat-form-field",222)(4,"mat-select",223),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(2).index;return e.oxw(3).changeColumnInDSForWhere(i,s,c,l)}),e.YNc(5,RL,2,2,"mat-option",99),e.qZA()(),e.TgZ(6,"mat-form-field",222)(7,"mat-select",224),e.YNc(8,HL,2,1,"ng-container",7),e.qZA()(),e.TgZ(9,"div",225),e._UZ(10,"input",226),e.YNc(11,YL,2,0,"ng-container",7),e.YNc(12,VL,2,0,"ng-container",7),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw(5);e.Q6J("formGroupName",t),e.xp6(2),e.Q6J("ngIf",0!=t),e.xp6(3),e.Q6J("ngForOf",o.columnsForWhereInDS),e.xp6(3),e.Q6J("ngIf",0!=o.signOperatorWhereInDS.length),e.xp6(3),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function KL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function WL(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function zL(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",137)(2,"table",121)(3,"thead")(4,"tr",50)(5,"th",199),e._uU(6),e.qZA(),e._UZ(7,"th",200),e.TgZ(8,"th",201),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteDataSet(i)}),e._UZ(9,"span",202),e.qZA()(),e.TgZ(10,"tr",50)(11,"th"),e._uU(12,"Column Name"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Column Type"),e.qZA(),e.TgZ(15,"th",203),e._uU(16,"Actions"),e.qZA()()(),e.TgZ(17,"tbody"),e.ynx(18),e.YNc(19,BL,9,8,"tr",6),e.BQk(),e.qZA(),e._UZ(20,"div"),e.qZA()(),e.TgZ(21,"form",204)(22,"label",205),e._uU(23,"Where:"),e.qZA(),e.TgZ(24,"div",206),e.YNc(25,$L,13,6,"div",207),e.qZA(),e.TgZ(26,"div",208)(27,"label",209),e._uU(28,"Group By"),e.qZA(),e.TgZ(29,"mat-form-field",210)(30,"mat-select",211),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"groupby")}),e.YNc(31,KL,2,2,"mat-option",99),e.qZA()()(),e.TgZ(32,"div",212)(33,"label",209),e._uU(34,"Having"),e.qZA(),e._UZ(35,"input",213),e.qZA(),e.TgZ(36,"div",212)(37,"label",214),e._uU(38,"Order By"),e.qZA(),e.TgZ(39,"mat-form-field",215)(40,"mat-select",216),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"orderby")}),e.YNc(41,WL,2,2,"mat-option",99),e.qZA()()()(),e.TgZ(42,"button",198),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index;return e.oxw(3).saveDataSet(a,s)}),e._uU(43,"Save Dataset"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(6),e.hij("Dataset Name :\xa0",t.datasetName,""),e.xp6(13),e.Q6J("ngForOf",t.datasetFieldDTOList),e.xp6(2),e.Q6J("formGroup",o.datasetTableForm),e.xp6(4),e.Q6J("ngForOf",o.whereArrInDS().controls),e.xp6(6),e.Q6J("ngForOf",t.groupBytoDB),e.xp6(10),e.Q6J("ngForOf",t.orderBytoDB)}}function GL(n,r){if(1&n&&(e.ynx(0),e.YNc(1,zL,44,6,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isDatasetTableExpand)}}function XL(n,r){if(1&n&&(e.TgZ(0,"div",170)(1,"div",25)(2,"h5"),e._uU(3,"Create Expression"),e.qZA()(),e.YNc(4,UL,31,10,"table",171),e.YNc(5,GL,2,1,"ng-container",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("ngForOf",t.createExpressionList),e.xp6(1),e.Q6J("ngForOf",t.datasetDetailsList)}}function jL(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"mat-card")(2,"span",24),e._uU(3,"Use the column names from the files listed below to create the dataset(s), then define the dataset columns using analytical operations or by using the column name directly."),e.qZA(),e.TgZ(4,"div")(5,"button",133),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!0}),e._uU(6,"Expand All "),e.qZA(),e.TgZ(7,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!1}),e._uU(8,"Collapse All "),e.qZA(),e.TgZ(9,"button",134),e.NdJ("click",function(){return e.CHM(t),e.oxw().createDataSetinDM()}),e._uU(10," Create DataSet"),e.qZA(),e.TgZ(11,"button",134),e.NdJ("click",function(){return e.CHM(t),e.oxw().uploadSQLScriptBtn()}),e._uU(12," Upload SQL Script"),e.qZA(),e.TgZ(13,"button",134),e.NdJ("click",function(){return e.CHM(t),e.oxw().uploadPythonScriptBtn()}),e._uU(14," Upload Python Script"),e.qZA()(),e.TgZ(15,"div",135)(16,"div",12)(17,"div",136),e.YNc(18,xL,7,3,"ng-container",6),e.TgZ(19,"div",137)(20,"div",138)(21,"h5"),e._uU(22,"DataSet Files "),e.TgZ(23,"span",39),e._uU(24,"Actions"),e.qZA()()(),e.YNc(25,vL,2,0,"div",139),e.YNc(26,yL,2,1,"mat-accordion",140),e.qZA()(),e.YNc(27,XL,6,2,"div",141),e.TgZ(28,"div")(29,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDataset()}),e._uU(30,"Append Dataset"),e.qZA()(),e.TgZ(31,"div",142)(32,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:4},"prev")}),e._uU(33,"Prev"),e.qZA(),e.TgZ(34,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().getViewScript()}),e._uU(35,"View Script"),e.qZA(),e.TgZ(36,"button",44),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeProject()}),e._uU(37,"Execute"),e.qZA(),e.TgZ(38,"button",143),e.NdJ("click",function(){return e.CHM(t),e.oxw().SaveContinue()}),e._uU(39,"Continue"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(18),e.Q6J("ngForOf",t.targetFiles),e.xp6(7),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)),e.xp6(1),e.Q6J("ngIf",0!=t.createExpressionList.length)}}const Oi=function(n){return{"is-invalid":n}};function eI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",230)(3,"div",231)(4,"h4",232),e._uU(5,"Append Name"),e.qZA()(),e.TgZ(6,"form",204)(7,"div",233)(8,"div",234)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",235),e.qZA()(),e.TgZ(12,"div",236)(13,"button",237),e.NdJ("click",function(){return e.CHM(t),e.oxw().createAppendSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.appendForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,Oi,t.submited&&t.appendForm.controls.appendNameControl.errors))}}function tI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",230)(3,"div",231)(4,"h4",232),e._uU(5,"Join Name"),e.qZA()(),e.TgZ(6,"form",204)(7,"div",233)(8,"div",234)(9,"label"),e._uU(10,"Enter Name"),e.qZA(),e._UZ(11,"input",235),e.qZA()(),e.TgZ(12,"div",236)(13,"button",239),e.NdJ("click",function(){return e.CHM(t),e.oxw().mergeSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableMergeNamePopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.joinForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,Oi,t.submited&&t.joinForm.controls.appendNameControl.errors))}}function nI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",245)(2,"span",246),e.BQk())}const iI=function(n,r){return{"dds-icon_arrow_down__l__stroke":n,"dds-icon_arrow_up__l__stroke":r}};function oI(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"th",159),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index;return e.oxw(2).onSortClick(a,s)}),e._uU(2),e._UZ(3,"span",244),e.YNc(4,nI,3,0,"ng-container",7),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(2);e.xp6(2),e.hij("",t," "),e.xp6(1),e.Q6J("ngClass",e.WLB(3,iI,i.sortColumn==o&&"asc"==i.sortOrder,i.sortColumn==o&&"desc"==i.sortOrder)),e.xp6(1),e.Q6J("ngIf",i.sortColumn!=o)}}function rI(n,r){if(1&n&&(e.TgZ(0,"td",248),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t],"")}}function aI(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,rI,2,1,"td",247),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.columnsArr)}}function sI(n,r){if(1&n&&(e.TgZ(0,"div",249),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Row Count: ",t.rowCount,"")}}function lI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",240),e._UZ(3,"div",231),e.TgZ(4,"form")(5,"table",121)(6,"thead")(7,"tr"),e.YNc(8,oI,5,6,"ng-container",6),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,aI,2,1,"tr",6),e.qZA()()(),e.YNc(11,sI,2,1,"div",241),e.TgZ(12,"div",242)(13,"button",243),e.NdJ("click",function(){return e.CHM(t),e.oxw().showTargetFilePopup=!1}),e._uU(14,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.columnsArr),e.xp6(2),e.Q6J("ngForOf",t.selectedM_A_S),e.xp6(1),e.Q6J("ngIf",t.rowCount)}}function cI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",230)(3,"div",231)(4,"h4",232),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",204)(7,"div",233)(8,"div",234)(9,"label"),e._uU(10,"Enter DataSet Name"),e.qZA(),e.TgZ(11,"input",250),e.NdJ("change",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA()()(),e.TgZ(12,"div",236)(13,"button",251),e.NdJ("click",function(){return e.CHM(t),e.oxw().createNewDataSet()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopUp=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetForm)}}function dI(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",104),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function _I(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",104),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function pI(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",104),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function uI(n,r){if(1&n&&(e.TgZ(0,"mat-option",104),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function fI(n,r){if(1&n&&(e.TgZ(0,"mat-option",264),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function mI(n,r){if(1&n&&(e.ynx(0),e.YNc(1,fI,2,2,"mat-option",263),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw().index,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].foreignKeyList)}}function hI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",265),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).addcolumnRowInDS(i,a)}),e._uU(1,"Column "),e.qZA()}}function gI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",106),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).deletecolumnRowInDS(i,a)}),e.qZA()}}function xI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",89)(1,"div",177)(2,"div",261)(3,"mat-form-field",96)(4,"mat-select",107),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectPrimaryKeyInDS(i,s,l)}),e.YNc(5,uI,2,2,"mat-option",99),e.qZA()()(),e.TgZ(6,"div",261)(7,"mat-form-field",96)(8,"mat-select",108),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectForeignKeyInDS(i,s,l)}),e.YNc(9,mI,2,1,"ng-container",7),e.qZA()()(),e.TgZ(10,"div",94),e.YNc(11,hI,2,0,"button",262),e.YNc(12,gI,1,0,"button",111),e.qZA()()()}if(2&n){const t=r.index,o=e.oxw().index,i=e.oxw(2);e.Q6J("formGroupName",t),e.xp6(5),e.Q6J("ngForOf",null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].primaryKeyList),e.xp6(4),e.Q6J("ngIf",null!=(null==i.dataSetData[o]?null:i.dataSetData[o].foreignTableList)),e.xp6(2),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function vI(n,r){if(1&n){const t=e.EpF();e.ynx(0,89),e.TgZ(1,"div",12)(2,"mat-form-field",256)(3,"mat-select",257),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectPrimaryTableInDS(i,s)}),e.YNc(4,dI,3,2,"ng-container",6),e.qZA()(),e.TgZ(5,"mat-form-field",256)(6,"mat-select",258),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectJoinTypeInDS(i,s)}),e.YNc(7,_I,3,2,"ng-container",6),e.qZA()(),e.TgZ(8,"mat-form-field",256)(9,"mat-select",259),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectForeignTableInDS(i,s)}),e.YNc(10,pI,3,2,"ng-container",6),e.qZA()(),e.TgZ(11,"div",260),e.YNc(12,xI,13,5,"div",88),e.qZA()(),e.BQk()}if(2&n){const t=r.index,o=e.oxw(2);e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("placeholder",o.placetable),e.xp6(1),e.Q6J("ngForOf",null==o.dataSetData[t]?null:o.dataSetData[t].primaryTableList),e.xp6(3),e.Q6J("ngForOf",o.joinType),e.xp6(3),e.Q6J("ngForOf",null==o.dataSetData[t]?null:o.dataSetData[t].foreignTableList),e.xp6(2),e.Q6J("ngForOf",o.columnArrInDS(t).controls)}}function CI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",252)(3,"div",231)(4,"h4",232),e._uU(5,"Save Dataset "),e.TgZ(6,"button",253),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeDatasetPopup()}),e.TgZ(7,"span",254),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form",204)(10,"div",255),e._UZ(11,"div"),e.YNc(12,vI,13,6,"ng-container",88),e.qZA(),e.TgZ(13,"div",236)(14,"button",251),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetDropdowns()}),e._uU(15,"Save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.dataSetForm),e.xp6(3),e.Q6J("ngForOf",t.DataSetArr().controls)}}function TI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",266)(2,"div",230)(3,"div",231)(4,"h4",232),e._uU(5,"View Script"),e.qZA()(),e.TgZ(6,"form",204),e._UZ(7,"textarea",267),e.qZA(),e.TgZ(8,"div",236)(9,"button",239),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.updateScriptByDatasetId(i.viewscriptForm)}),e._uU(10,"Save"),e.qZA(),e.TgZ(11,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptPopup=!1}),e._uU(12,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.viewscriptForm)}}function bI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",266)(2,"div",268)(3,"div",231)(4,"h4",232),e._uU(5,"Upload Script"),e.qZA()(),e.TgZ(6,"form",204)(7,"input",269),e.NdJ("keyup",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA(),e._UZ(8,"textarea",270),e.qZA(),e.TgZ(9,"div",236)(10,"button",239),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetApi()}),e._uU(11,"Save"),e.qZA(),e.TgZ(12,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQLPopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(3,Oi,t.submited&&t.sqlScriptForm.controls.datasetName.errors)),e.xp6(1),e.Q6J("ngClass",e.VKq(5,Oi,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function wI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",229)(2,"div",230)(3,"div",231)(4,"h4",232),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",204)(7,"div",233)(8,"div",234)(9,"label"),e._uU(10,"Enter DataSet Name"),e.qZA(),e.TgZ(11,"input",271),e.NdJ("change",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA()()(),e.TgZ(12,"div",236)(13,"button",251),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDatasetApi()}),e._uU(14,"Add"),e.qZA(),e.TgZ(15,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetAppendPopup=!1}),e._uU(16,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetAppendForm),e.xp6(5),e.Q6J("ngClass",e.VKq(2,Oi,t.submitted&&t.datasetAppendForm.controls.appendNameControl.errors))}}function SI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"label",272)(3,"input",273),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQLScript(i,a.isBtnClickedSQL_Python)}),e.qZA(),e._UZ(4,"span",22)(5,"br"),e.TgZ(6,"h5"),e._uU(7,"Upload File"),e.qZA(),e.TgZ(8,"p",23),e._uU(9,"Note: only .sql and .txt files"),e.qZA()()()()}}function NI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",204),e._UZ(2,"textarea",270),e.qZA(),e.TgZ(3,"div",236)(4,"button",239),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.saveUploadScript(i.isBtnClickedSQL_Python)}),e._uU(5,"Save"),e.qZA(),e.TgZ(6,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).enableUploadSQLPopup=!1}),e._uU(7,"Cancel"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,Oi,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function AI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",266)(2,"div",268)(3,"div",231)(4,"h4",232),e._uU(5,"Upload Script "),e.TgZ(6,"button",253),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQL_PythonPopup=!1}),e.TgZ(7,"span",254),e._uU(8,"\xd7"),e.qZA()()()(),e.YNc(9,SI,10,0,"div",13),e.YNc(10,NI,8,4,"div",7),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function yI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",266)(2,"div",268)(3,"div",231)(4,"h4",232),e._uU(5,"Upload Script "),e.TgZ(6,"button",253),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewscriptPopup=!1}),e.TgZ(7,"span",254),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form",204),e._UZ(10,"textarea",274),e.qZA(),e.TgZ(11,"div",236)(12,"button",239),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateViewScript()}),e._uU(13,"Update"),e.qZA(),e.TgZ(14,"button",238),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewscriptPopup=!1}),e._uU(15,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.getViewScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,Oi,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}let DI=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_){this.popup=t,this.router=o,this.formBuilder=i,this.toast=a,this.loader=s,this.fb=l,this.renderer=c,this.solService=d,this.dialog=_,this.submited=!1,this.submit=!1,this.fileListt=[],this.sortedList=[],this.sortedCheckedList=[],this.mergeCheckedList=[],this.appendUnchechedList=[],this.enableDataSetPopUp=!1,this.datasetDetailsList=[],this.createExpressionList=[],this.filesList=[],this.columnsArr=[],this.showUploadFilesTab=!1,this.masterSelected=!1,this.tabs=[{id:0,value:"Upload Files",isActive:!0},{id:1,value:"Filtered FIles",isActive:!1},{id:2,value:"Append",isActive:!1},{id:3,value:"Join",isActive:!1},{id:4,value:"Target Files",isActive:!1},{id:5,value:"Data Modelling",isActive:!1}],this.enableAppendNamePopup=!1,this.enableMergeNamePopup=!1,this.submitted=!1,this.submittedErrorMsg="",this.targetFileRowEdit=-1,this.hideCreateIdenticalBtnWithLength=!0,this.hideCreateIdenticalBtn=!0,this.selectedM_A_S=[],this.showTargetFilePopup=!1,this.cursorPosition=0,this.appendNameControl=new w.NI(null),this.opearatorList=[{id:0,value:"AND"},{id:1,value:"OR"}],this.signOperatorList=[],this.isOpenAccordion=!1,this.fx=[],this.appendListInMCL=[],this.appendListInSCL=[],this.sheetsListInSCL=[],this.allExpandState=!1,this.panelOpenState=!1,this.columnsForWhereInDS=[],this.dataType=["int","float","char","varchar","dateTime","money","text","decimal","datetime2","decimal","nvarchar","bigint"],this.dataTypee=[{id:0,value:"int"},{id:1,value:"float"},{id:2,value:"char"},{id:3,value:"varchar"},{id:4,value:"text"},{id:5,value:"money"},{id:6,value:"dateTime"},{id:7,value:"date"},{id:8,value:"datetime2"},{id:9,value:"decimal"},{id:10,value:"nvarchar"},{id:11,value:"bigint"}],this.dateTimeFormats=[{id:0,value:"MM/dd/yyyy"},{id:1,value:"MM-dd-yyyy"},{id:2,value:"dd/MM/yyyy"},{id:3,value:"dd-MM-yyyy"},{id:4,value:"yyyy/MM/dd"},{id:5,value:"yyyy-MM-dd"},{id:6,value:"yyyy/dd/MM"},{id:7,value:"yyyy-dd-MM"},{id:8,value:"MMddyyyy"},{id:9,value:"ddMMyyyy"},{id:10,value:"yyyyMMdd"},{id:11,value:"yyyyddMM"}],this.joinType=["Inner Join","Left Join","Outer Join","Right Join","Full Join","Cross Join"],this.unCheckedListAddToMergeList=[],this.allDatasetDetailsList=[],this.enableUploadSQLPopup=!1,this.placetable="Select Primary Table",this.dataSetData=[],this.iscreatesolutionEdit=!1,this.textAreaIndexInDM={},this.textAreaIndexinCE={},this.tablecolNameList=[],this.AJFDlist=[],this.aJFDAllFilesList=[],this.fileListtt=[],this.templatesMergeObj={},this.mergeCheckedListForDM=[],this.secndAPIResp={},this.isUploadFilesNextBtnEnable=!1,this.targetFiles=[],this.skipAppend=!1,this.skipJoin=!1,this.fileSheetList=[],this.showTargetFilesColumnss=[],this.singleTableDatasetsave=!1,this.viewScriptFromApi="",this.enableViewScriptPopup=!1,this.appendAPIResp={},this.searchfx=[],this.clickedRowDataInTF=[],this.fileTypeInTF="",this.allTableListInDM=[],this.allTableListWithoutDSInDM=[],this.selectedColumnsOfDS=[],this.saveDataSetPopup=!1,this.dropDownsInDS=[],this.sortDir=1,this.sortOrder="asc",this.signOperatorWhereInDS=[],this.enableDatasetAppendPopup=!1,this.enableUploadSQL_PythonPopup=!1,this.uploadSQLBtn=!0,this.enableViewscriptPopup=!1}ngOnInit(){this.joinSetForm=this.formBuilder.group({Merg:this.formBuilder.array([])}),this.process={processId:"86aee36c-a54a-49aa-8654-1a985172525a"},this.getAllFileTemplateListByProcessID(),this.appendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.joinForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionList=[],this.invoiceForm1=this.fb.group({DRows1:this.fb.array([])}),this.dataSetForm=this.fb.group({DSetRows:this.fb.array([])}),this.datasetForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.viewscriptForm=this.fb.group({sqlScript:[""],datasetId:[""]}),this.sqlScriptForm=this.fb.group({datasetName:["",w.kI.required],sqlScript:["",w.kI.required]}),this.datasetTableForm=this.fb.group({groupBy:[""],having:[""],orderBy:[""],where:this.fb.array([this.whereFirstRow()])}),this.datasetAppendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.getViewScriptForm=this.formBuilder.group({script:["",w.kI.required],solutionScriptId:[""]})}validateDatasetname(){return t=>{var o;const s=null===(o=this.datasetForm.get("appendNameControl"))||void 0===o?void 0:o.value;return this.solService.getExistDataset(s,"").subscribe(c=>{this.submitted=!1,this.submittedErrorMsg=""},c=>{this.submitted=!0,this.submittedErrorMsg="Dataset Name Already Exists"}),(0,xt.of)(null)}}Merg(){return this.formBuilder.group({tableControl:this.formBuilder.array([])})}addTable(){return this.formBuilder.group({table1:["",w.kI.required],join:["",w.kI.required],table2:["",w.kI.required],column:this.formBuilder.array([])})}addColumn(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}DataSetArr(){return this.dataSetForm.get("DSetRows")}MergeArr(){return this.joinSetForm.get("Merg")}TableArr(t){return this.MergeArr().controls[t].get("tableControl")}columnArr(t,o){return this.TableArr(t).controls[o].get("column")}addMergeJoin(){this.MergeArr().push(this.Merg());let t=this.MergeArr().length;this.TableArr(t-1).push(this.addTable());let o=this.TableArr(t-1).length;this.columnArr(t-1,o-1).push(this.addColumn())}addTableJoins(t,o){this.mergeCheckedList[t].dropDownList[o+1].columns=[{primaryKeyList:[],foreignKeyList:[]}],this.TableArr(t).push(this.addTable());let i=this.TableArr(t).length;this.columnArr(t,i-1).push(this.addColumn())}addColumnJoin(t,o){this.columnArr(t,o).push(this.addColumn())}removeTable(t,o){this.TableArr(t).removeAt(o)}removeCol(t,o,i){this.columnArr(t,o).removeAt(i)}DataSetRow(){return this.formBuilder.group({Ptable:["",w.kI.required],join:["",w.kI.required],Ftable:["",w.kI.required],Pcolumn:["",w.kI.required],Fcolumn:["",w.kI.required],columns:this.formBuilder.array([this.addColumnInDS()])})}addColumnInDS(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}columnArrInDS(t){return this.DataSetArr().controls[t].get("columns")}ngAfterViewInit(){}isValidName(){return t=>{var o;let i=!0;return""==(null===(o=this.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value)&&(i=!1),(0,xt.of)(i?null:{invalid:!0})}}isAllSelectedUploadFiles(){let t=1;this.fileListt.forEach(o=>{o.totalSheetList.forEach(i=>{0!=i.isSheetSelected||(t=0)})}),this.masterSelected=0!=t,this.nextBtnEnableInUF()}checkUncheckAllUploadFiles(){this.fileListt.forEach(t=>{var o;null===(o=null==t?void 0:t.totalSheetList)||void 0===o||o.forEach(i=>{i.isSheetSelected=this.masterSelected})}),this.nextBtnEnableInUF()}getAllFunctions(){this.solService.getAllFunctions().subscribe(t=>{this.fx=t.responseData,this.searchfx=t.responseData,console.log(t),this.loader.hide()},t=>{this.loader.hide()})}getAllFileTemplateListByProcessID(){this.loader.show(),this.solService.getAllFileTemplateListByProcessID(this.process.processId).subscribe(t=>{this.showUploadFilesTab=!0;const o=t.responseData.totalfileDetails;0==o.length?this.showUploadFilesTab=!1:(this.iscreatesolutionEdit=!0,o.forEach(i=>{i.totalSheetList.forEach(a=>{var s;a.isSheetSelected=!1;const l=a.sheetName;null===(s=a.sheet)||void 0===s||s.forEach(c=>{c.isChecked=!1,c.tableName=a.tableName,"xlsx"==i.fileExt||"xls"==i.fileExt?c.showTabColName=i.fileName+"-"+l+"."+i.fileExt+"["+c.fieldName+"]":("txt"==i.fileExt||"csv"==i.fileExt)&&(c.showTabColName=i.fileNameWithExt+"["+c.fieldName+"]"),c.fileExt=i.fileExt})})}),this.fileListt=o),this.loader.hide()},t=>{this.loader.hide()})}saveiputFiles(t){this.showUploadFilesTab=!0;let o=this.process.processId;const i=new FormData;i.append("processId",o);for(let a=0;a<t.target.files.length;a++)i.append("file",t.target.files[a]);for(let a=0;a<t.target.files.length;a++){const s=t.target.files[a];this.fileListt.push({fileNameWithExt:s.name.split(".")[0],isProgressBar:!0,fileExt:s.name.split(".")[1]})}this.solService.postInputFiles(i).subscribe(a=>{this.getAllFileTemplateListByProcessID()},a=>{this.loader.hide()})}addOpearatorValueFields(t,o){o.whereList.push({signOperatorList:o.signOperatorList,opearatorList:this.opearatorList,value:""})}delOpearatorValueFields(t,o,i,a){this.createExpressionList[i].whereList.splice(t,1)}changeSignOperator(t,o,i,a,s,l){const c=t.value;"parent"==l?this.createExpressionList[a].signOperator=c:i.signOperator=c}changeOperator(t,o,i,a,s){i.operator=t.value}rowClickedDataModeling(t,o,i,a){this.textAreaSlice("["+o.fieldName+"]")}textAreaSlice(t){const o=this.textAreaIndexinCE.value,i=this.textAreaIndexinCE.cursorPosition,a=[o.slice(0,i),t,o.slice(i)].join("");this.createExpressionList[this.textAreaIndexinCE.index].expression=a}textAreaInDataModeling(t,o){const i=t.target.selectionStart;t.target.value.substr(i,t.target.selectionEnd-i),this.textAreaIndexInDM={index:o,cursorPosition:i,value:t.target.value}}createNewDataSet(){var t;this.createExpressionList=[{excludeInSelect:!1,sourcecolumnName:"",columnId:"",columnFormat:"",signOperatorList:"",expression:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.enableDataSetPopUp=!1;const o={isDatasetTableExpand:!0,having:"",groupBytoDB:[],orderBytoDB:[],datasetName:null===(t=this.datasetForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),datasetFieldDTOList:[],orderBy:"",groupBy:""};this.datasetDetailsList.push(o)}saveDataSetDropdowns(){this.saveDataSetApi()}changePrimaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,u,d=JSON.parse(JSON.stringify(s.pkFKs[0].primaryTableList)),_=null==i.secondaryTableList?[]:JSON.parse(JSON.stringify(i.secondaryTableList));if(l.includes("-")){let m=l.split("-")[0],h=l.split("-")[1];this.fileListt.filter(p=>{p.fileName==m&&(null==p||p.totalSheetList.forEach(g=>{g.sheetName==h&&(c=g.templateId)}))})}else u=0==a?i.primaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType):i.secondaryTableList.filter(m=>m.fileName==l).map(m=>m.fileType),"append file"==u&&(c=this.appendAPIResp.appendSheetList.filter(m=>m.appendName==l)[0].appendID),"join file"==u&&(c=this.mergeCheckedList.filter(m=>m.showMergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].primaryTableName=l;if(0==a){if(i.primaryTableList.filter(h=>h.fileName==t.target.value),i.selectedPrimaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const h=this.mergeCheckedList.filter(p=>p.showMergeName==l);s.pkFKs[a+1].primaryKeyList=h[0].mergeFieldListDTOFromAPI}else{const h=i.primaryTableList.filter(p=>p.fileName==l);s.pkFKs[a+1].primaryKeyList=h[0].columnList}i.primaryTableList.forEach((h,p)=>{h.fileName==l&&d.splice(p,1)}),s.pkFKs[a+3].foreignTableList=d}let f=[];if(a>4){if(i.selectedSecondaryTable=l,i.primaryTemplateId=c,s.dataSetMergeListDTOs[i.order-1].primaryTemplateId=c,"join file"==u){const m=this.mergeCheckedList.filter(h=>h.showMergeName==l);s.pkFKs[a+1].secondaryKeyList=m[0].mergeFieldListDTOFromAPI}else{const m=i.secondaryTableList.filter(h=>h.fileName==l);s.pkFKs[a+1].secondaryKeyList=m[0].columnList}d.forEach(m=>{_.map(h=>h.fileName).includes(m.fileName)||f.push(m)}),s.pkFKs[a+3].foreignTableList=f}}changePrimaryKeyInDS(t,o,i,a,s){const l=t.target.value;let d;1==a?(i.selectedPrimaryKey=l,i.primaryKeyList.forEach(_=>{_.fieldName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d):(i.selectedSecondaryKey=l,i.secondaryKeyList.forEach(_=>{_.fieldName==l&&(d=_.columnId)}),i.primaryKeyId=d,s.dataSetMergeListDTOs[i.order-1].primaryKeyId=d)}changeJoinTypeInDS(t,o,i,a,s){const l=t.target.value;i.selectedMergeType=l,s.dataSetMergeListDTOs[i.order-1].joinType=l.slice(0,1)}changeSecondaryTableInDS(t,o,i,a,s){const l=t.target.value;let c,d;if(l.includes("-")){let p=l.split("-")[0],g=l.split("-")[1];this.fileListt.filter(v=>{v.fileName==p&&(null==v||v.totalSheetList.forEach(x=>{x.sheetName==g&&(c=x.templateId)}))})}else d=i.foreignTableList.filter(p=>p.fileName==l).map(p=>p.fileType),"append file"==d&&(c=this.appendAPIResp.appendSheetList.filter(p=>p.appendName==l)[0].appendID),"join file"==d&&(c=this.mergeCheckedList.filter(p=>p.showMergeName==l)[0].mergeIdFromAPI),s.dataSetMergeListDTOs[i.order-1].secondaryTableName=l;if(i.selectedForeignTable=l,i.secondaryTemplateId=c,"join file"==d){const p=this.mergeCheckedList.filter(g=>g.showMergeName==l);s.pkFKs[a+1].foreignKeyList=p[0].mergeFieldListDTOFromAPI}else{const p=i.foreignTableList.filter(g=>g.fileName==l);s.pkFKs[a+1].foreignKeyList=p[0].columnList}const m=[...s.pkFKs.filter(p=>p.selectedPrimaryTable).map(p=>p.selectedPrimaryTable),...s.pkFKs.filter(p=>p.selectedForeignTable).map(p=>p.selectedForeignTable)],h=[];s.pkFKs[0].primaryTableList.forEach(p=>{m.includes(p.fileName)&&h.push(p)}),null!=s.pkFKs[a+2]&&(s.pkFKs[a+2].secondaryTableList=h),s.dataSetMergeListDTOs[i.order-1].secondaryTemplateId=c}changeSecondaryKeyInDS(t,o,i,a,s){const l=t.target.value;i.selectedForeignKey=l;const c=i.foreignKeyList.filter(d=>d.fieldName==l);i.secondaryKeyId=c[0].columnId,s.dataSetMergeListDTOs[i.order-1].secondaryKeyId=c[0].columnId}accordionFilesRowClicked(t,o,i,a,s){const l=i.showTabColName,c=i.columnType;"textArea"==this.textAreaIndexinCE.tagType&&this.textAreaSlice(l),"input"==this.textAreaIndexinCE.tagType&&(this.createExpressionList[this.textAreaIndexinCE.index].fileType=s,this.createExpressionList[this.textAreaIndexinCE.index].sourcecolumnName=l,this.createExpressionList[this.textAreaIndexinCE.index].columnType=c,this.createExpressionList[this.textAreaIndexinCE.index].sqlColumn=i.sqlColumn,"date"==c||"datetime2"==c||"dateTime"==c?(this.createExpressionList[0].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]):this.createExpressionList[0].isColumnType=!1,("char"==c||"varchar"==c||"text"==c||"nvarchar"==c)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]),("int"==c||"float"==c||"money"==c||"decimal"==c||"bigint"==c)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]))}inputInCreateExpression(t,o){this.createExpressionList[o].sourcecolumnName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"input"}}textAreaInCreateExpression(t,o){this.createExpressionList[o].expression=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"textArea"}}createDataSetinDM(){var t;console.log("this.allTableListWithoutDSInDM",this.allTableListWithoutDSInDM),console.log("this.allTableListInDM",this.allTableListInDM),console.log("this.tablecolNameList",this.tablecolNameList),console.log("this.datasetDetailsList",this.datasetDetailsList),1!=this.datasetDetailsList.filter(i=>1==i.isDatasetTableExpand).length&&(this.enableDataSetPopUp=!0,null===(t=this.datasetForm.get("appendNameControl"))||void 0===t||t.reset())}accordionExpValue(t,o){this.textAreaSlice(t.functionType),this.isOpenAccordion=!1}changeDTinCreateExpression(t,o){this.createExpressionList[o].columnType=t.value,"date"==t.value||"datetime2"==t.value||"dateTime"==t.value?(this.createExpressionList[o].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]):this.createExpressionList[o].isColumnType=!1,("char"==t.value||"varchar"==t.value||"text"==t.value||"nvarchar"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]),("int"==t.value||"float"==t.value||"money"==t.value||"decimal"==t.value||"bigint"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]),this.createExpressionList[o].whereList=[]}changeDateTimeinCreateExpression(t,o){this.createExpressionList[o].columnFormat=t.value.value}datasetTableExpand(t,o){this.datasetDetailsList[o].isDatasetTableExpand=!0,t.isDatasetTableExpand=t.isDatasetTableExpand=!0}editRowInDataSet(t,o,i){this.datasetDetailsList[t].datasetFieldDTOList.forEach(a=>a.isEdit=!1),i.isEdit=!0,this.createExpressionList=[],this.createExpressionList.push(JSON.parse(JSON.stringify(i)))}deleteRowInDataset(t,o,i){var a,s,l;1==this.datasetDetailsList[t].datasetFieldDTOList[o].isEdit&&(this.createExpressionList=[{sourcecolumnName:"",columnId:"",expression:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}]),null===(a=this.datasetDetailsList[t])||void 0===a||a.datasetFieldDTOList.splice(o,1),null===(s=this.datasetDetailsList[t])||void 0===s||s.orderBytoDB.forEach((c,d)=>{var _;i.sourcecolumnName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.orderBytoDB.splice(d,1))}),null===(l=this.datasetDetailsList[t])||void 0===l||l.groupBytoDB.forEach((c,d)=>{var _;i.sourcecolumnName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.groupBytoDB.splice(d,1))}),this.columnsForWhereInDS.forEach((c,d)=>{i.sourcecolumnName==c.filefieldName&&this.columnsForWhereInDS.splice(d,1)}),this.UpdatechecksInDM(i,!1)}getAllDataSetNameAPI(){this.solService.getAllDatasetName(this.process.processId).subscribe(t=>{null!=t&&(t.responseData.forEach(o=>{o.datasetFieldDTOList.forEach(i=>{i.showTabColName=o.datasetName+"["+i.fieldName+"]",i.groupBy="",i.isColumnType=!1,i.isEdit=!1,i.or="",i.orderBy="",i.signOperator="",i.signOperatorList="",i.sourcecolumnName=i.uiFieldName,i.value="",i.where="",i.whereList=[]}),o.isDatasetTableExpand=!1,o.orderBytoDB=o.orderBy,o.groupBytoDB=o.groupBy}),this.allDatasetDetailsList=t.responseData,this.allTableListInDM=[],this.allTableListInDM=JSON.parse(JSON.stringify(this.allTableListWithoutDSInDM)),t.responseData.forEach(o=>{o.datasetFieldDTOList.forEach(i=>{i.fileType="dataset",i.fieldIDforExpn=i.datasetFieldId}),this.allTableListInDM.push({fileType:"dataset",tableNameUI:o.datasetName,tableNameDB:o.tableName,idName:"datasetId",ID:o.datasetId,columnList:o.datasetFieldDTOList,isSelecteddl:!1})})),this.tablecolNameList=[],this.tablecolNameList=this.allTableListInDM.map(o=>o.columnList.map(i=>({tableName:o.tableName,fileType:o.fileType,fieldID:o.fieldID,showTabColName:i.showTabColName,fieldIDforExpn:i.fieldIDforExpn,tableColumnName:i.tableColumnName}))).reduce((o,i)=>o.concat(i),[]),this.loader.hide()},t=>{this.loader.hide()})}nextBtnEnableInUF(){this.isUploadFilesNextBtnEnable=0==this.fileListt.filter(o=>{var i;return null===(i=o.totalSheetList)||void 0===i?void 0:i.some(a=>1==a.isSheetSelected)}).map(o=>Object.assign({},o,{totalSheetList:o.totalSheetList.filter(i=>1==i.isSheetSelected)})).length}deleteDataSet(t){this.datasetDetailsList.splice(t,1),this.createExpressionList=[],this.datasetDetailsList=[]}changeTabs(t,o){var i,a,s;if(1==t.id){if(this.fileListtt=[],this.nextBtnEnableInUF(),1==this.isUploadFilesNextBtnEnable)return;this.fileListt.forEach(l=>{0!=l.totalSheetList.filter(c=>c.isSheetSelected).length&&(this.fileListtt.push(l),("xlsx"!=l.fileExt||"xls"!=l.fileExt)&&l.totalSheetList.forEach(c=>{l.tableName=c.tableName}))}),this.createIdentical(-1),this.getTargetFileList()}if(2==t.id&&(this.sortedCheckedList.forEach(l=>l.isSelected=!1),(0==this.skipAppend||0==this.skipJoin)&&(t.id=4)),3==t.id&&this.sortedList[0].forEach(l=>l.isSelected=!1),this.submitted=!1,this.submittedErrorMsg="",4==t.id&&(this.targetFiles=[],this.getTargetFileList(),this.sortedCheckedList.forEach(l=>l.isSelected=!1)),4==t.id&&"prev"==o&&(this.createExpressionList=[],this.datasetDetailsList=[]),5==t.id&&(this.getAllFunctions(),this.allTableListInDM=[],this.allList(),this.getAllDataSetNameAPI()),"unChedkedList"==o&&(console.log("only reset"),0!=(null===(i=this.sortedList[0])||void 0===i?void 0:i.length)&&(this.unCheckedListAddToMergeList=this.sortedList[0].filter(l=>0==l.isSelected),this.unCheckedListAddToMergeList.forEach(l=>{let c;c=[l].map("xlsx"==l.fileExt||"xls"==l.fileExt?f=>[f.fileName,f.sheetName].join("-"):f=>[f.fileName]);const _=[];l.sheet.forEach(f=>{const h=Object.assign(Object.assign({},f),{isChecked:!1,dataType:"Select Data Type",newfieldName:"",isRowEdit:!1,fileSheet:c,generatedDataType:"",tableName:l.tableName});_.push(h)}),this.sortedCheckedList.push({columnList:_,showAppendName:c,fileName_SheetName:c,tableList:[l],isSelected:!1,fileExt:l.fileExt}),this.appendUnchechedList=[],this.appendUnchechedList=JSON.parse(JSON.stringify(this.sortedCheckedList))}))),"prevInMerge"==o&&0!=(null===(a=this.sortedList[0])||void 0===a?void 0:a.length)){let l=null===(s=this.sortedList[0])||void 0===s?void 0:s.length;this.sortedCheckedList.splice(this.sortedCheckedList.length-l,this.unCheckedListAddToMergeList.length)}this.tabs.forEach(l=>{l.isActive=t.id==l.id}),this.filesList.forEach(l=>{l.checkedSheetList=l.sheetList.filter(c=>c.isSelected)})}MergeSubmit(){this.loader.show(),console.log(this.joinSetForm.value,this.process.processId);let t={};t.processId=this.process.processId,t.templatesMergeDetailsList=[],this.MergeArr().controls.forEach((o,i)=>{t.templatesMergeDetailsList[i]={},t.templatesMergeDetailsList[i].mergeName=this.mergeCheckedList[i].showMergeName,t.templatesMergeDetailsList[i].templatesMergeList=[],t.templatesMergeDetailsList[i].mergeTableDetails=[],this.mergeCheckedList.forEach(()=>{this.mergeCheckedList[i].dropDownList[0].primaryTableList.forEach((a,s)=>{t.templatesMergeDetailsList[i].mergeTableDetails[s]={},"xlsx"==a.fileExt||"xls"==a.fileExt||"csv"==a.fileExt||"txt"==a.fileExt?(t.templatesMergeDetailsList[i].mergeTableDetails[s].id=a.templateId,t.templatesMergeDetailsList[i].mergeTableDetails[s].type="T"):a.isAppend&&this.appendAPIResp.appendSheetList.forEach(l=>{l.appendName==a.value.join()&&(t.templatesMergeDetailsList[i].mergeTableDetails[s].id=l.appendID,t.templatesMergeDetailsList[i].mergeTableDetails[s].type="A")})})}),this.TableArr(i).controls.forEach((a,s)=>{t.templatesMergeDetailsList[i].templatesMergeList[s]={};let d,_,l=a.value.table1.templateId,c=a.value.table2.templateId;null==l?this.appendAPIResp.appendSheetList.forEach(u=>{u.appendName==a.value.table1.value.join()&&(t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTemplateId=u.appendID,t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTableName=u.tableName,d=u.appendName)}):(t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTemplateId=l,t.templatesMergeDetailsList[i].templatesMergeList[s].primaryTableName=a.value.table1.tableName),null==c?this.appendAPIResp.appendSheetList.forEach(u=>{u.appendName==a.value.table2.value.join()&&(t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTemplateId=u.appendID,t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTableName=u.tableName,_=u.appendName)}):(t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTemplateId=c,t.templatesMergeDetailsList[i].templatesMergeList[s].secondaryTableName=a.value.table2.tableName),t.templatesMergeDetailsList[i].templatesMergeList[s].joinType=a.value.join[0],t.templatesMergeDetailsList[i].templatesMergeList[s].order=0==s?1:2,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList=[],this.columnArr(i,s).controls.forEach((u,f)=>{t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f]={},null==l?this.appendAPIResp.appendSheetList.forEach(m=>{m.appendName==d&&m.tableAppendFieldsDto.forEach(h=>{h.columnName==u.value.column1.columnName&&(t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryKeyId=h.fieldID)})}):t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryKeyId=u.value.column1.columnId,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].primaryFieldName=u.value.column1.columnName,null==c?this.appendAPIResp.appendSheetList.forEach(m=>{m.appendName==_&&m.tableAppendFieldsDto.forEach(h=>{h.columnName==u.value.column2.columnName&&(t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryKeyId=h.fieldID)})}):t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryKeyId=u.value.column2.columnId,t.templatesMergeDetailsList[i].templatesMergeList[s].columnArrayList[f].secondaryFieldName=u.value.column2.columnName})})}),console.log(t),this.solService.addJoinFiles(t).subscribe(o=>{console.log(o);let i=[];const a=o.responseData.templatesMergeDetailsList;a.forEach(s=>{s.templatesMergeList.forEach(l=>{l.columnArrayList.forEach(c=>{i.push({joinType:l.joinType,primaryTemplateId:l.primaryTemplateId,secondaryTemplateId:l.secondaryTemplateId,primaryKeyId:c.primaryKeyId,secondaryKeyId:c.secondaryKeyId}),this.popup.open(!0,"Saved Successfully !")})}),console.log(i),a.forEach(l=>{this.mergeCheckedList.forEach(c=>{l.mergeName==c.showMergeName&&(c.mergeIdFromAPI=l.mergeId,c.templatesMergeIdsListFromAPI=i,c.mergeFieldListDTOFromAPI=l.mergeFieldListDTO)})})}),this.loader.hide()},o=>{this.loader.hide()})}isAllSelected(t,o,i,a){this.submitted=!1,this.submittedErrorMsg="",this.hideCreateIdenticalBtnWithLength=!0,this.sortedList.forEach((s,l)=>{l==i&&s.forEach((c,d)=>{d==a&&(c.isSelected=t.target.checked)})})}createIdentical(t){var o;if(-1==t){this.sortedList=this.sortedList.splice(1,1);let i=[];this.fileListtt.forEach(s=>{s.totalSheetList.forEach(l=>{if(l.isSheetSelected&&null!=l.sheet){const c=l.sheet.map(_=>_.fieldName);let d=Object.assign(Object.assign({fileNameWithExt:s.fileNameWithExt,fileExt:s.fileExt,fileName:s.fileName,isSelected:!1},l),{[l.sheetName]:l.sheetData,fieldNames:c,[l.sheetName+"columnList"]:c});i.push(d)}})}),this.sortedList.push(i);const a=[];this.fileListtt.forEach(s=>{s.totalSheetList.forEach(l=>{l.isSheetSelected&&null!=l.sheet&&a.push(Object.assign({fileName:s.fileName},l))})}),this.fileSheetList=[],JSON.parse(JSON.stringify(this.fileListtt)).forEach(s=>{s.totalSheetList.forEach(l=>{l.isSheetSelected&&null!=l.sheet&&("xlsx"==l.fileExt||"xls"==l.fileExt?this.fileSheetList.push(Object.assign({fileExt:l.fileExt,fileName:s.fileName+"-"+l.sheetName+"."+s.fileExt},l)):("csv"==l.fileExt||"txt"==l.fileExt)&&this.fileSheetList.push(Object.assign({fileExt:l.fileExt,fileName:s.fileNameWithExt},l)))})}),console.log(" this.fileSheetList",this.fileSheetList)}if(0==t){this.sortedList[t].filter(c=>0==c.isSelected);let a=this.sortedList[t].filter(c=>1==c.isSelected),s=[],l=0;if(a.forEach(c=>{const _=c.sheetName;if(0==s.length)s=c[_+"columnList"];else{let u=c[_+"columnList"];s.forEach(f=>{u.includes(f)||(l=1)})}}),1==l)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");this.enableAppendNamePopup=!0,null===(o=this.appendForm.get("appendNameControl"))||void 0===o||o.reset()}2==t&&(this.appendUnchechedList.forEach(i=>{i.isSelected=!1}),this.sortedCheckedList=this.appendUnchechedList)}join2Sheets(){var t;if(this.sortedCheckedList.filter(i=>1==i.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Please select atleast two sheets");this.enableMergeNamePopup=!0,null===(t=this.joinForm.get("appendNameControl"))||void 0===t||t.reset()}mergeSet(){var t,o;this.submit=!0,this.addMergeJoin();let i=[],a=[],s=this.sortedCheckedList.filter(p=>p.isSelected),l=[],c=[];const d=[],_=[];s.forEach(p=>{p.fileName_SheetName.forEach(g=>{l.push(g)}),p.tableList.forEach(g=>{i.push(g)}),p.showAppendName.forEach(g=>{c.push(g)}),p.columnList.forEach(g=>{var v,x;(g=JSON.parse(JSON.stringify(g))).showTabColName=(null===(v=this.joinForm.get("appendNameControl"))||void 0===v?void 0:v.value.trim())+"["+g.fieldName+"]",d.push(Object.assign(Object.assign({},g),{joinName:null===(x=this.joinForm.get("appendNameControl"))||void 0===x?void 0:x.value.trim()}))}),p.columnList.forEach(g=>{_.push(g)}),p.columnListtt=_}),s.forEach(p=>{let g,v;("txt"==p.fileExt||"xlsx"==p.fileExt||"xls"==p.fileExt||"csv"==p.fileExt)&&(g=p.tableList[0].templateId,v=p.tableList[0].tableName),a.push({value:p.showAppendName,templateId:g,tableName:v,sheet:p.columnList,isSelected:!1,fileExt:p.fileExt,isAppend:p.isAppend})}),a.primaryKeyList=[];const u=[{type:null,primaryTableList:c,selectedPrimaryTable:"",optionValue:"select Primary Table",order:1},{type:null,primaryKeyList:[],selectedPrimaryKey:"",optionValue:"select Primary Key",order:1},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:1}];let f={type:null,foreignTableList:[],selectedForeignTable:"",optionValue:"select Foreign Table",order:1};u.push(f),f={},f.type=null,f.foreignKeyList=[],f.selectedForeignKey="",f.optionValue="select Foreign Key",f.order=1,u.push(f);let m=[];m.foreignKeyList=[];let h={dropDownList:[{primaryTableList:a,foreignTableList:m,columns:[{primaryKeyList:[],foreignKeyList:[]}]}],columnList:d,mergeList:s,showMergeName:null===(t=this.joinForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),mergedTableList:i,showMergeSheetNames:c,pkFkMergeTypeList:u,templatesMergeList:[{order:1,mergeName:null===(o=this.joinForm.get("appendNameControl"))||void 0===o?void 0:o.value.trim()}]};this.mergeCheckedList.push(h),this.enableMergeNamePopup=!1,this.sortedCheckedList.forEach(p=>{p.isSelected=!1})}resetMerge(){this.mergeCheckedList=[];const t=this.appendUnchechedList.filter(i=>1==i.isAppend),o=this.appendUnchechedList.filter(i=>null==i.isAppend);if(console.log(this.sortedCheckedList,"reset merge"),t.length>0&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),0==t.length&&(this.sortedCheckedList=JSON.parse(JSON.stringify(t))),o.length>0){const i=o.map(a=>a.tableList[0]);this.sortedList[0]=JSON.parse(JSON.stringify(i))}this.changeTabs({id:3},"unChedkedList"),this.MergeArr().clear()}addAppendName(){if(this.sortedList[0].filter(o=>1==o.isSelected).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");this.createIdentical(0)}createAppendSet(){var t;if(this.submited=!0,console.log(this.appendForm),this.appendForm.invalid)return;let o=this.sortedList[0].filter(c=>c.isSelected);this.sortedList[0].forEach(c=>c.isSelected=!1);const i=o.map(c=>[c.fileName,c.sheetName].join("-")),s=[];o[0].sheet.forEach(c=>{var d,_,u;(c=JSON.parse(JSON.stringify(c))).showTabColName=(null===(d=this.appendForm.get("appendNameControl"))||void 0===d?void 0:d.value.trim())+"["+c.fieldName+"]";const f=Object.assign(Object.assign({},c),{isChecked:!1,dataType:"Select Data Type",newfieldName:"",isRowEdit:!1,fileSheet:[null===(_=this.appendForm.get("appendNameControl"))||void 0===_?void 0:_.value.trim()],appendName:null===(u=this.appendForm.get("appendNameControl"))||void 0===u?void 0:u.value.trim()});s.push(f)});const l={columnList:s,showAppendName:[null===(t=this.appendForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim()],fileName_SheetName:i,tableList:o,isSelected:!1,isAppend:!0};this.sortedCheckedList.push(l),this.enableAppendNamePopup=!1}showTargetFileTableColumns(t,o,i,a){if(this.showTargetFilesColumnss=[],this.selectedM_A_S=[],this.selected_filename=o,this.sortedCheckedList.forEach(s=>{s.tabActiveInTargetFiles=!1}),this.mergeCheckedList.forEach(s=>{s.mergeList.forEach(l=>{l.tabActiveInTargetFiles=!1})}),"sortedCheckedList"==i){if(this.sortedCheckedList.forEach(s=>{s.tabActiveInTargetFiles=s.showAppendName==o}),o.join().includes("-")){const s=o.join().split("-")[1];this.selectedM_A_S=t.tableList[0][s]}else this.appendUnchechedList.filter(l=>l.showAppendName==o.join())[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})});this.showTargetFilesColumnss=t.columnList}"mergeCheckedList"==i&&(t.mergeList.forEach(s=>{s.tabActiveInTargetFiles=s.showAppendName==o}),o.join().includes("-")?t.mergeList.filter(l=>l.fileName_SheetName==o)[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})}):t.mergeList.filter(l=>l.showAppendName==o)[0].tableList.forEach(l=>{l[l.sheetName].forEach(d=>{this.selectedM_A_S.push(d)})}),this.showTargetFilesColumnss=a.columnList),this.preview()}checkedInJoin(t,o,i){this.submitted=!1,this.submittedErrorMsg="",o.isSelected=t.target.checked}changeDataTypeTF(t,o,i){const a=o.fileSheet;this.sortedCheckedList.filter(c=>c.showAppendName==a||this.sortedCheckedList.filter(d=>d.showAppendName==a.join()))[0].columnList[i].dataType=t.target.value,o.dataType=t.target.value}createSecondaryDropdown(t,o){const i=o.pkFkMergeTypeList.length;if(o.pkFkMergeTypeList[i-2].foreignTableList.length<2)return;let a=i/5+1;o.templatesMergeList.push({order:a,mergeName:o.showMergeName});let c=[...o.pkFkMergeTypeList.filter(u=>u.selectedPrimaryTable).map(u=>u.selectedPrimaryTable),...o.pkFkMergeTypeList.filter(u=>u.selectedForeignTable).map(u=>u.selectedForeignTable)],d=o.pkFkMergeTypeList[0].primaryTableList;d=d.filter(u=>!c.includes(u)),[{type:null,secondaryTableList:c,selectedSecondaryTable:"",optionValue:"select Secondary Table",order:a},{type:null,secondaryKeyList:[],selectedSecondaryKey:"",optionValue:"select Secondary Key",order:a},{type:null,mergeType:"",optionValue:"select Join Type",selectedMergeType:"",order:a},{type:null,foreignTableList:d,selectedForeignTable:"",optionValue:"select Foreign Table",order:a},{type:null,foreignKeyList:[],selectedForeignKey:"",optionValue:"select Foreign Key",order:a}].forEach(u=>{o.pkFkMergeTypeList.push(u)})}saveDataSetApi(){var o,i,a,t=this;let s={};if(s.processId=this.process.processId,this.enableUploadSQLPopup){if(this.submited=!0,this.sqlScriptForm.invalid)return;s.datasetName=this.sqlScriptForm.value.datasetName,s.sqlScript=this.sqlScriptForm.value.sqlScript,this.solService.addDataset(s).subscribe(function(){var l=(0,$e.Z)(function*(c){yield t.getAllDataSetNameAPI(),t.enableUploadSQLPopup=!1,t.loader.hide()});return function(c){return l.apply(this,arguments)}}(),l=>{this.loader.hide()})}else{s.dataSetMergeListDTOs=[],this.DataSetArr().controls.forEach((m,h)=>{s.dataSetMergeListDTOs[h]={},("append"==m.value.Ptable.fileType||"join"==m.value.Ptable.fileType||"files"==m.value.Ptable.fileType||"dataset"==m.value.Ptable.fileType)&&(s.dataSetMergeListDTOs[h].primaryTemplateId=m.value.Ptable.ID),("append"==m.value.Ftable.fileType||"join"==m.value.Ftable.fileType||"files"==m.value.Ftable.fileType||"dataset"==m.value.Ftable.fileType)&&(s.dataSetMergeListDTOs[h].secondaryTemplateId=m.value.Ftable.ID),s.dataSetMergeListDTOs[h].primaryTableName=m.value.Ptable.tableNameDB,s.dataSetMergeListDTOs[h].secondaryTableName=m.value.Ftable.tableNameDB,s.dataSetMergeListDTOs[h].columnArrayList=[],this.columnArrInDS(h).controls.forEach((p,g)=>{s.dataSetMergeListDTOs[h].columnArrayList[g]={},"append"==p.value.column1.fileType?s.dataSetMergeListDTOs[h].columnArrayList[g].primaryKeyId=p.value.column1.fieldID:"join"==p.value.column1.fileType||"files"==p.value.column1.fileType?s.dataSetMergeListDTOs[h].columnArrayList[g].primaryKeyId=p.value.column1.columnId:"dataset"==p.value.column1.fileType&&(s.dataSetMergeListDTOs[h].columnArrayList[g].primaryKeyId=p.value.column1.datasetFieldId),"append"==p.value.column2.fileType?s.dataSetMergeListDTOs[h].columnArrayList[g].secondaryKeyId=p.value.column2.fieldID:"join"==p.value.column2.fileType||"files"==p.value.column2.fileType?s.dataSetMergeListDTOs[h].columnArrayList[g].secondaryKeyId=p.value.column2.columnId:"dataset"==p.value.column2.fileType&&(s.dataSetMergeListDTOs[h].columnArrayList[g].secondaryKeyId=p.value.column2.datasetFieldId),s.dataSetMergeListDTOs[h].columnArrayList[g].primaryFieldName=p.value.column1.columnName,s.dataSetMergeListDTOs[h].columnArrayList[g].secondaryFieldName=p.value.column2.columnName}),s.dataSetMergeListDTOs[h].joinType=m.value.join.slice(0,1),s.dataSetMergeListDTOs[h].order=h,console.log(m.value,m),console.log(m.controls.Ptable.value)});const l=[],c=this.datasetDetailsList.filter(m=>m.isDatasetTableExpand);c[0].datasetFieldDTOList.forEach(m=>{null!=m.expression&&(""==m.expression.trim()||0==m.expression.trim().length)&&(m.expression=null);let h=m.expression;null!=h&&this.tablecolNameList.forEach(p=>{h.includes(p.showTabColName)&&(h=JSON.parse(JSON.stringify(h.split(p.showTabColName).join(p.tableColumnName))))}),l.push({tableName:m.tableName,columnFormat:m.columnFormat,excludeInSelect:m.excludeInSelect,columnName:m.columnName,fieldName:m.fieldName,expression:h,columnType:m.columnType,where:m.where,or:m.or,groupBy:"",sourcecolumnName:m.sourcecolumnName})}),s.datasetFieldDTOList=l,s.datasetName=c[0].datasetName;let d=null===(o=this.datasetTableForm.get("groupBy"))||void 0===o?void 0:o.value,_=null===(i=this.datasetTableForm.get("having"))||void 0===i?void 0:i.value,u=null===(a=this.datasetTableForm.get("orderBy"))||void 0===a?void 0:a.value;s.groupBy=""==d?null:d.join(),s.orderBy=""==u?null:u.join(),s.having=""==_.trim()?null:_,s.calender="";let f=[];this.whereArrInDS().controls.forEach((m,h)=>{console.log(m.controls.column.value),console.log(m.controls.signOperator.value),console.log(m.controls.value.value);let p=m.controls.column.value.dbtablefieldName,g=m.controls.signOperator.value.value,v=m.controls.value.value;if(0==h)""!=v&&""!=g&&(f="IS NULL"==g||"IS NOT NULL"==g?[p+" "+g]:[p+" "+g+" "+v]);else{console.log(m.controls.operator.value);let C,x=m.controls.operator.value;""!=v&&""!=g&&(C="IS NULL"==g||"IS NOT NULL"==g?x+" "+p+" "+g:x+" "+p+" "+g+" "+v),f.push(C)}}),s.where=f.join(" "),s.calender="",this.solService.addDataset(s).subscribe(function(){var m=(0,$e.Z)(function*(h){t.allTableListInDM.forEach((p,g)=>{"dataset"==p.fileType&&t.allTableListInDM.splice(g,1)}),t.tablecolNameList.forEach((p,g)=>{"dataset"==p.fileType&&t.tablecolNameList.splice(g,1)}),yield t.getAllDataSetNameAPI(),t.unChecksAllInDM(!1),t.loader.hide(),t.saveDataSetPopup=!1,t.createExpressionList=[],t.datasetDetailsList=[]});return function(h){return m.apply(this,arguments)}}(),m=>{this.loader.hide()})}}callGetViewscript(t){this.loader.show(),this.solService.getViewScript(t.datasetId).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.sqlScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptPopup=!0,this.loader.hide()},i=>{this.loader.hide()})}updateScriptByDatasetId(t){this.loader.show();const o={datasetId:t.value.datasetId,newScript:t.value.sqlScript.trim()};this.solService.updateScriptByDatasetId(o).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.newScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptPopup=!1,this.loader.hide()},i=>{this.loader.hide()})}editDatasetFile(t){this.createExpressionList=[{excludeInSelect:!1,sourcecolumnName:"",columnId:"",expression:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],t.isDatasetTableExpand=!0,this.datasetDetailsList[0]=t}saveAppendAPI(){const t=[];this.sortedCheckedList.forEach(i=>{const a=[];i.tableList.forEach(s=>{a.push({sheetId:s.templateId})}),t.push({appendDtos:a,appendName:i.showAppendName.join()})}),this.solService.addAppendFiles({processId:this.process.processId,appendSheetList:t}).subscribe(i=>{this.appendAPIResp=i.responseData,this.sortedCheckedList.forEach(a=>{a.isPreviewEnable=!0}),this.popup.open(!0,"Saved Successfully !"),this.loader.hide()},i=>{this.loader.hide()})}applyFilter(t){this.searchfx=this.fx.filter(o=>o).map(o=>{let i=o.funcDescritptionsList.filter(a=>a.functionType.toLowerCase().includes(t.target.value.toLowerCase()));return o.functionName.toLowerCase().includes(t.target.value.toLowerCase())||i.length>0?Object.assign(Object.assign({},o),{funcDescritptionsList:i}):{}}).filter(o=>0!==Object.keys(o).length)}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}selectuser(t,o){}selectPrimaryTable(t,o,i){var a;let l=this.mergeCheckedList[i].dropDownList[o];l.columns[0].primaryKeyList=t.value.sheet,0==o&&(l.primaryTableList.forEach(c=>JSON.parse(JSON.stringify(c)).isSelected=!1),t.value.isSelected=!0,l.foreignTableList=l.primaryTableList.filter(c=>!c.isSelected)),console.log(null===(a=this.mergeCheckedList[i])||void 0===a?void 0:a.dropDownList[o])}selectForeignTable(t,o,i){let s=this.mergeCheckedList[i].dropDownList[o];this.mergeCheckedList[i].dropDownList[o].foreignTableList.forEach(d=>JSON.parse(JSON.stringify(d)).isSelected=!1),t.value.isSelected=!0,s.columns[0].foreignKeyList=t.value.sheet;let l=[],c=[];if(0==o){const d=this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>1==JSON.parse(JSON.stringify(h)).isSelected)[0];l.push(d);const _=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>1==JSON.parse(JSON.stringify(h)).isSelected)[0];l.push(_),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].primaryTableList.filter(h=>0==JSON.parse(JSON.stringify(h)).isSelected).forEach(h=>c.push(h)),this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(h=>0==JSON.parse(JSON.stringify(h)).isSelected).forEach(h=>c.push(h));let m=[];m=c.filter((h,p,g)=>g.findIndex(v=>["templateId"].every(x=>v[x]===h[x]))===p),m.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:m},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}else{this.mergeCheckedList[i].dropDownList[o].primaryTableList.forEach(f=>l.push(f));const d=this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>1==f.isSelected)[0];l.push(d),l.primaryKeyList=[],this.mergeCheckedList[i].dropDownList[o].foreignTableList.filter(f=>0==f.isSelected).forEach(f=>c.push(f));let u=c.filter((f,m,h)=>h.findIndex(p=>["templateId"].every(g=>p[g]===f[g]))===m);u.foreignKeyList=[],this.mergeCheckedList[i].dropDownList[o+1]={primaryTableList:l,foreignTableList:u},console.log(this.mergeCheckedList),0==this.mergeCheckedList[i].dropDownList[o+1].foreignTableList.length&&(this.mergeCheckedList[i].allTablesSelected=!0)}console.log(this.mergeCheckedList[i].dropDownList[o+1])}selectPrimarykey(t,o,i,a){let l=JSON.parse(JSON.stringify(this.mergeCheckedList[a].dropDownList[i].columns[o].primaryKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.mergeCheckedList[a].dropDownList[i].columns[o+1]?this.mergeCheckedList[a].dropDownList[i].columns.push({primaryKeyList:l}):this.mergeCheckedList[a].dropDownList[i].columns[o+1].primaryKeyList=l}selectForeignKey(t,o,i,a){let l=JSON.parse(JSON.stringify(this.mergeCheckedList[a].dropDownList[i].columns[o].foreignKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.mergeCheckedList[a].dropDownList[i].columns[o+1]?this.mergeCheckedList[a].dropDownList[i].columns.push({foreignKeyList:l}):this.mergeCheckedList[a].dropDownList[i].columns[o+1].foreignKeyList=l}selectJoin(t,o,i){this.mergeCheckedList[i].dropDownList[o].joinType=t.value}previewPopup(t,o,i,a,s){this.rowCount="",""!=s||0!=(null==s?void 0:s.length)?(this.loader.show(),this.solService.viewTableDetails(s).subscribe(l=>{null!=l.responseData?(this.selectedM_A_S=l.responseData.tableDetails,this.rowCount=l.responseData.count,this.preview(),this.showTargetFilePopup=!0):this.popup.open(!1,l.statusMessage),this.loader.hide()},l=>{this.loader.hide()})):(this.showTargetFilePopup=!0,this.selectedM_A_S=o.sheetData,this.showTargetFilePopup=!0,this.preview())}preview(){for(var t in this.columnsArr=[],this.selectedM_A_S[0])this.selectedM_A_S[0].hasOwnProperty(t)&&this.columnsArr.push(t)}selectgroupByOrderByInDM(t,o,i,a){let l=t.value.map(c=>c.dbtablefieldName).join();"groupby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].groupBy=l),"orderby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].orderBy=l)}executeProject(){this.loader.show(),this.solService.executeProject(this.process.processId).subscribe(t=>{this.loader.hide()},t=>{this.loader.hide()})}fileClickedinTF(t,o,i,a){this.targetFiles.forEach(s=>{s.sheetList.forEach(l=>{l.isRowTabAvtive=!1})}),i.isRowTabAvtive=!0,this.fileTypeInTF=a,0==o?this.clickedRowDataInTF=i.tableAppendFieldsDto:1==o?this.clickedRowDataInTF=i.mergeFieldListDTO:2==o&&(this.clickedRowDataInTF=i.sheet)}getTargetFileList(){this.loader.show(),this.solService.getTargetFileList(this.process.processId).subscribe(t=>{var o,i;t.responseData.appendSheetListDto.appendSheetList.forEach(l=>{l.tableAppendFieldsDto.forEach(c=>{c.showTabColName=l.appendName+"["+c.fieldName+"]"})}),t.responseData.templateMergeListDTO.templatesMergeDetailsList.forEach(l=>{l.mergeFieldListDTO.forEach(c=>{c.showTabColName=l.mergeName+"["+c.fieldName+"]"})}),this.targetFiles=[{fileType:"append",sheetList:t.responseData.appendSheetListDto.appendSheetList},{fileType:"join",sheetList:t.responseData.templateMergeListDTO.templatesMergeDetailsList},{fileType:"files",sheetList:this.fileSheetList}],0==(null===(o=this.targetFiles.filter(l=>"join"==l.fileType)[0])||void 0===o?void 0:o.sheetList.length)&&(this.skipJoin=!0),0==(null===(i=this.targetFiles.filter(l=>"append"==l.fileType)[0])||void 0===i?void 0:i.sheetList.length)&&(this.skipAppend=!0),this.loader.hide()},t=>{this.targetFiles=[{fileType:"files",sheetList:this.fileSheetList}],this.loader.hide()})}allList(){this.allTableListInDM=[],this.targetFiles.forEach((t,o)=>{"append"==t.fileType?t.sheetList.forEach(i=>{i.tableAppendFieldsDto.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.fieldID}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.appendName,tableNameDB:i.tableName,idName:"appendID",ID:i.appendID,appendID:i.appendID,columnList:i.tableAppendFieldsDto,isSelecteddl:!1})}):"join"==t.fileType?t.sheetList.forEach(i=>{i.mergeFieldListDTO.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.mergeName,tableNameDB:i.tableName,idName:"mergeId",ID:i.mergeId,mergeId:i.mergeId,columnList:i.mergeFieldListDTO,isSelecteddl:!1})}):"files"==t.fileType&&t.sheetList.forEach(i=>{null!=i.sheet&&i.sheet.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.fileName,tableNameDB:i.tableName,idName:"templateId",ID:i.templateId,templateId:i.templateId,columnList:i.sheet,isSelecteddl:!1})})}),this.allTableListWithoutDSInDM=[],this.allTableListWithoutDSInDM=JSON.parse(JSON.stringify(this.allTableListInDM))}closeDatasetPopup(){this.dataSetForm.controls.DSetRows=this.fb.array([]),this.saveDataSetPopup=!1}saveDataSet(t,o){var a,s,l,i=this;if(this.selectedColumnsOfDS=[],null==t||t.datasetFieldDTOList.forEach(c=>{let d;d=c.sourcecolumnName.includes("[")?c.sourcecolumnName.split("[")[0]:c.tableName,this.allTableListInDM.forEach(u=>{u.tableNameUI==d&&0==this.selectedColumnsOfDS.filter(m=>m.tableNameUI==u.tableNameUI).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},u),{isSelecteddl:!1}))})}),this.selectedColumnsOfDS.length<2){let c={};c.processId=this.process.processId,1==this.selectedColumnsOfDS.length?("append"==this.selectedColumnsOfDS[0].fileType||"join"==this.selectedColumnsOfDS[0].fileType||"files"==this.selectedColumnsOfDS[0].fileType||"dataset"==this.selectedColumnsOfDS[0].fileType)&&(c.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableNameDB}]):0==this.selectedColumnsOfDS.length&&(c.dataSetMergeListDTOs=[]);const d=[],_=this.datasetDetailsList.filter(p=>p.isDatasetTableExpand);_[0].datasetFieldDTOList.forEach(p=>{null!=p.expression&&(""==p.expression.trim()||0==p.expression.trim().length)&&(p.expression=null);let g=p.expression;null!=g&&this.tablecolNameList.forEach(v=>{g.includes(v.showTabColName)&&(g=JSON.parse(JSON.stringify(g.split(v.showTabColName).join(v.tableColumnName))))}),d.push({tableName:p.tableName,excludeInSelect:p.excludeInSelect,columnFormat:p.columnFormat,columnName:p.columnName,fieldName:p.fieldName,expression:g,columnType:p.columnType,where:p.where,or:p.or,groupBy:"",sourcecolumnName:p.sourcecolumnName})}),c.datasetFieldDTOList=d,c.datasetName=_[0].datasetName;let u=null===(a=this.datasetTableForm.get("groupBy"))||void 0===a?void 0:a.value,f=null===(s=this.datasetTableForm.get("having"))||void 0===s?void 0:s.value,m=null===(l=this.datasetTableForm.get("orderBy"))||void 0===l?void 0:l.value;c.groupBy=""==u?null:u.join(),c.orderBy=""==m?null:m.join(),c.having=""==f.trim()?null:f,c.calender="";let h=[];this.whereArrInDS().controls.forEach((p,g)=>{console.log(p.controls.column.value),console.log(p.controls.signOperator.value),console.log(p.controls.value.value);let v=p.controls.column.value.dbtablefieldName,x=p.controls.signOperator.value.value,C=p.controls.value.value;if(0==g)""!=C&&""!=x&&(h="IS NULL"==x||"IS NOT NULL"==x?[v+" "+x]:[v+" "+x+" "+C]);else{console.log(p.controls.operator.value);let y,b=p.controls.operator.value;""!=C&&""!=x&&(y="IS NULL"==x||"IS NOT NULL"==x?b+" "+v+" "+x:b+" "+v+" "+x+" "+C),h.push(y)}}),c.where=h.join(" "),c.calender="",this.solService.addDataset(c).subscribe(function(){var p=(0,$e.Z)(function*(g){console.log("call addDS"),yield i.getAllDataSetNameAPI(),i.loader.hide(),i.createExpressionList=[],i.datasetDetailsList=[]});return function(g){return p.apply(this,arguments)}}(),p=>{this.loader.hide()})}else{this.dataSetForm.controls.DSetRows=this.fb.array([]),this.dataSetData=[];let c=[];c.primaryKeyList=[];let d=[];d.foreignKeyList=[],this.selectedColumnsOfDS.forEach(u=>{c.push(u)});let _={primaryTableList:c,foreignTableList:d,order:1,columns:[{primaryKeyList:[],foreignKeyList:[]}]};for(let u=0;u<this.selectedColumnsOfDS.length-1;u++)0==u?this.dataSetData.push(_):(c=[],c.primaryKeyList=[],this.dataSetData.push({primaryTableList:c,foreignTableList:d,columns:[{primaryKeyList:[],foreignKeyList:[]}],order:u+2})),this.DataSetArr().controls.push(this.DataSetRow());this.saveDataSetPopup=!0}this.DataSetArr().controls.forEach(c=>{console.log(c.value,c),console.log(c.controls.Ptable.value)})}selectPrimaryTableInDS(t,o){if(this.dataSetData[o].primaryTableList.forEach(i=>{JSON.parse(JSON.stringify(i)).isSelecteddl=!1}),t.value.isSelecteddl=!0,this.dataSetData[o].columns[0].primaryKeyList=t.value.columnList,0==o){let i=JSON.parse(JSON.stringify(this.dataSetData[o].primaryTableList.filter(a=>!a.isSelecteddl)));this.dataSetData[o].foreignTableList=i}else{let i=this.dataSetData[o-1].foreignTableList.filter(a=>!a.isSelecteddl);this.dataSetData[o].foreignTableList=i}}selectJoinTypeInDS(t,o){this.dataSetData[o].Join=t.value}selectForeignTableInDS(t,o){if(this.dataSetData[o].foreignTableList.forEach(i=>JSON.parse(JSON.stringify(i)).isSelecteddl=!1),t.value.isSelecteddl=!0,this.dataSetData[o].columns[0].foreignKeyList=t.value.columnList,0==o){let i=this.dataSetData[o].primaryTableList.filter(l=>l.isSelecteddl),a=this.dataSetData[o].foreignTableList.filter(l=>l.isSelecteddl),s=[];i.forEach(l=>s.push(l)),a.forEach(l=>s.push(l)),s.forEach(l=>JSON.parse(JSON.stringify(l)).isSelecteddl=!1),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=s)}else{let i=this.dataSetData[o].primaryTableList,a=this.dataSetData[o].foreignTableList.filter(l=>l.isSelecteddl),s=[];i.forEach(l=>s.push(l)),a.forEach(l=>s.push(l)),s.forEach(l=>JSON.parse(JSON.stringify(l)).isSelecteddl=!1),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=s)}}selectPrimaryKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].primaryKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({primaryKeyList:a}):this.dataSetData[i].columns[o+1].primaryKeyList=a}selectForeignKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].foreignKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({foreignKeyList:a}):this.dataSetData[i].columns[o+1].foreignKeyList=a}addcolumnRowInDS(t,o){this.columnArrInDS(o).push(this.addColumnInDS())}deletecolumnRowInDS(t,o){this.columnArrInDS(o).removeAt(t)}add_SaveCreateExpression(t){var o;if(""==t.sourcecolumnName.trim())return;const i=this.datasetDetailsList.filter(h=>1==h.isDatasetTableExpand),a=null===(o=i[0])||void 0===o?void 0:o.datasetFieldDTOList;let l,c,d,_,s=0;if(0!=a.length&&a.forEach(h=>{t.isEdit&&h.isEdit||h.sourcecolumnName==t.sourcecolumnName.trim()&&(s=1)}),1==s)return;l=this.allTableListInDM.filter(h=>h.columnList.some(p=>p.showTabColName==t.sourcecolumnName)).map(h=>Object.assign({},h,{columnList:h.columnList.filter(p=>p.showTabColName==t.sourcecolumnName)})),0!=l.length&&(t.tableName=l[0].tableNameDB),0!=l.length&&(c=l[0].columnList[0].columnName,_=l[0].columnList[0].fieldName,d=l[0].tableNameDB);let u=d+"."+c,f={},m={};if(0==l.length?(f={filefieldName:t.sourcecolumnName,dbtablefieldName:t.sourcecolumnName},m={filefieldName:t.sourcecolumnName,dbtablefieldName:t.sourcecolumnName,dataType:t.columnType},t.columnName=t.sourcecolumnName,t.fieldName=t.sourcecolumnName):(f={filefieldName:t.sourcecolumnName,dbtablefieldName:u},m={filefieldName:t.sourcecolumnName,dbtablefieldName:u,dataType:l[0].columnList[0].columnType},t.columnName=c,t.fieldName=_),t.isEdit||(i[0].orderBytoDB.push(f),i[0].groupBytoDB.push(f),this.columnsForWhereInDS.push(m)),""!=t.signOperator||0!=t.signOperator.length){let h=[];""!=t.value&&""!=t.signOperator?(h=[d+"."+c+" "+t.signOperator+" "+t.value],t.whereList.forEach(p=>{let g;g="IS NULL"==p.signOperator||"IS NOT NULL"==p.signOperator?p.operator+" "+d+"."+c+" "+p.signOperator:p.operator+" "+d+"."+c+" "+p.signOperator+" "+p.value,h.push(g)})):("IS NULL"==t.signOperator||"IS NOT NULL"==t.signOperator)&&(h=[d+"."+c+" "+t.signOperator],t.whereList.forEach(p=>{let g;g="IS NULL"==p.signOperator||"IS NOT NULL"==p.signOperator?p.operator+" "+d+"."+c+" "+p.signOperator:p.operator+" "+d+"."+c+" "+p.signOperator+" "+p.value,h.push(g)})),t.where=h.join(" ")}0==(null==a?void 0:a.length)?a.push(t):t.isEdit?a.forEach((h,p)=>{h.isEdit&&(t.isEdit=!1,a.splice(p,1,t))}):a.push(t),this.createExpressionList=[{excludeInSelect:!1,sourcecolumnName:"",expression:"",columnId:"",columnFormat:"",signOperatorList:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",value:"",signOperator:"",whereList:[]}],this.UpdatechecksInDM(t,!0)}deleteTables(t,o,i,a){console.log("e: ",t),console.log("item: ",o),this.deleteTableDetails={item:o,type:a},this.solService.deleteTables({id:o.datasetId,type:a,operation:"delete"}).subscribe(s=>{console.log(s),this.allDatasetDetailsList.splice(this.allDatasetDetailsList.findIndex(l=>l.datasetId===o.datasetId),1)})}onCheck(t){console.log(t),this.allDatasetDetailsList.forEach(o=>{t.datasetId==o.datasetId&&(o.selected=!o.selected)}),console.log(this.allDatasetDetailsList)}SaveContinue(){let t=[];this.allDatasetDetailsList.forEach(i=>{i.selected&&t.push(i.tableName)});let o={tables:t,processId:this.process.processId};console.log(o),this.solService.postPushDataSets(o).subscribe(i=>{console.log(i.responseData),this.router.navigate(["/user/admin1/powerbi-interface",{dataset:JSON.stringify(i.responseData)}])})}existDataset(){console.log(this.sqlScriptForm.value.datasetName),this.solService.getExistDataset(this.appendNameControl.value,"").subscribe(t=>{console.log(t)},t=>{this.popup.open(!1,"Dataset Name Already Exists")})}applyFilterForDMTables(t,o,i,a){console.log("e",t),console.log(a),"append"==a?(this.selectedIndexFilterAppend=""!=t.target.value?i:-1,this.filteredDataAppend=o.tableAppendFieldsDto.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"join"==a?(this.selectedIndexFilterJoin=""!=t.target.value?i:-1,this.filteredDataJoin=o.mergeFieldListDTO.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"files"==a?(this.selectedIndexFilterFiles=""!=t.target.value?i:-1,this.filteredDataFiles=o.sheet.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"dataset"==a&&(this.selectedIndexFilterDataset=""!=t.target.value?i:-1,this.filteredDataDataset=o.datasetFieldDTOList.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase())))}selectAllInDM(t,o){console.log(t,o);let i=[];0!=this.datasetDetailsList.length&&(i=this.datasetDetailsList[0].datasetFieldDTOList.map(s=>s.sourcecolumnName));let a=[];"append"==t?a=o.tableAppendFieldsDto:"join"==t?a=o.mergeFieldListDTO:"files"==t?a=o.sheet:"dataset"==t&&(a=o.datasetFieldDTOList),a.forEach(s=>{i.includes(s.showTabColName)||this.add_SaveCreateExpression({excludeInSelect:!1,sourcecolumnName:s.showTabColName,columnId:"",columnFormat:"",signOperatorList:"",expression:"",isEdit:!1,columnType:s.columnType,where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]})})}onSortClick(t,o){this.sortColumn==o?"asc"==this.sortOrder?(this.sortOrder="desc",this.sortDir=-1):(this.sortOrder="asc",this.sortDir=1):(this.sortColumn=o,this.sortOrder="asc"),this.selectedM_A_S.sort((i,a)=>(i=i[t].toLowerCase(),a=a[t].toLowerCase(),i.localeCompare(a)*this.sortDir))}UpdatechecksInDM(t,o){let i=[];this.targetFiles.forEach(a=>{a.sheetList.forEach(s=>{"Append"==s.type?s.tableAppendFieldsDto.forEach(l=>{l.showTabColName==t.sourcecolumnName&&(i=s.tableAppendFieldsDto,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):"Merge"==s.type?s.mergeFieldListDTO.forEach(l=>{l.showTabColName==t.sourcecolumnName&&(i=s.mergeFieldListDTO,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):s.sheet.forEach(l=>{l.showTabColName==t.sourcecolumnName&&(i=s.sheet,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}),0==i.length&&this.allDatasetDetailsList.forEach(a=>{a.datasetFieldDTOList.forEach(s=>{s.showTabColName==t.sourcecolumnName&&(i=a.datasetFieldDTOList,s.isSelectAllChildInDM=o,i.map(c=>c.isSelectAllChildInDM).includes(!1)?a.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}selectAllParentInDM(t,o,i){console.log(t,o,i);let a=t.target.checked,s=[];0!=this.datasetDetailsList.length&&(s=this.datasetDetailsList[0].datasetFieldDTOList.map(d=>d.sourcecolumnName));let l=[];"append"==o&&a?(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!0),l=i.tableAppendFieldsDto):"join"==o&&a?(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!0),l=i.mergeFieldListDTO):"files"==o&&a?(i.sheet.forEach(d=>d.isSelectAllChildInDM=!0),l=i.sheet):"dataset"==o&&a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!0),l=i.datasetFieldDTOList);let c=[];"append"!=o||a?"join"!=o||a?"files"!=o||a?"dataset"==o&&!a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!1),l=i.datasetFieldDTOList,c=i.datasetFieldDTOList.map(d=>d.showTabColName)):(i.sheet.forEach(d=>d.isSelectAllChildInDM=!1),l=i.sheet,c=i.sheet.map(d=>d.showTabColName)):(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!1),l=i.mergeFieldListDTO,c=i.mergeFieldListDTO.map(d=>d.showTabColName)):(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!1),l=i.tableAppendFieldsDto,c=i.tableAppendFieldsDto.map(d=>d.showTabColName)),a?l.forEach(d=>{s.includes(d.showTabColName)||this.add_SaveCreateExpression({excludeInSelect:!1,sourcecolumnName:d.showTabColName,columnId:"",columnFormat:"",signOperatorList:"",expression:"",isEdit:!1,columnType:d.columnType,where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]})}):a||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(d=>-1==c.indexOf(d.sourcecolumnName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList),console.log("this.datasetDetailsList[0].groupBytoDB",this.datasetDetailsList[0].groupBytoDB),console.log("this.datasetDetailsList[0].orderBytoDB",this.datasetDetailsList[0].orderBytoDB),this.UpdatechecksInDM(i,!1))}selectAllChildInDM(t,o,i,a){let s=t.target.checked,l=[];0!=this.datasetDetailsList.length&&(l=this.datasetDetailsList[0].datasetFieldDTOList.map(_=>_.sourcecolumnName)),s?l.includes(a.showTabColName)||this.add_SaveCreateExpression({excludeInSelect:!1,sourcecolumnName:a.showTabColName,columnId:"",columnFormat:"",signOperatorList:"",expression:"",isEdit:!1,columnType:a.columnType,where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}):s||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(_=>-1==a.showTabColName.indexOf(_.sourcecolumnName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)));let c=[];"append"==o?c=i.tableAppendFieldsDto:"join"==o?c=i.mergeFieldListDTO:"files"==o?c=i.sheet:"dataset"==o&&(c=i.datasetFieldDTOList),i.isSelectAllParentInDM=!c.map(_=>_.isSelectAllChildInDM).includes(!1),console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList),console.log(i,a)}unChecksAllInDM(t){this.targetFiles.forEach(o=>{o.sheetList.forEach(i=>{i.isSelectAllParentInDM=!1,"Append"==i.type?i.tableAppendFieldsDto.forEach(a=>{a.isSelectAllChildInDM=t}):"Merge"==i.type?i.mergeFieldListDTO.forEach(a=>{a.isSelectAllChildInDM=t}):i.sheet.forEach(a=>{a.isSelectAllChildInDM=t})})}),this.allDatasetDetailsList.forEach(o=>{o.isSelectAllParentInDM=!1,o.datasetFieldDTOList.forEach(i=>{i.isSelectAllChildInDM=t})})}whereFirstRow(){return this.formBuilder.group({column:["",w.kI.required],signOperator:["",w.kI.required],value:["",w.kI.required]})}whereRemainingRows(){return this.formBuilder.group({operator:["",w.kI.required],column:["",w.kI.required],signOperator:["",w.kI.required],value:["",w.kI.required]})}addOpearatorValueFieldsInDS(t,o){this.whereArrInDS().push(this.whereRemainingRows()),console.log(t,o)}delOpearatorValueFieldsInDS(t,o){this.whereArrInDS().removeAt(t),this.signOperatorWhereInDS.splice(t,1),console.log(t,o)}changeColumnInDSForWhere(t,o,i,a){let s=this.whereArrInDS().controls[o].get("column");console.log(o,i,a,s.value);let l=s.value.dataType,c=[];"date"==l||"datetime2"==l||"dateTime"==l?c=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]:"char"==l||"varchar"==l||"text"==l||"nvarchar"==l?c=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]:("int"==l||"float"==l||"money"==l||"decimal"==l||"bigint"==l)&&(c=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]),this.signOperatorWhereInDS[o]=c}whereArrInDS(){return this.datasetTableForm.get("where")}appendDataset(){let t=this.allDatasetDetailsList.filter(a=>a.selected),o=0,i=[];t.forEach(a=>{if(0==i.length)i=a.datasetFieldDTOList.map(s=>s.fieldName);else{let s=[];s=a.datasetFieldDTOList.map(l=>l.fieldName),i.forEach(l=>{s.includes(l)||(o=1)})}}),1!=o&&(this.enableDatasetAppendPopup=!0)}appendDatasetApi(){var t;this.enableDatasetAppendPopup=!1;let o=null===(t=this.datasetAppendForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim(),i=[],a={processId:this.process.processId,dataSetAppendDetailsDto:{appendName:o,datasetTableAppendDtos:i}};this.allDatasetDetailsList.forEach(s=>{s.selected&&i.push({datasetId:s.datasetId,datasetName:s.datasetName})}),this.solService.addDatasetAppend(a).subscribe(s=>{this.getAllDataSetNameAPI()},s=>{this.loader.hide()})}uploadSQLScriptBtn(){this.enableUploadSQL_PythonPopup=!0,this.isBtnClickedSQL_Python="S"}uploadPythonScriptBtn(){this.enableUploadSQL_PythonPopup=!0,this.isBtnClickedSQL_Python="P"}uploadPythonScript(){}uploadSQLScript(t,o){const i=t.target.files[0];let a=new FileReader;a.onload=s=>{this.uploadSQLBtn=!1,this.sqlScriptForm.patchValue({sqlScript:a.result})},a.readAsText(i)}saveUploadScript(t){var o;let i={processId:this.process.processId,script:null===(o=this.sqlScriptForm.get("sqlScript"))||void 0===o?void 0:o.value,type:t};this.solService.uploadScriptToProcess(i).subscribe(a=>{this.enableUploadSQL_PythonPopup=!1,this.popup.open(!0,"Saved Successfully !")})}getViewScript(){this.enableViewscriptPopup=!0,this.solService.getSolutionScript(this.process.processId).subscribe(t=>{var o,i;t&&this.getViewScriptForm.patchValue({script:null===(o=t.responseData)||void 0===o?void 0:o.script,solutionScriptId:null===(i=t.responseData)||void 0===i?void 0:i.solutionScriptId})},t=>{this.popup.open(!1,"No data"),this.loader.hide()})}updateViewScript(){var t,o;this.enableViewscriptPopup=!1;let i={solutionScriptId:null===(t=this.getViewScriptForm.get("solutionScriptId"))||void 0===t?void 0:t.value,script:null===(o=this.getViewScriptForm.get("script"))||void 0===o?void 0:o.value};this.solService.uploadScriptToProcess(i).subscribe(a=>{this.popup.open(!0,"Updated Successfully !")})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(fe.F0),e.Y36(w.qu),e.Y36(ti.q),e.Y36(Nn.D),e.Y36(w.qu),e.Y36(e.Qsj),e.Y36(Jt.e),e.Y36(co.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-solution-board-data-modelling"]],decls:28,vars:17,consts:[[1,"heading"],[2,"margin","0 0 5px"],[2,"color","#0076A8"],[1,"consen"],[2,"padding","10px"],[1,"bttn",2,"display","flex"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","combination",4,"ngIf"],["mat-button",""],["class","dds-icon dds-icon_chevron_right__l__stroke next",4,"ngIf"],[1,"dds-icon","dds-icon_chevron_right__l__stroke","next"],[1,"row"],["style","float:left ; width:100%",4,"ngIf"],["class","createNewSoltionsTable",4,"ngFor","ngForOf"],[2,"text-align","right","margin","20px 0 0 0"],["mat-button","","class","btnn","style","border:1px solid #0076A8; background: #fff; color: #0076A8;",3,"click",4,"ngIf"],["mat-button","","class","btnn",3,"disabled","click",4,"ngIf"],[2,"float","left","width","100%"],[1,"but"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],[1,"note","required-field"],[1,"header"],[1,"selectCheck"],["type","checkbox","name","list_name","value","m1",3,"ngModel","ngModelChange","change"],[1,"createNewSoltionsTable"],[1,"dds-icon","dds-icon_file_xls__l__filled"],[1,"dds-icon","dds-icon_file_txt__l__filled"],[1,"dds-icon","dds-icon_file_csv__l__filled"],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","ngModelChange","change"],["src","../../../../assets/images/xls_sheet.png","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["src","../../assets/images/loading.gif","alt","","width","20px","height","20px",2,"margin-top","-4px","margin-left","100px"],["mat-button","",1,"btnn",2,"border","1px solid #0076A8","background","#fff","color","#0076A8",3,"click"],["mat-button","",1,"btnn",3,"disabled","click"],[2,"padding-bottom","70px"],[1,"sheet"],[2,"float","right"],[2,"float","right","margin-top","20px"],["mat-button","","class","btnn",3,"click",4,"ngIf"],[1,"dds-icon","dds-icon_eyeopen",2,"float","right",3,"click"],[2,"padding-left","50px"],["mat-button","",1,"btnn",3,"click"],[1,"combination"],["mat-button","","class","btnn","style","margin: 30px;",3,"click",4,"ngIf"],["class","createNewSoltionsTable appendTable",4,"ngIf"],["mat-button","","class","btnn","style","margin: 25px;",3,"click",4,"ngIf"],[1,"createNewSoltionsTable","appendTable"],[2,"background-color","#0076A8"],[2,"padding-left","78px !important","background-color","#0076A8"],[2,"padding-left","53px !important","background-color","#0076A8"],["class","trrr",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["mat-button","",1,"btnn",2,"margin","30px",3,"disabled","click"],[1,"trrr"],["type","checkbox",3,"ngModel","ngModelChange","change"],[2,"width","50%"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"color","#26890d"],[1,"dds-icon","dds-icon_file_txt__l__filled",2,"color","#26890d"],[1,"dds-icon","dds-icon_file_csv__l__filled",2,"color","#26890d"],[1,"error"],["mat-button","",1,"btnn",2,"margin","30px",3,"click"],["colspan","3",2,"text-align","left","background-color","#0076A8"],[1,"append"],[2,"padding-left","60px","height","auto","padding","10px 60px","border-bottom","0px none"],["colspan","3",2,"width","50px","vertical-align","baseline","font-weight","bold"],[2,"border-bottom","1px solid"],["style","margin:0 0 5px 0",4,"ngFor","ngForOf"],[2,"width","110px","text-align","center"],[1,"dds-icon","dds-icon_eyeopen"],[2,"margin","0 0 5px 0"],["mat-button","",1,"btnn",2,"margin","25px",3,"click"],[2,"float","right","margin-right","28px"],["class","table table-striped createNewSoltionsTable",4,"ngIf"],["mat-button","","class","btnn","style","float: left;",3,"click",4,"ngIf"],[1,"table","table-striped","createNewSoltionsTable"],["class","",4,"ngFor","ngForOf"],[1,""],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","change"],[1,"rightIcons"],[2,"border","1px #000 solid",3,"formGroup"],[1,"row",2,"background-color","#0076A8","color","#fff","width","100%","margin","auto"],[1,"col-md-2",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-3",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-1",2,"font-weight","600","background-color","#0076A8","color","#fff"],["formArrayName","Merg"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"",2,"padding","7px"],["formArrayName","tableControl"],["class","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"",3,"formGroupName"],[1,"col-md-2"],[1,"col-md-3"],["appearance","fill"],["formControlName","table1",1,"form-control",3,"placeholder","selectionChange"],["placeholder","Select Join","formControlName","join",1,"form-control",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Foreign Table","formControlName","table2",1,"form-control",3,"selectionChange"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style"," line-height:14px;color: #fff;font-size: 14px;","title","Table",3,"disabled","click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["formArrayName","column"],[3,"value"],["mat-button","","title","Table",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"disabled","click"],["mat-button","",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"selectionChange"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"selectionChange"],[1,"col-md-2",2,"border-bottom","1px solid"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;","title","Column",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","","title","Column",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],["mat-button","",1,"btnn",2,"float","left",3,"click"],[1,"row","targetFileRow"],[1,"note","required-field",2,"margin","10px 0 0 0","width","calc(100% - 120px)"],[1,"col-md-6"],[1,"col-md-6","scroll",2,"margin-top","10px","padding","0"],["class","table table-striped",4,"ngIf"],[2,"margin-left","83%","width","auto"],[1,"col-md-12","combination","scroll",2,"padding","0px"],[1,"table","table-striped"],[2,"width","1%","border","0","cursor","pointer",3,"click"],[2,"background-color","#0076A8","z-index","1"],["scope","col",2,"margin","auto","color","#fff","width","10%"],["scope","col",2,"margin","auto","color","#fff","width","25%"],["scope","col",2,"margin","auto","color","#fff","width","20%"],["scope","row",2,"width","10%"],["type","checkbox",3,"ngModel","ngModelChange"],[2,"width","25%"],[2,"width","20%"],["placeholder","Select DataType",1,"form-control",3,"ngModel","ngModelChange"],["mat-raised-button","","matTooltipPosition","above","matTooltipClass","allow-cr","aria-label","Button that displays a tooltip in various positions",3,"matTooltip"],["mat-button","",1,"btnn",2,"margin-left","0px !important",3,"click"],["mat-button","",1,"btnn",2,"width","135px","float","right",3,"click"],[1,"dataModeling"],[1,"col-md-5","combination"],[1,"scroll"],[1,"header",2,"position","sticky","top","0","z-index","1"],["class","mat-table","style","text-align: center; font-size:13px",4,"ngIf"],["multi","","class","mat-table","is-open","true",4,"ngIf"],["class","col-md-7 combination expTable",4,"ngIf"],[2,"text-align","right","float","right"],["mat-button","",1,"btnn",2,"width","140px",3,"click"],[1,"scroll",2,"margin-bottom","10px"],["multi","","is-open","true",1,"mat-table"],[3,"expanded","opened","closed",4,"ngFor","ngForOf"],[3,"expanded","opened","closed"],[1,"mat-row"],[1,"dataP"],[1,"rightIcons1"],[1,"dds-icon","dds-icon_eyeopen",3,"click"],[1,"search1","col-md-6"],["id","form1","value","","placeholder","Search",1,"form-control",3,"keyup"],[2,"border-bottom","2px solid #cccccc","margin-bottom","10px"],["type","checkbox","title","Select All",1,"form-check-input",2,"margin-top","10px","margin-bottom","10px","height","18px","width","18px",3,"ngModel","ngModelChange","change"],[2,"margin-top","6px"],["style","cursor: pointer;",4,"ngFor","ngForOf"],[2,"cursor","pointer"],[3,"click"],["class","scroll","style","cursor: pointer;",4,"ngFor","ngForOf"],[1,"scroll",2,"cursor","pointer"],[1,"mat-table",2,"text-align","center","font-size","13px"],[1,"mat-row",2,"margin-top","30px"],["type","checkbox",1,"form-check-input",3,"click"],[1,"rightIcons",2,"width","25%"],["title","View Dataset",1,"dds-icon","dds-icon_eyeopen",3,"click"],["title","Edit Dataset",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],["title","View Script",1,"dds-icon","dds-icon_file",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[1,"col-md-7","combination","expTable"],["class","table table-striped","style","margin-bottom:60px ;",4,"ngFor","ngForOf"],[1,"table","table-striped",2,"margin-bottom","60px"],[2,"width","100%","text-align","left"],["placeholder","Column Name",1,"form-control",2,"width","50%",3,"value","select","click","keyup"],[2,"float","right","display","inline-flex","width","157px","margin-top","-2em"],["type","checkbox","name","where",2,"width","30px",3,"ngModel","ngModelChange"],[1,"row",2,"margin-top","10px"],["appearance","fill",1,"col-md-6",2,"padding-left","1px"],["placeholder","Select DataType",1,"form-control",3,"value","selectionChange"],[1,"dropdown","col-md-1"],["src","../../assets/images/fx.png","alt","","id","menu",2,"vertical-align","middle","margin","auto","width","28px","height","26px",3,"click"],[1,"dropdown-content","scroll"],[1,"search"],["id","form1","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],[1,"col-md-11"],["cols","20","rows","10","placeholder","Expression","name","Expression","id","",1,"form-control",2,"width","100%",3,"value","select","click","keyup"],["mat-button","","class","btnn","style","float:right ;",3,"click",4,"ngIf"],["appearance","fill",1,"col-md-6",2,"padding-right","1px"],["placeholder","Select DateFormat",1,"form-control",3,"selectionChange"],["style","border-bottom: 1px solid #000; border-radius: 0;padding: 0;",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #000","border-radius","0","padding","0"],[1,"addRow"],["placeholder","Select AND/OR",1,"form-control",3,"value","selectionChange"],["placeholder","Select Operator",1,"form-control",3,"value","selectionChange"],["placeholder","Value",1,"form-control",3,"ngModel","ngModelChange"],[1,"dds-icon","border","dds-icon_delete__l__stroke",3,"click"],["mat-button","",1,"btnn",2,"float","right",3,"click"],[2,"margin","auto"],["colspan","1"],[1,"col-md-3",2,"text-align","right",3,"click"],[1,"dds-icon","dds-icon_close__l__stroke",2,"color","#fff"],[2,"text-align","right"],[3,"formGroup"],[2,"margin","10px"],["formArrayName","where"],["style","margin-bottom: 10px;",3,"formGroupName",4,"ngFor","ngForOf"],[2,"display","flex","margin","20px 0"],[2,"margin-left","38px"],["appearance","fill",2,"margin-left","21px","width","706px"],["multiple","","placeholder","Select groupBy","formControlName","groupBy",1,"form-control",3,"selectionChange"],[2,"display","flex","margin","10px 0"],["matInput","","formControlName","having","placeholder","Having",1,"form-control",2,"margin-left","38px"],[2,"margin-left","35px"],["appearance","fill",2,"margin-left","26px","width","706px"],["multiple","","placeholder","Select orderBy","formControlName","orderBy",1,"form-control",3,"selectionChange"],[2,"width","1%","border","0"],[2,"text-align","right","width","1%","border","0"],[1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[2,"margin-bottom","10px",3,"formGroupName"],[1,"addRow","row"],["appearance","fill",1,"col-md-3"],["placeholder","Select Column","formControlName","column",1,"form-control",3,"selectionChange"],["placeholder","Select Operator","formControlName","signOperator",1,"form-control"],[1,"col-md-3",2,"display","flex"],["placeholder","Value","formControlName","value",1,"form-control",2,"width","210px"],["placeholder","Select AND/OR","formControlName","operator",1,"form-control"],[1,"dds-icon","border","dds-icon_plus__l__stroke",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[1,"row","popup"],[1,"field"],["type","text","formControlName","appendNameControl",3,"ngClass"],[1,"col-sm-12",2,"float","right","text-align","right"],["mat-button","","type","submit",3,"click"],["mat-button","",2,"color","#0076A8","background","#fff",3,"click"],["mat-button","",3,"click"],[1,"taxt-audit-popup","preview",2,"width","1000px"],["style","float:left;margin: 22px;",4,"ngIf"],[1,"col-sm-3",2,"float","right","text-align","right"],["mat-button","",2,"border","1px solid #0076A8","background","none","color","#0076A8",3,"click"],[1,"dds-icon",2,"color","#fff",3,"ngClass"],[1,"dds-icon","dds-icon_arrow_down__l__stroke"],[1,"dds-icon","dds-icon_arrow_up__l__stroke"],["style","width:120px; word-break: break-all;",4,"ngFor","ngForOf"],[2,"width","120px","word-break","break-all"],[2,"float","left","margin","22px"],["type","text","formControlName","appendNameControl",3,"change"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],[1,"taxt-audit-popup",2,"width","1200px"],[2,"background-color","#0076A8","color","white","float","right",3,"click"],["aria-hidden","true"],["formArrayName","DSetRows",1,"row","popup",2,"margin-top","10px"],["appearance","fill",1,"col-md-4"],["formControlName","Ptable",1,"form-control",3,"placeholder","selectionChange"],["placeholder","Join Type","formControlName","join",1,"form-control",3,"selectionChange"],["placeholder","Foreign Table","formControlName","Ftable",1,"form-control",3,"selectionChange"],["formArrayName","columns"],[1,"col-md-4"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["selectForeignKeyInDS","",3,"value",4,"ngFor","ngForOf"],["selectForeignKeyInDS","",3,"value"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],[1,"taxt_audit-report","enableUploadSQLPopup"],["mat-input","","type","name","cols","50","formControlName","sqlScript","name","s",1,"form-control",2,"min-height","60vh","width","100%"],[1,"taxt-audit-popup",2,"margin-left","50px"],["type","text","formControlName","datasetName","placeholder","DataSet Name",3,"ngClass","keyup"],["mat-input","","type","name","formControlName","sqlScript","name","s",1,"form-control",2,"background-color","#2d2d2d","color","#fff",3,"ngClass"],["type","text","formControlName","appendNameControl",3,"ngClass","change"],["for","sqlTxtFile",1,"button"],["type","file","id","sqlTxtFile",2,"display","none",3,"change"],["mat-input","","type","name","formControlName","script","name","s",1,"form-control",2,"background-color","#2d2d2d","color","#fff",3,"ngClass"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"New Solution"),e.qZA(),e.TgZ(3,"h5")(4,"span",2),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6,"Solution Board / New Solution"),e.qZA()(),e.TgZ(7,"div",3)(8,"h5",4),e._uU(9,"Dataset(s) Preparation:"),e.qZA(),e.TgZ(10,"div",5),e.YNc(11,yM,5,4,"ng-container",6),e.qZA(),e.YNc(12,UM,10,5,"div",7),e.YNc(13,$M,15,3,"ng-container",7),e.YNc(14,m5,10,7,"div",8),e.YNc(15,q5,18,8,"div",8),e.YNc(16,j5,13,2,"ng-container",7),e.YNc(17,jL,40,4,"div",7),e.qZA(),e.YNc(18,eI,17,4,"div",7),e.YNc(19,tI,17,4,"div",7),e.YNc(20,lI,15,3,"div",7),e.YNc(21,cI,17,1,"div",7),e.YNc(22,CI,16,2,"div",7),e.YNc(23,TI,13,1,"div",7),e.YNc(24,bI,14,7,"div",7),e.YNc(25,wI,17,4,"div",7),e.YNc(26,AI,11,2,"div",7),e.YNc(27,yI,16,4,"div",7)),2&t&&(e.xp6(11),e.Q6J("ngForOf",o.tabs),e.xp6(1),e.Q6J("ngIf",0==o.tabs[0].id&&1==o.tabs[0].isActive),e.xp6(1),e.Q6J("ngIf",1==o.tabs[1].id&&1==o.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",2==o.tabs[2].id&&1==o.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",3==o.tabs[3].id&&1==o.tabs[3].isActive),e.xp6(1),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",5==o.tabs[5].id&&1==o.tabs[5].isActive),e.xp6(1),e.Q6J("ngIf",o.enableAppendNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableMergeNamePopup),e.xp6(1),e.Q6J("ngIf",o.showTargetFilePopup),e.xp6(1),e.Q6J("ngIf",o.enableDataSetPopUp),e.xp6(1),e.Q6J("ngIf",o.saveDataSetPopup),e.xp6(1),e.Q6J("ngIf",o.enableViewScriptPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQLPopup),e.xp6(1),e.Q6J("ngIf",o.enableDatasetAppendPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQL_PythonPopup),e.xp6(1),e.Q6J("ngIf",o.enableViewscriptPopup))},directives:[be.sg,Ze.lW,be.O5,Se.a8,w.Wl,w.JJ,w.On,w._Y,w.JL,w.sg,w.CE,w.x0,Ln.KE,hi.gD,w.u,Et.ey,ms.gM,lt.pp,lt.ib,lt.yz,w.Fj,Qi.Nt,be.mk,w.F],styles:['.mat-card[_ngcontent-%COMP%]{margin-top:2%;float:left;width:100%}.btn[_ngcontent-%COMP%]{height:37px;border-radius:0;background-color:#0076a8;color:#fff;width:auto}h3[_ngcontent-%COMP%]{font-size:25px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}.btnn[_ngcontent-%COMP%]{border-radius:0;margin:14px 0 14px 20px!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;transition:all .5s cubic-bezier(.77,0,.175,1)}.btnn.preview[_ngcontent-%COMP%]{float:right;margin:10px 0 0!important}.btnn[_ngcontent-%COMP%]:hover{box-shadow:inset 135px 0 #041e42;color:#fff!important;border:1px solid #041E42}.btnnn[_ngcontent-%COMP%]{height:50px;border:1px solid #cccaca;text-align:left;width:100%;border-radius:0;background-color:#fff;color:#000;font-size:17px}.btnnn[_ngcontent-%COMP%]:nth-child(odd){background-color:#eee}.btnnn[_ngcontent-%COMP%]:hover, .btnnn[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.scroll[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll1[_ngcontent-%COMP%]{max-height:200px!important;margin-bottom:10px}.scroll2[_ngcontent-%COMP%]{max-height:400px!important;margin-bottom:10px}.scroll1[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .scroll2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.select[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:220px;border-radius:0;font-size:12px;border:1px solid #cccaca;font-family:open_sans-regular!important;padding:5px 8px}.dds-icon_file_xls__l__filled[_ngcontent-%COMP%]:before{padding-right:10px}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.sheet[_ngcontent-%COMP%]{border:2px solid #eee}table[_ngcontent-%COMP%]{width:100%;margin:0%}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#eeeeee}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#000;height:24px;padding:0 20px;font-family:open_sans-medium;font-size:14px;line-height:16px}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{color:#5aa448;font-size:19px}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#041E42!important}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px!important;color:#fff!important;font-family:open_sans-regular!important;font-weight:400}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;text-align:center}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#fff}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:28px;padding:2px 20px 2px 53px!important;border-bottom:1px solid #eee;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px}.selectCheck[_ngcontent-%COMP%]{float:left;width:100%;margin:0 0 10px}.selectCheck[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{vertical-align:middle;width:16px;height:16px;margin:0 5px 0 0}.selectCheck[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span.dds-icon[_ngcontent-%COMP%]{height:auto;vertical-align:middle}table[_ngcontent-%COMP%]   td.active[_ngcontent-%COMP%]{background-color:#87ceeb!important}h6[_ngcontent-%COMP%]{float:left;width:100%;padding:10px 0 0 65px}.append[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]{display:block;position:relative;padding:16px;border-radius:4px;box-shadow:0 0 6px 1px #cccaca;margin-top:10px;float:left;width:100%}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even)   td[_ngcontent-%COMP%]{background:#eee!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]{background-color:#fff;width:inherit;display:table-row;height:40px}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#fff!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px;margin:0 10px 0 0;vertical-align:middle}.header[_ngcontent-%COMP%]{width:100%;background:#0076A8;float:left;margin:0 0 15px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:8px 12px;color:#fff;font-family:open_sans-regular;font-size:14px;line-height:19px;float:left;width:100%;margin:0}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:14% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:159px;width:440px;border-style:dotted;border-width:1px solid;color:#0076a8;margin:auto;padding:30px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.taxt-audit-popup[_ngcontent-%COMP%]{background:#fff;width:700px;position:absolute;top:50%;left:50%;transform:translate(-50%,-40%)}.taxt-audit-popup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{float:left;width:100%}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{border-radius:0;border:0;margin:14px 20px 25px 0!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;float:right;transition:all .5s cubic-bezier(.77,0,.175,1)}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important;border:1px solid #041E42}.taxt-audit-popup[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#d8000c;position:absolute;font-size:12px;line-height:15px;font-family:open_sans-regular;bottom:71px;right:20px;font-size:11px}.taxt-audit-popup.preview[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:400px;overflow-y:auto}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.allow-cr[_ngcontent-%COMP%]{white-space:pre-line}.mat-accordion[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:2rem;border-bottom:none}.mat-expansion-panel-header.mat-row[_ngcontent-%COMP%]{border-bottom:none}p.dataP[_ngcontent-%COMP%]{float:left;width:calc(100% - 150px);margin:0;height:auto;line-height:20px;color:#000;line-height:36px}.rightIcons[_ngcontent-%COMP%]{float:right}.rightIcons[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 3px;float:left;height:auto}.rightIcons1[_ngcontent-%COMP%]{float:right}.rightIcons1[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 50px;float:left;height:auto}.mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000}.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0}.mat-table[_ngcontent-%COMP%]{display:block}.mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{min-height:33px}.mat-row[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;padding:0 24px;box-sizing:border-box}.mat-row[_ngcontent-%COMP%]:after, .mat-header-row[_ngcontent-%COMP%]:after{display:inline-block;min-height:inherit;content:""}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;position:relative}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{float:right;position:absolute;right:0}.dataModeling[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{float:left;width:100%;box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;margin:0 0 15px}.dataModeling[_ngcontent-%COMP%]   .mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:25px}.dataModeling[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:1px solid #D6D6D6;border-radius:0}.dataModeling[_ngcontent-%COMP%]   .combination[_ngcontent-%COMP%]{box-shadow:none}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-5[_ngcontent-%COMP%]{width:45%;padding:0}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-7[_ngcontent-%COMP%]{width:53%;padding:0;margin-left:2%}.dataModeling[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%], .dataModeling[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:0}.targetFileRow[_ngcontent-%COMP%]   .combination.col-md-6[_ngcontent-%COMP%]{width:50%;box-shadow:none}.row.popup[_ngcontent-%COMP%]{margin:0;float:left;width:100%}.row.popup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{float:left;width:100%}.row.popup[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{float:left;width:100%;padding:20px}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px #0003;padding:12px 16px;z-index:1;width:250px}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{height:24px!important;min-height:24px!important}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{top:0!important}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;margin:0 0 8px}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:none}.dropdown-content[_ngcontent-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:12px;margin-bottom:8px;width:100%;float:left;word-break:break-all}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dds-icon.border[_ngcontent-%COMP%]{border:2px solid #000;padding:5px;border-radius:50%;margin-top:2px}.error[_ngcontent-%COMP%]{color:#d8000c;font-size:12px;line-height:15px;font-family:open_sans-regular}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}form[_ngcontent-%COMP%]   .col-md-2[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{margin:1px 0 10px 10px!important;height:auto}.search[_ngcontent-%COMP%]{width:25%;float:right;border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF;margin:0 0 20px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12px;border-radius:0;border:0px none;padding:0;margin:0 3px 0 0;width:calc(100% - 30px);float:left}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none}.search[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;padding:3px 0 0;font-size:17px;height:auto}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px!important}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]{margin:2px 0;float:left;width:100%}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30%;float:left;margin:0 5px 0 0}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;margin:6px 0 0;cursor:pointer;font-size:16px;padding:3px}.dds-icon[_ngcontent-%COMP%]{color:#707070;font-size:19px}.note[_ngcontent-%COMP%]{font-size:13px;line-height:17px;font-family:open_sans-regular;color:#000;float:left;margin:0 0 10px;width:100%}.required-field[_ngcontent-%COMP%]:before{content:"*";color:red}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   .taxt-audit-popup[_ngcontent-%COMP%]{width:80%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:10px}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:0;width:100%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:50vh;width:100%}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.search1[_ngcontent-%COMP%]{font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}']}),n})();function kI(n,r){if(1&n&&(e.TgZ(0,"div",25)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(t.templateName)}}function FI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"div",26),e.NdJ("click",function(){return e.CHM(t),e.oxw().downloadTemplates()}),e.TgZ(2,"a"),e._uU(3,"Download"),e.qZA()()()}}function MI(n,r){if(1&n&&(e.TgZ(0,"p",27),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function LI(n,r){1&n&&(e.TgZ(0,"div",33),e._UZ(1,"input",34),e._uU(2,"\xa0 "),e._UZ(3,"input",35),e._uU(4,"\xa0 "),e._UZ(5,"input",36),e.qZA())}function II(n,r){1&n&&(e.TgZ(0,"div",33),e._UZ(1,"input",37),e._uU(2,"\xa0 "),e._UZ(3,"input",38),e._uU(4,"\xa0 "),e.TgZ(5,"select",39)(6,"option",40),e._uU(7,"Monday"),e.qZA(),e.TgZ(8,"option",41),e._uU(9,"Tuesday"),e.qZA(),e.TgZ(10,"option",42),e._uU(11,"Wednesday"),e.qZA(),e.TgZ(12,"option",43),e._uU(13,"Thursday"),e.qZA(),e.TgZ(14,"option",44),e._uU(15,"Friday"),e.qZA(),e.TgZ(16,"option",45),e._uU(17,"Saturday"),e.qZA(),e.TgZ(18,"option",46),e._uU(19,"Sunday"),e.qZA()(),e._uU(20,"\xa0 "),e._UZ(21,"input",47),e.qZA())}function EI(n,r){1&n&&(e.TgZ(0,"div",33),e._UZ(1,"input",37),e._uU(2,"\xa0 "),e._UZ(3,"input",38),e._uU(4,"\xa0 "),e.TgZ(5,"select",48)(6,"option",49),e._uU(7,"1"),e.qZA(),e.TgZ(8,"option",50),e._uU(9,"2"),e.qZA(),e.TgZ(10,"option",51),e._uU(11,"3"),e.qZA(),e.TgZ(12,"option",52),e._uU(13,"4"),e.qZA(),e.TgZ(14,"option",53),e._uU(15,"5"),e.qZA(),e.TgZ(16,"option",54),e._uU(17,"6"),e.qZA(),e.TgZ(18,"option",55),e._uU(19,"7"),e.qZA()(),e._uU(20," \xa0 "),e._UZ(21,"input",47),e.qZA())}function ZI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"form",28)(1,"div",6)(2,"div",29)(3,"div",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(1)}),e.TgZ(4,"p"),e._uU(5,"Schedule Daily"),e.qZA()(),e.TgZ(6,"div",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(2)}),e.TgZ(7,"p"),e._uU(8,"Schedule Weekly"),e.qZA()(),e.TgZ(9,"div",30),e.NdJ("click",function(){return e.CHM(t),e.oxw().changesubtab(3)}),e.TgZ(10,"p"),e._uU(11,"Schedule Monthly"),e.qZA()()(),e._UZ(12,"mat-divider"),e.YNc(13,LI,6,0,"div",31),e.YNc(14,II,22,0,"div",31),e.YNc(15,EI,22,0,"div",31),e.TgZ(16,"button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw().scheduler()}),e._uU(17,"Save"),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.scheduleForm),e.xp6(3),e.ekj("active",t.subtab1),e.xp6(3),e.ekj("active",t.subtab2),e.xp6(3),e.ekj("active",t.subtab3),e.xp6(4),e.Q6J("ngIf",t.subtab1),e.xp6(1),e.Q6J("ngIf",t.subtab2),e.xp6(1),e.Q6J("ngIf",t.subtab3)}}function PI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",56)(2,"div",57)(3,"div",58)(4,"h4",59),e._uU(5,"Project 01"),e.qZA(),e.TgZ(6,"button",60),e.NdJ("click",function(){return e.CHM(t),e.oxw().closePopup()}),e.TgZ(7,"span",61),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",62)(10,"h6",63),e._uU(11,"Execution started you will be notified once the dashboard is generated"),e.qZA()(),e.TgZ(12,"div",64)(13,"button",65),e._uU(14,"Ok"),e.qZA()()()()()}}let OI=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u,f){this.formbuilder=t,this.shared=o,this.solService=i,this.Users_service=a,this.Master=s,this.popup=l,this._sanitizer=c,this.toast=d,this.http=_,this.loader=u,this.router=f,this.panelOpenStateFive=!0,this.down=!0,this.hideschedule=!1,this.tabs=[{id:0,value:"Download Files",isActive:!0},{id:1,value:"Execute Project",isActive:!1},{id:2,value:"Shedule Project",isActive:!1}],this.subtab1=!0,this.subtab2=!1,this.subtab3=!1}ngOnInit(){this.scheduleForm=this.formbuilder.group({startdate1:[""],enddate1:[""],time1:[""],startdate2:[""],enddate2:[""],day:[""],time2:[""],startdate3:[""],enddate3:[""],date:[""],time3:[""]}),this.processId=JSON.parse(localStorage.getItem("projectProcess")||""),this.getAllAnalyticsAndTemplates(),this.projectData=JSON.parse(localStorage.getItem("project")||""),this.processname=this.projectData.processName,this.projectname=this.projectData.projectName,this.projectid=this.projectData.projectId,this.process=JSON.parse(localStorage.getItem("projectProcess")||""),this.fileElem=document.getElementById("browse"),this.shared.getClick()}getAllAnalyticsAndTemplates(){this.Users_service.getAllAnalyticsAndTemplates(this.processId).subscribe(o=>{this.anyData=o.responseData,this.anaytics=o.responseData.processAnalyticsDTOList,this.anayticfile=o.responseData.templateResponse,console.log("analytics",this.anaytics)})}downloadTemplates(){let t=this.processId;this.loader.show(),this.Master.downloadTemplates(t).subscribe(o=>{this.downloadt=o.responseData,this.downloadt.forEach(i=>{let a=i.fileName.split(".");if(console.log(a[1]),"jpg"==a[1]){let s=`data:image/jpg;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("xlsx"==a[1]||"xls"==a[1]){let s=`data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("pdf"==a[1]){let s=`data:application/pdf;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("png"==a[1]){let s=`data:image/png;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("csv"==a[1]){let s=`data:application/csv;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("txt"==a[1]){let s=`data:application/txt;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("zip"==a[1]){let s=`data:application/zip;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}}),this.loader.hide(),this.toast.success({title:"Success",message:"Downloaded Successfully!"})},o=>{this.loader.hide(),this.toast.error({title:"Error",message:"Download Failed!"})})}customPage(){}executePage(){}success(t){let o=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(o,o.userId),this.solService.executeProject({projectId:this.projectid,userId:o.userId,processId:this.anyData.processId}).subscribe(a=>{console.log(a),this.AddEventProceeding=!0,this.addEventIndex=t,this.hideschedule=!1})}saveiputFiles(t){let o=this.projectid;console.log("projectid",o);let i=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(i,i.userId);const a=new FormData;a.append("projectId",o),a.append("userId",i.userId),a.append("processId",this.anyData.processId);for(let s=0;s<t.target.files.length;s++)a.append("file",t.target.files[s]);console.log(a),this.loader.show(),this.solService.uploadExcelToProjectExecution(a).subscribe(s=>{this.uploaddata=s.responseData,this.loader.hide(),console.log(this.uploaddata),this.toast.success({title:"Success",message:"Upload Successfully!"})})}scheduler(){this.solService.addScheduler({projectId:this.projectid,scheduleFrequency:this.subtab1?"Daily":this.subtab2?"Weekly":"Monthly",startDate:this.scheduleForm.value.startdate1,endDate:this.scheduleForm.value.enddate1,executionTime:this.scheduleForm.value.time1,executionDay:this.scheduleForm.value.day,dateOfmonth:this.scheduleForm.value.date}).subscribe(i=>{console.log("contactus",i),this.toast.success({title:"Success",message:"Project Scheduled Successfully!"}),this.router.navigate(["/user/admin1/project"])})}changesubtab(t){1==t?(this.subtab1=!0,this.subtab2=!1,this.subtab3=!1):2==t?(this.subtab1=!1,this.subtab2=!0,this.subtab3=!1):(this.subtab1=!1,this.subtab2=!1,this.subtab3=!0)}executelater(){this.hideschedule=!0}closePopup(){this.AddEventProceeding=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(w.qu),e.Y36(xs.F),e.Y36(Jt.e),e.Y36(Hi.f),e.Y36(Hn.R),e.Y36(Fn.q),e.Y36(qi.H7),e.Y36(ti.q),e.Y36(Dt.eN),e.Y36(Nn.D),e.Y36(fe.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-view-download1"]],decls:57,vars:8,consts:[[1,"heading"],[1,"consen"],[1,"pro"],[1,"info","row"],[1,"col-md-4"],[1,"row"],[1,"col"],[1,"middle",2,"height","550px"],[1,"file","minfile"],[1,"file-head"],["class","file-main",4,"ngFor","ngForOf"],[1,"bton"],["class","cbtn",4,"ngIf"],[1,"but",2,"margin-top","20px"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],["style","margin: 20px 64px;",4,"ngFor","ngForOf"],[1,"bton","col"],[1,"cbtn"],["type","submit",2,"width","auto","margin-left","20px","color","#fff",3,"click"],[2,"width","auto","margin-left","20px","color","#fff",3,"disabled","click"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"file-main"],[3,"click"],[2,"margin","20px 64px"],[3,"formGroup"],[1,"row","container","no-gutters",2,"padding","20px 0 0 0"],[1,"col","subheading",3,"click"],["style","padding-top: 20px;",4,"ngIf"],["type","submit",2,"background-color","#0076A8","float","left","width","auto","color","white","border-color","#0076A8","margin","37% 3% 3% 0",3,"click"],[2,"padding-top","20px"],["type","date","formControlName","startdate1",1,"date"],["type","date","formControlName","enddate1",1,"date"],["type","time","step","3","formControlName","time1",1,"date",2,"width","100px"],["type","date","formControlName","startdate",1,"date"],["type","date","formControlName","enddate",1,"date"],["name","days","id","days","formControlName","day",2,"width","100px","height","29px"],["value","Monday"],["value","Tuesday"],["value","Wednesday"],["value","Thursday"],["value","Friday"],["value","Saturday"],["value","Sunday"],["type","time","formControlName","time",1,"date",2,"width","70px"],["name","date","id","date","formControlName","date",2,"width","75px","height","29px"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header",2,"display","flex","background-color","#0076A8"],[2,"background-color","#0076A8","color","white","padding","10px","margin-right","405px"],["type","button","aria-label","Close",1,"close",2,"background-color","#0076A8",3,"click"],["aria-hidden","true"],[2,"text-align","center","margin-top","20px"],[2,"padding","70px 20px 20px 20px"],[1,"col-sm-4",2,"float","right","margin","5% 22% 5% 0"],["mat-button","","routerLink","/user/admin1/project",2,"width","40%","height","35px","background-color","#0076A8","color","white","border-radius","0"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"Download & Upload Script"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"h4"),e._uU(8),e.qZA()(),e.TgZ(9,"div",4)(10,"h4"),e._uU(11),e.qZA()()()(),e.TgZ(12,"div",5)(13,"div",6)(14,"mat-card",7)(15,"div",8)(16,"h5"),e._uU(17,"Step:1 Download the files."),e.qZA(),e.TgZ(18,"div",9)(19,"h4"),e._uU(20,"Scripts / Templates to be downloaded"),e.qZA()(),e.YNc(21,kI,3,1,"div",10),e.qZA(),e.TgZ(22,"div",11),e.YNc(23,FI,4,0,"div",12),e.qZA()()(),e.TgZ(24,"div",6)(25,"mat-card",7)(26,"h5"),e._uU(27,"Step:2 Upload the files."),e.qZA(),e.TgZ(28,"div",9)(29,"h4"),e._uU(30,"Upload File"),e.qZA()(),e.TgZ(31,"div",13)(32,"div")(33,"label",14)(34,"input",15),e.NdJ("change",function(a){return o.saveiputFiles(a)}),e.qZA(),e._UZ(35,"span",16)(36,"br"),e.TgZ(37,"h5"),e._uU(38,"Upload Files"),e.qZA(),e.TgZ(39,"p",17),e._uU(40,"Note: Exclude .JS and .EXE files"),e.qZA()(),e.YNc(41,MI,2,1,"p",18),e.qZA()()()(),e.TgZ(42,"div",6)(43,"mat-card",7)(44,"h5"),e._uU(45,"Step:3 Execute or Schedule the Project."),e.qZA(),e.TgZ(46,"div",9)(47,"h4"),e._uU(48,"Execute process"),e.qZA()(),e.TgZ(49,"div",19)(50,"div",20)(51,"button",21),e.NdJ("click",function(a){return o.success(a)}),e._uU(52,"Execute Now"),e.qZA(),e.TgZ(53,"button",22),e.NdJ("click",function(){return o.executelater()}),e._uU(54,"Schedule"),e.qZA()()(),e.YNc(55,ZI,18,10,"form",23),e.qZA()()(),e.YNc(56,PI,15,0,"div",24),e.qZA()),2&t&&(e.xp6(8),e.hij("Project Name: ",o.projectname,""),e.xp6(3),e.hij("Process: ",o.processname," "),e.xp6(10),e.Q6J("ngForOf",o.anayticfile),e.xp6(2),e.Q6J("ngIf",o.down),e.xp6(18),e.Q6J("ngForOf",null==o.uploaddata?null:o.uploaddata.fileList),e.xp6(12),e.Q6J("disabled",null==(null==o.uploaddata?null:o.uploaddata.fileList)),e.xp6(2),e.Q6J("ngIf",o.hideschedule),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding))},directives:[Se.a8,be.sg,be.O5,w._Y,w.JL,w.sg,i_.d,w.Fj,w.JJ,w.u,w.EJ,w.YN,w.Kr,Ze.lW,fe.rH],styles:[".heading[_ngcontent-%COMP%]{background-color:#fff;color:#0076a8;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.pro[_ngcontent-%COMP%]{background-color:#fff;margin-top:20px;padding:20px 10px}.seper[_ngcontent-%COMP%]{padding:0;box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.info[_ngcontent-%COMP%]{padding:0}ul[_ngcontent-%COMP%]{padding:0;margin:0}li[_ngcontent-%COMP%]{padding:10px}.row[_ngcontent-%COMP%]{padding:0}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]::marker{display:none;font-size:0}li[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.bton[_ngcontent-%COMP%]{display:flex;margin:auto}.bton[_ngcontent-%COMP%]   .cbtn[_ngcontent-%COMP%]{display:flex;margin-top:20px}.bton[_ngcontent-%COMP%]   .ubtn[_ngcontent-%COMP%]{display:flex;margin-left:auto}.seper[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{padding:0}.seper[_ngcontent-%COMP%]   mat-expansion-panel.mat-expansion-panel.ng-tns-c197-0._mat-animation-noopable.ng-star-inserted[_ngcontent-%COMP%]{border-radius:0}h4[_ngcontent-%COMP%]{font-size:20px;margin:0}.accord[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:17px}.seper[_ngcontent-%COMP%]  .mat-expansion-panel-body{padding:0}.accord[_ngcontent-%COMP%]{margin-top:20px}.accord[_ngcontent-%COMP%]  .mat-content{display:block!important}.expansion.header[_ngcontent-%COMP%]{background-color:#041e42;color:#fff;padding:10px 15px}.file[_ngcontent-%COMP%]{border:2px #eee solid}.file-head[_ngcontent-%COMP%]{padding:10px 15px;background-color:#041e42;color:#fff}.file-head[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:17px;margin:0}.file-main[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px;padding:10px 15px;background-color:#f5f5f5;font-size:16px}.compliance-header[_ngcontent-%COMP%]   .compliance-report[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#fff;text-align:left;padding:0;border-bottom:1px solid #D0D0CE;background-color:#041e42;display:flex;align-items:center;height:36px}.compliance-header[_ngcontent-%COMP%]{float:left;width:100%;font-size:16px}.compliance-incom[_ngcontent-%COMP%]{width:30%;color:#fff;padding:10px;font-size:16px;text-align:justify}.compliance-incom1[_ngcontent-%COMP%]{width:30%;padding:10px;font-size:16px;text-align:justify}.compliance-expansion-main[_ngcontent-%COMP%]{display:flex;text-align:left;background:#F9F9F9;padding:20px 0}.accord[_ngcontent-%COMP%]  .mat-expansion-indicator{position:absolute;right:40px;top:9px;color:#fff}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}.heading[_ngcontent-%COMP%]{background-color:#fff;color:#0076a8;font-weight:700;height:80px;padding:20px}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.heading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:-10px 0 50px;font-size:15px}.pro[_ngcontent-%COMP%]{background-color:#fff;margin-top:20px;padding:20px 10px}.bton[_ngcontent-%COMP%]{display:flex;margin:auto}.bton[_ngcontent-%COMP%]   .cbtn[_ngcontent-%COMP%], .bton[_ngcontent-%COMP%]   .ubtn[_ngcontent-%COMP%]{display:flex;margin-left:auto}.bton[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;padding:10px 20px;text-decoration:none;margin:auto 5px;cursor:pointer}.dis[_ngcontent-%COMP%]{padding:0;margin:auto}.mini[_ngcontent-%COMP%]{box-shadow:0 2px 1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f;margin:20px;padding:0}.mini[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:20px;margin:0;background-color:#041e42;color:#fff;padding:10px 15px}.mini[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:10px 15px;margin:0}.minfile[_ngcontent-%COMP%]{height:450px;overflow:auto}.minfile[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0;font-size:17px}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.minfile[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.taxt-audit-popup[_ngcontent-%COMP%]{width:550px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:0% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:137px;width:322px;border-style:dotted;border-width:1px solid;color:#0076a8;padding:30px;margin-top:65px;margin-left:46px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.btnn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.fin[_ngcontent-%COMP%]{padding:0;border-radius:0;background-color:#fff;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.subheading[_ngcontent-%COMP%]{text-align:center}.subheading.active[_ngcontent-%COMP%]{border-bottom:5px solid #0076A8;width:100px}button[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}button[_ngcontent-%COMP%]:disabled, button[disabled][_ngcontent-%COMP%]{border:1px solid #999999;background-color:#ccc;color:#000}"]}),n})();function UI(n,r){1&n&&e._UZ(0,"span",11)}function BI(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"button",9),e._uU(2),e.YNc(3,UI,1,0,"span",10),e.qZA(),e._uU(4," \xa0 "),e.BQk()),2&n){const t=r.$implicit,o=r.index,i=e.oxw();e.xp6(1),e.ekj("active",t.isActive),e.xp6(1),e.Oqu(t.value),e.xp6(1),e.Q6J("ngIf",i.tabs.length-1!=o)}}function JI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"div")(3,"label",19)(4,"input",20),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._UZ(5,"span",21)(6,"br"),e.TgZ(7,"h5"),e._uU(8,"Upload Files"),e.qZA(),e.TgZ(9,"p",22),e._uU(10,"Note: Exclude .JS and .EXE files"),e.qZA()()()()()}}function qI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"label",23)(2,"input",20),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e.TgZ(3,"h6",24),e._uU(4,"Upload More Files"),e.qZA()(),e.TgZ(5,"span",25),e._uU(6,"Choose the sheets within the file(s)"),e.qZA(),e.TgZ(7,"div",26)(8,"h5"),e._uU(9,"Uploaded Files"),e.qZA()(),e.TgZ(10,"div",27)(11,"input",28),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw(2).masterSelected=i})("change",function(){return e.CHM(t),e.oxw(2).checkUncheckAllUploadFiles()}),e.qZA(),e.TgZ(12,"label"),e._uU(13,"Select All"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(11),e.Q6J("ngModel",t.masterSelected)}}function RI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",30),e.BQk())}function QI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",31),e.BQk())}function HI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",32),e.BQk())}function YI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",33),e.BQk())}function VI(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",34),e.BQk())}function $I(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",35),e.BQk())}function KI(n,r){1&n&&(e.ynx(0),e._UZ(1,"img",36),e.BQk())}function WI(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",37),e.NdJ("click",function(i){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).deleteTables(i,a,0,"file")}),e.qZA(),e.BQk()}}function zI(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).previewPopup(i.tableName)}),e.qZA(),e.BQk()}}function GI(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.sheetSelected=i})("change",function(){return e.CHM(t),e.oxw(3).isAllSelectedUploadFiles()}),e.qZA(),e._UZ(3,"img",39),e.TgZ(4,"label"),e._uU(5),e.qZA(),e.YNc(6,zI,2,0,"ng-container",7),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.sheetSelected),e.xp6(3),e.Oqu(t.sheetName),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt||"txt"==t.fileExt||"csv"==t.fileExt||"json"==t.fileExt)}}function XI(n,r){1&n&&(e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",41),e.qZA()())}function jI(n,r){if(1&n&&(e.TgZ(0,"table",29)(1,"thead")(2,"tr")(3,"th"),e.YNc(4,RI,2,0,"ng-container",7),e.YNc(5,QI,2,0,"ng-container",7),e.YNc(6,HI,2,0,"ng-container",7),e.YNc(7,YI,2,0,"ng-container",7),e.YNc(8,VI,2,0,"ng-container",7),e.YNc(9,$I,2,0,"ng-container",7),e.YNc(10,KI,2,0,"ng-container",7),e._uU(11),e.YNc(12,WI,2,0,"ng-container",7),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,GI,7,3,"tr",6),e.YNc(15,XI,3,0,"tr",7),e.qZA()()),2&n){const t=r.$implicit;e.xp6(4),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","pdf"==t.fileExt),e.xp6(1),e.Q6J("ngIf","jpg"==t.fileExt),e.xp6(1),e.Q6J("ngIf","png"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==t.fileExt),e.xp6(1),e.hij(" ",t.fileNameWithExt," "),e.xp6(1),e.Q6J("ngIf",!t.isProgressBar),e.xp6(2),e.Q6J("ngForOf",t.totalSheetList),e.xp6(1),e.Q6J("ngIf",t.isProgressBar)}}function eE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeTabs({id:1},"next")}),e._uU(1,"Next"),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isUploadFilesNextBtnEnable)}}function tE(n,r){if(1&n&&(e.TgZ(0,"div")(1,"mat-card")(2,"div",12)(3,"div"),e.YNc(4,JI,11,0,"div",13),e.YNc(5,qI,14,1,"div",7),e.YNc(6,jI,16,11,"table",14),e.qZA(),e.TgZ(7,"div",15),e.YNc(8,eE,2,1,"button",16),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",!t.showUploadFilesTab),e.xp6(1),e.Q6J("ngIf",t.showUploadFilesTab),e.xp6(1),e.Q6J("ngForOf",t.fileListt),e.xp6(2),e.Q6J("ngIf",t.fileListt.length>0)}}function nE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",52),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup(a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.appendName," ")}}function iE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",50)(2,"table",51)(3,"thead")(4,"tr",26)(5,"th"),e._uU(6,"Append Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,nE,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function oE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",52),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(4).previewPopup(a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.mergeName," ")}}function rE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",50)(2,"table",51)(3,"thead")(4,"tr",26)(5,"th"),e._uU(6,"Join Files"),e.qZA()()(),e.TgZ(7,"tbody"),e.YNc(8,oE,4,3,"tr",6),e.qZA()()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(8),e.Q6J("ngForOf",t.sheetList)}}function aE(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"td",52),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit,l=e.oxw(2),c=l.index,d=l.$implicit;return e.oxw(2).fileClickedinTF(a,c,s,d.fileType)}),e._uU(2),e.TgZ(3,"span",40),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(4).previewPopup(i.tableName)}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.ekj("active",t.isRowTabAvtive),e.xp6(1),e.hij(" ",t.fileName," ")}}function sE(n,r){if(1&n&&(e.TgZ(0,"tbody")(1,"tr"),e.YNc(2,aE,4,3,"ng-container",7),e.qZA()()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngIf",t.sheetSelected)}}function lE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",50)(2,"table",51)(3,"thead")(4,"tr",26)(5,"th"),e._uU(6,"Source Files"),e.qZA()()(),e.YNc(7,sE,3,1,"tbody",6),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(7),e.Q6J("ngForOf",t.sheetList)}}function cE(n,r){if(1&n&&(e.ynx(0),e.YNc(1,iE,9,1,"ng-container",7),e.YNc(2,rE,9,1,"ng-container",7),e.YNc(3,lE,8,1,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","append"==t.fileType&&0!=t.sheetList.length),e.xp6(1),e.Q6J("ngIf","join"==t.fileType&&0!=t.sheetList.length),e.xp6(1),e.Q6J("ngIf","files"==t.fileType&&0!=t.sheetList.length)}}function dE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span")(2,"div"),e._uU(3),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.fieldName)}}function _E(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function pE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",57)(2,"input",58),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isChecked=i}),e.qZA()(),e.TgZ(3,"td",59),e.YNc(4,dE,4,1,"ng-container",7),e.qZA(),e.TgZ(5,"td",60)(6,"mat-form-field",61)(7,"mat-select",62),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.columnType=i})("selectionChange",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).selectDropDownInTF(i,s)}),e.YNc(8,_E,2,2,"mat-option",63),e.qZA()()()()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(2),e.Q6J("ngModel",t.isChecked),e.xp6(2),e.Q6J("ngIf","files"==o.fileTypeInTF||"append"==o.fileTypeInTF||"join"==o.fileTypeInTF),e.xp6(3),e.Q6J("ngModel",t.columnType),e.xp6(1),e.Q6J("ngForOf",o.dataTypee)}}function uE(n,r){if(1&n&&(e.TgZ(0,"table",51)(1,"thead")(2,"tr",53)(3,"th",54),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",55),e._uU(6,"Column Name"),e.qZA(),e.TgZ(7,"th",56),e._uU(8,"Data Type"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,pE,9,4,"tr",6),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",t.clickedRowDataInTF)}}function fE(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",43)(2,"span",44),e._uU(3,"Here is the complete list of files that are appended, joined, and other individual files that can be used to build the datasets. "),e.qZA(),e.TgZ(4,"div",45),e.YNc(5,cE,4,3,"ng-container",6),e.qZA(),e.TgZ(6,"div",46),e.YNc(7,uE,11,1,"table",47),e.qZA(),e.TgZ(8,"div",48)(9,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:0})}),e._uU(10,"Prev"),e.qZA(),e.TgZ(11,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:2},"next")}),e._uU(12,"Next"),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("ngForOf",t.targetFiles),e.xp6(2),e.Q6J("ngIf",0!=(null==t.clickedRowDataInTF?null:t.clickedRowDataInTF.length))}}function mE(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",77),e.BQk())}function hE(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",78),e.BQk())}function gE(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",79),e.BQk())}function xE(n,r){1&n&&(e.ynx(0),e._UZ(1,"img",36),e.BQk())}function vE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",74)(1,"td")(2,"input",75),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isCheckedInAppend=i})("change",function(i){return e.CHM(t),e.oxw(3).isCheckedInAppend(i)}),e.qZA(),e.YNc(3,mE,2,0,"ng-container",7),e.YNc(4,hE,2,0,"ng-container",7),e.YNc(5,gE,2,0,"ng-container",7),e.YNc(6,xE,2,0,"ng-container",7),e._uU(7),e.qZA(),e._UZ(8,"td",76),e.TgZ(9,"td")(10,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a.tableName)}),e.qZA()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isCheckedInAppend),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==t.fileExt),e.xp6(1),e.hij(" ",t.fileName," ")}}function CE(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function TE(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Append Sheets"),e.qZA(),e.TgZ(3,"span",25),e._uU(4,"To append the sheets, please choose the ones with identical columns. Select atleast two sheets for appending "),e.qZA(),e.TgZ(5,"table",67)(6,"thead",68)(7,"tr")(8,"th",69),e._uU(9,"Filename"),e.qZA(),e._UZ(10,"th",70),e.TgZ(11,"th",68),e._uU(12,"Preview"),e.qZA()()(),e.TgZ(13,"tbody"),e.YNc(14,vE,11,6,"tr",71),e.qZA()(),e.YNc(15,CE,2,1,"div",72),e.TgZ(16,"button",73),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addAppend()}),e._uU(17," Append"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(14),e.Q6J("ngForOf",t.sourceFilesList),e.xp6(1),e.Q6J("ngIf",t.submitted)}}function bE(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",77),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.lnq(" ",t.fileName,"-",t.sheetName,".",t.fileExt," ")}}function wE(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",78),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function SE(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"span",79),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function NE(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"img",36),e._uU(2),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.fileNameWithExt," ")}}function AE(n,r){if(1&n&&(e.ynx(0),e.YNc(1,bE,3,3,"ng-container",7),e.YNc(2,wE,3,1,"ng-container",7),e.YNc(3,SE,3,1,"ng-container",7),e.YNc(4,NE,3,1,"ng-container",7),e.BQk()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==o.fileExt)}}function yE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",74)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td",76),e.YNc(4,AE,5,4,"ng-container",6),e.qZA(),e.TgZ(5,"td"),e.ynx(6,66),e.TgZ(7,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a.tableName)}),e.qZA(),e.TgZ(8,"span",82),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"append")}),e.qZA(),e.BQk(),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.appendName," "),e.xp6(2),e.Q6J("ngForOf",t.appendDtos)}}function DE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"table",67)(2,"thead",68)(3,"tr")(4,"th",69),e._uU(5,"Append Name"),e.qZA(),e._UZ(6,"th",70),e.TgZ(7,"th",68),e._uU(8,"Preview"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,yE,9,2,"tr",71),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",t.getAppendFilesList)}}function kE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",65),e.YNc(1,TE,18,2,"ng-container",7),e.YNc(2,DE,11,1,"ng-container",7),e.TgZ(3,"div",66)(4,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:1},"prev")}),e._uU(5,"Prev"),e.qZA(),e.TgZ(6,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3},"next")}),e._uU(7,"Next"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0!=t.sourceFilesList.length),e.xp6(1),e.Q6J("ngIf",0!=t.getAppendFilesList.length)}}function FE(n,r){1&n&&e.GkF(0)}function ME(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",77),e.BQk())}function LE(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",78),e.BQk())}function IE(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",79),e.BQk())}function EE(n,r){1&n&&(e.ynx(0),e._UZ(1,"img",36),e.BQk())}function ZE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",88)(1,"td")(2,"input",89),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isCheckedInJoin=i})("change",function(i){return e.CHM(t),e.oxw(3).checkedInJoin(i)}),e.qZA(),e.YNc(3,FE,1,0,"ng-container",7),e.YNc(4,ME,2,0,"ng-container",7),e.YNc(5,LE,2,0,"ng-container",7),e.YNc(6,IE,2,0,"ng-container",7),e.YNc(7,EE,2,0,"ng-container",7),e._uU(8),e.TgZ(9,"div",90)(10,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a.tableName)}),e.qZA()()()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isCheckedInJoin),e.xp6(1),e.Q6J("ngIf",1==t.isAppend),e.xp6(1),e.Q6J("ngIf","xlsx"==t.fileExt||"xls"==t.fileExt),e.xp6(1),e.Q6J("ngIf","txt"==t.fileExt),e.xp6(1),e.Q6J("ngIf","csv"==t.fileExt),e.xp6(1),e.Q6J("ngIf","json"==t.fileExt),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function PE(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function OE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",91),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).join2Sheets()}),e._uU(1,"Join"),e.qZA()}if(2&n){const t=e.oxw(3);e.Q6J("disabled",t.enableAddBtn)("ngClass",t.enableAddBtn?"disabled":"")}}function UE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",64),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function BE(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function JE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",64),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij("",t.tableNameUI," ")}}function qE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",112),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(4).addTableJoins(a,i)}),e.qZA()}if(2&n){const t=e.oxw(2).index,o=e.oxw(4);e.Q6J("disabled",null==o.joinCheckedList[t]?null:o.joinCheckedList[t].allTablesSelected)}}function RE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",113),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(4).removeTable(a,i)}),e.qZA()}}function QE(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function HE(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function YE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",119),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2).index,a=e.oxw().index;return e.oxw(4).addColumnJoin(a,i)}),e.qZA()}}function VE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",120),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index,s=e.oxw().index;return e.oxw(4).removeCol(s,a,i)}),e.qZA()}}const Ke=function(n){return{"is-invalid":n}};function $E(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",99)(1,"div",12),e._UZ(2,"div",104),e.TgZ(3,"div",105)(4,"mat-form-field",61)(5,"mat-select",114),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(4).selectPrimarykey(i,s,l,c)}),e.YNc(6,QE,2,2,"mat-option",63),e.qZA()()(),e._UZ(7,"div",104),e.TgZ(8,"div",105)(9,"mat-form-field",61)(10,"mat-select",115),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index,c=e.oxw().index;return e.oxw(4).selectForeignKey(i,s,l,c)}),e.YNc(11,HE,2,2,"mat-option",63),e.qZA()()(),e.TgZ(12,"div",116),e.YNc(13,YE,1,0,"button",117),e.YNc(14,VE,1,0,"button",118),e.qZA()()()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw().index,s=e.oxw(4);let l,c;e.Q6J("formGroupName",o),e.xp6(5),e.Q6J("ngClass",e.VKq(7,Ke,s.submitedJ&&(null==(l=t.get("column1"))?null:l.errors))),e.xp6(1),e.Q6J("ngForOf",null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].primaryKeyList),e.xp6(4),e.Q6J("ngClass",e.VKq(9,Ke,s.submitedJ&&(null==(c=t.get("column2"))?null:c.errors))),e.xp6(1),e.Q6J("ngForOf",null==s.joinCheckedList[a]||null==s.joinCheckedList[a].dropDownList[i]||null==s.joinCheckedList[a].dropDownList[i].columns[o]?null:s.joinCheckedList[a].dropDownList[i].columns[o].foreignKeyList),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function KE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",103)(1,"div",12),e._UZ(2,"div",104),e.TgZ(3,"div",105)(4,"mat-form-field",61)(5,"mat-select",106),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(4).selectPrimaryTable(i,s,l)}),e.YNc(6,UE,3,2,"ng-container",6),e.qZA()()(),e.TgZ(7,"div",104)(8,"mat-form-field",61)(9,"mat-select",107),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(4).selectJoin(i,s,l)}),e.YNc(10,BE,2,2,"mat-option",63),e.qZA()()(),e.TgZ(11,"div",105)(12,"mat-form-field",61)(13,"mat-select",108),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(4).selectForeignTable(i,s,l)}),e.YNc(14,JE,3,2,"ng-container",6),e.qZA()()(),e.TgZ(15,"div",104),e.YNc(16,qE,1,1,"button",109),e.YNc(17,RE,1,0,"button",110),e.qZA()(),e.TgZ(18,"div",111),e.YNc(19,$E,15,11,"div",98),e.qZA()()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw(4);let s,l,c;e.Q6J("formGroupName",o),e.xp6(5),e.Q6J("placeholder",a.placetable)("ngClass",e.VKq(11,Ke,a.submitedJ&&(null==(s=t.get("table1"))?null:s.errors))),e.xp6(1),e.Q6J("ngForOf",null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].primaryTableList),e.xp6(3),e.Q6J("ngClass",e.VKq(13,Ke,a.submitedJ&&(null==(l=t.get("join"))?null:l.errors))),e.xp6(1),e.Q6J("ngForOf",a.joinType),e.xp6(3),e.Q6J("ngClass",e.VKq(15,Ke,a.submitedJ&&(null==(c=t.get("table2"))?null:c.errors))),e.xp6(1),e.Q6J("ngForOf",null==a.joinCheckedList[i]?null:a.joinCheckedList[i].dropDownList[o].foreignTableList),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o),e.xp6(2),e.Q6J("ngForOf",a.columnArr(i,o).controls)}}function WE(n,r){if(1&n&&(e.TgZ(0,"div",99)(1,"div",100),e._uU(2),e.qZA(),e.TgZ(3,"div",101),e.YNc(4,KE,20,17,"div",102),e.qZA()()),2&n){const t=r.index,o=e.oxw(4);e.Q6J("formGroupName",t),e.xp6(2),e.hij("Join Table Name : ",o.joinCheckedList[t].joinName," "),e.xp6(2),e.Q6J("ngForOf",o.TableArr(t).controls)}}function zE(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",92)(2,"div",93)(3,"div",94),e._uU(4,"Join Set "),e.qZA(),e._UZ(5,"div",95)(6,"div",95)(7,"div",95)(8,"div",96),e.qZA(),e.TgZ(9,"div",97),e.YNc(10,WE,5,3,"div",98),e.qZA()()()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("formGroup",t.joinSetForm),e.xp6(9),e.Q6J("ngForOf",t.MergeArr().controls)}}function GE(n,r){if(1&n){const t=e.EpF();e.ynx(0,121),e.TgZ(1,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).resetJoin()}),e._uU(2,"Reset"),e.qZA(),e.TgZ(3,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(3).MergeSubmit()}),e._uU(4,"Save"),e.qZA(),e.BQk()}}function XE(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"table",84)(2,"tbody"),e.YNc(3,ZE,11,7,"tr",85),e.qZA()(),e.YNc(4,PE,2,1,"div",72),e.YNc(5,OE,2,2,"button",86),e.YNc(6,zE,11,2,"div",7),e.YNc(7,GE,5,0,"ng-container",87),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.append_SourceFilesList),e.xp6(1),e.Q6J("ngIf",t.submitted),e.xp6(1),e.Q6J("ngIf",t.append_SourceFilesList.length>0),e.xp6(1),e.Q6J("ngIf",0!=t.joinCheckedList.length),e.xp6(1),e.Q6J("ngIf",0!=t.joinCheckedList.length)}}function jE(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",74)(1,"td"),e._uU(2),e.qZA(),e._UZ(3,"td",76),e.TgZ(4,"td"),e.ynx(5,66),e.TgZ(6,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a.tableName)}),e.qZA(),e.TgZ(7,"span",82),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"merge")}),e.qZA(),e.BQk(),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.mergeName," ")}}function eZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"table",67)(2,"thead",68)(3,"tr")(4,"th",69),e._uU(5,"Join Name"),e.qZA(),e._UZ(6,"th",70),e.TgZ(7,"th",68),e._uU(8,"Preview"),e.qZA()()(),e.TgZ(9,"tbody"),e.YNc(10,jE,8,1,"tr",71),e.qZA()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(10),e.Q6J("ngForOf",t.getJoinFilesList)}}function tZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",65),e.ynx(1),e.TgZ(2,"span",25),e._uU(3,"Select the files, then join them based on common columns "),e.qZA(),e.TgZ(4,"div",26)(5,"h5"),e._uU(6,"Files "),e.TgZ(7,"div",83),e._uU(8,"Preview"),e.qZA()()(),e.YNc(9,XE,8,5,"ng-container",7),e.YNc(10,eZ,11,1,"ng-container",7),e.TgZ(11,"div",66)(12,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:2},"prev")}),e._uU(13,"Prev"),e.qZA(),e.TgZ(14,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:4},"next")}),e._uU(15,"Next"),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.append_SourceFilesList.length>0),e.xp6(1),e.Q6J("ngIf",0!=t.getJoinFilesList.length)}}function nZ(n,r){1&n&&(e.TgZ(0,"div",137),e._uU(1,"No files found"),e.qZA())}function iZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",150)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function oZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,iZ,4,2,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.tableAppendFieldsDto)}}function rZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",150)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"AF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function aZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,rZ,4,2,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw(6);e.xp6(1),e.Q6J("ngForOf",t.filteredDataAppend)}}function sZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",140),e.NdJ("opened",function(){return e.CHM(t),e.oxw(5).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(5).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",141)(2,"p",142),e._uU(3),e.qZA(),e.TgZ(4,"div",143)(5,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).previewPopup(a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",144)(8,"input",145),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(3).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",146)(10,"input",147),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(3).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",148),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,oZ,2,1,"ng-container",7),e.YNc(15,aZ,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(5);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.appendName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterAppend),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterAppend)}}function lZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",138),e.YNc(2,sZ,16,5,"mat-expansion-panel",139),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function cZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",127)(2,"h5"),e._uU(3,"Append Files"),e.qZA()(),e.YNc(4,nZ,2,0,"div",128),e.YNc(5,lZ,3,1,"ng-container",7),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function dZ(n,r){1&n&&(e.TgZ(0,"div",137),e._uU(1,"No files found"),e.qZA())}function _Z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",152)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function pZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,_Z,4,2,"mat-accordion",151),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.mergeFieldListDTO)}}function uZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",152)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"JF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function fZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,uZ,4,2,"mat-accordion",151),e.BQk()),2&n){const t=e.oxw(6);e.xp6(1),e.Q6J("ngForOf",t.filteredDataJoin)}}function mZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",140),e.NdJ("opened",function(){return e.CHM(t),e.oxw(5).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(5).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",141)(2,"p",142),e._uU(3),e.qZA(),e.TgZ(4,"div",143)(5,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).previewPopup(a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",144)(8,"input",145),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(3).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",146)(10,"input",147),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(3).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",148),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,pZ,2,1,"ng-container",7),e.YNc(15,fZ,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(5);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.mergeName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterJoin),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterJoin)}}function hZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",138),e.YNc(2,mZ,16,5,"mat-expansion-panel",139),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function gZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",127)(2,"h5"),e._uU(3,"Join Files"),e.qZA()(),e.YNc(4,dZ,2,0,"div",128),e.YNc(5,hZ,3,1,"ng-container",7),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function xZ(n,r){1&n&&(e.TgZ(0,"div",137),e._uU(1,"No files found"),e.qZA())}function vZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",150)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function CZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,vZ,4,2,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.sheet)}}function TZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",150)(1,"div",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(5).accordionFilesRowClicked(c,d,a,s,"SF")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllChildInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(2).$implicit,c=e.oxw(3).$implicit;return e.oxw(2).selectAllChildInDM(i,c.fileType,l,s)}),e.qZA(),e._uU(3),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function bZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,TZ,4,2,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw(6);e.xp6(1),e.Q6J("ngForOf",t.filteredDataFiles)}}function wZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",140),e.NdJ("opened",function(){return e.CHM(t),e.oxw(5).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(5).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",141)(2,"p",142),e._uU(3),e.qZA(),e.TgZ(4,"div",143)(5,"span",81),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).previewPopup(a.tableName)}),e.qZA()()(),e.TgZ(6,"div",12)(7,"div",144)(8,"input",145),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index,c=e.oxw(3).$implicit;return e.oxw(2).applyFilterForDMTables(i,s,l,c.fileType)}),e.qZA()()(),e.TgZ(9,"div",146)(10,"input",147),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit,l=e.oxw(3).$implicit;return e.oxw(2).selectAllParentInDM(i,l.fileType,s)}),e.qZA(),e._uU(11,"\xa0 "),e.TgZ(12,"label",148),e._uU(13,"Select All"),e.qZA()(),e.YNc(14,CZ,2,1,"ng-container",7),e.YNc(15,bZ,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(5);e.Q6J("expanded",i.allExpandState),e.xp6(3),e.Oqu(t.fileName),e.xp6(7),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterFiles),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterFiles)}}function SZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-accordion",138),e.YNc(2,wZ,16,5,"mat-expansion-panel",139),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(2),e.Q6J("ngForOf",t.sheetList)}}function NZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",127)(2,"h5"),e._uU(3,"Source Files"),e.qZA()(),e.YNc(4,xZ,2,0,"div",128),e.YNc(5,SZ,3,1,"ng-container",7),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Q6J("ngIf",0==t.sheetList.length),e.xp6(1),e.Q6J("ngIf",0!=t.sheetList.length)}}function AZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",136),e.YNc(2,cZ,6,2,"ng-container",7),e.qZA(),e.TgZ(3,"div",136),e.YNc(4,gZ,6,2,"ng-container",7),e.qZA(),e.TgZ(5,"div",136),e.YNc(6,NZ,6,2,"ng-container",7),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(2),e.Q6J("ngIf","append"==t.fileType),e.xp6(2),e.Q6J("ngIf","join"==t.fileType),e.xp6(2),e.Q6J("ngIf","files"==t.fileType)}}function yZ(n,r){1&n&&(e.TgZ(0,"div",137),e._uU(1,"No files found"),e.qZA())}function DZ(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",134),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isSelectAllChildInDM=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(3).selectAllChildInDM(i,"dataset",s,a)}),e.qZA(),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function kZ(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",150),e.YNc(1,DZ,4,2,"ng-container",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function FZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,kZ,2,1,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.datasetFieldDTOList)}}function MZ(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",134),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index,l=e.oxw(2),c=l.$implicit,d=l.index;return e.oxw(3).accordionFilesRowClicked(c,d,a,s,"DS")}),e.TgZ(2,"input",38),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().$implicit.isSelectAllChildInDM=i})("change",function(i){e.CHM(t);const a=e.oxw().$implicit,s=e.oxw(2).$implicit;return e.oxw(3).selectAllChildInDM(i,"dataset",s,a)}),e.qZA(),e._uU(3),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(2),e.Q6J("ngModel",t.isSelectAllChildInDM),e.xp6(1),e.hij(" ",t.fieldName," ")}}function LZ(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",150),e.YNc(1,MZ,4,2,"ng-container",7),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",!t.excludeInSelect)}}function IZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,LZ,2,1,"mat-accordion",149),e.BQk()),2&n){const t=e.oxw(4);e.xp6(1),e.Q6J("ngForOf",t.filteredDataDataset)}}function EZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",140),e.NdJ("opened",function(){return e.CHM(t),e.oxw(3).panelOpenState=!0})("closed",function(){return e.CHM(t),e.oxw(3).panelOpenState=!1}),e.TgZ(1,"mat-expansion-panel-header",153)(2,"input",154),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).onCheck(a)}),e.qZA(),e._uU(3,"\xa0 "),e.TgZ(4,"p",142),e._uU(5),e.qZA(),e.TgZ(6,"div",155)(7,"span",156),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).previewPopup(a.tableName)}),e.qZA(),e.TgZ(8,"span",157),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).editDatasetFile(a)}),e.qZA(),e.TgZ(9,"span",158),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).callGetViewscript(a)}),e.qZA(),e.TgZ(10,"span",159),e.NdJ("click",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).deleteTables(i,s,l,"dataset")}),e.qZA()()(),e.TgZ(11,"div",12)(12,"div",144)(13,"input",145),e.NdJ("keyup",function(i){const a=e.CHM(t),s=a.$implicit,l=a.index;return e.oxw(3).applyFilterForDMTables(i,s,l,"dataset")}),e.qZA()()(),e.TgZ(14,"div",146)(15,"input",147),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.isSelectAllParentInDM=i})("change",function(i){const s=e.CHM(t).$implicit;return e.oxw(3).selectAllParentInDM(i,"dataset",s)}),e.qZA(),e._uU(16,"\xa0 "),e.TgZ(17,"label",148),e._uU(18,"Select All"),e.qZA()(),e.YNc(19,FZ,2,1,"ng-container",7),e.YNc(20,IZ,2,1,"ng-container",7),e.qZA()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);e.Q6J("expanded",i.allExpandState),e.xp6(5),e.Oqu(t.datasetName),e.xp6(10),e.Q6J("ngModel",t.isSelectAllParentInDM),e.xp6(4),e.Q6J("ngIf",o!=i.selectedIndexFilterDataset),e.xp6(1),e.Q6J("ngIf",o==i.selectedIndexFilterDataset)}}function ZZ(n,r){if(1&n&&(e.TgZ(0,"mat-accordion",138),e.YNc(1,EZ,21,5,"mat-expansion-panel",139),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.allDatasetDetailsList)}}function PZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.operatorType),e.xp6(1),e.hij(" ",t.operatorType,"")}}function OZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t,"")}}function UZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",181)(2,"mat-select",182),e.YNc(3,OZ,2,2,"mat-option",63),e.qZA()(),e.BQk()),2&n){const t=e.oxw(4);e.xp6(3),e.Q6J("ngForOf",t.dateTimeFormats)}}function BZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"mat-accordion",184)(1,"div",134),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(5).accordionExpValue(a,a.Component)}),e._uU(2),e.qZA()()}if(2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionType,"")}}function JZ(n,r){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header",141),e._uU(2),e.qZA(),e.YNc(3,BZ,3,1,"mat-accordion",183),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.hij(" ",t.functionName," "),e.xp6(1),e.Q6J("ngForOf",t.funcDescritptionsList)}}function qZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function RZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function QZ(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",185)(2,"mat-form-field",61)(3,"mat-select",186),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeOperator(i,s,l,d,_)}),e.YNc(4,qZ,2,2,"mat-option",63),e.qZA()(),e.TgZ(5,"mat-form-field",61)(6,"mat-select",187),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(),d=c.index,_=c.$implicit;return e.oxw(3).changeSignOperator(i,s,l,d,_,"child")}),e.YNc(7,RZ,2,2,"mat-option",63),e.qZA()(),e.TgZ(8,"input",188),e.NdJ("ngModelChange",function(i){return e.CHM(t).$implicit.value=i}),e.qZA(),e.TgZ(9,"span",189),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(),c=l.index,d=l.$implicit;return e.oxw(3).delOpearatorValueFields(a,s,c,d)}),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=e.oxw(4);e.xp6(3),e.Q6J("value",t.operator),e.xp6(1),e.Q6J("ngForOf",o.opearatorList),e.xp6(2),e.Q6J("value",t.signOperator),e.xp6(1),e.Q6J("ngForOf",o.signOperatorList),e.xp6(1),e.Q6J("ngModel",t.value)}}function HZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"SAVE"),e.qZA()}}function YZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",123),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(3).add_SaveCreateExpression(i)}),e._uU(1,"ADD"),e.qZA()}}function VZ(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"table",163)(1,"tbody")(2,"tr")(3,"td",164)(4,"input",165),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).inputInCreateExpression(i,s)}),e.qZA(),e.TgZ(5,"div",166),e._UZ(6,"input",167),e.TgZ(7,"label"),e._uU(8,"Exclude in select"),e.qZA()(),e.TgZ(9,"div",168)(10,"mat-form-field",169)(11,"mat-select",170),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(3).changeDTinCreateExpression(i,s)}),e.YNc(12,PZ,2,2,"mat-option",63),e.qZA()(),e.YNc(13,UZ,4,1,"ng-container",7),e.qZA(),e.TgZ(14,"div",168)(15,"div",171)(16,"div")(17,"img",172),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return i.isOpenAccordion=0==i.isOpenAccordion}),e.qZA()(),e.TgZ(18,"div",173)(19,"div",174)(20,"input",175),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw(3).applyFilter(i)}),e.qZA(),e._UZ(21,"span",176),e.qZA(),e.TgZ(22,"mat-accordion",138),e.YNc(23,JZ,4,2,"mat-expansion-panel",6),e.qZA()()(),e.TgZ(24,"div",177)(25,"textarea",178),e.NdJ("select",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("click",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)})("keyup",function(i){const s=e.CHM(t).index;return e.oxw(3).textAreaInCreateExpression(i,s)}),e._uU(26,"                                                    "),e.qZA()()(),e.YNc(27,QZ,10,5,"ng-container",6),e.qZA()()(),e.ynx(28),e.YNc(29,HZ,2,0,"button",179),e.YNc(30,YZ,2,0,"button",180),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit,o=e.oxw(3);e.xp6(4),e.Q6J("ngClass",e.VKq(12,Ke,o.submited&&o.createExpressionForm.controls.sourceFieldName.errors))("value",t.sourceFieldName),e.xp6(7),e.Q6J("value",t.columnType)("ngClass",e.VKq(14,Ke,o.submited&&o.createExpressionForm.controls.columnType.errors)),e.xp6(1),e.Q6J("ngForOf",o.getOpearatorList),e.xp6(1),e.Q6J("ngIf",t.isColumnType),e.xp6(10),e.Q6J("ngForOf",o.searchfx),e.xp6(2),e.Q6J("ngClass",e.VKq(16,Ke,o.submited&&o.createExpressionForm.controls.sourceExpressionName.errors))("value",t.expression),e.xp6(2),e.Q6J("ngForOf",null==t?null:t.whereList),e.xp6(2),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",0==t.isEdit)}}function $Z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.ynx(1),e.TgZ(2,"td",208),e._uU(3),e.qZA(),e.TgZ(4,"td",208),e._uU(5),e.qZA(),e.TgZ(6,"td",209)(7,"span",210),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).editRowInDataSet(l,a,s)}),e.qZA(),e.TgZ(8,"span",211),e.NdJ("click",function(){const i=e.CHM(t),a=i.index,s=i.$implicit,l=e.oxw(2).index;return e.oxw(3).deleteRowInDataset(l,a,s)}),e.qZA()(),e.BQk(),e.qZA()}if(2&n){const t=r.$implicit;e.xp6(2),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.sourceFieldName,""),e.xp6(1),e.ekj("active",t.isEdit),e.xp6(1),e.hij(" ",t.columnType,""),e.xp6(1),e.ekj("active",t.isEdit)}}function KZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.value,"")}}function WZ(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",214)(2,"mat-select",221),e.YNc(3,KZ,2,2,"mat-option",63),e.qZA()(),e.BQk()),2&n){const t=e.oxw(6);e.xp6(3),e.Q6J("ngForOf",t.opearatorList)}}function zZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",222),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.s9C("title",t.filefieldName),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.filefieldName,"")}}function GZ(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t," ")}}function XZ(n,r){if(1&n&&(e.ynx(0),e.YNc(1,GZ,2,2,"mat-option",63),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw(5);e.xp6(1),e.Q6J("ngForOf",o.signOperatorWhereInDS[t])}}function jZ(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",223),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).addOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function eP(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",189),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.index,s=i.$implicit;return e.oxw(5).delOpearatorValueFieldsInDS(a,s)}),e.qZA(),e.BQk()}}function tP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",212)(1,"div",213),e.YNc(2,WZ,4,1,"ng-container",7),e.TgZ(3,"mat-form-field",214)(4,"mat-select",215,216),e.NdJ("selectionChange",function(i){const a=e.CHM(t),s=a.index,l=a.$implicit,c=e.oxw(2).index;return e.oxw(3).changeColumnInDSForWhere(i,s,c,l)}),e.YNc(6,zZ,2,3,"mat-option",217),e.qZA()(),e.TgZ(7,"mat-form-field",214)(8,"mat-select",218),e.YNc(9,XZ,2,1,"ng-container",7),e.qZA()(),e.TgZ(10,"div",219),e._UZ(11,"input",220),e.YNc(12,jZ,2,0,"ng-container",7),e.YNc(13,eP,2,0,"ng-container",7),e.qZA()()()}if(2&n){const t=r.index,o=e.MAs(5),i=e.oxw(5);e.Q6J("formGroupName",t),e.xp6(2),e.Q6J("ngIf",0!=t),e.xp6(2),e.s9C("title",o.triggerValue),e.xp6(2),e.Q6J("ngForOf",i.columnsForWhereInDS),e.xp6(3),e.Q6J("ngIf",0!=i.signOperatorWhereInDS.length),e.xp6(3),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",0!=t)}}function nP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function iP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.dbtablefieldName),e.xp6(1),e.hij(" ",t.filefieldName," ")}}function oP(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",126)(2,"table",51)(3,"thead")(4,"tr",68)(5,"th",190),e._uU(6),e.qZA(),e._UZ(7,"th",191),e.TgZ(8,"th",192),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteDataSet(i)}),e._UZ(9,"span",193),e.qZA()(),e.TgZ(10,"tr",68)(11,"th"),e._uU(12,"Column Name"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Column Type"),e.qZA(),e.TgZ(15,"th",194),e._uU(16,"Actions"),e.qZA()()(),e.TgZ(17,"tbody"),e.ynx(18),e.YNc(19,$Z,9,8,"tr",6),e.BQk(),e.qZA(),e._UZ(20,"div"),e.qZA()(),e.TgZ(21,"form",161)(22,"label",195),e._uU(23,"Where:"),e.qZA(),e.TgZ(24,"div",196),e.YNc(25,tP,14,7,"div",197),e.qZA(),e.TgZ(26,"div",198)(27,"label",199),e._uU(28,"Group By"),e.qZA(),e.TgZ(29,"mat-form-field",200)(30,"mat-select",201),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"groupby")}),e.TgZ(31,"mat-checkbox",202),e.NdJ("change",function(i){return e.CHM(t),e.oxw(4).toggleAllSelection(i)}),e._uU(32,"Select All"),e.qZA(),e.YNc(33,nP,2,2,"mat-option",63),e.qZA()()(),e.TgZ(34,"div",203)(35,"label",199),e._uU(36,"Having"),e.qZA(),e._UZ(37,"input",204),e.qZA(),e.TgZ(38,"div",203)(39,"label",205),e._uU(40,"Order By"),e.qZA(),e.TgZ(41,"mat-form-field",206)(42,"mat-select",207),e.NdJ("selectionChange",function(i){e.CHM(t);const a=e.oxw(),s=a.$implicit,l=a.index;return e.oxw(3).selectgroupByOrderByInDM(i,s,l,"orderby")}),e.YNc(43,iP,2,2,"mat-option",63),e.qZA()()()(),e.TgZ(44,"button",123),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=i.$implicit,s=i.index;return e.oxw(3).saveDataSet(a,s)}),e._uU(45,"Save Dataset"),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit,o=e.oxw(3);e.xp6(6),e.hij("Dataset Name :\xa0",t.datasetName,""),e.xp6(13),e.Q6J("ngForOf",t.datasetFieldDTOList),e.xp6(2),e.Q6J("formGroup",o.datasetTableForm),e.xp6(4),e.Q6J("ngForOf",o.whereArrInDS().controls),e.xp6(8),e.Q6J("ngForOf",t.groupBytoDB),e.xp6(10),e.Q6J("ngForOf",t.orderBytoDB)}}function rP(n,r){if(1&n&&(e.ynx(0),e.YNc(1,oP,46,6,"ng-container",7),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf",t.isDatasetTableExpand)}}function aP(n,r){if(1&n&&(e.TgZ(0,"div",160)(1,"div",26)(2,"h5"),e._uU(3,"Create Expression"),e.qZA()(),e.TgZ(4,"form",161),e.YNc(5,VZ,31,18,"table",162),e.qZA(),e.YNc(6,rP,2,1,"ng-container",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(4),e.Q6J("formGroup",t.createExpressionForm),e.xp6(1),e.Q6J("ngForOf",t.createExpressionList),e.xp6(1),e.Q6J("ngForOf",t.datasetDetailsList)}}function sP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function lP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function cP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function dP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function _P(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function pP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",241),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).addNewRelation(i)}),e.qZA()}}function uP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",113),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index;return e.oxw(3).deleteRelationRow(i)}),e.qZA()}}function fP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",233)(1,"div",234)(2,"mat-form-field",61)(3,"mat-select",235),e.NdJ("selectionChange",function(){const a=e.CHM(t).index;return e.oxw(3).onChangeTable(a,"from")}),e.YNc(4,sP,2,2,"mat-option",63),e.qZA()(),e.TgZ(5,"mat-form-field",61)(6,"mat-select",236),e.YNc(7,lP,2,2,"mat-option",63),e.qZA()()(),e.TgZ(8,"div",234)(9,"mat-form-field",61)(10,"mat-select",237),e.YNc(11,cP,2,2,"mat-option",63),e.qZA()()(),e.TgZ(12,"div",234)(13,"mat-form-field",61)(14,"mat-select",238),e.NdJ("selectionChange",function(){const a=e.CHM(t).index;return e.oxw(3).onChangeToTable(a,"to")}),e.YNc(15,dP,2,2,"mat-option",63),e.qZA()(),e.TgZ(16,"mat-form-field",61)(17,"mat-select",239),e.YNc(18,_P,2,2,"mat-option",63),e.qZA()()(),e.TgZ(19,"div",234),e.YNc(20,pP,1,0,"button",240),e.YNc(21,uP,1,0,"button",110),e.qZA()()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);let a,s,l,c,d;e.Q6J("formGroupName",o),e.xp6(3),e.Q6J("ngClass",e.VKq(13,Ke,i.submitedRelation&&(null==(a=t.get("fromTable"))?null:a.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].fromTableList),e.xp6(2),e.Q6J("ngClass",e.VKq(15,Ke,i.submitedRelation&&(null==(s=t.get("fromColumn"))?null:s.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].fromColumnList),e.xp6(3),e.Q6J("ngClass",e.VKq(17,Ke,i.submitedRelation&&(null==(l=t.get("crossFilteringBehavior"))?null:l.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].cfbList),e.xp6(3),e.Q6J("ngClass",e.VKq(19,Ke,i.submitedRelation&&(null==(c=t.get("toTable"))?null:c.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].toTableList),e.xp6(2),e.Q6J("ngClass",e.VKq(21,Ke,i.submitedRelation&&(null==(d=t.get("toColumn"))?null:d.errors))),e.xp6(1),e.Q6J("ngForOf",null==i.relationship[o]?null:i.relationship[o].toColumnList),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}function mP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"Add Relationship "),e.TgZ(6,"i",228),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeRelModal()}),e.qZA()()(),e.TgZ(7,"form",161)(8,"div",229),e.YNc(9,fP,22,23,"div",230),e.qZA()(),e.TgZ(10,"div")(11,"button",231),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).saveRelationship()}),e._uU(12,"Add"),e.qZA(),e.TgZ(13,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).closeRelModal()}),e._uU(14,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.xp6(7),e.Q6J("formGroup",t.addRelationshipForm),e.xp6(2),e.Q6J("ngForOf",t.relationshipArr().controls)}}function hP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"mat-card")(2,"span",25),e._uU(3,"Use the column names from the files listed below to create the dataset(s), then define the dataset columns using analytical operations or by using the column name directly."),e.qZA(),e.TgZ(4,"div")(5,"button",122),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!0}),e._uU(6,"Expand All "),e.qZA(),e.TgZ(7,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().allExpandState=!1}),e._uU(8,"Collapse All "),e.qZA(),e.TgZ(9,"button",123),e.NdJ("click",function(){return e.CHM(t),e.oxw().createDataSetinDM()}),e._uU(10," Create DataSet"),e.qZA(),e.TgZ(11,"button",123),e.NdJ("click",function(){return e.CHM(t),e.oxw().uploadSQLScriptBtn()}),e._uU(12," Upload SQL Script"),e.qZA(),e.TgZ(13,"button",123),e.NdJ("click",function(){return e.CHM(t),e.oxw().uploadPythonScriptBtn()}),e._uU(14," Upload Python Script"),e.qZA()(),e.TgZ(15,"div",124)(16,"div",12)(17,"div",125),e.YNc(18,AZ,7,3,"ng-container",6),e.TgZ(19,"div",126)(20,"div",127)(21,"h5"),e._uU(22,"DataSet Files "),e.TgZ(23,"span",66),e._uU(24,"Actions"),e.qZA()()(),e.YNc(25,yZ,2,0,"div",128),e.YNc(26,ZZ,2,1,"mat-accordion",129),e.qZA()(),e.YNc(27,aP,7,3,"div",130),e.TgZ(28,"div",131)(29,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDataset()}),e._uU(30,"Append Dataset"),e.qZA(),e.TgZ(31,"button",42),e.NdJ("click",function(){return e.CHM(t),e.oxw().openRelModal()}),e._uU(32,"Add Relationship"),e.qZA()(),e.YNc(33,mP,15,2,"div",7),e.TgZ(34,"div",132)(35,"input",133),e.NdJ("ngModelChange",function(i){return e.CHM(t),e.oxw().isOverride=i})("click",function(){return e.CHM(t),e.oxw().overrideConfirm()}),e.qZA(),e.TgZ(36,"label",134),e.NdJ("click",function(){return e.CHM(t),e.oxw().overrideConfirm()}),e._uU(37,"Override"),e.qZA(),e.TgZ(38,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeTabs({id:3},"prev")}),e._uU(39,"Prev"),e.qZA(),e.TgZ(40,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().generateScript()}),e._uU(41,"Generate Script"),e.qZA(),e.TgZ(42,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw().getViewScript()}),e._uU(43,"View Script"),e.qZA(),e.TgZ(44,"button",135),e.NdJ("click",function(){return e.CHM(t),e.oxw().SaveContinue()}),e._uU(45,"Continue"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(18),e.Q6J("ngForOf",t.targetFiles),e.xp6(7),e.Q6J("ngIf",0==(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)||null==t.allDatasetDetailsList),e.xp6(1),e.Q6J("ngIf",0!=(null==t.allDatasetDetailsList?null:t.allDatasetDetailsList.length)),e.xp6(1),e.Q6J("ngIf",0!=t.createExpressionList.length),e.xp6(4),e.Q6J("disabled",t.disableRelButton),e.xp6(2),e.Q6J("ngIf",t.showRelationshipModal),e.xp6(2),e.Q6J("ngModel",t.isOverride),e.xp6(9),e.Q6J("disabled",t.disableContinueBtn())}}function gP(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function xP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"Append Name"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",242)(8,"div",243)(9,"label"),e._uU(10,"Enter Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",244),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(14,gP,2,1,"div",72),e.TgZ(15,"div",245)(16,"button",246),e.NdJ("click",function(){return e.CHM(t),e.oxw().addAppendApi()}),e._uU(17,"Add"),e.qZA(),e.TgZ(18,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableAppendNamePopup=!1}),e._uU(19,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.appendForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,Ke,t.submited&&t.appendForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function vP(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function CP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"Join Name"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",242)(8,"div",243)(9,"label"),e._uU(10,"Enter Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",244),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(14,vP,2,1,"div",72),e.TgZ(15,"div",245)(16,"button",247),e.NdJ("click",function(){return e.CHM(t),e.oxw().addJoin()}),e._uU(17,"Add"),e.qZA(),e.TgZ(18,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableMergeNamePopup=!1}),e._uU(19,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.joinForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,Ke,t.submited&&t.joinForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function TP(n,r){1&n&&(e.ynx(0),e._UZ(1,"span",253)(2,"span",254),e.BQk())}const bP=function(n,r){return{"dds-icon_arrow_down__l__stroke":n,"dds-icon_arrow_up__l__stroke":r}};function wP(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"th",134),e.NdJ("click",function(){const i=e.CHM(t),a=i.$implicit,s=i.index;return e.oxw(2).onSortClick(a,s)}),e._uU(2),e._UZ(3,"span",252),e.YNc(4,TP,3,0,"ng-container",7),e.qZA(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(2);e.xp6(2),e.hij("",t," "),e.xp6(1),e.Q6J("ngClass",e.WLB(3,bP,i.sortColumn==o&&"asc"==i.sortOrder,i.sortColumn==o&&"desc"==i.sortOrder)),e.xp6(1),e.Q6J("ngIf",i.sortColumn!=o)}}function SP(n,r){if(1&n&&(e.TgZ(0,"td",256),e._uU(1),e.qZA()),2&n){const t=r.$implicit,o=e.oxw().$implicit;e.xp6(1),e.hij(" ",o[t],"")}}function NP(n,r){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,SP,2,1,"td",255),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.columnsArr)}}function AP(n,r){if(1&n&&(e.TgZ(0,"div",257),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Row Count: ",t.rowCount,"")}}function yP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",248),e._UZ(3,"div",226),e.TgZ(4,"form")(5,"table",51)(6,"thead")(7,"tr"),e.YNc(8,wP,5,6,"ng-container",6),e.qZA()(),e.TgZ(9,"tbody"),e.YNc(10,NP,2,1,"tr",6),e.qZA()()(),e.YNc(11,AP,2,1,"div",249),e.TgZ(12,"div",250)(13,"button",251),e.NdJ("click",function(){return e.CHM(t),e.oxw().previewPopupClose()}),e._uU(14,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.columnsArr),e.xp6(2),e.Q6J("ngForOf",t.selectedM_A_S),e.xp6(1),e.Q6J("ngIf",t.rowCount)}}function DP(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function kP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",242)(8,"div",243)(9,"label"),e._uU(10,"Enter DataSet Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",244),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(14,DP,2,1,"div",72),e.TgZ(15,"button",231),e.NdJ("click",function(){return e.CHM(t),e.oxw().createNewDataSet()}),e._uU(16,"Add"),e.qZA(),e.TgZ(17,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDataSetPopUp=!1}),e._uU(18,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,Ke,t.submited&&t.datasetForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function FP(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",64),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function MP(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",64),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function LP(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",64),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t.tableNameUI," ")}}function IP(n,r){if(1&n&&(e.TgZ(0,"mat-option",64),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}function EP(n,r){if(1&n&&(e.TgZ(0,"mat-option",274),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.fieldName," ")}}const o_=function(n){return{fieldName:n}};function ZP(n,r){if(1&n&&(e.ynx(0),e.YNc(1,EP,2,2,"mat-option",273),e.ALo(2,"searchFilter"),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw().index,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",e.gM2(2,1,null==i.dataSetData[o]||null==i.dataSetData[o].columns[t]?null:i.dataSetData[o].columns[t].foreignKeyList,e.VKq(6,o_,i.dataSetData[o].columns[t].searchValueFK),"dataset","fk"))}}function PP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",241),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).addcolumnRowInDS(i,a)}),e._uU(1,"Column "),e.qZA()}}function OP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",275),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,a=e.oxw().index;return e.oxw(2).deletecolumnRowInDS(i,a)}),e.qZA()}}function UP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",99)(1,"div",168)(2,"div",268)(3,"mat-form-field",61)(4,"mat-select",269),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectPrimaryKeyInDS(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(2).closeDropdown(a,s,"dataset","pk")}),e.TgZ(5,"input",264),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).searchField(i,s,l,"dataset","pk")}),e.qZA(),e.YNc(6,IP,2,2,"mat-option",63),e.ALo(7,"searchFilter"),e.qZA()()(),e.TgZ(8,"div",268)(9,"mat-form-field",61)(10,"mat-select",270),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).selectForeignKeyInDS(i,s,l)})("closed",function(){const a=e.CHM(t).index,s=e.oxw().index;return e.oxw(2).closeDropdown(a,s,"dataset","fk")}),e.TgZ(11,"input",264),e.NdJ("keyup",function(i){const s=e.CHM(t).index,l=e.oxw().index;return e.oxw(2).searchField(i,s,l,"dataset","fk")}),e.qZA(),e.YNc(12,ZP,3,8,"ng-container",7),e.qZA()()(),e.TgZ(13,"div",104),e.YNc(14,PP,2,0,"button",271),e.YNc(15,OP,1,0,"button",272),e.qZA()()()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw().index,a=e.oxw(2);let s,l;e.Q6J("formGroupName",o),e.xp6(4),e.Q6J("ngClass",e.VKq(14,Ke,a.submitedDS&&(null==(s=t.get("column1"))?null:s.errors))),e.xp6(1),e.Q6J("value",a.dataSetData[i].columns[o].searchValuePK),e.xp6(1),e.Q6J("ngForOf",e.gM2(7,9,null==a.dataSetData[i]||null==a.dataSetData[i].columns[o]?null:a.dataSetData[i].columns[o].primaryKeyList,e.VKq(16,o_,a.dataSetData[i].columns[o].searchValuePK),"dataset","pk")),e.xp6(4),e.Q6J("ngClass",e.VKq(18,Ke,a.submitedDS&&(null==(l=t.get("column2"))?null:l.errors))),e.xp6(1),e.Q6J("value",a.dataSetData[i].columns[o].searchValueFK),e.xp6(1),e.Q6J("ngIf",null!=(null==a.dataSetData[i]?null:a.dataSetData[i].foreignTableList)),e.xp6(2),e.Q6J("ngIf",0==o),e.xp6(1),e.Q6J("ngIf",0!=o)}}const r_=function(n){return{tableNameUI:n}};function BP(n,r){if(1&n){const t=e.EpF();e.ynx(0,99),e.TgZ(1,"div",12)(2,"mat-form-field",262)(3,"mat-select",263),e.NdJ("closed",function(){const a=e.CHM(t).index;return e.oxw(2).closeDropdown(0,a,"dataset","pt")})("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectPrimaryTableInDS(i,s)}),e.TgZ(4,"input",264),e.NdJ("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).searchField(i,0,s,"dataset","pt")}),e.qZA(),e.YNc(5,FP,3,2,"ng-container",6),e.ALo(6,"searchFilter"),e.qZA()(),e.TgZ(7,"mat-form-field",262)(8,"mat-select",265),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectJoinTypeInDS(i,s)}),e.YNc(9,MP,3,2,"ng-container",6),e.qZA()(),e.TgZ(10,"mat-form-field",262)(11,"mat-select",266),e.NdJ("selectionChange",function(i){const s=e.CHM(t).index;return e.oxw(2).selectForeignTableInDS(i,s)})("closed",function(){const a=e.CHM(t).index;return e.oxw(2).closeDropdown(0,a,"dataset","ft")}),e.TgZ(12,"input",264),e.NdJ("keyup",function(i){const s=e.CHM(t).index;return e.oxw(2).searchField(i,0,s,"dataset","ft")}),e.qZA(),e.YNc(13,LP,3,2,"ng-container",6),e.ALo(14,"searchFilter"),e.qZA()(),e.TgZ(15,"div",267),e.YNc(16,UP,16,20,"div",98),e.qZA()(),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(2);let a,s,l;e.Q6J("formGroupName",o),e.xp6(3),e.Q6J("placeholder",i.placetable)("ngClass",e.VKq(21,Ke,i.submitedDS&&(null==(a=t.get("Ptable"))?null:a.errors))),e.xp6(1),e.Q6J("value",i.dataSetData[o].searchValuePT),e.xp6(1),e.Q6J("ngForOf",e.gM2(6,11,null==i.dataSetData[o]?null:i.dataSetData[o].primaryTableList,e.VKq(23,r_,i.dataSetData[o].searchValuePT),"dataset","pt")),e.xp6(3),e.Q6J("ngClass",e.VKq(25,Ke,i.submitedDS&&(null==(s=t.get("join"))?null:s.errors))),e.xp6(1),e.Q6J("ngForOf",i.joinType),e.xp6(2),e.Q6J("ngClass",e.VKq(27,Ke,i.submitedDS&&(null==(l=t.get("Ftable"))?null:l.errors))),e.xp6(1),e.Q6J("value",i.dataSetData[o].searchValueFT),e.xp6(1),e.Q6J("ngForOf",e.gM2(14,16,null==i.dataSetData[o]?null:i.dataSetData[o].foreignTableList,e.VKq(29,r_,i.dataSetData[o].searchValueFT),"dataset","ft")),e.xp6(3),e.Q6J("ngForOf",i.columnArrInDS(o).controls)}}function JP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",258)(3,"div",226)(4,"h4",227),e._uU(5,"Save Dataset "),e.TgZ(6,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().closeDatasetPopup()}),e.TgZ(7,"span",260),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form",161)(10,"div",261),e._UZ(11,"div"),e.YNc(12,BP,17,31,"ng-container",98),e.qZA(),e.TgZ(13,"div",245)(14,"button",231),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetDropdowns()}),e._uU(15,"Save"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.dataSetForm),e.xp6(3),e.Q6J("ngForOf",t.DataSetArr().controls)}}function qP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",276)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"View Script"),e.qZA()(),e.TgZ(6,"form",161),e._UZ(7,"textarea",277),e.qZA(),e.TgZ(8,"div",245)(9,"button",247),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.updateScriptByDatasetId(i.viewscriptForm)}),e._uU(10,"Save"),e.qZA(),e.TgZ(11,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewScriptDSPopup=!1}),e._uU(12,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.viewscriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,Ke,t.viewscriptForm.controls.sqlScript.errors))}}function RP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",276)(2,"div",278)(3,"div",226)(4,"h4",227),e._uU(5,"Upload Script"),e.qZA()(),e.TgZ(6,"form",161)(7,"input",279),e.NdJ("keyup",function(){return e.CHM(t),e.oxw().existDataset()}),e.qZA(),e._UZ(8,"textarea",280),e.qZA(),e.TgZ(9,"div",245)(10,"button",247),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveDataSetApi()}),e._uU(11,"Save"),e.qZA(),e.TgZ(12,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQLPopup=!1}),e._uU(13,"Cancel"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(3,Ke,t.submited&&t.sqlScriptForm.controls.datasetName.errors)),e.xp6(1),e.Q6J("ngClass",e.VKq(5,Ke,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function QP(n,r){if(1&n&&(e.TgZ(0,"div",80),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.submittedErrorMsg)}}function HP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",227),e._uU(5,"DataSet"),e.qZA()(),e.TgZ(6,"form",161)(7,"div",242)(8,"div",243)(9,"label"),e._uU(10,"Enter DataSet Name"),e.TgZ(11,"sup"),e._uU(12,"*"),e.qZA()(),e.TgZ(13,"input",244),e.NdJ("keyup",function(i){return e.CHM(t),e.oxw().isTableExistAppend(i)}),e.qZA()()(),e.YNc(14,QP,2,1,"div",72),e.TgZ(15,"div",245)(16,"button",231),e.NdJ("click",function(){return e.CHM(t),e.oxw().appendDatasetApi()}),e._uU(17,"Add"),e.qZA(),e.TgZ(18,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetAppendPopup=!1}),e._uU(19,"Cancel"),e.qZA()()()()()()}if(2&n){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.datasetAppendForm),e.xp6(7),e.Q6J("ngClass",e.VKq(3,Ke,t.submitted&&t.datasetAppendForm.controls.appendNameControl.errors)),e.xp6(1),e.Q6J("ngIf",t.submited)}}function YP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"label",281)(3,"input",282),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQL_PythonScript(i,a.isBtnClickedSQL_Python)}),e.qZA(),e._UZ(4,"span",21)(5,"br"),e.TgZ(6,"h5"),e._uU(7,"Upload Script"),e.TgZ(8,"sup"),e._uU(9,"*"),e.qZA()(),e.TgZ(10,"p",22),e._uU(11,"Note: only .sql and .txt files"),e.qZA()()()()}}function VP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",161),e._UZ(2,"textarea",280),e.qZA(),e.TgZ(3,"div",245)(4,"button",247),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.saveUploadScript(i.isBtnClickedSQL_Python)}),e._uU(5,"Save"),e.qZA(),e.TgZ(6,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).enableUploadSQLPopup=!1}),e._uU(7,"Cancel"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,Ke,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function $P(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",276)(2,"div",278)(3,"div",226)(4,"h4",227),e._uU(5,"Upload Script "),e.TgZ(6,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadSQL=!1}),e.TgZ(7,"span",260),e._uU(8,"\xd7"),e.qZA()()()(),e.YNc(9,YP,12,0,"div",13),e.YNc(10,VP,8,4,"div",7),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function KP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"div",18)(2,"label",281)(3,"input",282),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw(2);return a.uploadSQL_PythonScript(i,a.isBtnClickedSQL_Python)}),e.qZA(),e._UZ(4,"span",21)(5,"br"),e.TgZ(6,"h5"),e._uU(7,"Upload Script"),e.TgZ(8,"sup"),e._uU(9,"*"),e.qZA()(),e.TgZ(10,"p",22),e._uU(11,"Note: only .py and .txt files"),e.qZA()()()()}}function WP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",161),e._UZ(2,"textarea",280),e.qZA(),e.TgZ(3,"div",245)(4,"button",247),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return i.saveUploadScript(i.isBtnClickedSQL_Python)}),e._uU(5,"Save"),e.qZA(),e.TgZ(6,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).enableUploadPython=!1}),e._uU(7,"Cancel"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("formGroup",t.sqlScriptForm),e.xp6(1),e.Q6J("ngClass",e.VKq(2,Ke,t.submited&&t.sqlScriptForm.controls.sqlScript.errors))}}function zP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",276)(2,"div",278)(3,"div",226)(4,"h4",227),e._uU(5,"Upload Script "),e.TgZ(6,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableUploadPython=!1}),e.TgZ(7,"span",260),e._uU(8,"\xd7"),e.qZA()()()(),e.YNc(9,KP,12,0,"div",13),e.YNc(10,WP,8,4,"div",7),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf",t.uploadSQLBtn),e.xp6(1),e.Q6J("ngIf",!t.uploadSQLBtn)}}function GP(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"textarea",286),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(1,Ke,t.submited&&t.getViewScriptForm.controls.gscript.errors))}}function XP(n,r){if(1&n&&(e.ynx(0),e._UZ(1,"textarea",287),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(1,Ke,t.submited&&t.getViewScriptForm.controls.script.errors))}}const a_=function(n){return{activeBtn:n}};function jP(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",276)(2,"div",278)(3,"div",226)(4,"h4",227),e._uU(5,"View Script "),e.TgZ(6,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewscriptPopup=!1}),e.TgZ(7,"span",260),e._uU(8,"\xd7"),e.qZA()()()(),e.TgZ(9,"form",161),e.YNc(10,GP,2,3,"ng-container",7),e.YNc(11,XP,2,3,"ng-container",7),e.qZA(),e.TgZ(12,"div",283)(13,"button",284),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.isSQL_Python(i.isUploadScript)}),e._uU(14,"Uploaded Script"),e.qZA(),e.TgZ(15,"button",285),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.isSQL_Python(i.isManualScript)}),e._uU(16,"Manual Script"),e.qZA()(),e.TgZ(17,"button",247),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeViewScript()}),e._uU(18,"Execute"),e.qZA(),e.TgZ(19,"button",247),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateViewScript()}),e._uU(20,"Update"),e.qZA(),e.TgZ(21,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableViewscriptPopup=!1}),e._uU(22,"Cancel"),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("formGroup",t.getViewScriptForm),e.xp6(1),e.Q6J("ngIf",t.isManualScript),e.xp6(1),e.Q6J("ngIf",t.isUploadScript),e.xp6(2),e.Q6J("ngClass",e.VKq(5,a_,t.isUploadScript)),e.xp6(2),e.Q6J("ngClass",e.VKq(7,a_,t.isManualScript))}}function e8(n,r){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Are You Sure want to Delete ",t.deleteTableDetails.item.fileNameWithExt," ?")}}function t8(n,r){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Are You Sure want to Delete ",t.deleteTableDetails.item.appendName," ?")}}function n8(n,r){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Are You Sure want to Delete ",t.deleteTableDetails.item.mergeName," ?")}}function i8(n,r){if(1&n&&(e.TgZ(0,"h3"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("Are You Sure want to Delete ",t.deleteTableDetails.item.datasetName," ?")}}function o8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",288)(5,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDeletePopup=!1}),e.TgZ(6,"span",260),e._uU(7,"\xd7"),e.qZA()()()(),e.TgZ(8,"div",289),e.YNc(9,e8,2,1,"h3",7),e.YNc(10,t8,2,1,"h3",7),e.YNc(11,n8,2,1,"h3",7),e.YNc(12,i8,2,1,"h3",7),e.qZA(),e.TgZ(13,"div",290)(14,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDeletePopup=!1}),e._uU(15,"Cancel"),e.qZA(),e.TgZ(16,"button",291),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return i.deleteTable(i.deleteTableDetails.item,i.deleteTableDetails.type)}),e._uU(17,"Ok"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngIf","file"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","append"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","merge"==t.deleteTableDetails.type),e.xp6(1),e.Q6J("ngIf","dataset"==t.deleteTableDetails.type)}}function r8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",288)(5,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDeletePopup=!1}),e.TgZ(6,"span",260),e._uU(7,"\xd7"),e.qZA()()()(),e.TgZ(8,"div",289)(9,"h3"),e._uU(10,"Are you sure want to override ?"),e.qZA(),e._UZ(11,"div",292),e.qZA(),e.TgZ(12,"div",290)(13,"button",232),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableOverRideConfirmPopup=!1}),e._uU(14,"Cancel"),e.qZA(),e.TgZ(15,"button",291),e.NdJ("click",function(){return e.CHM(t),e.oxw().overrideOK()}),e._uU(16,"Ok"),e.qZA()()()()()}}function a8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",224)(2,"div",225)(3,"div",226)(4,"h4",288)(5,"button",259),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetColumnsExceed=!1}),e.TgZ(6,"span",260),e._uU(7,"\xd7"),e.qZA()()()(),e.TgZ(8,"div",289)(9,"h3"),e._uU(10),e.qZA()(),e.TgZ(11,"div",290)(12,"button",291),e.NdJ("click",function(){return e.CHM(t),e.oxw().enableDatasetColumnsExceed=!1}),e._uU(13,"Ok"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(10),e.hij("Current Dataset has ",t.saveDatasetRowsLength.length," columns. It shouldn't exceed 75 columns")}}let s8=(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u){this.popup=t,this.router=o,this.formBuilder=i,this.toast=a,this.loader=s,this.fb=l,this.renderer=c,this.solService=d,this.dialog=_,this.activatedRoute=u,this.enableAddBtn=!1,this.submited=!1,this.submit=!1,this.isOverride=!1,this.fileListt=[],this.sortedList=[],this.sortedCheckedList=[],this.mergeCheckedList=[],this.appendUnchechedList=[],this.disableContinue=!1,this.disableRelButton=!0,this.enableDataSetPopUp=!1,this.datasetDetailsList=[],this.createExpressionList=[],this.filesList=[],this.columnsArr=[],this.showUploadFilesTab=!1,this.masterSelected=!1,this.tabs=[{id:0,value:"Upload Files",isActive:!0,routeValue:"upload-files"},{id:1,value:"Target FIles",isActive:!1,routeValue:"target-files"},{id:2,value:"Append",isActive:!1,routeValue:"append"},{id:3,value:"Join",isActive:!1,routeValue:"join"},{id:4,value:"Data Modelling",isActive:!1,routeValue:"data-modeling"}],this.enableAppendNamePopup=!1,this.enableMergeNamePopup=!1,this.submitted=!1,this.targetFileRowEdit=-1,this.selectedM_A_S=[],this.showTargetFilePopup=!1,this.enableOverRideConfirmPopup=!1,this.cursorPosition=0,this.appendNameControl=new w.NI(null),this.opearatorList=[{id:0,value:"AND"},{id:1,value:"OR"}],this.signOperatorList=[],this.isOpenAccordion=!1,this.fx=[],this.allExpandState=!1,this.panelOpenState=!1,this.dataType=["int","float","char","varchar","dateTime","money","text","decimal","datetime2","decimal","nvarchar","bigint"],this.dataTypee=[{id:0,value:"int"},{id:1,value:"float"},{id:2,value:"char"},{id:3,value:"varchar"},{id:4,value:"text"},{id:5,value:"money"},{id:6,value:"dateTime"},{id:7,value:"date"},{id:8,value:"datetime2"},{id:9,value:"decimal"},{id:10,value:"nvarchar"},{id:11,value:"bigint"}],this.dateTimeFormats=["MM/dd/yyyy","MM-dd-yyyy","dd/MM/yyyy","dd-MM-yyyy","yyyy/MM/dd","yyyy-MM-dd","yyyy/dd/MM","yyyy-dd-MM","MMddyyyy","ddMMyyyy","yyyyMMdd","yyyyddMM"],this.joinType=["Inner Join","Left Join","Outer Join","Right Join","Full Join","Cross Join"],this.unCheckedListAddToMergeList=[],this.allDatasetDetailsList=[],this.relationShipPayload=[],this.selectedDateList=[],this.relationship=[],this.enableUploadSQLPopup=!1,this.placetable="Select Primary Table",this.dataSetData=[],this.showRelationshipModal=!1,this.hideCreateIdenticalBtnWithLength=!0,this.columnsForWhereInDS=[],this.isManualScript=!0,this.isUploadScript=!1,this.clickedRowDataInTF=[],this.fileTypeInTF="",this.append_SourceFilesList=[],this.appendList=[],this.sourceFilesList=[],this.enableViewScriptPopup=!1,this.joinCheckedList=[],this.submitedJ=!1,this.textAreaIndexInDM={},this.textAreaIndexinCE={},this.tablecolNameList=[],this.singleTableDatasetsave=!1,this.viewScriptFromApi="",this.submitedDS=!1,this.enableViewScriptDSPopup=!1,this.searchfx=[],this.allTableListInDM=[],this.allTableListWithoutDSInDM=[],this.selectedColumnsOfDS=[],this.saveDataSetPopup=!1,this.dropDownsInDS=[],this.enableDatasetColumnsExceed=!1,this.saveDatasetRowsLength={},this.enableDeletePopup=!1,this.sortDir=-1,this.sortOrder="desc",this.signOperatorWhereInDS=[],this.enableDatasetAppendPopup=!1,this.enableUploadSQL=!1,this.enableUploadPython=!1,this.uploadSQLBtn=!0,this.enableViewscriptPopup=!1,this.submitedRelation=!1,this.getAppendFilesList=[],this.getJoinFilesList=[],this.getOpearatorList=[],this.fileListtt=[],this.isUploadFilesNextBtnEnable=!1,this.targetFiles=[]}ngOnInit(){let t=this.activatedRoute.snapshot.paramMap.get("id");this.joinSetForm=this.formBuilder.group({Merg:this.formBuilder.array([])}),this.process=JSON.parse(localStorage.getItem("process")||"{}"),console.log(this.process),null!=this.process.processId?(this.tabs.forEach(o=>{o.routeValue==t&&this.changeTabs(o,"prev")}),this.appendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.joinForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.createExpressionList=[],this.invoiceForm1=this.fb.group({DRows1:this.fb.array([])}),this.dataSetForm=this.fb.group({DSetRows:this.fb.array([])}),this.datasetForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.viewscriptForm=this.fb.group({sqlScript:[""],datasetId:[""]}),this.sqlScriptForm=this.fb.group({datasetName:["",w.kI.required],sqlScript:["",w.kI.required]}),this.datasetTableForm=this.fb.group({groupBy:[""],having:[""],orderBy:[""],where:this.fb.array([this.whereFirstRow()])}),this.datasetAppendForm=this.formBuilder.group({appendNameControl:["",w.kI.required]}),this.getViewScriptForm=this.formBuilder.group({script:["",w.kI.required],solutionScriptId:[""],type:[""],gscript:[""]}),this.createExpressionForm=this.fb.group({sourceFieldName:["",w.kI.required],columnType:[[],w.kI.required],columnFormat:[[]],excludeInSelect:[!1],sourceExpressionName:[""]}),this.addRelationshipForm=this.fb.group({addRelationshipRows:this.fb.array([this.addRelationshipRow()])})):this.router.navigate(["/user/admin1/add-process"])}ngAfterViewInit(){}validateDatasetname(){return t=>{var o;const s=null===(o=this.datasetForm.get("appendNameControl"))||void 0===o?void 0:o.value;return this.solService.getExistDataset(s,"").subscribe(c=>{this.submitted=!1,this.submittedErrorMsg=""},c=>{this.submitted=!0,this.submittedErrorMsg="Dataset Name Already Exists"}),(0,xt.of)(null)}}previewPopup(t){this.rowCount="",""!=t&&(this.loader.show(),this.solService.viewTableDetails(t).subscribe(o=>{null!=o.responseData?(this.selectedM_A_S=o.responseData.tableDetails,this.rowCount=o.responseData.count,this.preview(),this.showTargetFilePopup=!0):this.popup.open(!1,o.statusMessage),this.loader.hide()},o=>{this.popup.open(!1,"Table not created!!"),this.loader.hide()}))}preview(){for(var t in this.columnsArr=[],this.selectedM_A_S[0])this.selectedM_A_S[0].hasOwnProperty(t)&&this.columnsArr.push(t)}searchField(t,o,i,a,s){"dataset"==a&&("pt"==s?this.dataSetData[i].searchValuePT=t.target.value:"ft"==s?this.dataSetData[i].searchValueFT=t.target.value:"pk"==s?this.dataSetData[i].columns[o].searchValuePK=t.target.value:"fk"==s&&(this.dataSetData[i].columns[o].searchValueFK=t.target.value))}closeDropdown(t,o,i,a){"dataset"==i&&("pt"==a?this.dataSetData[o].searchValuePT="":"ft"==a?this.dataSetData[o].searchValueFT="":"pk"==a?this.dataSetData[o].columns[t].searchValuePK="":"fk"==a&&(this.dataSetData[o].columns[t].searchValueFK=""))}getAllFileTemplateListByProcessID(){this.loader.show(),this.solService.getAllFileTemplateListByProcessID(this.process.processId).subscribe(t=>{this.showUploadFilesTab=!0;const o=t.responseData.totalfileDetails;0==o.length?this.showUploadFilesTab=!1:(o.forEach(i=>{i.totalSheetList.forEach(a=>{var s;const l=a.sheetName;null===(s=a.sheet)||void 0===s||s.forEach(c=>{c.isChecked=!1,c.tableName=a.tableName,"xlsx"==i.fileExt||"xls"==i.fileExt?c.showTabColName=i.fileName+"-"+l+"."+i.fileExt+"["+c.fieldName+"]":("txt"==i.fileExt||"csv"==i.fileExt)&&(c.showTabColName=i.fileNameWithExt+"["+c.fieldName+"]"),c.fileExt=i.fileExt})})}),this.fileListt=o,this.isAllSelectedUploadFiles()),this.loader.hide()},t=>{this.showUploadFilesTab=!1,this.fileListt.forEach((o,i)=>{o.isProgressBar&&this.fileListt.splice(i,1)}),this.loader.hide()})}saveiputFiles(t){this.showUploadFilesTab=!0;let o=this.process.processId,i=["xlsx","xls","txt","csv","json","jpeg","png","jpg","pdf"];for(let s=0;s<t.target.files.length;s++){const l=t.target.files[s];i.includes(l.name.split(".")[1])&&this.fileListt.push({fileNameWithExt:l.name.split(".")[0],isProgressBar:!0,fileExt:l.name.split(".")[1]})}let a=[];for(let s=0;s<t.target.files.length;s++)if(i.includes(t.target.files[s].name.split(".")[1])){const c=new FormData;c.append("processId",o),c.append("file",t.target.files[s]),a.push(this.solService.postInputFiles(c).pipe((0,Kr.K)(d=>(0,xt.of)({error:d,isError:!0}))))}console.log(a),(0,Ji.D)(a).subscribe(s=>{console.log(s),this.getAllFileTemplateListByProcessID()})}isAllSelectedUploadFiles(){let t=1;this.fileListt.forEach(o=>{o.totalSheetList.forEach(i=>{0!=i.sheetSelected||(t=0)})}),this.masterSelected=0!=t,console.log(this.fileListt),this.nextBtnEnableInUF()}checkUncheckAllUploadFiles(){this.fileListt.forEach(t=>{var o;null===(o=null==t?void 0:t.totalSheetList)||void 0===o||o.forEach(i=>{i.sheetSelected=this.masterSelected})}),this.nextBtnEnableInUF()}nextBtnEnableInUF(){this.isUploadFilesNextBtnEnable=0==this.fileListt.filter(o=>{var i;return null===(i=o.totalSheetList)||void 0===i?void 0:i.some(a=>1==a.sheetSelected)}).map(o=>Object.assign({},o,{totalSheetList:o.totalSheetList.filter(i=>1==i.sheetSelected)})).length}fileClickedinTF(t,o,i,a){this.targetFiles.forEach(s=>{s.sheetList.forEach(l=>{l.isRowTabAvtive=!1})}),i.isRowTabAvtive=!0,this.fileTypeInTF=a,0==o?this.clickedRowDataInTF=i.tableAppendFieldsDto:1==o?this.clickedRowDataInTF=i.mergeFieldListDTO:2==o&&(this.clickedRowDataInTF=i.sheet)}getTargetFileList(){this.targetFiles=[],this.loader.show(),this.solService.getTargetFileList(this.process.processId).subscribe(t=>{var o,i,a,s,l;null===(o=t.responseData.appendSheetListDto)||void 0===o||o.appendSheetList.forEach(_=>{_.tableNameUI=_.appendName,_.isSelectAllParentInDM=!1,_.tableAppendFieldsDto.forEach(u=>{u.isSelectAllChildInDM=!1,u.fileType=_.type,u.showTabColName=_.appendName+"["+u.fieldName+"]",u.isDropdownDirtyInTF=!1})}),null===(i=t.responseData.templateMergeListDTO)||void 0===i||i.templatesMergeDetailsList.forEach(_=>{_.isSelectAllParentInDM=!1,_.mergeFieldListDTO.forEach(u=>{u.isSelectAllChildInDM=!1,u.showTabColName=_.mergeName+"["+u.fieldName+"]",u.isDropdownDirtyInTF=!1})});let c=null===(a=t.responseData.templateFileDetailsListDto)||void 0===a?void 0:a.totalfileDetails;c.forEach(_=>{_.totalSheetList.forEach(u=>{var f;const m=u.sheetName;null===(f=u.sheet)||void 0===f||f.forEach(h=>{h.tableName=u.tableName,h.isDropdownDirtyInTF=!1,h.type="template","xlsx"==_.fileExt||"xls"==_.fileExt?h.showTabColName=_.fileName+"-"+m+"."+_.fileExt+"["+h.fieldName+"]":("txt"==_.fileExt||"csv"==_.fileExt||"json"==_.fileExt)&&(h.showTabColName=_.fileNameWithExt+"["+h.fieldName+"]"),h.fileExt=_.fileExt})})});const d=[];c.forEach(_=>{_.isSelectAllParentInDM=!1,_.totalSheetList.forEach(u=>{var f;u.sheetSelected&&(null===(f=u.sheet)||void 0===f||f.forEach(m=>{m.isSelectAllChildInDM=!1}),u.type="template",null!=u.sheet&&("xlsx"==u.fileExt||"xls"==u.fileExt?d.push(Object.assign(Object.assign({fileExt:u.fileExt,fileName:_.fileName+"-"+u.sheetName+"."+_.fileExt},u),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:_.fileName+"-"+u.sheetName+"."+_.fileExt})):("csv"==u.fileExt||"txt"==u.fileExt||"json"==u.fileExt)&&d.push(Object.assign(Object.assign({fileExt:u.fileExt,fileName:_.fileNameWithExt},u),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:_.fileNameWithExt}))))})}),this.targetFiles=[{fileType:"append",sheetList:null===(s=t.responseData.appendSheetListDto)||void 0===s?void 0:s.appendSheetList},{fileType:"join",sheetList:null===(l=t.responseData.templateMergeListDTO)||void 0===l?void 0:l.templatesMergeDetailsList},{fileType:"files",sheetList:d}],console.log(this.targetFiles,"this.targetFiles"),this.sourceFilesList=d,this.allList(),this.loader.hide()},t=>{this.loader.hide()})}selectDropDownInTF(t,o){o.isDropdownDirtyInTF=!0}isCheckedInAppend(t){this.submitted=!1,this.submittedErrorMsg=""}addAppend(){console.log("this.sourceFilesList",this.sourceFilesList);let t=this.sourceFilesList.filter(a=>a.isCheckedInAppend);if(t.length<2)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");let o=0,i=[];if(t.forEach(a=>{if(0==i.length)i=a.sheet.map(s=>s.fieldName);else{let s=[];s=a.sheet.map(l=>l.fieldName),i.forEach(l=>{s.includes(l)||(o=1)})}}),1==o)return this.submitted=!0,void(this.submittedErrorMsg="Ensure that the files with identical columns are selected for appending");this.enableAppendNamePopup=!0,this.appendForm.reset()}isTableExistAppend(t){this.submited=!1,this.submittedErrorMsg=""}isTableExist(t,o){this.loader.show(),this.solService.getExistDataset(t,o).subscribe(i=>{this.loader.hide(),this.enableAddBtn=!1,this.submited=!1,this.submittedErrorMsg="",this.appendForm.controls.appendNameControl.setValidators([]),this.appendForm.controls.appendNameControl.updateValueAndValidity(),this.postAddAppendFiles(t),console.log(i)},i=>{this.loader.hide(),this.enableAddBtn=!1,this.submited=!0,this.submittedErrorMsg="Append Name Already Exist!!!",this.appendForm.controls.appendNameControl.setValidators([w.kI.required]),this.appendForm.controls.appendNameControl.updateValueAndValidity()})}addAppendApi(){var t;this.enableAddBtn=!0;let o=null===(t=this.appendForm.get("appendNameControl"))||void 0===t?void 0:t.value;this.submited=!0,console.log(this.appendForm),!this.appendForm.invalid&&this.isTableExist(o,"append")}postAddAppendFiles(t){let o=[];this.sourceFilesList.forEach(a=>{a.isCheckedInAppend&&o.push({sheetId:a.templateId,fileName:a.fileName})}),this.solService.addAppendFiles({processId:this.process.processId,appendSheetList:[{appendDtos:o,appendName:t}]}).subscribe(a=>{this.getAppendFilesApi(),this.appendForm.reset(),this.sourceFilesList.forEach(s=>s.isCheckedInAppend=!1),this.enableAppendNamePopup=!1,this.popup.open(!0,"Saved Successfully !"),this.loader.hide()},a=>{this.loader.hide()})}Merg(){return this.formBuilder.group({tableControl:this.formBuilder.array([])})}addTable(){return this.formBuilder.group({table1:["",w.kI.required],join:["",w.kI.required],table2:["",w.kI.required],column:this.formBuilder.array([])})}addColumn(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}MergeArr(){return this.joinSetForm.get("Merg")}TableArr(t){return this.MergeArr().controls[t].get("tableControl")}columnArr(t,o){return this.TableArr(t).controls[o].get("column")}addMergeJoin(){this.MergeArr().push(this.Merg());let t=this.MergeArr().length;this.TableArr(t-1).push(this.addTable());let o=this.TableArr(t-1).length;this.columnArr(t-1,o-1).push(this.addColumn())}addTableJoins(t,o){var i,a,s;let l=this.joinCheckedList[t].dropDownList.length,c=this.TableArr(t).length;if(0==this.joinCheckedList[t].dropDownList[l-1].foreignTableList.length||""==(null===(i=this.TableArr(t).controls[c-1].get("table1"))||void 0===i?void 0:i.value)||""==(null===(a=this.TableArr(t).controls[c-1].get("table2"))||void 0===a?void 0:a.value))return;this.TableArr(t).push(this.addTable());let d=this.TableArr(t).length;this.columnArr(t,d-1).push(this.addColumn()),console.log(null===(s=this.joinCheckedList[t])||void 0===s?void 0:s.dropDownList)}addColumnJoin(t,o){var i,a;let s=this.columnArr(t,o).controls.length;""==(null===(i=this.columnArr(t,o).controls[s-1].get("column1"))||void 0===i?void 0:i.value)||""==(null===(a=this.columnArr(t,o).controls[s-1].get("column2"))||void 0===a?void 0:a.value)||0==this.joinCheckedList[t].dropDownList[o].columns[s].primaryKeyList.length||0==this.joinCheckedList[t].dropDownList[o].columns[s].foreignKeyList.length||this.columnArr(t,o).push(this.addColumn())}removeCol(t,o,i){for(let a=i;a<=this.joinCheckedList[t].dropDownList[o].columns.length;a++)this.columnArr(t,o).removeAt(a);this.joinCheckedList[t].dropDownList[o].columns.splice(i+1,this.joinCheckedList[t].dropDownList[o].columns.length)}removeTable(t,o){console.log("removeTable()",t,o);for(let i=o;i<=this.joinCheckedList[t].dropDownList.length;i++)this.TableArr(t).removeAt(o);this.joinCheckedList[t].dropDownList.splice(o+1,this.joinCheckedList[t].dropDownList.length),console.log(this.joinCheckedList[t].dropDownList)}resetJoin(){this.joinCheckedList=[],this.append_SourceFilesList.forEach(t=>t.isCheckedInJoin=!1)}saveJoin(){}MergeSubmit(){this.submitedJ=!0;let t=0;if(this.MergeArr().controls.forEach((a,s)=>{this.TableArr(s).controls.forEach(l=>{l.invalid&&(t=1)})}),1==t)return void this.toast.error({title:"Error",message:"Enter all the required fields"});console.log(this.joinSetForm.value,this.process.processId);let o={};o.processId=this.process.processId,o.templatesMergeDetailsList=[];let i=[];this.MergeArr().controls.forEach((a,s)=>{o.templatesMergeDetailsList[s]={},o.templatesMergeDetailsList[s].mergeName=this.joinCheckedList[s].joinName,o.templatesMergeDetailsList[s].templatesMergeList=[],o.templatesMergeDetailsList[s].mergeTableDetails=[],i=[],a.controls.tableControl.controls.forEach((l,c)=>{l.controls.table1&&i.push(l.controls.table1.value),l.controls.table2&&i.push(l.controls.table2.value)}),i=[...new Set(i)],i.forEach((l,c)=>{o.templatesMergeDetailsList[s].mergeTableDetails[c]={},"template"==l.type?(o.templatesMergeDetailsList[s].mergeTableDetails[c].id=l.templateId,o.templatesMergeDetailsList[s].mergeTableDetails[c].type="T"):"Append"==l.type&&(o.templatesMergeDetailsList[s].mergeTableDetails[c].id=l.appendID,o.templatesMergeDetailsList[s].mergeTableDetails[c].type="A")}),this.TableArr(s).controls.forEach((l,c)=>{o.templatesMergeDetailsList[s].templatesMergeList[c]={},"Append"==l.value.table1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].primaryTemplateId=l.value.table1.appendID),"Append"==l.value.table2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].secondaryTemplateId=l.value.table2.appendID),"template"==l.value.table1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].primaryTemplateId=l.value.table1.templateId),"template"==l.value.table2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].secondaryTemplateId=l.value.table2.templateId),o.templatesMergeDetailsList[s].templatesMergeList[c].primaryTableName=l.value.table1.tableNameDB,o.templatesMergeDetailsList[s].templatesMergeList[c].secondaryTableName=l.value.table2.tableNameDB,o.templatesMergeDetailsList[s].templatesMergeList[c].joinType=l.value.join[0],o.templatesMergeDetailsList[s].templatesMergeList[c].order=0==c?1:2,o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList=[],this.columnArr(s,c).controls.forEach((d,_)=>{o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_]={},"append"==d.value.column1.fileType&&(o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].primaryKeyId=d.value.column1.fieldID),"append"==d.value.column2.fileType&&(o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].secondaryKeyId=d.value.column2.fieldID),"template"==d.value.column1.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].primaryKeyId=d.value.column1.columnId),"template"==d.value.column2.type&&(o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].secondaryKeyId=d.value.column2.columnId),o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].primaryFieldName=d.value.column1.columnName,o.templatesMergeDetailsList[s].templatesMergeList[c].columnArrayList[_].secondaryFieldName=d.value.column2.columnName})})}),console.log(o),this.solService.addJoinFiles(o).subscribe(a=>{console.log(a),this.joinCheckedList=[],this.joinSetForm.controls.Merg=this.fb.array([]),this.getJoinFilesListApi(),this.popup.open(!0,"Saved Successfully !"),this.loader.hide()},a=>{this.loader.hide()})}join2Sheets(){var t;if(this.submitedJ=!1,this.append_SourceFilesList.filter(i=>i.isCheckedInJoin).length<2)return this.submitted=!0,void(this.submittedErrorMsg="Please select atleast two sheets");this.enableMergeNamePopup=!0,null===(t=this.joinForm.get("appendNameControl"))||void 0===t||t.reset()}addJoin(){var t;let o=null===(t=this.joinForm.get("appendNameControl"))||void 0===t?void 0:t.value;this.submited=!0,console.log(this.joinForm),!this.joinForm.invalid&&(this.loader.show(),this.solService.getExistDataset(o,"merge").subscribe(i=>{this.loader.hide(),this.submited=!1,this.submittedErrorMsg="",this.addJoinCreate(o),console.log(i)},i=>{this.loader.hide(),this.submited=!0,this.submittedErrorMsg="Join Name Already Exist!!!"}))}addJoinCreate(t){this.addMergeJoin();let o=this.append_SourceFilesList.filter(l=>l.isCheckedInJoin);const i=[];o.forEach(l=>{"Append"==l.type?i.push({tableNameUI:l.tableNameUI,tableNameDB:l.tableName,sheet:l.tableAppendFieldsDto,isSelected:!1,type:"Append",appendID:l.appendID}):"files"==l.type&&i.push({tableNameUI:l.tableNameUI,tableNameDB:l.tableName,sheet:l.sheet,isSelected:!1,fileExt:l.fileExt,type:"template",templateId:l.templateId})}),this.joinCheckedList.push({dropDownList:[{primaryTableList:i,foreignTableList:[],columns:[{primaryKeyList:[],foreignKeyList:[]}]}],joinName:t}),console.log(this.joinCheckedList),this.append_SourceFilesList.forEach(l=>l.isCheckedInJoin=!1),this.enableMergeNamePopup=!1}checkedInJoin(t){this.submitted=!1,this.submittedErrorMsg=""}selectPrimaryTable(t,o,i){var a,s,l,c;let _=this.joinCheckedList[i].dropDownList[o];if(_.columns[0].primaryKeyList=t.value.sheet,this.removeTable(i,o+1),this.joinCheckedList[i].dropDownList.splice(o+1,this.joinCheckedList[i].dropDownList.length),this.removeCol(i,o,1),this.joinCheckedList[i].dropDownList[o].columns.splice(2,this.joinCheckedList[i].dropDownList[o].columns.length),null===(a=this.TableArr(i).controls[o].get("table2"))||void 0===a||a.reset(),null===(s=this.TableArr(i).controls[o].get("column"))||void 0===s||s.reset(),0==o){let u=null===(l=this.TableArr(i).controls[o].get("table1"))||void 0===l?void 0:l.value.tableNameDB;_.foreignTableList=[],this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.foreignTableList.push(f)})}console.log(null===(c=this.joinCheckedList[i])||void 0===c?void 0:c.dropDownList[o])}selectForeignTable(t,o,i){var a,s,l;let c=this.joinCheckedList[i].dropDownList[o];console.log("selectForeignTable()",i,o),this.removeTable(i,o+1),this.joinCheckedList[i].dropDownList.splice(o+1,this.joinCheckedList[i].dropDownList.length),this.removeCol(i,o,1),this.joinCheckedList[i].dropDownList[o].columns.splice(2,this.joinCheckedList[i].dropDownList[o].columns.length),c.columns[0].foreignKeyList=t.value.sheet;let d=[],_=[];if(0==o){d.push(null===(a=this.TableArr(i).controls[o].get("table1"))||void 0===a?void 0:a.value),d.push(null===(s=this.TableArr(i).controls[o].get("table2"))||void 0===s?void 0:s.value);let u=d.map(f=>f.tableNameDB);this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.push(f)}),this.joinCheckedList[i].dropDownList[o+1]={primaryTableList:d,foreignTableList:_,columns:[{primaryKeyList:[],foreignKeyList:[]}]}}else{c.primaryTableList.forEach(f=>{d.push(f)}),d.push(null===(l=this.TableArr(i).controls[o].get("table2"))||void 0===l?void 0:l.value);let u=d.map(f=>f.tableNameDB);this.joinCheckedList[i].dropDownList[0].primaryTableList.forEach(f=>{u.includes(f.tableNameDB)||_.push(f)}),this.joinCheckedList[i].dropDownList[o+1]={primaryTableList:d,foreignTableList:_,columns:[{primaryKeyList:[],foreignKeyList:[]}]}}console.log(this.joinCheckedList[i].dropDownList[o+1])}selectPrimarykey(t,o,i,a){this.joinCheckedList[a].dropDownList[i].columns.splice(o+2,this.joinCheckedList[a].dropDownList[i].columns.length),this.removeCol(a,i,o+1);let l=JSON.parse(JSON.stringify(this.joinCheckedList[a].dropDownList[i].columns[o].primaryKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.joinCheckedList[a].dropDownList[i].columns[o+1]?this.joinCheckedList[a].dropDownList[i].columns.push({primaryKeyList:l}):this.joinCheckedList[a].dropDownList[i].columns[o+1].primaryKeyList=l}selectForeignKey(t,o,i,a){this.joinCheckedList[a].dropDownList[i].columns.splice(o+2,this.joinCheckedList[a].dropDownList[i].columns.length),this.removeCol(a,i,o+1);let l=JSON.parse(JSON.stringify(this.joinCheckedList[a].dropDownList[i].columns[o].foreignKeyList));l.forEach((c,d)=>{c.columnId==t.value.columnId&&l.splice(d,1)}),null==this.joinCheckedList[a].dropDownList[i].columns[o+1]?this.joinCheckedList[a].dropDownList[i].columns.push({foreignKeyList:l}):this.joinCheckedList[a].dropDownList[i].columns[o+1].foreignKeyList=l}selectJoin(t,o,i){this.joinCheckedList[i].dropDownList[o].joinType=t.value,console.log(this.joinCheckedList[i].dropDownList)}DataSetArr(){return this.dataSetForm.get("DSetRows")}DataSetRow(){return this.formBuilder.group({Ptable:["",w.kI.required],join:["",w.kI.required],Ftable:["",w.kI.required],columns:this.formBuilder.array([this.addColumnInDS()])})}addColumnInDS(){return this.formBuilder.group({column1:["",w.kI.required],column2:["",w.kI.required]})}columnArrInDS(t){return this.DataSetArr().controls[t].get("columns")}isValidName(){return t=>{var o;let i=!0;return""==(null===(o=this.appendForm.get("appendNameControl"))||void 0===o?void 0:o.value)&&(i=!1),(0,xt.of)(i?null:{invalid:!0})}}getAllFunctions(){this.solService.getAllFunctions().subscribe(t=>{this.fx=t.responseData,this.searchfx=t.responseData,console.log(t),this.loader.hide()},t=>{this.loader.hide()})}addOpearatorValueFields(t,o){o.whereList.push({signOperatorList:o.signOperatorList,opearatorList:this.opearatorList,value:""})}delOpearatorValueFields(t,o,i,a){this.createExpressionList[i].whereList.splice(t,1)}changeSignOperator(t,o,i,a,s,l){const c=t.value;"parent"==l?this.createExpressionList[a].signOperator=c:i.signOperator=c}changeOperator(t,o,i,a,s){i.operator=t.value}rowClickedDataModeling(t,o,i,a){this.textAreaSlice("["+o.fieldName+"]")}textAreaSlice(t){var o;const i=this.textAreaIndexinCE.value,a=this.textAreaIndexinCE.cursorPosition,s=[i.slice(0,a),t,i.slice(a)].join("");this.createExpressionList[this.textAreaIndexinCE.index].sourceExpressionName=s,null===(o=this.createExpressionForm.get("sourceExpressionName"))||void 0===o||o.patchValue(s)}textAreaInDataModeling(t,o){const i=t.target.selectionStart;t.target.value.substr(i,t.target.selectionEnd-i),this.textAreaIndexInDM={index:o,cursorPosition:i,value:t.target.value}}toggleAllSelection(t){var o;const i=this.datasetDetailsList.filter(a=>a.isDatasetTableExpand);t.checked?null===(o=this.datasetTableForm.get("groupBy"))||void 0===o||o.patchValue([...i[0].groupBytoDB.map(a=>a.dbtablefieldName)]):this.datasetTableForm.controls.groupBy.patchValue([])}createNewDataSet(){var t;let o=null===(t=this.datasetForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim();this.loader.show(),this.solService.getExistDataset(o,"dataset").subscribe(i=>{this.loader.hide(),this.submited=!1,this.submittedErrorMsg="",this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],this.enableDataSetPopUp=!1,this.datasetDetailsList.push({isDatasetTableExpand:!0,having:"",groupBytoDB:[],orderBytoDB:[],datasetName:o,datasetFieldDTOList:[],orderBy:"",groupBy:""}),console.log(i)},i=>{this.loader.hide(),this.submited=!0,this.submittedErrorMsg="Dataset Name Already Exist!!!"})}saveDataSetDropdowns(){this.saveDataSetApi()}accordionFilesRowClicked(t,o,i,a,s){var l,c;const d=i.showTabColName,_=i.columnType;"textArea"==this.textAreaIndexinCE.tagType&&this.textAreaSlice(d),"input"==this.textAreaIndexinCE.tagType&&(this.createExpressionList[this.textAreaIndexinCE.index].fileType=s,null===(l=this.createExpressionForm.get("sourceFieldName"))||void 0===l||l.patchValue(d),null===(c=this.createExpressionForm.get("columnType"))||void 0===c||c.patchValue(_),this.createExpressionList[this.textAreaIndexinCE.index].sqlColumn=i.sqlColumn,this.createExpressionList[0].isColumnType="date"==_||"datetime2"==_||"dateTime"==_)}inputInCreateExpression(t,o){this.createExpressionList[o].sourceFieldName=t.target.value.trim(),this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"input"}}textAreaInCreateExpression(t,o){this.createExpressionList[o].sourceExpressionName=t.target.value,this.textAreaIndexinCE={index:o,cursorPosition:t.target.selectionStart,value:t.target.value,tagType:"textArea"}}createDataSetinDM(){var t;console.log("this.datasetDetailsList",this.datasetDetailsList),console.log("this.allDatasetDetailsList",this.allDatasetDetailsList),this.unChecksAllInDM(!1),this.createExpressionForm.reset(),1!=this.datasetDetailsList.filter(i=>1==i.isDatasetTableExpand).length&&(this.enableDataSetPopUp=!0,null===(t=this.datasetForm.get("appendNameControl"))||void 0===t||t.reset())}accordionExpValue(t,o){this.textAreaSlice(t.functionType),this.isOpenAccordion=!1}changeDTinCreateExpression(t,o){this.createExpressionList[o].columnType=t.value,"date"==t.value||"datetime2"==t.value||"datetime"==t.value?(this.createExpressionList[o].isColumnType=!0,this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]):this.createExpressionList[o].isColumnType=!1,("char"==t.value||"varchar"==t.value||"text"==t.value||"nvarchar"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"LIKE"},{id:3,value:"NOT LIKE"},{id:4,value:"NOT IN"},{id:5,value:"IN"}]),("int"==t.value||"float"==t.value||"money"==t.value||"decimal"==t.value||"bigint"==t.value)&&(this.signOperatorList=[{id:0,value:"IS NULL"},{id:1,value:"IS NOT NULL"},{id:2,value:"IN"},{id:3,value:"NOT IN"},{id:4,value:"="},{id:5,value:"!="},{id:6,value:">="},{id:7,value:">"},{id:8,value:"<"},{id:9,value:"<="}]),this.createExpressionList[o].whereList=[]}changeDateTimeinCreateExpression(t,o){this.createExpressionList[o].columnFormat=t.value.value}datasetTableExpand(t,o){this.datasetDetailsList[o].isDatasetTableExpand=!0,t.isDatasetTableExpand=t.isDatasetTableExpand=!0}editRowInDataSet(t,o,i){this.datasetDetailsList[t].datasetFieldDTOList.forEach(a=>a.isEdit=!1),i.isEdit=!0,this.createExpressionList=[],this.createExpressionForm.patchValue(1==i.isColumnType?{sourceFieldName:i.sourceFieldName,excludeInSelect:i.excludeInSelect,columnType:i.columnType,columnFormat:i.columnFormat,sourceExpressionName:i.sourceExpressionName}:{sourceFieldName:i.sourceFieldName,excludeInSelect:i.excludeInSelect,columnType:i.columnType,sourceExpressionName:i.sourceExpressionName}),this.createExpressionList.push(JSON.parse(JSON.stringify(i)))}deleteRowInDataset(t,o,i){var a,s,l;1==this.datasetDetailsList[t].datasetFieldDTOList[o].isEdit&&(this.createExpressionList=[{sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}]),null===(a=this.datasetDetailsList[t])||void 0===a||a.datasetFieldDTOList.splice(o,1),null===(s=this.datasetDetailsList[t])||void 0===s||s.orderBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.orderBytoDB.splice(d,1))}),null===(l=this.datasetDetailsList[t])||void 0===l||l.groupBytoDB.forEach((c,d)=>{var _;i.sourceFieldName==c.filefieldName&&(null===(_=this.datasetDetailsList[t])||void 0===_||_.groupBytoDB.splice(d,1))}),this.columnsForWhereInDS.forEach((c,d)=>{i.sourceFieldName==c.filefieldName&&this.columnsForWhereInDS.splice(d,1)}),this.UpdatechecksInDM(i,!1)}getAllDataSetNameAPI(){this.solService.getAllDatasetName(this.process.processId).subscribe(t=>{null!=t&&(t.responseData.forEach(o=>{o.isSelectAllParentInDM=!1;const i=[];o.datasetFieldDTOList.forEach(a=>{a.isSelectAllChildInDM=!1,a.showTabColName=o.datasetName+"["+a.fieldName+"]",a.isColumnType="date"==a.columnType||"datetime2"==a.columnType||"datetime"==a.columnType,a.isEdit=!1,a.or="";const l=a.tableName+"."+a.columnName;""==a.where.split(" ").join().split(l).join().split(",").join()&&i.push({filefieldName:a.sourceFieldName,dbtablefieldName:a.tableName+"."+a.columnName})}),o.isDatasetTableExpand=!1,o.orderBytoDB=i,o.groupBytoDB=i}),this.allDatasetDetailsList=t.responseData,t.responseData.forEach(o=>{o.datasetFieldDTOList.forEach(i=>{i.fileType="dataset",i.fieldIDforExpn=i.datasetFieldId}),this.allTableListInDM.push({fileType:"dataset",tableNameUI:o.datasetName,tableNameDB:o.tableName,idName:"datasetId",ID:o.datasetId,columnList:o.datasetFieldDTOList,isSelecteddl:!1})}),console.log("getalldsapi",this.allTableListInDM)),this.tablecolNameList=[],this.tablecolNameList=this.allTableListInDM.map(o=>o.columnList.map(i=>({tableNameUI:o.tableNameUI,tableNameDB:o.tableNameDB,fileType:o.fileType,fieldID:o.fieldID,showTabColName:i.showTabColName,fieldIDforExpn:i.fieldIDforExpn,tableColumnName:i.tableColumnName,columnName:i.columnName}))).reduce((o,i)=>o.concat(i),[]),this.loader.hide()},t=>{this.loader.hide()})}deleteDataSet(t){this.datasetDetailsList.splice(t,1),this.createExpressionList=[],this.datasetDetailsList=[],this.clearWhereInDS()}isAllSelected(t,o,i,a){this.submitted=!1,this.submittedErrorMsg="",this.hideCreateIdenticalBtnWithLength=!0,this.sortedList.forEach((s,l)=>{l==i&&s.forEach((c,d)=>{d==a&&(c.isSelected=t.target.checked)})})}saveDataSetApi(){var o,i,a,t=this;this.loader.show();let s={};if(s.processId=this.process.processId,this.enableUploadSQLPopup){if(this.submited=!0,this.sqlScriptForm.invalid)return;s.datasetName=this.sqlScriptForm.value.datasetName,s.sqlScript=this.sqlScriptForm.value.sqlScript,this.solService.addDataset(s).subscribe(function(){var l=(0,$e.Z)(function*(c){yield t.getAllDataSetNameAPI(),t.enableUploadSQLPopup=!1,t.loader.hide()});return function(c){return l.apply(this,arguments)}}(),l=>{this.loader.hide()})}else{this.submitedDS=!0;let l=0;if(this.DataSetArr().controls.forEach(p=>{p.invalid&&(l=1)}),1==l)return void this.popup.open(!1,"Enter all the required fields");s.dataSetMergeListDTOs=[],this.DataSetArr().controls.forEach((p,g)=>{s.dataSetMergeListDTOs[g]={},("append"==p.value.Ptable.fileType||"join"==p.value.Ptable.fileType||"files"==p.value.Ptable.fileType||"dataset"==p.value.Ptable.fileType)&&(s.dataSetMergeListDTOs[g].primaryTemplateId=p.value.Ptable.ID),("append"==p.value.Ftable.fileType||"join"==p.value.Ftable.fileType||"files"==p.value.Ftable.fileType||"dataset"==p.value.Ftable.fileType)&&(s.dataSetMergeListDTOs[g].secondaryTemplateId=p.value.Ftable.ID),s.dataSetMergeListDTOs[g].primaryTableName=p.value.Ptable.tableNameDB,s.dataSetMergeListDTOs[g].secondaryTableName=p.value.Ftable.tableNameDB,s.dataSetMergeListDTOs[g].columnArrayList=[],this.columnArrInDS(g).controls.forEach((v,x)=>{s.dataSetMergeListDTOs[g].columnArrayList[x]={},"append"==v.value.column1.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.fieldID:"join"==v.value.column1.fileType||"files"==v.value.column1.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.columnId:"dataset"==v.value.column1.fileType&&(s.dataSetMergeListDTOs[g].columnArrayList[x].primaryKeyId=v.value.column1.datasetFieldId),"append"==v.value.column2.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.fieldID:"join"==v.value.column2.fileType||"files"==v.value.column2.fileType?s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.columnId:"dataset"==v.value.column2.fileType&&(s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryKeyId=v.value.column2.datasetFieldId),s.dataSetMergeListDTOs[g].columnArrayList[x].primaryFieldName=v.value.column1.columnName,s.dataSetMergeListDTOs[g].columnArrayList[x].secondaryFieldName=v.value.column2.columnName}),s.dataSetMergeListDTOs[g].joinType=p.value.join.slice(0,1),s.dataSetMergeListDTOs[g].order=g,console.log(p.value,p),console.log(p.controls.Ptable.value)});const c=[],d=this.datasetDetailsList.filter(p=>p.isDatasetTableExpand);d[0].datasetFieldDTOList.forEach(p=>{null!=p.sourceExpressionName&&(""==p.sourceExpressionName.trim()||0==p.sourceExpressionName.trim().length)&&(p.sourceExpressionName=null);let v,g=p.sourceExpressionName;null!=g&&this.tablecolNameList.forEach(x=>{g.includes(x.showTabColName)&&(g=JSON.parse(JSON.stringify(g.split(x.showTabColName).join(x.tableColumnName))),v=x.tableNameDB)}),null==p.tableName&&(p.tableName=v),p.isColumnType||(p.columnFormat=null),c.push({tableName:p.tableName,columnFormat:p.columnFormat,excludeInSelect:p.excludeInSelect,columnName:p.columnName,fieldName:p.fieldName,expression:g,columnType:p.columnType,where:p.where,or:p.or,groupBy:"",sourceFieldName:p.sourceFieldName,sourceExpressionName:p.sourceExpressionName})}),s.datasetFieldDTOList=c,s.datasetName=d[0].datasetName;let _=null===(o=this.datasetTableForm.get("groupBy"))||void 0===o?void 0:o.value,u=null===(i=this.datasetTableForm.get("having"))||void 0===i?void 0:i.value,f=null===(a=this.datasetTableForm.get("orderBy"))||void 0===a?void 0:a.value;s.groupBy=""==_?null:_.join(),s.orderBy=""==f?null:f.join(),null!=u&&(s.having=""==u.trim()?null:u),s.calender="";let m=[],h=[];this.whereArrInDS().controls.forEach((p,g)=>{console.log(p.controls.column.value),console.log(p.controls.signOperator.value),console.log(p.controls.value.value);let v=p.controls.column.value.dbtablefieldName,x=p.controls.signOperator.value,C=p.controls.value.value;if(0==g)""!=x&&(m="IS NULL"==x||"IS NOT NULL"==x?[v+" "+x]:[v+" "+x+" "+C]),h.push("IS NULL"==x||"IS NOT NULL"==x?{fieName:p.controls.column.value.filefieldName,signOperator:x,value:""}:{fieName:p.controls.column.value.filefieldName,signOperator:x,value:C});else{console.log(p.controls.operator.value);let y,b=p.controls.operator.value;""!=x&&(y="IS NULL"==x||"IS NOT NULL"==x?b+" "+v+" "+x:b+" "+v+" "+x+" "+C),m.push(y),h.push("IS NULL"==x||"IS NOT NULL"==x?{operator:b,fieName:p.controls.column.value.filefieldName,signOperator:x,value:""}:{operator:b,fieName:p.controls.column.value.filefieldName,signOperator:x,value:C})}}),s.where=m.join(" "),s.uiWhere=JSON.stringify(h),s.calender="",d[0].datasetId&&(s.datasetId=d[0].datasetId),this.solService.addDataset(s).subscribe(function(){var p=(0,$e.Z)(function*(g){t.clearWhereInDS(),t.allTableListInDM.forEach((v,x)=>{"dataset"==v.fileType&&t.allTableListInDM.splice(x,1)}),t.tablecolNameList.forEach((v,x)=>{"dataset"==v.fileType&&t.tablecolNameList.splice(x,1)}),yield t.getAllDataSetNameAPI(),t.unChecksAllInDM(!1),t.loader.hide(),t.saveDataSetPopup=!1,t.createExpressionList=[],t.datasetDetailsList=[]});return function(g){return p.apply(this,arguments)}}(),p=>{this.loader.hide()})}}clearWhereInDS(){this.columnsForWhereInDS=[],this.datasetTableForm.controls.where=this.fb.array([this.whereFirstRow()]),this.datasetTableForm.patchValue({having:"",groupBy:"",orderBy:""})}callGetViewscript(t){this.loader.show(),this.solService.getViewScript(t.datasetId).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.sqlScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptDSPopup=!0,this.loader.hide()},i=>{this.loader.hide()})}updateScriptByDatasetId(t){if(this.viewscriptForm.invalid||""==this.viewscriptForm.controls.sqlScript.value.trim())return void this.popup.open(!1,"Script shouldn't be empty");this.loader.show();const o={datasetId:t.value.datasetId,newScript:t.value.sqlScript.trim()};this.solService.updateScriptByDatasetId(o).subscribe(i=>{var a,s;null===(a=this.viewscriptForm.get("sqlScript"))||void 0===a||a.patchValue(null==i?void 0:i.responseData.newScript),null===(s=this.viewscriptForm.get("datasetId"))||void 0===s||s.patchValue(null==i?void 0:i.responseData.datasetId),this.enableViewScriptDSPopup=!1,this.popup.open(!0,"update Script Successfully"),this.loader.hide()},i=>{this.popup.open(!1,"update Script Failed! (Syntax Error)"),this.loader.hide()})}editDatasetFile(t){var o,i,a;this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",columnId:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]}],t.isDatasetTableExpand=!0,this.datasetDetailsList[0]=t;let s=[],l=[];null!=t.orderBy&&(s=t.orderBy.split(",")),null!=t.groupBy&&(l=t.groupBy.split(",")),null===(o=this.datasetTableForm.get("orderBy"))||void 0===o||o.patchValue(s),null===(i=this.datasetTableForm.get("groupBy"))||void 0===i||i.patchValue(l),null===(a=this.datasetTableForm.get("having"))||void 0===a||a.patchValue(t.having),this.columnsForWhereInDS=[],t.datasetFieldDTOList.forEach(d=>{d.sourceFieldName.includes("[")?this.columnsForWhereInDS.push({filefieldName:d.sourceFieldName,dbtablefieldName:d.tableName+"."+d.columnName,dataType:d.columnType}):this.columnsForWhereInDS.push({filefieldName:d.sourceFieldName,dbtablefieldName:d.expression,dataType:d.columnType})});let c=JSON.parse(t.uiWhere);this.datasetTableForm.controls.where=this.fb.array([this.whereFirstRow()]),c.forEach((d,_)=>{0==_?this.columnsForWhereInDS.forEach(u=>{u.filefieldName==d.fieName&&(this.whereArrInDS().controls[_].patchValue({column:u,signOperator:d.signOperator,value:d.value}),this.changeColumnInDSForWhere(0,_,0,0))}):(this.whereArrInDS().push(this.whereRemainingRows()),this.columnsForWhereInDS.forEach(u=>{u.filefieldName==d.fieName&&(this.whereArrInDS().controls[_].patchValue({operator:d.operator,column:u,signOperator:d.signOperator,value:d.value}),this.changeColumnInDSForWhere(0,_,0,0))}))})}applyFilter(t){this.searchfx=this.fx.filter(o=>o).map(o=>{let i=o.funcDescritptionsList.filter(a=>a.functionType.toLowerCase().includes(t.target.value.toLowerCase()));return o.functionName.toLowerCase().includes(t.target.value.toLowerCase())||i.length>0?Object.assign(Object.assign({},o),{funcDescritptionsList:i}):{}}).filter(o=>0!==Object.keys(o).length)}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}selectuser(t,o){}selectgroupByOrderByInDM(t,o,i,a){let l=t.value.map(c=>c.dbtablefieldName).join();"groupby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].groupBy=l),"orderby"==a&&(this.datasetDetailsList.filter(c=>1==c.isDatasetTableExpand)[0].orderBy=l)}allList(){this.allTableListInDM=[],this.targetFiles.forEach((t,o)=>{"append"==t.fileType?t.sheetList.forEach(i=>{i.tableAppendFieldsDto.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.fieldID}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.appendName,tableNameDB:i.tableName,idName:"appendID",ID:i.appendID,appendID:i.appendID,columnList:i.tableAppendFieldsDto,isSelecteddl:!1})}):"join"==t.fileType?t.sheetList.forEach(i=>{i.mergeFieldListDTO.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.mergeName,tableNameDB:i.tableName,idName:"mergeId",ID:i.mergeId,mergeId:i.mergeId,columnList:i.mergeFieldListDTO,isSelecteddl:!1})}):"files"==t.fileType&&t.sheetList.forEach(i=>{null!=i.sheet&&i.sheet.forEach(a=>{a.fileType=t.fileType,a.fieldIDforExpn=a.columnId}),this.allTableListInDM.push({fileType:t.fileType,tableNameUI:i.fileName,tableNameDB:i.tableName,idName:"templateId",ID:i.templateId,templateId:i.templateId,columnList:i.sheet,isSelecteddl:!1})})}),this.allTableListWithoutDSInDM=[],this.allTableListWithoutDSInDM=JSON.parse(JSON.stringify(this.allTableListInDM)),console.log("getall()",this.allTableListInDM),this.getAllDataSetNameAPI()}closeDatasetPopup(){this.dataSetForm.controls.DSetRows=this.fb.array([]),this.saveDataSetPopup=!1}saveDataSet(t,o){var a,s,l,i=this;this.saveDatasetRowsLength={};const c=this.datasetDetailsList.filter(_=>_.isDatasetTableExpand);if(0==c[0].datasetFieldDTOList.length)return;if(c[0].datasetFieldDTOList.length>75)return this.enableDatasetColumnsExceed=!0,void(this.saveDatasetRowsLength.length=c[0].datasetFieldDTOList.length);let d=[];if(this.submitedDS=!1,this.selectedColumnsOfDS=[],null==t||t.datasetFieldDTOList.forEach(_=>{let u;u=_.sourceFieldName.includes("[")?_.sourceFieldName.split("[")[0]:_.tableName,this.allTableListInDM.forEach(m=>{c[0].datasetFieldDTOList.forEach(h=>{let p=h.sourceExpressionName;null!=p&&this.tablecolNameList.forEach(g=>{p.includes(g.showTabColName)&&d.push(g.tableNameUI)})}),m.tableNameUI==u&&0==this.selectedColumnsOfDS.filter(p=>p.tableNameUI==m.tableNameUI).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},m),{isSelecteddl:!1}))})}),d=[...new Set(d)],d.forEach(_=>{this.allTableListInDM.forEach(u=>{_.includes(u.tableNameUI)&&0==this.selectedColumnsOfDS.filter(m=>m.tableNameUI==_).length&&this.selectedColumnsOfDS.push(Object.assign(Object.assign({},u),{isSelecteddl:!1}))})}),console.log("this.selectedColumnsOfDS",this.selectedColumnsOfDS),this.selectedColumnsOfDS.length<2){let _={};_.processId=this.process.processId,1==this.selectedColumnsOfDS.length?("append"==this.selectedColumnsOfDS[0].fileType||"join"==this.selectedColumnsOfDS[0].fileType||"files"==this.selectedColumnsOfDS[0].fileType||"dataset"==this.selectedColumnsOfDS[0].fileType)&&(_.dataSetMergeListDTOs=[{primaryTemplateId:this.selectedColumnsOfDS[0].ID,primaryTableName:this.selectedColumnsOfDS[0].tableNameDB}]):0==this.selectedColumnsOfDS.length&&(_.dataSetMergeListDTOs=[]);const u=[],f=this.datasetDetailsList.filter(x=>x.isDatasetTableExpand);f[0].datasetFieldDTOList.forEach(x=>{null!=x.sourceExpressionName&&(""==x.sourceExpressionName.trim()||0==x.sourceExpressionName.trim().length)&&(x.sourceExpressionName=null);let b,C=x.sourceExpressionName;null!=C&&this.tablecolNameList.forEach(y=>{C.includes(y.showTabColName)&&(C=JSON.parse(JSON.stringify(C.split(y.showTabColName).join(y.tableColumnName))),b=y.tableNameDB)}),null==x.tableName&&(x.tableName=b),x.isColumnType||(x.columnFormat=null),u.push({tableName:x.tableName,excludeInSelect:x.excludeInSelect,columnFormat:x.columnFormat,columnName:x.columnName,fieldName:x.fieldName,expression:C,columnType:x.columnType,where:x.where,or:x.or,groupBy:"",sourceFieldName:x.sourceFieldName,sourceExpressionName:x.sourceExpressionName})}),_.datasetFieldDTOList=u,_.datasetName=f[0].datasetName;let m=null===(a=this.datasetTableForm.get("groupBy"))||void 0===a?void 0:a.value,h=null===(s=this.datasetTableForm.get("having"))||void 0===s?void 0:s.value,p=null===(l=this.datasetTableForm.get("orderBy"))||void 0===l?void 0:l.value;_.groupBy=""==m?null:m.join(),_.orderBy=""==p?null:p.join(),null!=h&&(_.having=""==h.trim()?null:h),_.calender="";let g=[],v=[];this.whereArrInDS().controls.forEach((x,C)=>{console.log(x.controls.column.value),console.log(x.controls.signOperator.value),console.log(x.controls.value.value);let b=x.controls.column.value.dbtablefieldName,y=x.controls.signOperator.value,M=x.controls.value.value;if(0==C)""!=y&&(g="IS NULL"==y||"IS NOT NULL"==y?[b+" "+y]:[b+" "+y+" "+M]),v.push("IS NULL"==y||"IS NOT NULL"==y?{fieName:x.controls.column.value.filefieldName,signOperator:y,value:""}:{fieName:x.controls.column.value.filefieldName,signOperator:y,value:M});else{console.log(x.controls.operator.value);let U,A=x.controls.operator.value;""!=y&&(U="IS NULL"==y||"IS NOT NULL"==y?A+" "+b+" "+y:A+" "+b+" "+y+" "+M),g.push(U),v.push("IS NULL"==y||"IS NOT NULL"==y?{operator:A,fieName:x.controls.column.value.filefieldName,signOperator:y,value:""}:{operator:A,fieName:x.controls.column.value.filefieldName,signOperator:y,value:M})}}),_.where=g.join(" "),_.uiWhere=JSON.stringify(v),_.calender="",f[0].datasetId&&(_.datasetId=f[0].datasetId),this.solService.addDataset(_).subscribe(function(){var x=(0,$e.Z)(function*(C){console.log("call addDS"),yield i.getAllDataSetNameAPI(),i.loader.hide(),i.clearWhereInDS(),i.unChecksAllInDM(!1),i.createExpressionList=[],i.datasetDetailsList=[]});return function(C){return x.apply(this,arguments)}}(),x=>{this.loader.hide()})}else{this.dataSetForm.controls.DSetRows=this.fb.array([]),this.dataSetData=[];let _=[],u=[];this.selectedColumnsOfDS.forEach(m=>{_.push(m)});let f={searchValuePT:"",searchValueFT:"",primaryTableList:_,foreignTableList:u,order:1,columns:[{primaryKeyList:[],foreignKeyList:[]}]};for(let m=0;m<this.selectedColumnsOfDS.length-1;m++)0==m?this.dataSetData.push(f):(_=[],_.primaryKeyList=[],this.dataSetData.push({searchValuePT:"",searchValueFT:"",primaryTableList:_,foreignTableList:u,columns:[{primaryKeyList:[],foreignKeyList:[]}],order:m+2})),this.DataSetArr().controls.push(this.DataSetRow());this.saveDataSetPopup=!0}this.DataSetArr().controls.forEach(_=>{console.log(_.value,_),console.log(_.controls.Ptable.value)})}selectPrimaryTableInDS(t,o){if(this.dataSetData.forEach((i,a)=>{var s,l,c;a>o&&(this.dataSetData[a].Join="",this.dataSetData[a].primaryTableList=[],this.dataSetData[a].foreignTableList=[],null===(s=this.DataSetArr().controls[o].get("join"))||void 0===s||s.reset()),a==o&&(this.dataSetData[a].foreignTableList=[],null===(l=this.DataSetArr().controls[o].get("Ftable"))||void 0===l||l.reset(),null===(c=this.DataSetArr().controls[o].get("join"))||void 0===c||c.reset()),a>=o&&(this.columnArrInDS(a).clear(),this.columnArrInDS(a).push(this.addColumnInDS()),this.dataSetData[a].columns=[{primaryKeyList:[],foreignKeyList:[]}])}),this.dataSetData[o].columns.forEach(i=>{i.searchValuePK="",i.searchValueFK=""}),this.dataSetData[o].columns[0].primaryKeyList=t.value.columnList,0==o)this.dataSetData[0].primaryTableList.forEach(i=>{this.DataSetArr().controls[o].value.Ptable.ID!=i.ID&&this.dataSetData[o].foreignTableList.push(i)});else{let i=this.dataSetData[o].primaryTableList.map(a=>a.ID);this.dataSetData[0].primaryTableList.forEach(a=>{i.includes(a.ID)||this.dataSetData[o].foreignTableList.push(a)})}}selectJoinTypeInDS(t,o){this.dataSetData[o].Join=t.value,console.log(this.dataSetData)}selectForeignTableInDS(t,o){if(this.dataSetData.forEach((i,a)=>{var s,l;a>o&&(null===(s=this.DataSetArr().controls[a].get("join"))||void 0===s||s.reset(),this.dataSetData[a].primaryTableList=[],this.dataSetData[a].foreignTableList=[],this.dataSetData[a].columns=[{primaryKeyList:[],foreignKeyList:[]}]),a==o&&(this.dataSetData[a].columns[0].foreignKeyList=[],this.dataSetData[a].columns.splice(1,this.dataSetData[a].columns.length),null!=this.DataSetArr().controls[a+1]&&(null===(l=this.DataSetArr().controls[a+1].get("Ptable"))||void 0===l||l.reset())),a>=o&&(this.columnArrInDS(a).clear(),this.columnArrInDS(a).push(this.addColumnInDS()))}),this.dataSetData[o].columns[0].foreignKeyList=t.value.columnList,0==o){let i=[];i.push(this.DataSetArr().controls[o].value.Ptable),i.push(this.DataSetArr().controls[o].value.Ftable),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=i)}else{let i=[];this.dataSetData[o].primaryTableList.forEach(a=>{i.push(a)}),i.push(this.DataSetArr().controls[o].value.Ftable),null!=this.dataSetData[o+1]&&(this.dataSetData[o+1].primaryTableList=i)}}selectPrimaryKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].primaryKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({primaryKeyList:a,searchValuePK:"",searchValueFK:""}):this.dataSetData[i].columns[o+1].primaryKeyList=a}selectForeignKeyInDS(t,o,i){let a=JSON.parse(JSON.stringify(this.dataSetData[i].columns[o].foreignKeyList));a.forEach((s,l)=>{s.fieldIDforExpn==t.value.fieldIDforExpn&&a.splice(l,1)}),null==this.dataSetData[i].columns[o+1]?this.dataSetData[i].columns.push({foreignKeyList:a,searchValuePK:"",searchValueFK:""}):this.dataSetData[i].columns[o+1].foreignKeyList=a}addcolumnRowInDS(t,o){var i,a;let s=this.columnArrInDS(o).length;if(""==(null===(i=this.columnArrInDS(o).controls[s-1].get("column1"))||void 0===i?void 0:i.value)||""==(null===(a=this.columnArrInDS(o).controls[s-1].get("column2"))||void 0===a?void 0:a.value))return;let l=0;this.dataSetData[o].columns.forEach(c=>{(0==(null==c?void 0:c.primaryKeyList.length)||0==(null==c?void 0:c.foreignKeyList.length))&&(l=1)}),1!=l&&this.columnArrInDS(o).push(this.addColumnInDS())}deletecolumnRowInDS(t,o){this.columnArrInDS(o).removeAt(t),this.dataSetData[o].columns.splice(t+1,this.dataSetData[o].columns.length)}add_SaveCreateExpression(t){var o,i,a,s,l,c;if(console.log("this.createExpressionForm",this.createExpressionForm),t.sourceFieldName=null===(o=this.createExpressionForm.get("sourceFieldName"))||void 0===o?void 0:o.value,t.excludeInSelect=null===(i=this.createExpressionForm.get("excludeInSelect"))||void 0===i?void 0:i.value,t.columnType=null===(a=this.createExpressionForm.get("columnType"))||void 0===a?void 0:a.value,1==t.isColumnType&&(t.columnFormat=null===(s=this.createExpressionForm.get("columnFormat"))||void 0===s?void 0:s.value),t.sourceExpressionName=null===(l=this.createExpressionForm.get("sourceExpressionName"))||void 0===l?void 0:l.value,this.submited=!0,""==t.sourceFieldName.trim()||""==t.columnType)return void this.popup.open(!1,"Enter All the Required Fields");if(""==t.sourceFieldName.trim())return;const d=this.datasetDetailsList.filter(C=>1==C.isDatasetTableExpand),_=null===(c=d[0])||void 0===c?void 0:c.datasetFieldDTOList;let f,m,h,p,u=0;if(0!=_.length&&_.forEach(C=>{t.isEdit&&C.isEdit||C.sourceFieldName==t.sourceFieldName.trim()&&(u=1)}),1==u)return;f=this.allTableListInDM.filter(C=>C.columnList.some(b=>b.showTabColName==t.sourceFieldName)).map(C=>Object.assign({},C,{columnList:C.columnList.filter(b=>b.showTabColName==t.sourceFieldName)})),0!=f.length&&(t.tableName=f[0].tableNameDB),0!=f.length&&(m=f[0].columnList[0].columnName,p=f[0].columnList[0].fieldName,h=f[0].tableNameDB);let g=h+"."+m,v={},x={};if(0==f.length){let C=null;this.tablecolNameList.forEach(b=>{t.sourceExpressionName==b.showTabColName&&(C=b.tableNameDB+"."+b.columnName)}),v={filefieldName:t.sourceFieldName,dbtablefieldName:C},x={filefieldName:t.sourceFieldName,dbtablefieldName:C,dataType:t.columnType},t.columnName=t.sourceFieldName,t.fieldName=t.sourceFieldName}else v={filefieldName:t.sourceFieldName,dbtablefieldName:g},x={filefieldName:t.sourceFieldName,dbtablefieldName:g,dataType:f[0].columnList[0].columnType},t.columnName=m,t.fieldName=p;t.isEdit||(d[0].orderBytoDB.push(v),d[0].groupBytoDB.push(v),this.columnsForWhereInDS.push(x)),0==(null==_?void 0:_.length)?_.push(t):t.isEdit?_.forEach((C,b)=>{C.isEdit&&(t.isEdit=!1,_.splice(b,1,t))}):_.push(t),this.createExpressionList=[{excludeInSelect:!1,sourceFieldName:"",expression:"",columnId:"",columnFormat:"",signOperatorList:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",value:"",signOperator:"",whereList:[]}],this.UpdatechecksInDM(t,!0),this.createExpressionForm.reset(),this.submited=!1}deleteTables(t,o,i,a){console.log("e: ",t),console.log("item: ",o),this.deleteTableDetails={item:o,type:a},this.enableDeletePopup=!0}deleteTable(t,o){let i={type:o,operation:"delete"};"file"==o?i.id=t.fileId:"append"==o?i.id=t.appendID:"merge"==o?i.id=t.mergeId:"dataset"==o&&(i.id=t.datasetId),this.solService.deleteTables(i).subscribe(a=>{console.log(a),this.enableDeletePopup=!1,"file"==o?this.getAllFileTemplateListByProcessID():"append"==o?this.getAppendFilesApi():"merge"==o?this.getJoinFilesListApi():"dataset"==o&&(this.getAllDataSetNameAPI(),0==this.datasetDetailsList.length&&(this.createExpressionList=[])),"file"==o?this.popup.open(!0,t.fileNameWithExt+" Deleted Successfully !"):"append"==o?this.popup.open(!0,t.appendName+" Deleted Successfully !"):"merge"==o?this.popup.open(!0,t.mergeName+" Deleted Successfully !"):"dataset"==o&&this.popup.open(!0,t.datasetName+" Deleted Successfully !")},a=>{this.popup.open(!1,"failed to delete"),this.enableDeletePopup=!1})}existDataset(){console.log(this.sqlScriptForm.value.datasetName)}applyFilterForDMTables(t,o,i,a){console.log("e",t),console.log(a),"append"==a?(this.selectedIndexFilterAppend=""!=t.target.value?i:-1,this.filteredDataAppend=o.tableAppendFieldsDto.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"join"==a?(this.selectedIndexFilterJoin=""!=t.target.value?i:-1,this.filteredDataJoin=o.mergeFieldListDTO.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"files"==a?(this.selectedIndexFilterFiles=""!=t.target.value?i:-1,this.filteredDataFiles=o.sheet.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase()))):"dataset"==a&&(this.selectedIndexFilterDataset=""!=t.target.value?i:-1,this.filteredDataDataset=o.datasetFieldDTOList.filter(s=>s.fieldName.toLowerCase().includes(t.target.value.toLowerCase())))}selectAllInDM(t,o){console.log(t,o);let i=[];0!=this.datasetDetailsList.length&&(i=this.datasetDetailsList[0].datasetFieldDTOList.map(s=>s.sourceFieldName));let a=[];"append"==t?a=o.tableAppendFieldsDto:"join"==t?a=o.mergeFieldListDTO:"files"==t?a=o.sheet:"dataset"==t&&(a=o.datasetFieldDTOList),a.forEach(s=>{i.includes(s.showTabColName)||this.add_SaveCreateExpression({excludeInSelect:!1,sourceFieldName:s.showTabColName,columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:s.columnType,where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]})})}onSortClick(t,o){this.sortColumn==o?"desc"==this.sortOrder?(this.sortOrder="asc",this.sortDir=1):(this.sortOrder="desc",this.sortDir=-1):(this.sortColumn=o,this.sortOrder="desc"),this.selectedM_A_S.sort((i,a)=>(i=i[t].toLowerCase(),a=a[t].toLowerCase(),i.localeCompare(a)*this.sortDir))}previewPopupClose(){this.sortColumn=-1,this.showTargetFilePopup=!1}UpdatechecksInDM(t,o){let i=[];this.targetFiles.forEach(a=>{a.sheetList.forEach(s=>{"Append"==s.type?s.tableAppendFieldsDto.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.tableAppendFieldsDto,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):"Merge"==s.type?s.mergeFieldListDTO.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.mergeFieldListDTO,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)}):s.sheet.forEach(l=>{l.showTabColName==t.sourceFieldName&&(i=s.sheet,l.isSelectAllChildInDM=o,i.map(d=>d.isSelectAllChildInDM).includes(!1)?s.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}),0==i.length&&this.allDatasetDetailsList.forEach(a=>{a.datasetFieldDTOList.forEach(s=>{s.showTabColName==t.sourceFieldName&&(i=a.datasetFieldDTOList,s.isSelectAllChildInDM=o,i.map(c=>c.isSelectAllChildInDM).includes(!1)?a.isSelectAllParentInDM=!1:t.isSelectAllParentInDM=!0)})})}selectAllParentInDM(t,o,i){console.log(t,o,i);let a=t.target.checked,s=[];0!=this.datasetDetailsList.length&&(s=this.datasetDetailsList[0].datasetFieldDTOList.map(d=>d.sourceFieldName));let l=[];"append"==o&&a?(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!0),l=i.tableAppendFieldsDto):"join"==o&&a?(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!0),l=i.mergeFieldListDTO):"files"==o&&a?(i.sheet.forEach(d=>d.isSelectAllChildInDM=!0),l=i.sheet):"dataset"==o&&a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!0),l=i.datasetFieldDTOList);let c=[];"append"!=o||a?"join"!=o||a?"files"!=o||a?"dataset"==o&&!a&&(i.datasetFieldDTOList.forEach(d=>d.isSelectAllChildInDM=!1),l=i.datasetFieldDTOList,c=i.datasetFieldDTOList.map(d=>d.showTabColName)):(i.sheet.forEach(d=>d.isSelectAllChildInDM=!1),l=i.sheet,c=i.sheet.map(d=>d.showTabColName)):(i.mergeFieldListDTO.forEach(d=>d.isSelectAllChildInDM=!1),l=i.mergeFieldListDTO,c=i.mergeFieldListDTO.map(d=>d.showTabColName)):(i.tableAppendFieldsDto.forEach(d=>d.isSelectAllChildInDM=!1),l=i.tableAppendFieldsDto,c=i.tableAppendFieldsDto.map(d=>d.showTabColName)),0!=this.datasetDetailsList.length&&(a?l.forEach(d=>{if(!s.includes(d.showTabColName)){let _={excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]};this.createExpressionForm.controls.sourceFieldName.patchValue(d.showTabColName),this.createExpressionForm.controls.columnType.patchValue(d.columnType),this.add_SaveCreateExpression(_)}}):a||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(d=>-1==c.indexOf(d.sourceFieldName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(d=>-1==c.indexOf(d.filefieldName)),this.columnsForWhereInDS=this.columnsForWhereInDS.filter(d=>-1==c.indexOf(d.filefieldName)),console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList),console.log("this.datasetDetailsList[0].groupBytoDB",this.datasetDetailsList[0].groupBytoDB),console.log("this.datasetDetailsList[0].orderBytoDB",this.datasetDetailsList[0].orderBytoDB),this.UpdatechecksInDM(i,!1)))}selectAllChildInDM(t,o,i,a){let s=t.target.checked,l=[];0!=this.datasetDetailsList.length&&(l=this.datasetDetailsList[0].datasetFieldDTOList.map(_=>_.sourceFieldName));let c=[];if("append"==o?c=i.tableAppendFieldsDto:"join"==o?c=i.mergeFieldListDTO:"files"==o?c=i.sheet:"dataset"==o&&(c=i.datasetFieldDTOList),i.isSelectAllParentInDM=!c.map(_=>_.isSelectAllChildInDM).includes(!1),console.log(i),0!=this.datasetDetailsList.length){if(s){if(!l.includes(a.showTabColName)){let _={excludeInSelect:!1,sourceFieldName:"",columnId:"",columnFormat:"",signOperatorList:"",sourceExpressionName:"",isEdit:!1,columnType:"",where:"",or:"",groupBy:"",orderBy:"",value:"",signOperator:"",whereList:[]};this.createExpressionForm.controls.sourceFieldName.patchValue(a.showTabColName),this.createExpressionForm.controls.columnType.patchValue(a.columnType),this.add_SaveCreateExpression(_)}}else s||(this.datasetDetailsList[0].datasetFieldDTOList=this.datasetDetailsList[0].datasetFieldDTOList.filter(_=>-1==a.showTabColName.indexOf(_.sourceFieldName)),this.datasetDetailsList[0].groupBytoDB=this.datasetDetailsList[0].groupBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)),this.datasetDetailsList[0].orderBytoDB=this.datasetDetailsList[0].orderBytoDB.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)),this.columnsForWhereInDS=this.columnsForWhereInDS.filter(_=>-1==a.showTabColName.indexOf(_.filefieldName)));console.log("this.datasetDetailsList[0].datasetFieldDTOList ",this.datasetDetailsList[0].datasetFieldDTOList),console.log(i,a)}}unChecksAllInDM(t){this.targetFiles.forEach(o=>{o.sheetList.forEach(i=>{i.isSelectAllParentInDM=!1,"Append"==i.type?i.tableAppendFieldsDto.forEach(a=>{a.isSelectAllChildInDM=t}):"Merge"==i.type?i.mergeFieldListDTO.forEach(a=>{a.isSelectAllChildInDM=t}):i.sheet.forEach(a=>{a.isSelectAllChildInDM=t})})}),this.allDatasetDetailsList.forEach(o=>{o.isSelectAllParentInDM=!1,o.datasetFieldDTOList.forEach(i=>{i.isSelectAllChildInDM=t})})}whereFirstRow(){return this.formBuilder.group({column:["",w.kI.required],signOperator:["",w.kI.required],value:["",w.kI.required]})}whereRemainingRows(){return this.formBuilder.group({operator:["",w.kI.required],column:["",w.kI.required],signOperator:["",w.kI.required],value:["",w.kI.required]})}addOpearatorValueFieldsInDS(t,o){this.whereArrInDS().push(this.whereRemainingRows()),console.log(t,o)}delOpearatorValueFieldsInDS(t,o){this.whereArrInDS().removeAt(t),this.signOperatorWhereInDS.splice(t,1),console.log(t,o)}changeColumnInDSForWhere(t,o,i,a){let s=this.whereArrInDS().controls[o].get("column");console.log(o,i,a,s.value);let l=s.value.dataType,c=[];c=this.getOpearatorList.filter(d=>d.operatorType.trim()==l),this.signOperatorWhereInDS[o]=c[0].operatorList}whereArrInDS(){return this.datasetTableForm.get("where")}appendDataset(){var t;let o=this.allDatasetDetailsList.filter(s=>s.selected),i=0,a=[];if(o.length>1){if(o.forEach(s=>{if(0==a.length)a=s.datasetFieldDTOList.map(l=>l.fieldName);else{let l=[];l=s.datasetFieldDTOList.map(c=>c.fieldName),a.forEach(c=>{l.includes(c)||(i=1)})}}),1==i)return;this.enableDatasetAppendPopup=!0,null===(t=this.datasetAppendForm.get("appendNameControl"))||void 0===t||t.reset()}}appendDatasetApi(){var t;let o=null===(t=this.datasetAppendForm.get("appendNameControl"))||void 0===t?void 0:t.value.trim();this.loader.show(),this.solService.getExistDataset(o,"dataset").subscribe(i=>{this.loader.hide(),this.enableDatasetAppendPopup=!1,this.submited=!1,this.submittedErrorMsg="",this.createDatasetAppend(o),console.log(i)},i=>{this.loader.hide(),this.submited=!0,this.submittedErrorMsg="Dataset Name Already Exist!!!"})}createDatasetAppend(t){let o=[],i={processId:this.process.processId,dataSetAppendDetailsDto:{appendName:t,datasetTableAppendDtos:o}};this.allDatasetDetailsList.forEach(a=>{a.selected&&o.push({datasetId:a.datasetId,datasetName:a.datasetName})}),this.solService.addDatasetAppend(i).subscribe(a=>{this.getAllDataSetNameAPI()},a=>{this.loader.hide()})}uploadSQLScriptBtn(){this.uploadSQLBtn=!0,this.sqlScriptForm.reset(),this.enableUploadSQL=!0,this.isBtnClickedSQL_Python="S"}uploadPythonScriptBtn(){this.uploadSQLBtn=!0,this.sqlScriptForm.reset(),this.enableUploadPython=!0,this.isBtnClickedSQL_Python="P"}generateScript(){this.saveUploadScript("M")}uploadPythonScript(){}uploadSQL_PythonScript(t,o){if("P"==o){const i=t.target.files[0];if("py"==t.target.files[0].name.split(".")[1]||"txt"==t.target.files[0].name.split(".")[1]){let a=new FileReader;a.onload=s=>{this.uploadSQLBtn=!1,this.sqlScriptForm.patchValue({sqlScript:a.result})},a.readAsText(i)}}else if("S"==o){const i=t.target.files[0];if("sql"==t.target.files[0].name.split(".")[1]||"txt"==t.target.files[0].name.split(".")[1]){let a=new FileReader;a.onload=s=>{this.uploadSQLBtn=!1,this.sqlScriptForm.patchValue({sqlScript:a.result})},a.readAsText(i)}}}saveUploadScript(t){var o;let i={processId:this.process.processId,type:t};("P"==t||"S"==t)&&(i.script=null===(o=this.sqlScriptForm.get("sqlScript"))||void 0===o?void 0:o.value),this.solService.uploadScriptToProcess(i).subscribe(a=>{console.log(a),"P"==t&&(this.enableUploadPython=!1),"S"==t&&(this.enableUploadSQL=!1),("P"==t||"S"==t)&&this.popup.open(!0,"Saved Successfully !"),"M"==t&&this.popup.open(!0,"Generated Successfully !")},a=>{this.popup.open(!1,"failed"),this.loader.hide()})}getViewScript(){this.isManualScript=!0,this.isUploadScript=!1,this.getViewScriptForm.reset(),this.getSolutionScript(!0)}getSolutionScript(t){this.solService.getSolutionScript(this.process.processId).subscribe(o=>{var i,a,s,l;o&&(1==t&&(this.enableViewscriptPopup=!0),this.getViewScriptForm.patchValue({script:null===(i=o.responseData)||void 0===i?void 0:i.script,gscript:null===(a=o.responseData)||void 0===a?void 0:a.gscript,solutionScriptId:null===(s=o.responseData)||void 0===s?void 0:s.solutionScriptId,type:null===(l=o.responseData)||void 0===l?void 0:l.type}))},o=>{1==t&&this.popup.open(!1,"No data"),this.loader.hide()})}executeViewScript(){var t,o;let i;this.isUploadScript?"P"==(null===(t=this.getViewScriptForm.get("type"))||void 0===t?void 0:t.value)?i=1:"S"==(null===(o=this.getViewScriptForm.get("type"))||void 0===o?void 0:o.value)&&(i=2):this.isManualScript&&(i=2),this.solService.execscript(this.process.processId,i).subscribe(a=>{this.enableViewscriptPopup=!1,this.popup.open(!0,"Executed Successfully !")},a=>{this.popup.open(!1,"failed")})}updateViewScript(){var t,o,i;let a={processId:this.process.processId};this.isUploadScript&&(a.script=null===(t=this.getViewScriptForm.get("script"))||void 0===t?void 0:t.value,a.type=null===(o=this.getViewScriptForm.get("type"))||void 0===o?void 0:o.value),this.isManualScript&&(a.gscript=null===(i=this.getViewScriptForm.get("gscript"))||void 0===i?void 0:i.value,a.type="M"),console.log(a),this.solService.uploadScriptToProcess(a).subscribe(s=>{this.enableViewscriptPopup=!1,this.toast.success({title:"Success",message:"Updated Successfully !"})})}isSQL_Python(t){t==this.isManualScript?(this.isManualScript=!0,this.isUploadScript=!1):t==this.isUploadScript&&(this.isUploadScript=!0,this.isManualScript=!1)}overrideConfirm(){this.isOverride?this.isOverride=!1:this.enableOverRideConfirmPopup=!0}overrideOK(){this.enableOverRideConfirmPopup=!1,this.isOverride=!0}closeOverridePopup(){this.isOverride=!1,this.enableOverRideConfirmPopup=!1}executeProject(){this.loader.show(),this.solService.execSolutionScript(this.process.processId).subscribe(t=>{this.loader.hide()},t=>{this.loader.hide()})}deleteRelationRow(t){this.relationshipArr().removeAt(t),this.relationship.splice(t,1)}addRelationshipRow(){return this.formBuilder.group({fromTable:["",w.kI.required],toTable:["",w.kI.required],crossFilteringBehavior:["",w.kI.required],fromColumn:["",w.kI.required],toColumn:["",w.kI.required]})}relationshipArr(){return this.addRelationshipForm.get("addRelationshipRows")}fetchFromTables(){return this.selectedDateList.map(t=>({name:t.datasetName,value:t.tableName}))}fetchToTables(t){const o=this.relationship;return this.selectedDateList.map(i=>{var a;return(null===(a=o[t])||void 0===a?void 0:a.fromTable)!==i.tableName?{name:i.datasetName,value:i.tableName}:null}).filter(function(i){return null!=i})}fetchTableColumns(t){return this.selectedDateList.find(i=>i.tableName===t).datasetFieldDTOList.map(i=>({name:i.fieldName,value:i.columnName}))}fetchCrossFltrBehaviours(){return[{name:"Automatic",value:"Automatic"},{name:"Many To Many",value:"BothDirections"},{name:"One To Many",value:"OneDirection"}]}openRelModal(){this.addRelationshipForm.controls.addRelationshipRows=this.fb.array([this.addRelationshipRow()]),this.submitedRelation=!1,console.log("seelcted tables:",this.selectedDateList),this.showRelationshipModal=!0,this.relationship=[{name:"",fromTable:"",fromTableList:this.fetchFromTables(),crossFilteringBehavior:this.fetchCrossFltrBehaviours()[0].value,cfbList:this.fetchCrossFltrBehaviours(),fromColumn:"",fromColumnList:[],toTable:"",toTablesList:[],toColumn:"",toColumnList:[],validators:{name:0,fromtable:0,fromColumn:0,toTable:0,toColumn:0}}],console.log("relation ship info:",this.relationship)}closeRelModal(){this.showRelationshipModal=!1,this.relationship=[]}addNewRelation(t){let o=this.relationshipArr().length;this.relationshipArr().controls[o-1].invalid||(this.relationshipArr().push(this.addRelationshipRow()),this.relationship.push({name:"",fromTable:"",fromTableList:this.fetchFromTables(),crossFilteringBehavior:this.fetchCrossFltrBehaviours()[0].value,cfbList:this.fetchCrossFltrBehaviours(),fromColumn:"",fromColumnList:[],toTable:"",toTablesList:[],toColumn:"",toColumnList:[],validators:{name:0,fromtable:0,fromColumn:0,toTable:0,toColumn:0}}))}onChangeToTable(t,o){let i=this.relationshipArr().controls[t].value.toTable;this.relationship[t][o+"ColumnList"]=this.fetchTableColumns(i)}populateToTables(t,o){let i=[];return this.relationship[t].fromTableList.forEach(a=>{o!=a.value&&i.push(a)}),i}onChangeTable(t,o){console.log("index",t);let i=this.relationshipArr().controls[t].value.fromTable;this.relationship[t][o+"ColumnList"]=this.fetchTableColumns(i),this.relationship[t].toTableList=this.populateToTables(t,i),this.filterExistingRel(this.relationship[t].fromTable,t)}filterExistingRel(t,o){const i=this.relationship.filter(a=>a.fromTable===t).map(a=>a.toTable).filter(function(a){return null!=a&&""!==a});this.relationship[o].toTableList=this.relationship[o].toTableList.filter(a=>i.indexOf(a.value)<0)}onCheck(t){console.log(t),this.allDatasetDetailsList.forEach(i=>{t.datasetId==i.datasetId&&(i.selected=!i.selected)});const o=this.selectedDateList.findIndex(i=>i.datasetName===t.datasetName);o>-1?this.selectedDateList.splice(o,1):this.selectedDateList.push(t),this.selectedDateList.length>1?(this.disableContinue=!0,this.disableRelButton=!1):(this.disableContinue=!1,this.disableRelButton=!0),console.log(this.allDatasetDetailsList)}validateRelation(t){return t.validators.name=t.name?0:1,t.validators.fromTable=t.fromTable?0:1,t.validators.fromColumn=t.fromColumn?0:1,t.validators.toTable=t.toTable?0:1,t.validators.toColumn=t.toColumn?0:1,t.validators.name||t.validators.fromTable||t.validators.fromColumn||t.validators.toTable||t.validators.toColumn}disableContinueBtn(){return this.selectedDateList.length>1&&this.disableContinue}saveRelation(){if(!this.validateRelation(this.relationship[this.relationship.length-1])){let t=this.relationship.map(o=>({name:o.name,fromTable:o.fromTable,crossFilteringBehavior:o.crossFilteringBehavior,fromColumn:o.fromColumn,toTable:o.toTable,toColumn:o.toColumn}));this.relationship=[],this.relationShipPayload=this.relationShipPayload.concat(t),this.showRelationshipModal=!1,this.disableContinue=!1}}saveRelationship(){this.submitedRelation=!0;let t=0;this.relationshipArr().controls.forEach((o,i)=>{o.invalid&&(t=1)}),1!=t?(this.relationShipPayload=[],this.relationshipArr().controls.forEach(o=>{this.relationShipPayload.push({name:"",fromTable:o.value.fromTable,crossFilteringBehavior:o.value.crossFilteringBehavior,fromColumn:o.value.fromColumn,toTable:o.value.toTable,toColumn:o.value.toColumn}),this.relationship=[],this.showRelationshipModal=!1,this.disableContinue=!1})):this.toast.error({title:"Error",message:"Enter all the required fields"})}SaveContinue(){let t=[];this.allDatasetDetailsList.forEach(a=>{a.selected&&t.push(a.tableName)});let o=JSON.parse(localStorage.getItem("userInfo")||""),i={tables:t,userId:o.userId,processId:this.process.processId};this.relationShipPayload.length>0&&(this.relationShipPayload.forEach((a,s)=>{a.name="relation"+s}),i.relationShips=this.relationShipPayload),console.log(i),this.loader.show(),this.solService.postPushDataSets(i,this.isOverride).subscribe(a=>{this.router.navigate(["/user/admin1/powerbi-interface",{dataset:JSON.stringify(a.responseData)}]),this.loader.hide()},a=>{this.loader.hide()})}oneNext(){var t=this;let o={checkDtoslist:[]};this.fileListt.forEach(i=>{i.totalSheetList.forEach(a=>{o.checkDtoslist.push(a.sheetSelected?{id:a.templateId,value:1}:{id:a.templateId,value:0})})}),this.solService.saveCheckedSheetList(o).subscribe(function(){var i=(0,$e.Z)(function*(a){yield t.getTargetFileList()});return function(a){return i.apply(this,arguments)}}(),i=>{})}twoNext(){var t=this;let o={fieldCheckListDtos:[]};this.targetFiles.forEach(i=>{let a=[],s=[];"append"==i.fileType?(i.sheetList.forEach(l=>{l.tableAppendFieldsDto.forEach(c=>{c.isChecked&&a.push({id:c.fieldID,value:1}),c.isDropdownDirtyInTF&&s.push({id:c.fieldID,dataType:c.columnType})})}),o.fieldCheckListDtos.push({type:"AppendField",checkDtoslist:a,fieldDataTypeDtos:s})):"join"==i.fileType?(i.sheetList.forEach(l=>{l.mergeFieldListDTO.forEach(c=>{c.isChecked&&a.push({id:c.columnId,value:1}),c.isDropdownDirtyInTF&&s.push({id:c.columnId,dataType:c.columnType})})}),o.fieldCheckListDtos.push({type:"MergeField",checkDtoslist:a,fieldDataTypeDtos:s})):"files"==i.fileType&&(i.sheetList.forEach(l=>{l.sheet.forEach(c=>{c.isChecked&&a.push({id:c.columnId,value:1}),c.isDropdownDirtyInTF&&s.push({id:c.columnId,dataType:c.columnType})})}),o.fieldCheckListDtos.push({type:"TemplateField",checkDtoslist:a,fieldDataTypeDtos:s}))}),this.solService.saveFieldCheckList(o).subscribe(function(){var i=(0,$e.Z)(function*(a){t.getTargetFileList()});return function(a){return i.apply(this,arguments)}}(),i=>{}),this.getAppendFilesApi()}getAppendFilesApi(){this.getAppendFilesList=[],this.solService.getAppendFiles(this.process.processId).subscribe(t=>{var o;this.getAppendFilesList=null===(o=t.responseData)||void 0===o?void 0:o.appendSheetList,console.log("getAppendFiles",t)},t=>{})}threeNext(){this.getJoinFilesListApi()}getJoinFilesListApi(){this.getAppendFilesList=[],this.solService.getMergeList(this.process.processId).subscribe(t=>{var o;this.getJoinFilesList=null===(o=t.responseData)||void 0===o?void 0:o.templatesMergeDetailsList,console.log("getMergeList",t)},t=>{})}threePrev(){this.append_SourceFilesList=[],this.getJoinFilesList=[],(0,Ji.D)([this.solService.getTargetFileList(this.process.processId),this.solService.getMergeList(this.process.processId)]).subscribe(t=>{var o,i,a,s,l,c,d,_;console.log(t),null===(i=null===(o=t[0])||void 0===o?void 0:o.responseData.appendSheetListDto)||void 0===i||i.appendSheetList.forEach(m=>{m.tableNameUI=m.appendName,m.isSelectAllParentInDM=!1,m.tableAppendFieldsDto.forEach(h=>{h.isSelectAllChildInDM=!1,h.fileType=m.type,h.showTabColName=m.appendName+"["+h.fieldName+"]",h.isDropdownDirtyInTF=!1})});let u=null===(s=null===(a=t[0])||void 0===a?void 0:a.responseData.templateFileDetailsListDto)||void 0===s?void 0:s.totalfileDetails;u.forEach(m=>{m.totalSheetList.forEach(h=>{var p;const g=h.sheetName;null===(p=h.sheet)||void 0===p||p.forEach(v=>{v.tableName=h.tableName,v.isDropdownDirtyInTF=!1,v.type="template","xlsx"==m.fileExt||"xls"==m.fileExt?v.showTabColName=m.fileName+"-"+g+"."+m.fileExt+"["+v.fieldName+"]":("txt"==m.fileExt||"csv"==m.fileExt||"json"==m.fileExt)&&(v.showTabColName=m.fileNameWithExt+"["+v.fieldName+"]"),v.fileExt=m.fileExt})})});const f=[];u.forEach(m=>{m.isSelectAllParentInDM=!1,m.totalSheetList.forEach(h=>{var p;h.sheetSelected&&(null===(p=h.sheet)||void 0===p||p.forEach(g=>{g.isSelectAllChildInDM=!1}),h.type="template",null!=h.sheet&&("xlsx"==h.fileExt||"xls"==h.fileExt?f.push(Object.assign(Object.assign({fileExt:h.fileExt,fileName:m.fileName+"-"+h.sheetName+"."+m.fileExt},h),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:m.fileName+"-"+h.sheetName+"."+m.fileExt})):("csv"==h.fileExt||"txt"==h.fileExt||"json"==h.fileExt)&&f.push(Object.assign(Object.assign({fileExt:h.fileExt,fileName:m.fileNameWithExt},h),{isCheckedInAppend:!1,isCheckedInJoin:!1,type:"files",tableNameUI:m.fileNameWithExt}))))})}),null===(c=null===(l=t[0])||void 0===l?void 0:l.responseData.appendSheetListDto)||void 0===c||c.appendSheetList.forEach(m=>this.append_SourceFilesList.push(m)),f.forEach(m=>this.append_SourceFilesList.push(m)),this.getJoinFilesList=null===(_=null===(d=t[1])||void 0===d?void 0:d.responseData)||void 0===_?void 0:_.templatesMergeDetailsList})}getAllOperatorsList(){this.solService.getAllOperators().subscribe(t=>{this.getOpearatorList=null==t?void 0:t.responseData,console.log("this.getOpearatorList",this.getOpearatorList)},t=>{})}changeTabs(t,o){if(console.log(t,o),this.submitted=!1,this.submittedErrorMsg="",0==t.id&&null==o&&(this.router.navigate(["/user/admin1/solutionboard/upload-files"]),this.getAllFileTemplateListByProcessID()),0==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/upload-files"]),this.getAllFileTemplateListByProcessID()),1==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/target-files"]),this.getTargetFileList()),1==t.id&&"next"==o){if(this.router.navigate(["/user/admin1/solutionboard/target-files"]),this.nextBtnEnableInUF(),1==this.isUploadFilesNextBtnEnable)return;this.oneNext()}2==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/append"]),this.getTargetFileList(),this.getAppendFilesApi()),2==t.id&&"next"==o&&(this.router.navigate(["/user/admin1/solutionboard/append"]),this.twoNext()),3==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/join"]),this.threePrev(),this.createExpressionList=[],this.datasetDetailsList=[]),3==t.id&&"next"==o&&(this.router.navigate(["/user/admin1/solutionboard/join"]),this.threePrev()),4==t.id&&"prev"==o&&(this.router.navigate(["/user/admin1/solutionboard/data-modeling"]),this.getTargetFileList(),this.getAllFunctions(),this.getAllOperatorsList()),4==t.id&&"next"==o&&(this.router.navigate(["/user/admin1/solutionboard/data-modeling"]),this.getTargetFileList(),this.getAllFunctions(),this.getAllOperatorsList()),this.tabsChange(t),console.log("this.fileListt",this.fileListt)}tabsChange(t){this.tabs.forEach(o=>{o.isActive=t.id==o.id})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(fe.F0),e.Y36(w.qu),e.Y36(ti.q),e.Y36(Nn.D),e.Y36(w.qu),e.Y36(e.Qsj),e.Y36(Jt.e),e.Y36(co.uw),e.Y36(fe.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-solution-board-overall"]],decls:33,vars:21,consts:[[1,"heading"],[2,"margin","0 0 5px"],[2,"color","#0076A8"],[1,"consen"],[2,"padding","10px"],[1,"bttn",2,"display","flex"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","combination",4,"ngIf"],["mat-button",""],["class","dds-icon dds-icon_chevron_right__l__stroke next",4,"ngIf"],[1,"dds-icon","dds-icon_chevron_right__l__stroke","next"],[1,"row"],["style","float:left ; width:100%",4,"ngIf"],["class","createNewSoltionsTable",4,"ngFor","ngForOf"],[2,"text-align","right","margin","20px 0 0 0"],["mat-button","","class","btnn",3,"disabled","click",4,"ngIf"],[2,"float","left","width","100%"],[1,"but"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[2,"font-size","9px","color","#707070"],["for","inputfile",1,"button",2,"float","right","background-color","#0076A8","color","#fff"],[2,"color","#fff","padding","7px"],[1,"note","required-field"],[1,"header"],[1,"selectCheck"],["type","checkbox","name","list_name","value","m1",3,"ngModel","ngModelChange","change"],[1,"createNewSoltionsTable"],[1,"dds-icon","dds-icon_file_xls__l__filled"],[1,"dds-icon","dds-icon_file_txt__l__filled"],[1,"dds-icon","dds-icon_file_csv__l__filled"],[1,"dds-icon","dds-icon_file_pdf__l__filled"],[1,"dds-icon","dds-icon_file_jpg__l__filled"],[1,"dds-icon","dds-icon_file_png__l__filled"],["src","../../assets/images/Json.svg","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["title","Delete",1,"dds-icon","dds-icon_delete__l__stroke",2,"float","right",3,"click"],["type","checkbox",1,"form-check-input",2,"margin","0 8px 0 0",3,"ngModel","ngModelChange","change"],["src","../../../../assets/images/xls_sheet.png","alt","","width","15px","height","15px",2,"margin","0 5px 0 0"],["title","preview",1,"dds-icon","dds-icon_eyeopen",2,"float","right",3,"click"],["src","../../assets/images/loading.gif","alt","","width","20px","height","20px",2,"margin-top","-4px","margin-left","100px"],["mat-button","",1,"btnn",3,"disabled","click"],[1,"row","targetFileRow"],[1,"note","required-field",2,"margin","10px 0 0 0","width","calc(100% - 120px)"],[1,"col-md-6"],[1,"col-md-6","scroll",2,"margin-top","10px","padding","0"],["class","table table-striped",4,"ngIf"],[2,"margin-left","70%","width","auto"],["mat-button","",1,"btnn",3,"click"],[1,"col-md-12","combination","scroll",2,"padding","0px"],[1,"table","table-striped"],[2,"width","1%","border","0","cursor","pointer",3,"click"],[2,"background-color","#0076A8","z-index","1"],["scope","col",2,"margin","auto","color","#fff","width","10%"],["scope","col",2,"margin","auto","color","#fff","width","25%"],["scope","col",2,"margin","auto","color","#fff","width","20%"],["scope","row",2,"width","10%"],["type","checkbox",3,"ngModel","ngModelChange"],[2,"width","25%"],[2,"width","20%"],["appearance","fill"],["placeholder","Select DataType",1,"form-control",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"combination"],[2,"float","right"],[1,"createNewSoltionsTable","appendTable"],[2,"background-color","#0076A8"],[2,"padding-left","78px !important","background-color","#0076A8"],[2,"padding-left","53px !important","background-color","#0076A8"],["class","trrr",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],["mat-button","",1,"btnn",2,"margin","30px",3,"click"],[1,"trrr"],["type","checkbox",3,"ngModel","ngModelChange","change"],[2,"width","50%"],[1,"dds-icon","dds-icon_file_xls__l__filled",2,"color","#26890d"],[1,"dds-icon","dds-icon_file_txt__l__filled",2,"color","#26890d"],[1,"dds-icon","dds-icon_file_csv__l__filled",2,"color","#26890d"],[1,"error"],["title","preview",1,"dds-icon","dds-icon_eyeopen",3,"click"],["title","Delete",1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[2,"float","right","margin-right","28px"],[1,"table","table-striped","createNewSoltionsTable"],["class","",4,"ngFor","ngForOf"],["mat-button","","class","btnn",3,"disabled","ngClass","click",4,"ngIf"],["style","float: left;",4,"ngIf"],[1,""],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","change"],[1,"rightIcons"],["mat-button","",1,"btnn",3,"disabled","ngClass","click"],[2,"border","1px #000 solid",3,"formGroup"],[1,"row",2,"background-color","#0076A8","color","#fff","width","100%","margin","auto"],[1,"col-md-2",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-3",2,"font-weight","600","background-color","#0076A8","color","#fff"],[1,"col-md-1",2,"font-weight","600","background-color","#0076A8","color","#fff"],["formArrayName","Merg"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"",2,"padding","7px"],["formArrayName","tableControl"],["class","",3,"formGroupName",4,"ngFor","ngForOf"],[1,"",3,"formGroupName"],[1,"col-md-2"],[1,"col-md-3"],["formControlName","table1",1,"form-control",3,"placeholder","ngClass","selectionChange"],["placeholder","Select Join","formControlName","join",1,"form-control",3,"ngClass","selectionChange"],["placeholder","Select Foreign Table","formControlName","table2",1,"form-control",3,"ngClass","selectionChange"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style"," line-height:14px;color: #fff;font-size: 14px;","title","Table",3,"disabled","click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","title","Table Delete","style","width: 50px; font-size:22px; line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["formArrayName","column"],["mat-button","","title","Table",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"disabled","click"],["mat-button","","title","Table Delete",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"ngClass","selectionChange"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"ngClass","selectionChange"],[1,"col-md-2",2,"border-bottom","1px solid"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;","title","Column",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","title","Column Delete","style","width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","","title","Column",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],["mat-button","","title","Column Delete",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],[2,"float","left"],["mat-button","",1,"btnn",2,"margin-left","0px !important",3,"click"],["mat-button","",1,"btnn",2,"float","right",3,"click"],[1,"dataModeling"],[1,"col-md-5","combination"],[1,"scroll"],[1,"header",2,"position","sticky","top","0","z-index","1"],["class","mat-table","style","text-align: center; font-size:13px",4,"ngIf"],["multi","","class","mat-table","is-open","true",4,"ngIf"],["class","col-md-7 combination expTable",4,"ngIf"],[2,"padding","0"],[2,"text-align","right","float","right"],["type","checkbox",2,"margin-right","10px",3,"ngModel","ngModelChange","click"],[3,"click"],["mat-button","",1,"btnn",2,"width","140px",3,"disabled","click"],[1,"scroll",2,"margin-bottom","10px"],[1,"mat-table",2,"text-align","center","font-size","13px"],["multi","","is-open","true",1,"mat-table"],[3,"expanded","opened","closed",4,"ngFor","ngForOf"],[3,"expanded","opened","closed"],[1,"mat-row"],[1,"dataP"],[1,"rightIcons1"],[1,"search1","col-md-6"],["id","form1","value","","placeholder","Search",1,"form-control",3,"keyup"],[2,"border-bottom","2px solid #cccccc","margin-bottom","10px"],["type","checkbox","title","Select All",1,"form-check-input",2,"margin-top","10px","margin-bottom","10px","height","18px","width","18px",3,"ngModel","ngModelChange","change"],[2,"margin-top","6px"],["style","cursor: pointer;",4,"ngFor","ngForOf"],[2,"cursor","pointer"],["class","scroll","style","cursor: pointer;",4,"ngFor","ngForOf"],[1,"scroll",2,"cursor","pointer"],[1,"mat-row",2,"margin-top","30px"],["type","checkbox",1,"form-check-input",3,"click"],[1,"rightIcons",2,"width","25%"],["title","View Dataset","title","preview",1,"dds-icon","dds-icon_eyeopen",3,"click"],["title","Edit Dataset",1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],["title","View Script",1,"dds-icon","dds-icon_file",3,"click"],["title","Delete Dataset",1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[1,"col-md-7","combination","expTable"],[3,"formGroup"],["class","table table-striped","style","margin-bottom:60px ;",4,"ngFor","ngForOf"],[1,"table","table-striped",2,"margin-bottom","60px"],[2,"width","100%","text-align","left"],["formControlName","sourceFieldName","oninput","this.value = this.value.replace(/[^0-9a-zA-Z_ ]/g, '').replace(/(\\..*)\\./g, '$1');","placeholder","Column Name",1,"form-control",2,"width","50%",3,"ngClass","value","select","click","keyup"],[2,"float","right","display","inline-flex","width","157px","margin-top","-2em"],["type","checkbox","formControlName","excludeInSelect","name","where",2,"width","30px"],[1,"row",2,"margin-top","10px"],["appearance","fill",1,"col-md-6",2,"padding-left","1px"],["placeholder","Select DataType","formControlName","columnType",1,"form-control",3,"value","ngClass","selectionChange"],[1,"dropdown","col-md-1"],["src","../../assets/images/fx.png","alt","","id","menu",2,"vertical-align","middle","margin","auto","width","28px","height","26px",3,"click"],[1,"dropdown-content","scroll"],[1,"search"],["id","form1","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],[1,"col-md-11"],["cols","20","rows","10","placeholder","Expression","formControlName","sourceExpressionName","name","Expression","id","",1,"form-control",2,"width","100%",3,"ngClass","value","select","click","keyup"],["mat-button","","class","btnn",3,"click",4,"ngIf"],["mat-button","","class","btnn","style","float:right ;",3,"click",4,"ngIf"],["appearance","fill",1,"col-md-6",2,"padding-right","1px"],["placeholder","Select DateFormat","formControlName","columnFormat",1,"form-control"],["style","border-bottom: 1px solid #000; border-radius: 0;padding: 0;",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #000","border-radius","0","padding","0"],[1,"addRow"],["placeholder","Select AND/OR",1,"form-control",3,"value","selectionChange"],["placeholder","Select Operator",1,"form-control",3,"value","selectionChange"],["placeholder","Value",1,"form-control",3,"ngModel","ngModelChange"],[1,"dds-icon","border","dds-icon_delete__l__stroke",3,"click"],[2,"margin","auto"],["colspan","1"],[1,"col-md-3",2,"text-align","right",3,"click"],[1,"dds-icon","dds-icon_close__l__stroke",2,"color","#fff"],[2,"text-align","right"],[2,"margin","10px"],["formArrayName","where"],["style","margin-bottom: 10px;",3,"formGroupName",4,"ngFor","ngForOf"],[2,"display","flex","margin","20px 0"],[2,"margin-left","38px"],["appearance","fill",2,"margin-left","21px","width","706px"],["multiple","","placeholder","Select groupBy","formControlName","groupBy",1,"form-control",3,"selectionChange"],[3,"change"],[2,"display","flex","margin","10px 0"],["matInput","","formControlName","having","placeholder","Having",1,"form-control",2,"margin-left","38px"],[2,"margin-left","35px"],["appearance","fill",2,"margin-left","26px","width","706px"],["multiple","","placeholder","Select orderBy","formControlName","orderBy",1,"form-control",3,"selectionChange"],[2,"width","1%","border","0"],[2,"text-align","right","width","1%","border","0"],[1,"dds-icon","dds-icon_edit__l__stroke",3,"click"],[1,"dds-icon","dds-icon_delete__l__stroke",3,"click"],[2,"margin-bottom","10px",3,"formGroupName"],[1,"addRow","row"],["appearance","fill",1,"col-md-3"],["placeholder","Select Column","formControlName","column",1,"form-control",3,"title","selectionChange"],["matSelect",""],[3,"title","value",4,"ngFor","ngForOf"],["placeholder","Select Operator","formControlName","signOperator",1,"form-control"],[1,"col-md-3",2,"display","flex"],["placeholder","Value","formControlName","value",1,"form-control",2,"width","210px"],["placeholder","Select AND/OR","formControlName","operator",1,"form-control"],[3,"title","value"],[1,"dds-icon","border","dds-icon_plus__l__stroke",3,"click"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header"],[2,"background-color","#0076A8","color","white","padding","10px"],[1,"report-modal-close","dds-icon","dds-icon_close__l__stroke",3,"click"],["formArrayName","addRelationshipRows"],["class","flex-container","style","margin: 10px 0px 10px 75px;",3,"formGroupName",4,"ngFor","ngForOf"],["mat-button","",2,"background-color","#0076A8","color","white",3,"click"],["mat-button","",2,"color","#0076A8","background","#fff",3,"click"],[1,"flex-container",2,"margin","10px 0px 10px 75px",3,"formGroupName"],[1,"flex-child"],["id","Name","formControlName","fromTable","placeholder","select from table",1,"form-control",3,"ngClass","selectionChange"],["id","Name","formControlName","fromColumn","placeholder","select table column",1,"form-control",3,"ngClass"],["id","Name","formControlName","crossFilteringBehavior","placeholder","select to table",1,"form-control",3,"ngClass"],["id","Name","formControlName","toTable","placeholder","select to table",1,"form-control",3,"ngClass","selectionChange"],["id","Name","formControlName","toColumn","placeholder","select table column",1,"form-control",3,"ngClass"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style"," line-height:14px;color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","",1,"dds-icon","dds-icon_plus__l__stroke","btnn",2,"line-height","14px","color","#fff","font-size","14px",3,"click"],[1,"row","popup"],[1,"field"],["type","text","formControlName","appendNameControl","oninput","this.value = this.value.replace(/[^0-9a-zA-Z_]/g, '').replace(/(\\..*)\\./g, '$1');",3,"ngClass","keyup"],[1,"col-sm-12",2,"float","right","text-align","right"],["mat-button","","type","submit",3,"click"],["mat-button","",3,"click"],[1,"taxt-audit-popup","preview",2,"width","1000px"],["style","float:left;margin: 22px;",4,"ngIf"],[1,"col-sm-3",2,"float","right","text-align","right"],["mat-button","",2,"border","1px solid #0076A8","background","none","color","#0076A8",3,"click"],[1,"dds-icon",2,"color","#fff",3,"ngClass"],[1,"dds-icon","dds-icon_arrow_down__l__stroke"],[1,"dds-icon","dds-icon_arrow_up__l__stroke"],["style","width:120px; word-break: break-all;",4,"ngFor","ngForOf"],[2,"width","120px","word-break","break-all"],[2,"float","left","margin","22px"],[1,"taxt-audit-popup",2,"width","1200px"],[2,"background-color","#0076A8","color","white","float","right",3,"click"],["aria-hidden","true"],["formArrayName","DSetRows",1,"row","popup",2,"margin-top","10px"],["appearance","fill",1,"col-md-4"],["formControlName","Ptable",1,"form-control",3,"placeholder","ngClass","closed","selectionChange"],["type","text","placeholder","search",3,"value","keyup"],["placeholder","Join Type","formControlName","join",1,"form-control",3,"ngClass","selectionChange"],["placeholder","Foreign Table","formControlName","Ftable",1,"form-control",3,"ngClass","selectionChange","closed"],["formArrayName","columns"],[1,"col-md-4"],["placeholder","Select Column","formControlName","column1",1,"form-control",3,"ngClass","selectionChange","closed"],["placeholder","Select Column","formControlName","column2",1,"form-control",3,"ngClass","selectionChange","closed"],["mat-button","","class","dds-icon dds-icon_plus__l__stroke btnn","style","color: #fff;font-size: 14px;","style","line-height:14px; color: #fff;font-size: 14px;",3,"click",4,"ngIf"],["mat-button","","class","dds-icon dds-icon_delete__l__stroke btnn","style","color: #fff;font-size: 14px;","style","width: 50px; font-size:22px; line-height:14px; color:#fff;font-size: 14px;",3,"click",4,"ngIf"],["selectForeignKeyInDS","",3,"value",4,"ngFor","ngForOf"],["selectForeignKeyInDS","",3,"value"],["mat-button","",1,"dds-icon","dds-icon_delete__l__stroke","btnn",2,"width","50px","font-size","22px","line-height","14px","color","#fff","font-size","14px",3,"click"],[1,"taxt_audit-report","enableUploadSQLPopup"],["mat-input","","type","name","cols","50","formControlName","sqlScript","name","s",1,"form-control",2,"min-height","60vh","width","100%",3,"ngClass"],[1,"taxt-audit-popup",2,"margin-left","50px"],["type","text","formControlName","datasetName","placeholder","DataSet Name",3,"ngClass","keyup"],["mat-input","","type","name","formControlName","sqlScript","name","s",1,"form-control",2,"background-color","#2d2d2d","color","#fff",3,"ngClass"],["for","sqlTxtFile",1,"button"],["type","file","id","sqlTxtFile",2,"display","none",3,"change"],[2,"float","left","margin-left","20px"],["mat-button","",2,"color","#0076A8","background-color","#fff",3,"ngClass","click"],["mat-button","",2,"margin-right","2px !important","color","#0076A8","background-color","#fff",3,"ngClass","click"],["mat-input","","type","name","formControlName","gscript","name","m",1,"form-control",2,"background-color","#2d2d2d","color","#fff",3,"ngClass"],["mat-input","","type","name","formControlName","script","name","sp",1,"form-control",2,"background-color","#2d2d2d","color","#fff",3,"ngClass"],[2,"background-color","#0076A8","color","white","padding","10px","height","34px","margin-bottom","20px"],[2,"text-align","center"],[1,"col-sm-4",2,"float","right","margin","5% 35% 5% 35%"],["mat-button","",2,"width","40%","height","39px","background-color","#0076A8","color","white","border-radius","0","margin-top","42px",3,"click"],[1,"dds-icon_exclemation-mark","next",2,"border-radius","100%"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"New Solution"),e.qZA(),e.TgZ(3,"h5")(4,"span",2),e._uU(5,"Dashboard / "),e.qZA(),e._uU(6,"Solution Board / New Solution"),e.qZA()(),e.TgZ(7,"div",3)(8,"div"),e._uU(9),e.qZA(),e.TgZ(10,"h5",4),e._uU(11,"Dataset(s) Preparation:"),e.qZA(),e.TgZ(12,"div",5),e.YNc(13,BI,5,4,"ng-container",6),e.qZA(),e.YNc(14,tE,9,4,"div",7),e.YNc(15,fE,13,2,"ng-container",7),e.YNc(16,kE,8,2,"div",8),e.YNc(17,tZ,16,2,"div",8),e.YNc(18,hP,46,8,"div",7),e.qZA(),e.YNc(19,xP,20,5,"div",7),e.YNc(20,CP,20,5,"div",7),e.YNc(21,yP,15,3,"div",7),e.YNc(22,kP,19,5,"div",7),e.YNc(23,JP,16,2,"div",7),e.YNc(24,qP,13,4,"div",7),e.YNc(25,RP,14,7,"div",7),e.YNc(26,HP,20,5,"div",7),e.YNc(27,$P,11,2,"div",7),e.YNc(28,zP,11,2,"div",7),e.YNc(29,jP,23,9,"div",7),e.YNc(30,o8,18,4,"div",7),e.YNc(31,r8,17,0,"div",7),e.YNc(32,a8,14,1,"div",7)),2&t&&(e.xp6(9),e.hij("Process Name: ",o.process.processName,""),e.xp6(4),e.Q6J("ngForOf",o.tabs),e.xp6(1),e.Q6J("ngIf",0==o.tabs[0].id&&1==o.tabs[0].isActive),e.xp6(1),e.Q6J("ngIf",1==o.tabs[1].id&&1==o.tabs[1].isActive),e.xp6(1),e.Q6J("ngIf",2==o.tabs[2].id&&1==o.tabs[2].isActive),e.xp6(1),e.Q6J("ngIf",3==o.tabs[3].id&&1==o.tabs[3].isActive),e.xp6(1),e.Q6J("ngIf",4==o.tabs[4].id&&1==o.tabs[4].isActive),e.xp6(1),e.Q6J("ngIf",o.enableAppendNamePopup),e.xp6(1),e.Q6J("ngIf",o.enableMergeNamePopup),e.xp6(1),e.Q6J("ngIf",o.showTargetFilePopup),e.xp6(1),e.Q6J("ngIf",o.enableDataSetPopUp),e.xp6(1),e.Q6J("ngIf",o.saveDataSetPopup),e.xp6(1),e.Q6J("ngIf",o.enableViewScriptDSPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQLPopup),e.xp6(1),e.Q6J("ngIf",o.enableDatasetAppendPopup),e.xp6(1),e.Q6J("ngIf",o.enableUploadSQL),e.xp6(1),e.Q6J("ngIf",o.enableUploadPython),e.xp6(1),e.Q6J("ngIf",o.enableViewscriptPopup),e.xp6(1),e.Q6J("ngIf",o.enableDeletePopup),e.xp6(1),e.Q6J("ngIf",o.enableOverRideConfirmPopup),e.xp6(1),e.Q6J("ngIf",o.enableDatasetColumnsExceed))},directives:[be.sg,Ze.lW,be.O5,Se.a8,w.Wl,w.JJ,w.On,Ln.KE,hi.gD,Et.ey,be.mk,w._Y,w.JL,w.sg,w.CE,w.x0,w.u,lt.pp,lt.ib,lt.yz,w.Fj,Ls.oG,Qi.Nt,w.F],pipes:[Is],styles:['.mat-card[_ngcontent-%COMP%]{margin-top:2%;float:left;width:100%}.btn[_ngcontent-%COMP%]{height:37px;border-radius:0;background-color:#0076a8;color:#fff;width:auto}.taxt-audit-popup[_ngcontent-%COMP%]{height:auto}.report-modal-close[_ngcontent-%COMP%]{float:right;position:relative;top:0;cursor:pointer;color:#fff}.flex-container[_ngcontent-%COMP%]{display:inline-flex}.flex-child[_ngcontent-%COMP%]{margin:5px;width:150px}.required[_ngcontent-%COMP%]{color:red;font-size:12px;font-weight:600;position:relative;top:-10px}.flex-child[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:5px}.mat-button-disabled[_ngcontent-%COMP%]{cursor:not-allowed!important;background:#0076a873!important}h3[_ngcontent-%COMP%]{font-size:25px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}.btnn[_ngcontent-%COMP%]{border-radius:0;margin:14px 0 14px 10px!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:150px;height:40px;font-family:open_sans-regular;font-size:13px;line-height:18px;transition:all .5s cubic-bezier(.77,0,.175,1)}.btnn.preview[_ngcontent-%COMP%]{float:right;margin:10px 0 0!important}.btnn[_ngcontent-%COMP%]:hover{box-shadow:inset 150px 0 #041e42;color:#fff!important;border:1px solid #041E42}.btnnn[_ngcontent-%COMP%]{height:50px;border:1px solid #cccaca;text-align:left;width:100%;border-radius:0;background-color:#fff;color:#000;font-size:17px}.btnnn[_ngcontent-%COMP%]:nth-child(odd){background-color:#eee}.btnnn[_ngcontent-%COMP%]:hover, .btnnn[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff}.scroll[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll1[_ngcontent-%COMP%]{max-height:200px!important;margin-bottom:10px}.scroll2[_ngcontent-%COMP%]{max-height:400px!important;margin-bottom:10px}.scroll1[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .scroll2[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{position:sticky;top:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.select[_ngcontent-%COMP%]{transform:rotate(45deg);-webkit-transform:rotate(45deg)}table[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:220px;border-radius:0;font-size:12px;border:1px solid #cccaca;font-family:open_sans-regular!important;padding:5px 8px}.dds-icon_file_xls__l__filled[_ngcontent-%COMP%]:before{padding-right:10px}.bttn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:inline;height:45px;width:15%;border-radius:0;background-color:#fff;color:#000;box-shadow:0 0 6px 1px #cccaca}.bttn[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#0076a8;color:#fff;box-shadow:0 0 6px 1px #cccaca}.sheet[_ngcontent-%COMP%]{border:2px solid #eee}table[_ngcontent-%COMP%]{width:100%;margin:0%}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#eeeeee}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#000;height:24px;padding:0 20px;font-family:open_sans-medium;font-size:14px;line-height:16px}table.createNewSoltionsTable[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{color:#5aa448;font-size:19px}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#041E42!important}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px!important;color:#fff!important;font-family:open_sans-regular!important;font-weight:400}table.createNewSoltionsTable.appendTable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;text-align:center}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background:#fff}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{height:28px;padding:2px 20px 2px 53px!important;border-bottom:1px solid #eee;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{height:16px;width:16px;vertical-align:middle}table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], table.createNewSoltionsTable[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{text-align:left}table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px}.selectCheck[_ngcontent-%COMP%]{float:left;width:100%;margin:0 0 10px}.selectCheck[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{vertical-align:middle;width:16px;height:16px;margin:0 5px 0 0}.selectCheck[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-family:open_sans-regular;vertical-align:middle}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span.dds-icon[_ngcontent-%COMP%]{height:auto;vertical-align:middle}table[_ngcontent-%COMP%]   td.active[_ngcontent-%COMP%]{background-color:#87ceeb!important}h6[_ngcontent-%COMP%]{float:left;width:100%;padding:10px 0 0 65px}.append[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]{display:block;position:relative;padding:16px;border-radius:4px;box-shadow:0 0 6px 1px #cccaca;margin-top:10px;float:left;width:100%}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even){background-color:#eee}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]:nth-child(even)   td[_ngcontent-%COMP%]{background:#eee!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]{background-color:#fff;width:inherit;display:table-row;height:40px}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#fff!important}.combination[_ngcontent-%COMP%]   .trrr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px;margin:0 10px 0 0;vertical-align:middle}.header[_ngcontent-%COMP%]{width:100%;background:#0076A8;float:left;margin:0 0 15px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{padding:8px 12px;color:#fff;font-family:open_sans-regular;font-size:14px;line-height:19px;float:left;width:100%;margin:0}.heading[_ngcontent-%COMP%]{background-color:#fff;padding:8px 20px;display:inline-block;width:100%}.heading[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;line-height:20px;font-family:open_sans-bold;margin:0 0 3px;color:#1c1c1c;float:left;width:100%}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin:0}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{float:left;margin:0 8px 0 0;color:#000;font-family:open_sans-regular;font-size:10px;line-height:14px;list-style:none}.heading[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#005587;font-family:open_sans-regular;font-size:10px;line-height:14px;float:left;text-decoration:none;padding:0 7px 0 0}.next[_ngcontent-%COMP%]{position:absolute;top:20%;left:95%;font-size:22px;color:#0076a8!important;border:1px #707070 solid;border-radius:50%;background-color:#fff;z-index:1;padding:0;height:24px;line-height:21px}.but[_ngcontent-%COMP%]{padding:0;display:block;width:440px;margin:14% auto 15%}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{background-color:#eee;text-align-last:center;height:159px;width:440px;border-style:dotted;border-width:1px solid;color:#0076a8;margin:auto;padding:30px}.but[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;padding:0 0 0 10px;vertical-align:middle}.taxt-audit-popup[_ngcontent-%COMP%]{background:#fff;width:800px;position:absolute;top:50%;left:50%;transform:translate(-50%,-40%)}.taxt-audit-popup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{float:left;width:100%}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{border-radius:0;border:0;margin:14px 20px 25px 0!important;background-color:#0076a8;border:1px solid #0076A8;color:#fff;width:100px;font-family:open_sans-regular;font-size:13px;line-height:18px;padding:9px 0;float:right;transition:all .5s cubic-bezier(.77,0,.175,1)}.taxt-audit-popup[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]:hover{box-shadow:inset 100px 0 #041e42;color:#fff!important;border:1px solid #041E42}.taxt-audit-popup[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#d8000c;position:absolute;font-size:12px;line-height:15px;font-family:open_sans-regular;bottom:71px;right:20px;font-size:11px}.taxt-audit-popup.preview[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{height:400px;overflow-y:auto}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.allow-cr[_ngcontent-%COMP%]{white-space:pre-line}.mat-accordion[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]{padding-left:1.5rem;padding-right:2rem;border-bottom:none}.mat-expansion-panel-header.mat-row[_ngcontent-%COMP%]{border-bottom:none}p.dataP[_ngcontent-%COMP%]{float:left;width:calc(100% - 150px);margin:0;height:auto;line-height:20px;color:#000;line-height:36px}.rightIcons[_ngcontent-%COMP%]{float:right}.rightIcons[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 3px;float:left;height:auto}.rightIcons1[_ngcontent-%COMP%]{float:right}.rightIcons1[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{margin:9px 50px;float:left;height:auto}.mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000}.mat-expansion-panel-spacing[_ngcontent-%COMP%]{margin:0}.mat-table[_ngcontent-%COMP%]{display:block}.mat-header-row[_ngcontent-%COMP%], .mat-row[_ngcontent-%COMP%]{min-height:33px}.mat-row[_ngcontent-%COMP%], .mat-header-row[_ngcontent-%COMP%]{display:flex;border-bottom-width:1px;border-bottom-style:solid;align-items:center;padding:0 24px;box-sizing:border-box}.mat-row[_ngcontent-%COMP%]:after, .mat-header-row[_ngcontent-%COMP%]:after{display:inline-block;min-height:inherit;content:""}.mat-cell[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{flex:1;overflow:hidden;word-wrap:break-word}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;position:relative}.dataModeling[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{float:right;position:absolute;right:0}.dataModeling[_ngcontent-%COMP%]   .mat-table[_ngcontent-%COMP%]{float:left;width:100%;box-shadow:0 0 4px #0003;border:1px solid #D6D6D6;margin:0 0 15px}.dataModeling[_ngcontent-%COMP%]   .mat-content[_ngcontent-%COMP%]{font-size:14px;line-height:25px}.dataModeling[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{border-bottom:1px solid #D6D6D6;border-radius:0}.dataModeling[_ngcontent-%COMP%]   .combination[_ngcontent-%COMP%]{box-shadow:none}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-5[_ngcontent-%COMP%]{width:45%;padding:0}.dataModeling[_ngcontent-%COMP%]   .combination.col-md-7[_ngcontent-%COMP%]{width:53%;padding:0;margin-left:2%}.dataModeling[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%], .dataModeling[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin:0}.targetFileRow[_ngcontent-%COMP%]   .combination.col-md-6[_ngcontent-%COMP%]{width:50%;box-shadow:none}.row.popup[_ngcontent-%COMP%]{margin:0;float:left;width:100%}.row.popup[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{float:left;width:100%}.row.popup[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{float:left;width:100%;padding:20px}.dropdown[_ngcontent-%COMP%]{position:relative;display:inline-block;cursor:pointer}.dropdown-content[_ngcontent-%COMP%]{display:none;position:absolute;background-color:#f9f9f9;min-width:160px;box-shadow:0 8px 16px #0003;padding:12px 16px;z-index:1;width:250px}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{height:24px!important;min-height:24px!important}.dropdown-content[_ngcontent-%COMP%]   .mat-expansion-indicator[_ngcontent-%COMP%]{top:0!important}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{width:100%;margin:0 0 8px}.dropdown-content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{box-shadow:none}.dropdown-content[_ngcontent-%COMP%]   .mat-accordion[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:12px;margin-bottom:8px;width:100%;float:left;word-break:break-all}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dds-icon.border[_ngcontent-%COMP%]{border:2px solid #000;padding:5px;border-radius:50%;margin-top:2px}.error[_ngcontent-%COMP%]{color:#d8000c;font-size:12px;line-height:15px;font-family:open_sans-regular}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}form[_ngcontent-%COMP%]   .col-md-2[_ngcontent-%COMP%]   .btnn[_ngcontent-%COMP%]{margin:1px 0 10px 10px!important;height:auto}.search[_ngcontent-%COMP%]{width:25%;float:right;border-radius:0;box-shadow:inset 0 2px 2px #00000029;border:1px solid #CCCCCC;font-size:14px;line-height:19px;font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF;margin:0 0 20px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12px;border-radius:0;border:0px none;padding:0;margin:0 3px 0 0;width:calc(100% - 30px);float:left}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{box-shadow:none}.search[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;padding:3px 0 0;font-size:17px;height:auto}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 10px!important}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]{margin:2px 0;float:left;width:100%}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:30%;float:left;margin:0 5px 0 0}.expTable.combination[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .addRow[_ngcontent-%COMP%]   .dds-icon[_ngcontent-%COMP%]{float:left;margin:6px 0 0;cursor:pointer;font-size:16px;padding:3px}.dds-icon[_ngcontent-%COMP%]{color:#707070;font-size:19px}.note[_ngcontent-%COMP%]{font-size:13px;line-height:17px;font-family:open_sans-regular;color:#000;float:left;margin:0 0 10px;width:100%}.required-field[_ngcontent-%COMP%]:before{content:"*";color:red}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   .taxt-audit-popup[_ngcontent-%COMP%]{width:80%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{padding:10px}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:0;width:100%}.taxt_audit-report.enableUploadSQLPopup[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:50vh;width:100%}.scroll[_ngcontent-%COMP%]{overflow-y:auto;box-shadow:0 0 1px #9b9b9b,0 1px 1px #9b9b9b,0 1px 1px #9b9b9b}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 gray;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#041E42;border-radius:0}.scroll[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#041E42}.search1[_ngcontent-%COMP%]{font-family:open_sans-regular;color:#000;padding:5.5px 10px;background:#FFFFFF}sup[_ngcontent-%COMP%]{color:red}.activeBtn[_ngcontent-%COMP%]{color:#0076a8;background:#fff}.nonactiveBtn[_ngcontent-%COMP%]{color:#fff;background:#0076A8}form[_ngcontent-%COMP%]   input.is-invalid[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.is-invalid[_ngcontent-%COMP%]{border:1px solid #f00;transition:.3 ease-in linear}.mat-button.activeBtn[_ngcontent-%COMP%]{background-color:#0076a8!important;color:#fff!important}']}),n})();var s_=ce(2916),l_=ce(353),l8=ce(4241);function c_(n=0,r=l_.P){return(!(0,l8.k)(n)||n<0)&&(n=0),(!r||"function"!=typeof r.schedule)&&(r=l_.P),new s_.y(t=>(t.add(r.schedule(c8,n,{subscriber:t,counter:0,period:n})),t))}function c8(n){const{subscriber:r,counter:t,period:o}=n;r.next(t),this.schedule({subscriber:r,counter:t+1,period:o},o)}function d8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Total Projects"),e.qZA(),e.TgZ(3,"h2"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(null==t?null:t.statusCount)}}function _8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,d8,5,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Total Projects"==(null==t?null:t.statusName))}}function p8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Standalone"),e.qZA(),e.TgZ(3,"h2"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(null==t?null:t.totalProjects)}}function u8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,p8,5,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Standlone"==(null==t?null:t.projectType))}}function f8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h5"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(null==t?null:t.statusCount)}}function m8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,f8,3,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Completed"==(null==t?null:t.statusName))}}function h8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,m8,2,1,"ng-container",7),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.projectTypeStatus)}}function g8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,h8,2,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Standlone"==(null==t?null:t.projectType))}}function x8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h5"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(null==t?null:t.statusCount)}}function v8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,x8,3,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","failed"==(null==t?null:t.statusName))}}function C8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,v8,2,1,"ng-container",7),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.projectTypeStatus)}}function T8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,C8,2,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Standlone"==(null==t?null:t.projectType))}}function b8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"h3"),e._uU(2,"Draft Projects"),e.qZA(),e.TgZ(3,"h2"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.Oqu(null==t?null:t.statusCount)}}function w8(n,r){if(1&n&&(e.ynx(0),e.YNc(1,b8,5,1,"ng-container",54),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Draft"==(null==t?null:t.statusName))}}function S8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Project Name "),e.qZA())}function N8(n,r){if(1&n&&(e.TgZ(0,"td",56),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.projectName," ")}}function A8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Process Name "),e.qZA())}function y8(n,r){if(1&n&&(e.TgZ(0,"td",56),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.processName," ")}}function D8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Process Type "),e.qZA())}function k8(n,r){if(1&n&&(e.TgZ(0,"td",56),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.projectType," ")}}function F8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Creation Date & Time "),e.qZA())}function M8(n,r){if(1&n&&(e.TgZ(0,"td",56),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.creationDate,"dd/MM/yyyy, h:mm a")," ")}}function L8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Execution Date & Time "),e.qZA())}function I8(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"--"),e.qZA())}function E8(n,r){if(1&n&&(e.TgZ(0,"td",56)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.YNc(4,I8,2,0,"span",54),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(e.xi3(3,2,t.lastExcuteDate,"dd/MM/yyyy, h:mm a")),e.xp6(2),e.Q6J("ngIf",null==t.lastExcuteDate)}}function Z8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Scheduled Date & Time "),e.qZA())}function P8(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"--"),e.qZA())}function O8(n,r){if(1&n&&(e.TgZ(0,"td",56)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.YNc(4,P8,2,0,"span",54),e.qZA()),2&n){const t=r.$implicit;e.xp6(2),e.Oqu(e.xi3(3,2,t.lastScheduleDate,"dd/MM/yyyy, h:mm a")),e.xp6(2),e.Q6J("ngIf",null==t.lastScheduleDate)}}function U8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Project Status "),e.qZA())}function B8(n,r){if(1&n&&(e.TgZ(0,"td",56)(1,"span"),e._uU(2),e.qZA()()),2&n){const t=r.$implicit;e.xp6(1),e.Tol(t.statusName),e.xp6(1),e.Oqu(t.statusName)}}function J8(n,r){1&n&&(e.TgZ(0,"th",55),e._uU(1," Actions "),e.qZA())}function q8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",61),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw().projectCompleted(i)}),e.qZA()}}function R8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",62),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw().failedproject(i)}),e.qZA()}}function Q8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",62),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw().failedproject(i)}),e.qZA()}}function H8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",63),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).projectScheduled()}),e.qZA()}}function Y8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"span",64),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw().projectDraft(i)}),e.qZA()}}function V8(n,r){if(1&n&&(e.TgZ(0,"td",56),e.YNc(1,q8,1,0,"span",57),e.YNc(2,R8,1,0,"span",58),e.YNc(3,Q8,1,0,"span",58),e.YNc(4,H8,1,0,"span",59),e.YNc(5,Y8,1,0,"span",60),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("ngIf","Success"==t.statusName),e.xp6(1),e.Q6J("ngIf","Failed"==t.statusName),e.xp6(1),e.Q6J("ngIf","PBI-Failed"==t.statusName),e.xp6(1),e.Q6J("ngIf","Scheduled"==t.statusName),e.xp6(1),e.Q6J("ngIf","Draft"==t.statusName)}}function $8(n,r){1&n&&e._UZ(0,"tr",65)}function K8(n,r){1&n&&e._UZ(0,"tr",66)}function W8(n,r){if(1&n&&(e.TgZ(0,"tr",67)(1,"td",68),e._uU(2," No data found "),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",t.displayedColumns.length)}}function z8(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",73)(2,"div",74)(3,"label"),e._uU(4,"Frequency"),e.qZA(),e._UZ(5,"input",75),e.qZA(),e.TgZ(6,"div",74)(7,"label"),e._uU(8,"Startday"),e.qZA(),e._UZ(9,"input",75),e.qZA()(),e.TgZ(10,"div",73)(11,"div",74)(12,"label"),e._uU(13,"Endday"),e.qZA(),e._UZ(14,"input",75),e.qZA(),e.TgZ(15,"div",74)(16,"label"),e._uU(17,"Execution Time"),e.qZA(),e._UZ(18,"input",75),e.qZA()(),e.TgZ(19,"div",73)(20,"div",74)(21,"label"),e._uU(22,"Execution Day"),e.qZA(),e._UZ(23,"input",75),e.qZA(),e.TgZ(24,"div",74)(25,"label"),e._uU(26,"Execution Date"),e.qZA(),e._UZ(27,"input",75),e.qZA()(),e.BQk()),2&n){const t=r.$implicit;e.xp6(5),e.Q6J("value",t.schedulerDTO.schedulefrequency),e.xp6(4),e.Q6J("value",t.schedulerDTO.startDate),e.xp6(5),e.Q6J("value",t.schedulerDTO.endDate),e.xp6(4),e.Q6J("value",t.schedulerDTO.executionTime),e.xp6(5),e.Q6J("value",t.schedulerDTO.executionDay),e.xp6(4),e.Q6J("value",t.schedulerDTO.dateOfMonth)}}function G8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",43)(2,"div",69)(3,"div",45)(4,"h3"),e._uU(5,"Scheduled Project"),e.qZA(),e.TgZ(6,"button",70),e.NdJ("click",function(){return e.CHM(t),e.oxw().CloseModal()}),e.TgZ(7,"span",71),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",72)(10,"form"),e.YNc(11,z8,28,6,"ng-container",7),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.projectdetails)}}function X8(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",43)(2,"div",69)(3,"div",45)(4,"h3"),e._uU(5,"Failure"),e.qZA(),e.TgZ(6,"button",76),e.NdJ("click",function(){return e.CHM(t),e.oxw().CloseModal()}),e._UZ(7,"span",50),e.qZA()(),e.TgZ(8,"div",77),e.ynx(9),e.TgZ(10,"p",78),e._uU(11),e.qZA(),e.BQk(),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Oqu(t.failed.errorMessage)}}const j8=function(){return[10,20,50]},e7=function(){return["/powerbireport"]};function n7(n,r){if(1&n&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t.processName," ")}}function i7(n,r){1&n&&(e.TgZ(0,"div",22)(1,"label"),e._uU(2,"\xa0"),e.qZA(),e.TgZ(3,"button",23),e._uU(4,"Create"),e.qZA()())}function o7(n,r){if(1&n&&(e.TgZ(0,"div",37)(1,"label"),e._UZ(2,"span",38),e._uU(3),e.qZA()()),2&n){const t=r.$implicit;e.xp6(3),e.hij(" ",t.templateName,"")}}function r7(n,r){1&n&&(e.TgZ(0,"h5",4),e._uU(1,"Upload Files"),e.qZA())}function a7(n,r){1&n&&(e.TgZ(0,"h5",4),e._uU(1,"Uploaded Files"),e.qZA())}function s7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",39),e.ynx(1),e.TgZ(2,"label",40)(3,"input",41),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._UZ(4,"span",42),e.TgZ(5,"h5"),e._uU(6,"Drag and drop files, or "),e.TgZ(7,"span"),e._uU(8,"Browse"),e.qZA()(),e.TgZ(9,"p"),e._uU(10,"Supported XLS, PDF & CSV files."),e.qZA()(),e.BQk(),e.qZA()}}function l7(n,r){if(1&n&&(e.TgZ(0,"div",37)(1,"label"),e._UZ(2,"span",38),e._uU(3),e.qZA()()),2&n){const t=r.$implicit;e.xp6(3),e.hij(" ",t,"")}}function c7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24)(1,"div",25),e.YNc(2,l7,4,1,"div",26),e.qZA(),e.TgZ(3,"div",27)(4,"label",43)(5,"input",44),e.NdJ("change",function(i){return e.CHM(t),e.oxw(2).saveiputFiles(i)}),e.qZA(),e._uU(6," Upload More Files"),e._UZ(7,"span",45),e.qZA()()()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.uploadData)}}function d7(n,r){1&n&&(e.TgZ(0,"div",53)(1,"div",33)(2,"label"),e._uU(3,"Week"),e.qZA(),e.TgZ(4,"select",61)(5,"option",62),e._uU(6,"Monday"),e.qZA(),e.TgZ(7,"option",63),e._uU(8,"Tuesday"),e.qZA(),e.TgZ(9,"option",64),e._uU(10,"Wednesday"),e.qZA(),e.TgZ(11,"option",65),e._uU(12,"Thursday"),e.qZA(),e.TgZ(13,"option",66),e._uU(14,"Friday"),e.qZA(),e.TgZ(15,"option",67),e._uU(16,"Saturday"),e.qZA(),e.TgZ(17,"option",68),e._uU(18,"Sunday"),e.qZA()()()())}function _7(n,r){1&n&&(e.TgZ(0,"div",53)(1,"div",54)(2,"label"),e._uU(3,"Date"),e.qZA(),e.TgZ(4,"select",69)(5,"option",70),e._uU(6,"1"),e.qZA(),e.TgZ(7,"option",71),e._uU(8,"2"),e.qZA(),e.TgZ(9,"option",72),e._uU(10,"3"),e.qZA(),e.TgZ(11,"option",73),e._uU(12,"4"),e.qZA(),e.TgZ(13,"option",74),e._uU(14,"5"),e.qZA(),e.TgZ(15,"option",75),e._uU(16,"6"),e.qZA(),e.TgZ(17,"option",76),e._uU(18,"7"),e.qZA()()()())}function p7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"form",46)(1,"div",47)(2,"div",48)(3,"div",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changesubtab(1)}),e.TgZ(4,"p",50),e._uU(5,"Daily"),e.qZA()(),e.TgZ(6,"div",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changesubtab(2)}),e.TgZ(7,"p",50),e._uU(8,"Weekly"),e.qZA()(),e.TgZ(9,"div",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changesubtab(3)}),e.TgZ(10,"p",50),e._uU(11," Monthly"),e.qZA()(),e._UZ(12,"div",51),e.qZA(),e.TgZ(13,"div",52)(14,"div",53)(15,"div",54)(16,"label"),e._uU(17,"Start Date"),e.qZA(),e._UZ(18,"input",55),e.qZA()(),e.TgZ(19,"div",56)(20,"div",54)(21,"label"),e._uU(22,"End Date"),e.qZA(),e._UZ(23,"input",57),e.qZA()(),e.YNc(24,d7,19,0,"div",58),e.YNc(25,_7,19,0,"div",58),e.TgZ(26,"div",56)(27,"div",59)(28,"label"),e._uU(29,"Time"),e.qZA(),e._UZ(30,"input",60),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.Q6J("formGroup",t.scheduleForm),e.xp6(3),e.ekj("active",t.subtab1),e.xp6(3),e.ekj("active",t.subtab2),e.xp6(3),e.ekj("active",t.subtab3),e.xp6(3),e.Q6J("ngClass",t.subtab1?"tab1":t.subtab2?"tab2":t.subtab3?"tab3":""),e.xp6(12),e.Q6J("ngIf",t.subtab2),e.xp6(1),e.Q6J("ngIf",t.subtab3)}}function u7(n,r){1&n&&(e.TgZ(0,"div",6)(1,"div",7)(2,"div",33)(3,"label"),e._uU(4,"Source"),e.TgZ(5,"sup"),e._uU(6,"*"),e.qZA()(),e.TgZ(7,"mat-form-field",8)(8,"mat-select")(9,"mat-option",21),e._uU(10," Select Source "),e.qZA()()()()(),e.TgZ(11,"div",13)(12,"div",33)(13,"label"),e._uU(14,"Path"),e.TgZ(15,"sup"),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"mat-form-field"),e._UZ(18,"input",77),e.qZA()()()())}function f7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",6)(2,"div",7)(3,"h5",4),e._uU(4,"Download Files"),e.qZA(),e.TgZ(5,"div",24)(6,"div",25),e.YNc(7,o7,4,1,"div",26),e.qZA(),e.TgZ(8,"div",27)(9,"button",28),e.NdJ("click",function(){return e.CHM(t),e.oxw().downloadTemplates()}),e._uU(10,"Download"),e._UZ(11,"span",29),e.qZA()()()(),e.TgZ(12,"div",7),e.YNc(13,r7,2,0,"h5",30),e.YNc(14,a7,2,0,"h5",30),e.YNc(15,s7,11,0,"div",31),e.YNc(16,c7,8,1,"div",32),e.qZA(),e.TgZ(17,"div",7)(18,"div")(19,"h5",4),e._uU(20,"Execute Process"),e.qZA(),e.TgZ(21,"div",33)(22,"div",15)(23,"input",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeProject()}),e.qZA(),e.TgZ(24,"label"),e._uU(25,"Execute Now"),e.qZA()()()(),e.YNc(26,p7,31,10,"form",35),e.qZA()(),e.YNc(27,u7,19,0,"div",36),e.qZA()}if(2&n){const t=e.oxw();e.xp6(7),e.Q6J("ngForOf",t.anayticfile),e.xp6(6),e.Q6J("ngIf",0==(null==t.uploadData?null:t.uploadData.length)),e.xp6(1),e.Q6J("ngIf",(null==t.uploadData?null:t.uploadData.length)>0),e.xp6(1),e.Q6J("ngIf",0==(null==t.uploadData?null:t.uploadData.length)),e.xp6(1),e.Q6J("ngIf",(null==t.uploadData?null:t.uploadData.length)>0),e.xp6(7),e.Q6J("checked",!t.scheduleForms),e.xp6(3),e.Q6J("ngIf",t.scheduleForms),e.xp6(1),e.Q6J("ngIf",t.scheduleForms)}}function m7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",78)(1,"button",79),e._uU(2,"Cancel "),e._UZ(3,"span",80),e.qZA(),e.TgZ(4,"button",81),e.NdJ("click",function(){return e.CHM(t),e.oxw().executeNow()}),e._uU(5,"Submit "),e._UZ(6,"span",82),e.qZA()()}}function h7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",83)(2,"div",84)(3,"div",85)(4,"h3"),e._uU(5,"Project 01"),e.qZA(),e.TgZ(6,"button",86),e.NdJ("click",function(){return e.CHM(t),e.oxw().closePopup()}),e.TgZ(7,"span",87),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",88)(10,"p"),e._uU(11,"Execution started you will be notified once the dashboard is generated"),e.qZA()(),e.TgZ(12,"div",89)(13,"button",90),e._uU(14,"OK"),e.qZA()()()()()}}function g7(n,r){1&n&&(e.ynx(0),e._uU(1," Success !"),e.BQk())}function x7(n,r){if(1&n&&(e.TgZ(0,"label"),e._uU(1),e.YNc(2,g7,2,0,"ng-container",19),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("",t.percentage,"% "),e.xp6(1),e.Q6J("ngIf",t.icon)}}function v7(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.errMsg)}}function C7(n,r){1&n&&e._UZ(0,"div",100)}function T7(n,r){1&n&&e._UZ(0,"div",101)}function b7(n,r){if(1&n&&e._UZ(0,"div",104),2&n){const t=e.oxw(2).$implicit;e.Udp("width",t.percentage+"%")}}function w7(n,r){if(1&n&&e._UZ(0,"div",105),2&n){const t=e.oxw(2).$implicit;e.Udp("width",t.percentage+"%")}}function S7(n,r){if(1&n&&(e.ynx(0),e.YNc(1,b7,1,2,"div",102),e.YNc(2,w7,1,2,"div",103),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",0==t.isError)}}function N7(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",94),e._UZ(2,"img",95),e._uU(3),e.qZA(),e.TgZ(4,"div",96),e.YNc(5,x7,3,2,"label",19),e.YNc(6,v7,2,1,"ng-container",19),e.YNc(7,C7,1,0,"div",97),e.YNc(8,T7,1,0,"div",98),e.qZA(),e.TgZ(9,"div",99),e.YNc(10,S7,3,2,"ng-container",19),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(3),e.hij(" ",t.file," "),e.xp6(2),e.Q6J("ngIf",0==t.isError),e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",t.isError),e.xp6(1),e.Q6J("ngIf",0==t.isError&&t.icon),e.xp6(2),e.Q6J("ngIf",null!=(null==t?null:t.percentage))}}function A7(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"div",83)(2,"div",84)(3,"div",85)(4,"h3"),e._uU(5,"Uploading File(s)"),e.qZA(),e.TgZ(6,"button",91),e.NdJ("click",function(){return e.CHM(t),e.oxw().progressBarPopup=!1}),e.TgZ(7,"span",87),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",88)(10,"div",92),e.YNc(11,N7,11,6,"ng-container",93),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.progressBar)}}const y7=function(n){return{"is-invalid":n}},k7=[{path:"",children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:Ie.M},{path:"user-management",component:Ge},{path:"add-user",component:ot},{path:"approvals",component:Sn.l},{path:"master",component:nn.c},{path:"project",component:o1.n},{path:"create-project",component:u1},{path:"view-download",component:WF},{path:"execute-process",component:iM},{path:"custom-data",component:fM},{path:"project-overview",component:oM.A},{path:"explore-solution",component:Bt.C},{path:"solution-board",component:l1},{path:"solutionboard/:id",component:n1},{path:"solution-board-dashboard",component:c1.O},{path:"create-new-solution",component:yS},{path:"solution_data_modeling",component:cy},{path:"solutiondatamodeling",component:bk},{path:"solutionboard_data_modeling",component:DI},{path:"client-info",component:wk.u},{path:"client-info2",component:YF},{path:"schedule",component:tM},{path:"announcements",component:mM.l},{path:"add-announcements",component:hM.D},{path:"notifications",component:gM.t},{path:"powerbi-interface",component:SM},{path:"powerbi-approval",component:NM},{path:"view-download1",component:OI},{path:"solution-board-overall",component:s8},{path:"my-project",component:(()=>{class n{constructor(t,o,i,a,s,l,c,d){this.popup=t,this.router=o,this.loader=i,this.solService=a,this.route=s,this.Master=l,this.httpService=c,this.document=d,this.draftshow=!1,this.solshow=!0,this.standshow=!0}ngOnInit(){this.getAllProjectOverview(),this.displayedColumns=["projectName","processName","projectType","creationDate","lastExcuteDate","lastScheduleDate","statusName","action"],setTimeout(()=>{this.execution()},1e3),this.powerbi=this.service?this.service:new It.service.Service(It.factories.hpmFactory,It.factories.wpmpFactory,It.factories.routerFactory)}execution(){let t=this.projectdetails.filter(o=>this.containsValue(o,"Initiated Execution".trim().toLowerCase()));t&&t.length>0&&(this.inter=c_(2e4).subscribe(o=>{this.getAllProjectOverview(),t=this.projectdetails.filter(i=>this.containsValue(i,"Initiated Execution".trim().toLowerCase())),0==t.length&&clearInterval(this.inter)}))}edit(t){this.AddEventProceeding=!0,this.addEventIndex=t}CloseModal(){this.AddEventProceeding=!1,this.AddEventProceeding1=!1,this.AddEventProceeding2=!1}getAllProjectOverview(){this.loader.show();let t=JSON.parse(localStorage.getItem("userInfo")||"{}");this.httpService.getAllProjectOverview(t.userId).subscribe(o=>{this.response=o.responseData,this.projectdetails=o.responseData.projectList,this.projectSearch=new Ne.by(o.responseData.projectList),this.projectSearch.paginator=this.paginator,this.projectSearch.sort=this.sort,this.projectStatus=o.responseData.projectStatus,this.standalone=o.responseData.standloneAndIncrementalAndScheduler,this.loader.hide(),this.schedulerdetails=o.responseData.schedulerDTO,this.reportdata=o.responseData.reportResponse},o=>{this.loader.hide()})}projectCompleted(t){var o,i;let a={embedtype:"RV",reportid:null===(o=t.reportResponse[0])||void 0===o?void 0:o.reportId,datasetid:null===(i=t.reportResponse[0])||void 0===i?void 0:i.datasetId};this.solService.viewReport(a).subscribe(s=>{var l,c,d;console.log(s.responseData),this.AddEventProceeding=!0,this.embedViewContainer=document.getElementById("embedView"),this.reportViewConfig={type:"report",tokenType:It.models.TokenType.Embed,accessToken:null===(l=s.responseData)||void 0===l?void 0:l.embedToken,embedUrl:null===(c=s.responseData)||void 0===c?void 0:c.embedUrl,id:null===(d=s.responseData)||void 0===d?void 0:d.reportId,filters:[],settings:{filterPaneEnabled:!0,navContentPaneEnabled:!0}},console.log(this.embedViewContainer),this.viewReport=this.powerbi.embed(this.embedViewContainer,this.reportViewConfig)})}projectScheduled(){this.AddEventProceeding1=!0}hideViewReport(){this.AddEventProceeding=!1}failedproject(t){this.failed=t,console.log(t),this.AddEventProceeding2=!0}createProject(){localStorage.removeItem("project"),this.router.navigate(["/user/admin1/new-project"])}projectDraft(t){localStorage.setItem("project",JSON.stringify(t)),this.router.navigate(["/user/admin1/new-project",{data:JSON.stringify(t)}])}getErrorMsgByProjectID(t){this.solService.getErrorMsgByProjectID(t).subscribe(o=>{o&&this.popup.open(!1,o.responseData)},o=>{this.popup.open(!1,o.error.responseData)})}PrintReport(){var t=this;return(0,$e.Z)(function*(){try{yield t.viewReport.print()}catch(o){console.log(o)}})()}openWindow(){localStorage.setItem("powerbiconfig",JSON.stringify(this.reportViewConfig))}applyFilter(t){this.projectSearch=new Ne.by(this.projectdetails.filter(o=>this.containsValue(o,t.target.value.trim().toLowerCase()))),this.projectSearch.paginator=this.paginator,this.projectSearch.sort=this.sort}containsValue(t,o){return Object.values(t).reduce((i,a)=>(null!=a&&(a=a.toString().trim().toLowerCase()),i||(null==a?void 0:a.indexOf(o))>-1),!1)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(fe.F0),e.Y36(Nn.D),e.Y36(Jt.e),e.Y36(fe.gz),e.Y36(Hn.R),e.Y36(hs.O),e.Y36(be.K0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-my-project"]],viewQuery:function(t,o){if(1&t&&(e.Gf(gs.NW,5),e.Gf(Ri.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.paginator=i.first),e.iGM(i=e.CRH())&&(o.sort=i.first)}},inputs:{service:"service"},decls:95,vars:17,consts:[[1,"heading"],[1,"consen","custom-height"],[1,"row","cards-group"],[1,"col"],[1,"color1"],[1,"cards"],[1,"part1"],[4,"ngFor","ngForOf"],[1,"part2"],[1,"dds-icon","dds-icon_folder__l__stroke"],[1,"color2"],[1,"part2","labels"],[1,"color5"],[1,"dds-icon","dds-icon_calendar__l__stroke"],[1,"table-group","middle"],[1,"toolbar-block"],[1,"search"],["id","form1","value","","placeholder","Search",1,"form-control",3,"keyup"],[1,"dds-icon","dds-icon_search__l__stroke","icons"],["mat-button","","color","primary"],[1,"dds-icon","dds-icon_file_xls__l__filled"],[1,"dds-icon","dds-icon_sort_down__l__stroke"],["mat-button","","href","javascript:void(0);",3,"click"],[1,"dds-icon","dds-icon_plus__l__stroke"],[1,"main"],[1,"minfile"],[1,"table-container","min-height-scroll"],["mat-table","","matSort","",1,"table","table-striped","solutions-table",3,"dataSource"],["matColumnDef","projectName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","processName"],["matColumnDef","projectType"],["matColumnDef","creationDate"],["matColumnDef","lastExcuteDate"],["matColumnDef","lastScheduleDate"],["matColumnDef","statusName"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page",3,"length","pageSizeOptions"],[3,"ngClass"],[1,"taxt_audit-report"],[1,"taxt-audit-popup",2,"width","1100px !important"],[1,"taxt-header","popup-header"],[1,"button-group"],["mat-button","","target","_blank",1,"primary",3,"routerLink","click"],["mat-button","",1,"primary",3,"click"],["mat-button","",1,"close","report-modal-close",3,"click"],[1,"dds-icon","dds-icon_close__l__stroke"],[1,"report-container","popup-body",2,"margin-bottom","0px !important"],["id","embedView",3,"embedConfig"],[1,"popup-footer","button-group"],[4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["class","ico dds-icon dds-icon_eyeopen dds-icon_arrow_rotate_right__l__strok",3,"click",4,"ngIf"],["class","ico dds-icon dds-icon_alert__l__stroke","style","color: red !important;",3,"click",4,"ngIf"],["class","ico dds-icon dds-icon_hourglass",3,"click",4,"ngIf"],["class","ico dds-icon dds-icon_arrow_right__l__stroke",3,"click",4,"ngIf"],[1,"ico","dds-icon","dds-icon_eyeopen","dds-icon_arrow_rotate_right__l__strok",3,"click"],[1,"ico","dds-icon","dds-icon_alert__l__stroke",2,"color","red !important",3,"click"],[1,"ico","dds-icon","dds-icon_hourglass",3,"click"],[1,"ico","dds-icon","dds-icon_arrow_right__l__stroke",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell"],[1,"taxt-audit-popup"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"popup-body",2,"margin-bottom","0px !important"],[1,"row"],[1,"col-sm-6"],["type","text","disabled","",1,"form-control","reflect-model",3,"value"],["type","button","mat-button","",1,"close",3,"click"],[1,"popup-body"],[2,"text-align","center","color","#f00"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1"),e._uU(2,"My Projects"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"mat-card",4)(7,"div",5)(8,"div",6),e.YNc(9,_8,2,1,"ng-container",7),e.qZA(),e.TgZ(10,"div",8),e._UZ(11,"span",9),e.qZA()()()(),e.TgZ(12,"div",3)(13,"mat-card",10)(14,"div",5)(15,"div",6),e.YNc(16,u8,2,1,"ng-container",7),e.qZA(),e.TgZ(17,"div",11)(18,"h6"),e._uU(19,"Success "),e.YNc(20,g8,2,1,"ng-container",7),e.qZA(),e.TgZ(21,"h6"),e._uU(22,"Failed "),e.YNc(23,T8,2,1,"ng-container",7),e.qZA()()()()(),e.TgZ(24,"div",3)(25,"mat-card",12)(26,"div",5)(27,"div",6),e.YNc(28,w8,2,1,"ng-container",7),e.qZA(),e.TgZ(29,"div",8),e._UZ(30,"span",13),e.qZA()()()()(),e.TgZ(31,"mat-card",14)(32,"div",15)(33,"div",16)(34,"input",17),e.NdJ("keyup",function(a){return o.applyFilter(a)}),e.qZA(),e._UZ(35,"span",18),e.qZA(),e.TgZ(36,"button",19),e._uU(37,"Export "),e._UZ(38,"span",20),e.qZA(),e.TgZ(39,"button",19),e._uU(40,"Filters "),e._UZ(41,"span",21),e.qZA(),e.TgZ(42,"a",22),e.NdJ("click",function(){return o.createProject()}),e._uU(43,"Create New Project "),e._UZ(44,"span",23),e.qZA()(),e.TgZ(45,"div",24)(46,"div",25)(47,"div",26)(48,"table",27),e.ynx(49,28),e.YNc(50,S8,2,0,"th",29),e.YNc(51,N8,2,1,"td",30),e.BQk(),e.ynx(52,31),e.YNc(53,A8,2,0,"th",29),e.YNc(54,y8,2,1,"td",30),e.BQk(),e.ynx(55,32),e.YNc(56,D8,2,0,"th",29),e.YNc(57,k8,2,1,"td",30),e.BQk(),e.ynx(58,33),e.YNc(59,F8,2,0,"th",29),e.YNc(60,M8,3,4,"td",30),e.BQk(),e.ynx(61,34),e.YNc(62,L8,2,0,"th",29),e.YNc(63,E8,5,5,"td",30),e.BQk(),e.ynx(64,35),e.YNc(65,Z8,2,0,"th",29),e.YNc(66,O8,5,5,"td",30),e.BQk(),e.ynx(67,36),e.YNc(68,U8,2,0,"th",29),e.YNc(69,B8,3,3,"td",30),e.BQk(),e.ynx(70,37),e.YNc(71,J8,2,0,"th",29),e.YNc(72,V8,6,5,"td",30),e.BQk(),e.YNc(73,$8,1,0,"tr",38),e.YNc(74,K8,1,0,"tr",39),e.YNc(75,W8,3,1,"tr",40),e.qZA()(),e._UZ(76,"mat-paginator",41),e.qZA()()(),e.TgZ(77,"div",42)(78,"div",43)(79,"div",44)(80,"div",45)(81,"h3"),e._uU(82,"PowerBI Report "),e.qZA(),e.TgZ(83,"div",46)(84,"a",47),e.NdJ("click",function(){return o.openWindow()}),e._uU(85," Open Report in new Window "),e.qZA(),e.TgZ(86,"a",48),e.NdJ("click",function(){return o.PrintReport()}),e._uU(87,"Print"),e.qZA()(),e.TgZ(88,"button",49),e.NdJ("click",function(){return o.hideViewReport()}),e._UZ(89,"span",50),e.qZA()(),e.TgZ(90,"div",51),e._UZ(91,"powerbi-report",52),e.qZA(),e._UZ(92,"div",53),e.qZA()()(),e.YNc(93,G8,12,1,"div",54),e.YNc(94,X8,12,1,"div",54),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngForOf",o.projectStatus),e.xp6(7),e.Q6J("ngForOf",o.standalone),e.xp6(4),e.Q6J("ngForOf",o.standalone),e.xp6(3),e.Q6J("ngForOf",o.standalone),e.xp6(5),e.Q6J("ngForOf",o.projectStatus),e.xp6(20),e.Q6J("dataSource",o.projectSearch),e.xp6(25),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(2),e.Q6J("length",null==o.projectSearch?null:o.projectSearch.data.length)("pageSizeOptions",e.DdM(15,j8)),e.xp6(1),e.Q6J("ngClass",o.AddEventProceeding?"":"displ"),e.xp6(7),e.Q6J("routerLink",e.DdM(16,e7)),e.xp6(7),e.Q6J("embedConfig",o.reportViewConfig),e.xp6(2),e.Q6J("ngIf",o.AddEventProceeding1),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding2))},directives:[Se.a8,be.sg,be.O5,Ze.lW,Ze.zs,Ne.BZ,Ri.YE,Ne.w1,Ne.fO,Ne.ge,Ne.Dz,Ne.ev,Ne.as,Ne.XQ,Ne.nj,Ne.Gk,Ne.Ee,gs.NW,be.mk,fe.yS,Jr.$i,w._Y,w.JL,w.F],pipes:[be.uU],styles:[".taxt_audit-report[_ngcontent-%COMP%]   .taxt-audit-popup[_ngcontent-%COMP%]{max-height:700px!important;overflow:auto}.displ[_ngcontent-%COMP%]{display:none}"]}),n})()},{path:"new-project",component:(()=>{class n{constructor(t,o,i,a,s,l,c,d,_,u,f){this.popup=t,this.formbuilder=o,this.shared=i,this.solService=a,this.Users_service=s,this.Master=l,this._sanitizer=c,this.http=d,this.loader=_,this.router=u,this.solution=f,this.flag=!0,this.submited=!1,this.panelOpenStateFive=!0,this.down=!0,this.tabs=[{id:0,value:"Download Files",isActive:!0},{id:1,value:"Execute Project",isActive:!1},{id:2,value:"Shedule Project",isActive:!1}],this.subtab1=!0,this.subtab2=!1,this.subtab3=!1,this.progressBar=[],this.progressBarPopup=!1,this.userData={},this.projectcreated=!1}ngOnInit(){this.projectForm=this.formbuilder.group({projectname:["",w.kI.required],standalone:[""],chooseProcess:[""]}),this.scheduleForm=this.formbuilder.group({startdate1:[""],enddate1:[""],time1:[""],day:[""],date:[""]}),this.scheduleForms=!1,this.getprocessbyid(),this.processId=JSON.parse(localStorage.getItem("projectProcess")||"null"),this.projectData=JSON.parse(localStorage.getItem("project")||"null"),this.userData=JSON.parse(localStorage.getItem("userInfo")||"{}"),console.log(this.projectData),this.projectData&&(this.processname=this.projectData.processName,this.projectname=this.projectData.projectName,this.projectid=this.projectData.projectId,this.getAllAnalyticsAndTemplates(),this.getAllUploadFileTemplate()),this.process=JSON.parse(localStorage.getItem("projectProcess")||"{}"),this.fileElem=document.getElementById("browse"),this.shared.getClick()}getprocessbyid(){let t=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(t,t.userId),"External User"==t.roleName?this.Users_service.getprocessbyid(t.userId,1).subscribe(o=>{var i;this.processes=o.responseData,console.log(this.processes),this.projectData&&(this.processes.forEach(a=>{(this.projectData.organizationSolutionId==a.orgsolnId||this.projectData.processId==a.processId)&&(console.log("hi"),this.projectForm.patchValue({chooseProcess:a,projectname:this.projectname,standalone:this.projectData.projectType}))}),this.projectcreated=!0,this.getAllAnalyticsAndTemplates(),this.getAllUploadFileTemplate()),this.userProcess=[],console.log("this.AllProcess",this.AllProcess),null===(i=this.AllProcess)||void 0===i||i.forEach(a=>{o.responseData.forEach(s=>{s.processId==a.processId&&this.userProcess.push(a)}),a.img=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/png;base64,"+a.imageUrl)}),this.loader.hide(),console.log("userid process",this.userProcess,this.processes)}):this.Users_service.getprocessbyid(t.userId,2).subscribe(o=>{var i;this.processes=o.responseData,console.log(this.processes,this.projectData),this.projectData&&(this.processes.forEach(a=>{(this.projectData.organizationSolutionId==a.orgsolnId||this.projectData.processId==a.processId)&&(console.log("hi"),this.projectForm.patchValue({chooseProcess:a,projectname:this.projectname,standalone:this.projectData.projectType}))}),this.projectcreated=!0,this.getAllAnalyticsAndTemplates(),this.getAllUploadFileTemplate()),this.userProcess=[],console.log("this.AllProcess",this.AllProcess),null===(i=this.AllProcess)||void 0===i||i.forEach(a=>{o.responseData.forEach(s=>{s.processId==a.processId&&this.userProcess.push(a)}),a.img=this._sanitizer.bypassSecurityTrustResourceUrl("data:image/png;base64,"+a.imageUrl)}),this.loader.hide(),console.log("userid process",this.userProcess,this.processes)})}getAllProcess(){this.loader.show(),this.Master.getAllProcess().subscribe(t=>{this.AllProcess=t.responseData,console.log(this.AllProcess),this.getprocessbyid()})}success(t){this.AddEventProceeding=!0,this.addEventIndex=t}CloseModal(){this.AddEventProceeding=!1}projectSubmit(){if(this.loader.show(),this.submited=!0,this.projectForm.invalid)return console.log(this.projectForm),this.popup.open(!1,"Enter All the Required Fields"),void this.loader.hide();let t;console.log(this.processes),this.processes.forEach(a=>{var s;a.processId==this.processId&&(console.log(a,this.processdetails),this.processId=a.processId,t=null===(s=this.processdetails)||void 0===s?void 0:s.orgsolnId,console.log(this.processId))});let o=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(o,o.userId);let i={projectName:this.projectForm.value.projectname,executionType:this.projectForm.value.standalone?"S":"I",processName:this.projectForm.value.chooseProcess.processName,organizationSolutionId:this.projectForm.value.chooseProcess.orgsolnId,userId:o.userId};this.processId=this.projectForm.value.chooseProcess.processId,console.log(this.processId),this.processes.forEach(a=>{this.processName==a.processName&&(i.organizationSolutionId=a.orgsolnId)}),console.log(i),this.solution.createProject(i).subscribe(a=>{console.log(a),this.projectcreated=!0,this.projectid=a.responseData.projectId,console.log(this.projectid),this.popup.open(!0,"Project created successfully !"),localStorage.setItem("project",JSON.stringify(a.responseData)),localStorage.setItem("projectProcess",JSON.stringify(this.processId)),this.AddEventProceeding=!0,this.loader.hide(),this.getAllAnalyticsAndTemplates(),this.getAllUploadFileTemplate()},a=>{this.loader.hide(),this.popup.open(!1,a.error.statusMessage)})}downloadTemplates(){let t=this.processId;this.loader.show(),this.Master.downloadTemplates(t).subscribe(o=>{this.downloadt=o.responseData,this.downloadt.forEach(i=>{let a=i.fileName.split(".");if(console.log(a[1]),"jpg"==a[1]){let s=`data:image/jpg;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("xlsx"==a[1]||"xls"==a[1]){let s=`data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("pdf"==a[1]){let s=`data:application/pdf;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("png"==a[1]){let s=`data:image/png;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("csv"==a[1]){let s=`data:application/csv;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("txt"==a[1]){let s=`data:application/txt;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}if("zip"==a[1]){let s=`data:application/zip;base64,${i.content}`,l=document.createElement("a");l.download=i.fileName,l.href=s,l.click(),window.URL.revokeObjectURL(o.URL)}}),this.loader.hide(),this.popup.open(!0,"Downloaded Successfully!")},o=>{this.loader.hide(),this.popup.open(!1,"Download Failed!")})}getAllAnalyticsAndTemplates(){this.Users_service.getAllAnalyticsAndTemplates(this.processId||this.projectData.processId).subscribe(o=>{this.anyData=o.responseData,console.log(this.anyData),this.anaytics=o.responseData.processAnalyticsDTOList,this.anayticfile=o.responseData.templateResponse})}getAllUploadFileTemplate(){var t;this.uploadData=[];let o=(null===(t=this.projectData)||void 0===t?void 0:t.projectId)||this.projectid;this.solService.getAllUploadFileTemplate(o).subscribe(i=>{var a;this.uploadData=i.responseData,console.log("this.uploadData",this.uploadData),console.log("this.uploadData",(null===(a=this.uploadData)||void 0===a?void 0:a.length)>=0)},i=>{})}scheduler(){this.solService.addScheduler({projectId:this.projectid,scheduleFrequency:this.subtab1?"Daily":this.subtab2?"Weekly":"Monthly",startDate:this.scheduleForm.value.startdate1,endDate:this.scheduleForm.value.enddate1,executionTime:this.scheduleForm.value.time1,executionDay:this.scheduleForm.value.day,dateOfmonth:this.scheduleForm.value.date}).subscribe(i=>{console.log("contactus",i),this.popup.open(!0,"Project Scheduled Successfully!"),this.router.navigate(["/user/admin1/project"])})}saveiputFiles(t){console.log("projectid",this.projectid);let i=JSON.parse(localStorage.getItem("userInfo")||"{}");console.log(i,i.userId);let a=[];this.progressBar=[];for(let s=0;s<t.target.files.length;s++){const l=new FormData;l.append("projectId",this.projectid),l.append("userId",i.userId),l.append("processId",this.anyData.processId),l.append("file",t.target.files[s]),a.push(this.solService.uploadExcelToProjectExecution(l).pipe((0,ys.b)(c=>{console.log(c),c.type===Dt.dt.UploadProgress&&(this.progressBar[s]={percentage:Math.round(95/c.total*c.loaded),file:t.target.files[s].name,isError:!1,icon:!1},console.log(this.progressBar))}),(0,Kr.K)(c=>(0,xt.of)({error:c,isError:!0}))))}this.uploadData=[],this.progressBarPopup=!0,(0,Ji.D)(a).subscribe(s=>{console.log(s),s.forEach((c,d)=>{this.progressBar[d].percentage=100,this.progressBar[d].icon=!0,c.isError?(this.progressBar[d].isError=c.isError,this.progressBar[d].errMsg=c.error.error.statusMessage):this.progressBar[d].isError=!1}),s.map(c=>c.isError).includes(!0)||(this.progressBarPopup=!1),this.getAllUploadFileTemplate(),console.log("this.uploaddata",this.uploadData)})}changesubtab(t){1==t?(this.subtab1=!0,this.subtab2=!1,this.subtab3=!1):2==t?(this.subtab1=!1,this.subtab2=!0,this.subtab3=!1):(this.subtab1=!1,this.subtab2=!1,this.subtab3=!0)}scheduleProject(){this.scheduleForms=!0}executeProject(){this.scheduleForms=!1}closePopup(){this.AddEventProceeding1=!1}executeNow(){var t;if(console.log(this.projectid),!this.scheduleForms){let o={projectId:(null===(t=this.projectData)||void 0===t?void 0:t.projectId)||this.projectid,userId:this.userData.userId,processId:this.anyData.processId};this.solService.executeProject(o).subscribe(i=>{this.popup.open(!0,i.responseData),this.loader.hide(),this.router.navigate(["user/admin1/my-project"])},i=>{this.loader.hide()})}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Fn.q),e.Y36(w.qu),e.Y36(xs.F),e.Y36(Jt.e),e.Y36(Hi.f),e.Y36(Hn.R),e.Y36(qi.H7),e.Y36(Dt.eN),e.Y36(Nn.D),e.Y36(fe.F0),e.Y36(Jt.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-new-project"]],decls:46,vars:10,consts:[[1,"heading"],[1,"page-title-wrapper"],[1,"consen","mainContainer"],[1,"inner-container"],[1,"sub-title"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-md-4"],["appearance","fill"],["placeholder","Select","formControlName","chooseProcess",1,"form-control","reflect-model"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-4"],["type","text","formControlName","projectname","oninput","this.value = this.value.replace(/[^a-zA-Z10-9 ]/g, '').replace(/(\\..*)\\./g, '$1');","maxlength","50",1,"form-control","reflect-model",3,"ngClass"],[1,"col-md-8"],[1,"input-group",2,"display","flex","align-items","center"],[1,"flex-list"],["type","radio","formControlName","standalone","value","Standalone",1,"radio"],["class","col-md-4 button-block",4,"ngIf"],[2,"opacity","0.2"],[4,"ngIf"],["class","button-group",4,"ngIf"],[3,"value"],[1,"col-md-4","button-block"],["mat-button","","type","submit",1,"submit","primary"],[1,"box-container"],[1,"scroll","new-project-download-list"],["class","file-main",4,"ngFor","ngForOf"],[1,"button-container"],["mat-button","",1,"submit","primary",3,"click"],[1,"dds-icon","dds-icon_download__l__stroke"],["class","sub-title",4,"ngIf"],["class","box-container upload-inner-container",4,"ngIf"],["class","box-container",4,"ngIf"],[1,"input-group"],["type","radio","name","executeProcess","value","execute",1,"radio",3,"checked","click"],[3,"formGroup",4,"ngIf"],["class","row",4,"ngIf"],[1,"file-main"],[1,"dds-icon","dds-icon_file_xls__l__filled"],[1,"box-container","upload-inner-container"],["for","inputfile",1,"button"],["type","file","id","inputfile","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke","icon"],["for","inputfile1",1,"button"],["type","file","id","inputfile1","multiple","",2,"display","none",3,"change"],[1,"dds-icon","dds-icon_upload__l__stroke"],[3,"formGroup"],[1,"col","tabs-container"],[1,"row","container"],[1,"col","subheading",3,"click"],[1,"options"],[1,"strip",3,"ngClass"],[1,"row",2,"margin-top","20px !important"],[1,"col-sm-6"],[1,"input-group","date"],["type","date","formControlName","startdate1",1,"form-control","reflect-model"],[1,"col-md-6"],["type","date","formControlName","enddate1",1,"form-control","reflect-model"],["class","col-sm-6",4,"ngIf"],[1,"input-group","time"],["type","time","formControlName","time1",1,"form-control","reflect-model"],["name","days","id","days","formControlName","day",1,"form-control","reflect-model"],["value","Monday"],["value","Tuesday"],["value","Wednesday"],["value","Thursday"],["value","Friday"],["value","Saturday"],["value","Sunday"],["name","date","id","date","formControlName","date",1,"form-control","reflect-model"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["matInput","","value",""],[1,"button-group"],["mat-button","","type","reset","routerLink","/user/admin1/my-project",1,"cancel"],[1,"dds-icon","dds-icon_close__l__stroke"],["mat-button","","type","submit",1,"submit",3,"click"],[1,"dds-icon","dds-icon_arrow_right__l__stroke"],[1,"taxt_audit-report"],[1,"taxt-audit-popup"],[1,"taxt-header","popup-header"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"popup-body"],[1,"popup-footer"],["mat-button","","routerLink","/user/admin1/my-project",1,"primary","btnn",2,"margin","auto"],[1,"close",3,"click"],[1,"upload"],[4,"ngFor","ngForOf"],[1,"file-name-block"],["src","../../../assets/images/Group 4899.svg"],[1,"upload-file-info"],["class","ico dds-icon dds-icon_alert__l__stroke","style","color: red !important; margin-left: 84%;",4,"ngIf"],["class","completedprogress","style","margin-left: 74%;",4,"ngIf"],[1,"progress"],[1,"ico","dds-icon","dds-icon_alert__l__stroke",2,"color","red !important","margin-left","84%"],[1,"completedprogress",2,"margin-left","74%"],["class","failedprogress-bar","role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["class","progress-bar","role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",3,"width",4,"ngIf"],["role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"failedprogress-bar"],["role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress-bar"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ul")(3,"li"),e._uU(4,"My Projects"),e.qZA(),e.TgZ(5,"li"),e._uU(6,"Create New Project"),e.qZA()()()(),e.TgZ(7,"div",2)(8,"div",3)(9,"mat-card")(10,"h5",4),e._uU(11,"Project Details"),e.qZA(),e.TgZ(12,"form",5),e.NdJ("ngSubmit",function(){return o.projectSubmit()}),e.TgZ(13,"div",6)(14,"div",7)(15,"label"),e._uU(16,"Select Process"),e.TgZ(17,"sup"),e._uU(18,"*"),e.qZA()(),e.TgZ(19,"mat-form-field",8)(20,"mat-select",9),e.YNc(21,n7,2,2,"mat-option",10),e.qZA()()(),e.TgZ(22,"div",11)(23,"label"),e._uU(24,"Enter Project Name"),e.TgZ(25,"sup"),e._uU(26,"*"),e.qZA()(),e._UZ(27,"input",12),e.qZA(),e.TgZ(28,"div",11)(29,"div",6)(30,"div",13)(31,"label"),e._uU(32,"Project Type"),e.TgZ(33,"sup"),e._uU(34,"*"),e.qZA()(),e.TgZ(35,"div",14)(36,"div",15),e._UZ(37,"input",16),e.TgZ(38,"label"),e._uU(39,"Standalone"),e.qZA()()()(),e.YNc(40,i7,5,0,"div",17),e.qZA()()()(),e._UZ(41,"hr",18),e.YNc(42,f7,28,8,"div",19),e.qZA()(),e.YNc(43,m7,7,0,"div",20),e.qZA(),e.YNc(44,h7,15,0,"div",19),e.YNc(45,A7,12,1,"div",19)),2&t&&(e.xp6(12),e.Q6J("formGroup",o.projectForm),e.xp6(9),e.Q6J("ngForOf",o.processes),e.xp6(6),e.Q6J("ngClass",e.VKq(8,y7,o.submited&&o.projectForm.controls.projectname.errors)),e.xp6(13),e.Q6J("ngIf",!o.projectcreated),e.xp6(2),e.Q6J("ngIf",o.projectcreated),e.xp6(1),e.Q6J("ngIf",o.projectcreated),e.xp6(1),e.Q6J("ngIf",o.AddEventProceeding1),e.xp6(1),e.Q6J("ngIf",o.progressBarPopup))},directives:[Se.a8,w._Y,w.JL,w.sg,Ln.KE,hi.gD,w.JJ,w.u,be.sg,Et.ey,w.Fj,w.nD,be.mk,w._,be.O5,Ze.lW,w.EJ,w.YN,w.Kr,Qi.Nt,fe.rH],styles:[""]}),n})()}]}];let F7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[fe.Bz.forChild(k7)],fe.Bz]}),n})();var M7=ce(4623),L7=ce(5078),I7=ce(1469);let Z7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[be.ez,Et.BQ],Et.BQ]}),n})();var Ko=ce(2654),P7=ce(352),d_=ce(5421);function vs(n,r,t){for(let o in r)if(r.hasOwnProperty(o)){const i=r[o];i?n.setProperty(o,i,(null==t?void 0:t.has(o))?"important":""):n.removeProperty(o)}return n}function lo(n,r){const t=r?"":"none";vs(n.style,{"touch-action":r?"":"none","-webkit-user-drag":r?"":"none","-webkit-tap-highlight-color":r?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function __(n,r,t){vs(n.style,{position:r?"":"fixed",top:r?"":"0",opacity:r?"":"0",left:r?"":"-999em"},t)}function Rr(n,r){return r&&"none"!=r?n+" "+r:n}function p_(n){const r=n.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(n)*r}function Cs(n,r){return n.getPropertyValue(r).split(",").map(o=>o.trim())}function Ts(n){const r=n.getBoundingClientRect();return{top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.width,height:r.height,x:r.x,y:r.y}}function bs(n,r,t){const{top:o,bottom:i,left:a,right:s}=n;return t>=o&&t<=i&&r>=a&&r<=s}function Wo(n,r,t){n.top+=r,n.bottom=n.top+n.height,n.left+=t,n.right=n.left+n.width}function u_(n,r,t,o){const{top:i,right:a,bottom:s,left:l,width:c,height:d}=n,_=c*r,u=d*r;return o>i-u&&o<s+u&&t>l-_&&t<a+_}class f_{constructor(r){this._document=r,this.positions=new Map}clear(){this.positions.clear()}cache(r){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),r.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:Ts(t)})})}handleScroll(r){const t=(0,Mn.sA)(r),o=this.positions.get(t);if(!o)return null;const i=o.scrollPosition;let a,s;if(t===this._document){const d=this.getViewportScrollPosition();a=d.top,s=d.left}else a=t.scrollTop,s=t.scrollLeft;const l=i.top-a,c=i.left-s;return this.positions.forEach((d,_)=>{d.clientRect&&t!==_&&t.contains(_)&&Wo(d.clientRect,l,c)}),i.top=a,i.left=s,{top:l,left:c}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function m_(n){const r=n.cloneNode(!0),t=r.querySelectorAll("[id]"),o=n.nodeName.toLowerCase();r.removeAttribute("id");for(let i=0;i<t.length;i++)t[i].removeAttribute("id");return"canvas"===o?x_(n,r):("input"===o||"select"===o||"textarea"===o)&&g_(n,r),h_("canvas",n,r,x_),h_("input, textarea, select",n,r,g_),r}function h_(n,r,t,o){const i=r.querySelectorAll(n);if(i.length){const a=t.querySelectorAll(n);for(let s=0;s<i.length;s++)o(i[s],a[s])}}let U7=0;function g_(n,r){"file"!==r.type&&(r.value=n.value),"radio"===r.type&&r.name&&(r.name=`mat-clone-${r.name}-${U7++}`)}function x_(n,r){const t=r.getContext("2d");if(t)try{t.drawImage(n,0,0)}catch(o){}}const v_=(0,Mn.i$)({passive:!0}),Qr=(0,Mn.i$)({passive:!1}),ws=new Set(["position"]);class J7{constructor(r,t,o,i,a,s){this._config=t,this._document=o,this._ngZone=i,this._viewportRuler=a,this._dragDropRegistry=s,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new vt.xQ,this._pointerMoveSubscription=Ko.w.EMPTY,this._pointerUpSubscription=Ko.w.EMPTY,this._scrollSubscription=Ko.w.EMPTY,this._resizeSubscription=Ko.w.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new vt.xQ,this.started=new vt.xQ,this.released=new vt.xQ,this.ended=new vt.xQ,this.entered=new vt.xQ,this.exited=new vt.xQ,this.dropped=new vt.xQ,this.moved=this._moveEvents,this._pointerDown=l=>{if(this.beforeStarted.next(),this._handles.length){const c=this._getTargetHandle(l);c&&!this._disabledHandles.has(c)&&!this.disabled&&this._initializeDragSequence(c,l)}else this.disabled||this._initializeDragSequence(this._rootElement,l)},this._pointerMove=l=>{const c=this._getPointerPositionOnPage(l);if(!this._hasStartedDragging){if(Math.abs(c.x-this._pickupPositionOnPage.x)+Math.abs(c.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const m=Date.now()>=this._dragStartTime+this._getDragStartDelay(l),h=this._dropContainer;if(!m)return void this._endDragSequence(l);(!h||!h.isDragging()&&!h.isReceiving())&&(l.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(l)))}return}l.preventDefault();const d=this._getConstrainedPointerPosition(c);if(this._hasMoved=!0,this._lastKnownPointerPosition=c,this._updatePointerDirectionDelta(d),this._dropContainer)this._updateActiveDropContainer(d,c);else{const _=this._activeTransform;_.x=d.x-this._pickupPositionOnPage.x+this._passiveTransform.x,_.y=d.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(_.x,_.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:d,event:l,distance:this._getDragDistance(d),delta:this._pointerDirectionDelta})})},this._pointerUp=l=>{this._endDragSequence(l)},this._nativeDragStart=l=>{if(this._handles.length){const c=this._getTargetHandle(l);c&&!this._disabledHandles.has(c)&&!this.disabled&&l.preventDefault()}else this.disabled||l.preventDefault()},this.withRootElement(r).withParent(t.parentDragRef||null),this._parentPositions=new f_(o),s.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(r){const t=(0,rt.Ig)(r);t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(o=>lo(o,t)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(r){this._handles=r.map(o=>(0,rt.fI)(o)),this._handles.forEach(o=>lo(o,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(o=>{this._handles.indexOf(o)>-1&&t.add(o)}),this._disabledHandles=t,this}withPreviewTemplate(r){return this._previewTemplate=r,this}withPlaceholderTemplate(r){return this._placeholderTemplate=r,this}withRootElement(r){const t=(0,rt.fI)(r);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,Qr),t.addEventListener("touchstart",this._pointerDown,v_),t.addEventListener("dragstart",this._nativeDragStart,Qr)}),this._initialTransform=void 0,this._rootElement=t),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(r){return this._boundaryElement=r?(0,rt.fI)(r):null,this._resizeSubscription.unsubscribe(),r&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(r){return this._parentDragRef=r,this}dispose(){var r,t;this._removeRootElementListeners(this._rootElement),this.isDragging()&&(null===(r=this._rootElement)||void 0===r||r.remove()),null===(t=this._anchor)||void 0===t||t.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(r){!this._disabledHandles.has(r)&&this._handles.indexOf(r)>-1&&(this._disabledHandles.add(r),lo(r,!0))}enableHandle(r){this._disabledHandles.has(r)&&(this._disabledHandles.delete(r),lo(r,this.disabled))}withDirection(r){return this._direction=r,this}_withDropContainer(r){this._dropContainer=r}getFreeDragPosition(){const r=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:r.x,y:r.y}}setFreeDragPosition(r){return this._activeTransform={x:0,y:0},this._passiveTransform.x=r.x,this._passiveTransform.y=r.y,this._dropContainer||this._applyRootElementTransform(r.x,r.y),this}withPreviewContainer(r){return this._previewContainer=r,this}_sortFromLastPointerPosition(){const r=this._lastKnownPointerPosition;r&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(r),r)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){var r,t;null===(r=this._preview)||void 0===r||r.remove(),null===(t=this._previewRef)||void 0===t||t.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){var r,t;null===(r=this._placeholder)||void 0===r||r.remove(),null===(t=this._placeholderRef)||void 0===t||t.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(r){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(r),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(r);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(r){zo(r)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._dropContainer;if(t){const o=this._rootElement,i=o.parentNode,a=this._placeholder=this._createPlaceholderElement(),s=this._anchor=this._anchor||this._document.createComment(""),l=this._getShadowRoot();i.insertBefore(s,o),this._initialTransform=o.style.transform||"",this._preview=this._createPreviewElement(),__(o,!1,ws),this._document.body.appendChild(i.replaceChild(a,o)),this._getPreviewInsertionPoint(i,l).appendChild(this._preview),this.started.next({source:this}),t.start(),this._initialContainer=t,this._initialIndex=t.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(t?t.getScrollableParents():[])}_initializeDragSequence(r,t){this._parentDragRef&&t.stopPropagation();const o=this.isDragging(),i=zo(t),a=!i&&0!==t.button,s=this._rootElement,l=(0,Mn.sA)(t),c=!i&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),d=i?(0,Wr.yG)(t):(0,Wr.X6)(t);if(l&&l.draggable&&"mousedown"===t.type&&t.preventDefault(),o||a||c||d)return;if(this._handles.length){const f=s.style;this._rootElementTapHighlight=f.webkitTapHighlightColor||"",f.webkitTapHighlightColor="transparent"}this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(f=>this._updateOnScroll(f)),this._boundaryElement&&(this._boundaryRect=Ts(this._boundaryElement));const _=this._previewTemplate;this._pickupPositionInElement=_&&_.template&&!_.matchSize?{x:0,y:0}:this._getPointerPositionInElement(r,t);const u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(r){__(this._rootElement,!0,ws),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,o=t.getItemIndex(this),i=this._getPointerPositionOnPage(r),a=this._getDragDistance(i),s=t._isOverContainer(i.x,i.y);this.ended.next({source:this,distance:a,dropPoint:i}),this.dropped.next({item:this,currentIndex:o,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:s,distance:a,dropPoint:i}),t.drop(this,o,this._initialIndex,this._initialContainer,s,a,i),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:r,y:t},{x:o,y:i}){let a=this._initialContainer._getSiblingContainerFromPosition(this,r,t);!a&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(r,t)&&(a=this._initialContainer),a&&a!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=a,this._dropContainer.enter(this,r,t,a===this._initialContainer&&a.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:a,currentIndex:a.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(o,i),this._dropContainer._sortItem(this,r,t,this._pointerDirectionDelta),this._applyPreviewTransform(r-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_createPreviewElement(){const r=this._previewTemplate,t=this.previewClass,o=r?r.template:null;let i;if(o&&r){const a=r.matchSize?this._rootElement.getBoundingClientRect():null,s=r.viewContainer.createEmbeddedView(o,r.context);s.detectChanges(),i=T_(s,this._document),this._previewRef=s,r.matchSize?b_(i,a):i.style.transform=Hr(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const a=this._rootElement;i=m_(a),b_(i,a.getBoundingClientRect()),this._initialTransform&&(i.style.transform=this._initialTransform)}return vs(i.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},ws),lo(i,!1),i.classList.add("cdk-drag-preview"),i.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(a=>i.classList.add(a)):i.classList.add(t)),i}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const r=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(r.left,r.top);const t=function O7(n){const r=getComputedStyle(n),t=Cs(r,"transition-property"),o=t.find(l=>"transform"===l||"all"===l);if(!o)return 0;const i=t.indexOf(o),a=Cs(r,"transition-duration"),s=Cs(r,"transition-delay");return p_(a[i])+p_(s[i])}(this._preview);return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(o=>{const i=s=>{var l;(!s||(0,Mn.sA)(s)===this._preview&&"transform"===s.propertyName)&&(null===(l=this._preview)||void 0===l||l.removeEventListener("transitionend",i),o(),clearTimeout(a))},a=setTimeout(i,1.5*t);this._preview.addEventListener("transitionend",i)}))}_createPlaceholderElement(){const r=this._placeholderTemplate,t=r?r.template:null;let o;return t?(this._placeholderRef=r.viewContainer.createEmbeddedView(t,r.context),this._placeholderRef.detectChanges(),o=T_(this._placeholderRef,this._document)):o=m_(this._rootElement),o.style.pointerEvents="none",o.classList.add("cdk-drag-placeholder"),o}_getPointerPositionInElement(r,t){const o=this._rootElement.getBoundingClientRect(),i=r===this._rootElement?null:r,a=i?i.getBoundingClientRect():o,s=zo(t)?t.targetTouches[0]:t,l=this._getViewportScrollPosition();return{x:a.left-o.left+(s.pageX-a.left-l.left),y:a.top-o.top+(s.pageY-a.top-l.top)}}_getPointerPositionOnPage(r){const t=this._getViewportScrollPosition(),o=zo(r)?r.touches[0]||r.changedTouches[0]||{pageX:0,pageY:0}:r,i=o.pageX-t.left,a=o.pageY-t.top;if(this._ownerSVGElement){const s=this._ownerSVGElement.getScreenCTM();if(s){const l=this._ownerSVGElement.createSVGPoint();return l.x=i,l.y=a,l.matrixTransform(s.inverse())}}return{x:i,y:a}}_getConstrainedPointerPosition(r){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:o,y:i}=this.constrainPosition?this.constrainPosition(r,this):r;if("x"===this.lockAxis||"x"===t?i=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===t)&&(o=this._pickupPositionOnPage.x),this._boundaryRect){const{x:a,y:s}=this._pickupPositionInElement,l=this._boundaryRect,{width:c,height:d}=this._getPreviewRect(),_=l.top+s,u=l.bottom-(d-s);o=C_(o,l.left+a,l.right-(c-a)),i=C_(i,_,u)}return{x:o,y:i}}_updatePointerDirectionDelta(r){const{x:t,y:o}=r,i=this._pointerDirectionDelta,a=this._pointerPositionAtLastDirectionChange,s=Math.abs(t-a.x),l=Math.abs(o-a.y);return s>this._config.pointerDirectionChangeThreshold&&(i.x=t>a.x?1:-1,a.x=t),l>this._config.pointerDirectionChangeThreshold&&(i.y=o>a.y?1:-1,a.y=o),i}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const r=this._handles.length>0||!this.isDragging();r!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=r,lo(this._rootElement,r))}_removeRootElementListeners(r){r.removeEventListener("mousedown",this._pointerDown,Qr),r.removeEventListener("touchstart",this._pointerDown,v_),r.removeEventListener("dragstart",this._nativeDragStart,Qr)}_applyRootElementTransform(r,t){const o=Hr(r,t),i=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=i.transform&&"none"!=i.transform?i.transform:""),i.transform=Rr(o,this._initialTransform)}_applyPreviewTransform(r,t){var o;const i=(null===(o=this._previewTemplate)||void 0===o?void 0:o.template)?void 0:this._initialTransform,a=Hr(r,t);this._preview.style.transform=Rr(a,i)}_getDragDistance(r){const t=this._pickupPositionOnPage;return t?{x:r.x-t.x,y:r.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:r,y:t}=this._passiveTransform;if(0===r&&0===t||this.isDragging()||!this._boundaryElement)return;const o=this._boundaryElement.getBoundingClientRect(),i=this._rootElement.getBoundingClientRect();if(0===o.width&&0===o.height||0===i.width&&0===i.height)return;const a=o.left-i.left,s=i.right-o.right,l=o.top-i.top,c=i.bottom-o.bottom;o.width>i.width?(a>0&&(r+=a),s>0&&(r-=s)):r=0,o.height>i.height?(l>0&&(t+=l),c>0&&(t-=c)):t=0,(r!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:r})}_getDragStartDelay(r){const t=this.dragStartDelay;return"number"==typeof t?t:zo(r)?t.touch:t?t.mouse:0}_updateOnScroll(r){const t=this._parentPositions.handleScroll(r);if(t){const o=(0,Mn.sA)(r);this._boundaryRect&&o!==this._boundaryElement&&o.contains(this._boundaryElement)&&Wo(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){var r;return(null===(r=this._parentPositions.positions.get(this._document))||void 0===r?void 0:r.scrollPosition)||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,Mn.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(r,t){const o=this._previewContainer||"global";if("parent"===o)return r;if("global"===o){const i=this._document;return t||i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.msFullscreenElement||i.body}return(0,rt.fI)(o)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),this._previewRect}_getTargetHandle(r){return this._handles.find(t=>r.target&&(r.target===t||t.contains(r.target)))}}function Hr(n,r){return`translate3d(${Math.round(n)}px, ${Math.round(r)}px, 0)`}function C_(n,r,t){return Math.max(r,Math.min(t,n))}function zo(n){return"t"===n.type[0]}function T_(n,r){const t=n.rootNodes;if(1===t.length&&t[0].nodeType===r.ELEMENT_NODE)return t[0];const o=r.createElement("div");return t.forEach(i=>o.appendChild(i)),o}function b_(n,r){n.style.width=`${r.width}px`,n.style.height=`${r.height}px`,n.style.transform=Hr(r.left,r.top)}function Go(n,r){return Math.max(0,Math.min(r,n))}class R7{constructor(r,t,o,i,a){this._dragDropRegistry=t,this._ngZone=i,this._viewportRuler=a,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new vt.xQ,this.entered=new vt.xQ,this.exited=new vt.xQ,this.dropped=new vt.xQ,this.sorted=new vt.xQ,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=Ko.w.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new vt.xQ,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),c_(0,P7.Z).pipe((0,nr.R)(this._stopScrollTimers)).subscribe(()=>{const s=this._scrollNode,l=this.autoScrollStep;1===this._verticalScrollDirection?s.scrollBy(0,-l):2===this._verticalScrollDirection&&s.scrollBy(0,l),1===this._horizontalScrollDirection?s.scrollBy(-l,0):2===this._horizontalScrollDirection&&s.scrollBy(l,0)})},this.element=(0,rt.fI)(r),this._document=o,this.withScrollableParents([this.element]),t.registerDropContainer(this),this._parentPositions=new f_(o)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(r,t,o,i){let a;this._draggingStarted(),null==i?(a=this.sortingDisabled?this._draggables.indexOf(r):-1,-1===a&&(a=this._getItemIndexFromPointerPosition(r,t,o))):a=i;const s=this._activeDraggables,l=s.indexOf(r),c=r.getPlaceholderElement();let d=s[a];if(d===r&&(d=s[a+1]),!d&&(null==a||-1===a||a<s.length-1)&&this._shouldEnterAsFirstChild(t,o)&&(d=s[0]),l>-1&&s.splice(l,1),d&&!this._dragDropRegistry.isDragging(d)){const _=d.getRootElement();_.parentElement.insertBefore(c,_),s.splice(a,0,r)}else(0,rt.fI)(this.element).appendChild(c),s.push(r);c.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:r,container:this,currentIndex:this.getItemIndex(r)})}exit(r){this._reset(),this.exited.next({item:r,container:this})}drop(r,t,o,i,a,s,l){this._reset(),this.dropped.next({item:r,currentIndex:t,previousIndex:o,container:this,previousContainer:i,isPointerOverContainer:a,distance:s,dropPoint:l})}withItems(r){const t=this._draggables;return this._draggables=r,r.forEach(o=>o._withDropContainer(this)),this.isDragging()&&(t.filter(i=>i.isDragging()).every(i=>-1===r.indexOf(i))?this._reset():this._cacheItems()),this}withDirection(r){return this._direction=r,this}connectedTo(r){return this._siblings=r.slice(),this}withOrientation(r){return this._orientation=r,this}withScrollableParents(r){const t=(0,rt.fI)(this.element);return this._scrollableElements=-1===r.indexOf(t)?[t,...r]:r.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(r){return this._isDragging?("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(o=>o.drag===r):this._draggables.indexOf(r)}isReceiving(){return this._activeSiblings.size>0}_sortItem(r,t,o,i){if(this.sortingDisabled||!this._clientRect||!u_(this._clientRect,.05,t,o))return;const a=this._itemPositions,s=this._getItemIndexFromPointerPosition(r,t,o,i);if(-1===s&&a.length>0)return;const l="horizontal"===this._orientation,c=a.findIndex(g=>g.drag===r),d=a[s],u=d.clientRect,f=c>s?1:-1,m=this._getItemOffsetPx(a[c].clientRect,u,f),h=this._getSiblingOffsetPx(c,a,f),p=a.slice();(function q7(n,r,t){const o=Go(r,n.length-1),i=Go(t,n.length-1);if(o===i)return;const a=n[o],s=i<o?-1:1;for(let l=o;l!==i;l+=s)n[l]=n[l+s];n[i]=a})(a,c,s),this.sorted.next({previousIndex:c,currentIndex:s,container:this,item:r}),a.forEach((g,v)=>{if(p[v]===g)return;const x=g.drag===r,C=x?m:h,b=x?r.getPlaceholderElement():g.drag.getRootElement();g.offset+=C,l?(b.style.transform=Rr(`translate3d(${Math.round(g.offset)}px, 0, 0)`,g.initialTransform),Wo(g.clientRect,0,C)):(b.style.transform=Rr(`translate3d(0, ${Math.round(g.offset)}px, 0)`,g.initialTransform),Wo(g.clientRect,C,0))}),this._previousSwap.overlaps=bs(u,t,o),this._previousSwap.drag=d.drag,this._previousSwap.delta=l?i.x:i.y}_startScrollingIfNecessary(r,t){if(this.autoScrollDisabled)return;let o,i=0,a=0;if(this._parentPositions.positions.forEach((s,l)=>{l===this._document||!s.clientRect||o||u_(s.clientRect,.05,r,t)&&([i,a]=function Q7(n,r,t,o){const i=N_(r,o),a=A_(r,t);let s=0,l=0;if(i){const c=n.scrollTop;1===i?c>0&&(s=1):n.scrollHeight-c>n.clientHeight&&(s=2)}if(a){const c=n.scrollLeft;1===a?c>0&&(l=1):n.scrollWidth-c>n.clientWidth&&(l=2)}return[s,l]}(l,s.clientRect,r,t),(i||a)&&(o=l))}),!i&&!a){const{width:s,height:l}=this._viewportRuler.getViewportSize(),c={width:s,height:l,top:0,right:s,bottom:l,left:0};i=N_(c,t),a=A_(c,r),o=window}o&&(i!==this._verticalScrollDirection||a!==this._horizontalScrollDirection||o!==this._scrollNode)&&(this._verticalScrollDirection=i,this._horizontalScrollDirection=a,this._scrollNode=o,(i||a)&&o?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const r=(0,rt.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=r.msScrollSnapType||r.scrollSnapType||"",r.scrollSnapType=r.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const r=(0,rt.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(r).clientRect}_cacheItemPositions(){const r="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const o=t.getVisibleElement();return{drag:t,offset:0,initialTransform:o.style.transform||"",clientRect:Ts(o)}}).sort((t,o)=>r?t.clientRect.left-o.clientRect.left:t.clientRect.top-o.clientRect.top)}_reset(){this._isDragging=!1;const r=(0,rt.fI)(this.element).style;r.scrollSnapType=r.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{var o;const i=t.getRootElement();if(i){const a=null===(o=this._itemPositions.find(s=>s.drag===t))||void 0===o?void 0:o.initialTransform;i.style.transform=a||""}}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(r,t,o){const i="horizontal"===this._orientation,a=t[r].clientRect,s=t[r+-1*o];let l=a[i?"width":"height"]*o;if(s){const c=i?"left":"top",d=i?"right":"bottom";-1===o?l-=s.clientRect[c]-a[d]:l+=a[c]-s.clientRect[d]}return l}_getItemOffsetPx(r,t,o){const i="horizontal"===this._orientation;let a=i?t.left-r.left:t.top-r.top;return-1===o&&(a+=i?t.width-r.width:t.height-r.height),a}_shouldEnterAsFirstChild(r,t){if(!this._activeDraggables.length)return!1;const o=this._itemPositions,i="horizontal"===this._orientation;if(o[0].drag!==this._activeDraggables[0]){const s=o[o.length-1].clientRect;return i?r>=s.right:t>=s.bottom}{const s=o[0].clientRect;return i?r<=s.left:t<=s.top}}_getItemIndexFromPointerPosition(r,t,o,i){const a="horizontal"===this._orientation,s=this._itemPositions.findIndex(({drag:l,clientRect:c})=>{if(l===r)return!1;if(i){const d=a?i.x:i.y;if(l===this._previousSwap.drag&&this._previousSwap.overlaps&&d===this._previousSwap.delta)return!1}return a?t>=Math.floor(c.left)&&t<Math.floor(c.right):o>=Math.floor(c.top)&&o<Math.floor(c.bottom)});return-1!==s&&this.sortPredicate(s,r,this)?s:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(r,t){return null!=this._clientRect&&bs(this._clientRect,r,t)}_getSiblingContainerFromPosition(r,t,o){return this._siblings.find(i=>i._canReceive(r,t,o))}_canReceive(r,t,o){if(!this._clientRect||!bs(this._clientRect,t,o)||!this.enterPredicate(r,this))return!1;const i=this._getShadowRoot().elementFromPoint(t,o);if(!i)return!1;const a=(0,rt.fI)(this.element);return i===a||a.contains(i)}_startReceiving(r,t){const o=this._activeSiblings;!o.has(r)&&t.every(i=>this.enterPredicate(i,this)||this._draggables.indexOf(i)>-1)&&(o.add(r),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(r){this._activeSiblings.delete(r),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(r=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(r);t&&(this._itemPositions.forEach(({clientRect:o})=>{Wo(o,t.top,t.left)}),this._itemPositions.forEach(({drag:o})=>{this._dragDropRegistry.isDragging(o)&&o._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const r=(0,Mn.kV)((0,rt.fI)(this.element));this._cachedShadowRoot=r||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const r=this._activeDraggables.filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,r))}}function N_(n,r){const{top:t,bottom:o,height:i}=n,a=.05*i;return r>=t-a&&r<=t+a?1:r>=o-a&&r<=o+a?2:0}function A_(n,r){const{left:t,right:o,width:i}=n,a=.05*i;return r>=t-a&&r<=t+a?1:r>=o-a&&r<=o+a?2:0}const Yr=(0,Mn.i$)({passive:!1,capture:!0});let H7=(()=>{class n{constructor(t,o){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=i=>i.isDragging(),this.pointerMove=new vt.xQ,this.pointerUp=new vt.xQ,this.scroll=new vt.xQ,this._preventDefaultWhileDragging=i=>{this._activeDragInstances.length>0&&i.preventDefault()},this._persistentTouchmoveListener=i=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&i.preventDefault(),this.pointerMove.next(i))},this._document=o}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,Yr)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,Yr)}startDragging(t,o){if(!(this._activeDragInstances.indexOf(t)>-1)&&(this._activeDragInstances.push(t),1===this._activeDragInstances.length)){const i=o.type.startsWith("touch");this._globalListeners.set(i?"touchend":"mouseup",{handler:a=>this.pointerUp.next(a),options:!0}).set("scroll",{handler:a=>this.scroll.next(a),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Yr}),i||this._globalListeners.set("mousemove",{handler:a=>this.pointerMove.next(a),options:Yr}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((a,s)=>{this._document.addEventListener(s,a.handler,a.options)})})}}stopDragging(t){const o=this._activeDragInstances.indexOf(t);o>-1&&(this._activeDragInstances.splice(o,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(t){return this._activeDragInstances.indexOf(t)>-1}scrolled(t){const o=[this.scroll];return t&&t!==this._document&&o.push(new s_.y(i=>this._ngZone.runOutsideAngular(()=>{const s=l=>{this._activeDragInstances.length&&i.next(l)};return t.addEventListener("scroll",s,!0),()=>{t.removeEventListener("scroll",s,!0)}}))),(0,po.T)(...o)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,o)=>{this._document.removeEventListener(o,t.handler,t.options)}),this._globalListeners.clear()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.R0b),e.LFG(be.K0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Y7={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let V7=(()=>{class n{constructor(t,o,i,a){this._document=t,this._ngZone=o,this._viewportRuler=i,this._dragDropRegistry=a}createDrag(t,o=Y7){return new J7(t,o,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new R7(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(be.K0),e.LFG(e.R0b),e.LFG(d_.rL),e.LFG(H7))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[V7],imports:[d_.ZD]}),n})();var K7=ce(2115);let W7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[be.ez,F7,Se.QW,w.u5,lt.To,Ln.lN,zr.Ps,M7.ie,I7.m,w.UX,L7.q,Z7,hi.LD,$7,Dt.JF,K_,Jr.Xg,K7.X]]}),n})()},6496:(As,$r,ce)=>{var be;window,As.exports=(be=ce(8551),function(w){var fe={};function Ie(e){if(fe[e])return fe[e].exports;var Se=fe[e]={i:e,l:!1,exports:{}};return w[e].call(Se.exports,Se,Se.exports,Ie),Se.l=!0,Se.exports}return Ie.m=w,Ie.c=fe,Ie.d=function(e,Se,gt){Ie.o(e,Se)||Object.defineProperty(e,Se,{enumerable:!0,get:gt})},Ie.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},Ie.t=function(e,Se){if(1&Se&&(e=Ie(e)),8&Se||4&Se&&"object"==typeof e&&e&&e.__esModule)return e;var gt=Object.create(null);if(Ie.r(gt),Object.defineProperty(gt,"default",{enumerable:!0,value:e}),2&Se&&"string"!=typeof e)for(var Ze in e)Ie.d(gt,Ze,function(xe){return e[xe]}.bind(null,Ze));return gt},Ie.n=function(e){var Se=e&&e.__esModule?function(){return e.default}:function(){return e};return Ie.d(Se,"a",Se),Se},Ie.o=function(e,Se){return Object.prototype.hasOwnProperty.call(e,Se)},Ie.p="",Ie(Ie.s=3)}([function(w,fe){w.exports=be},function(w,fe){Object.defineProperty(fe,"__esModule",{value:!0}),fe.Errors=void 0;var Ie=function(){function e(){}return e.PowerBIClientIsNotInitialized="powerbi-client module is not initialized. Please import powerbi-client script before importing powerbi-report-authoring.",e}();fe.Errors=Ie},function(w,fe){Object.defineProperty(fe,"__esModule",{value:!0}),fe.Config=void 0;var Ie=function(){function e(){}return e.version="1.1.3",e}();fe.Config=Ie},function(w,fe,Ie){Object.defineProperty(fe,"__esModule",{value:!0}),fe.startAuthoring=void 0;var e=Ie(4);function Se(){e.extensions.forEach(function(gt){gt.initialize()})}fe.startAuthoring=Se,Se()},function(w,fe,Ie){Object.defineProperty(fe,"__esModule",{value:!0}),fe.extensions=void 0;var e=Ie(5),Se=Ie(6),gt=Ie(7);fe.extensions=[new Se.ReportExtensions,new e.PageExtensions,new gt.VisualExtensions]},function(w,fe,Ie){Object.defineProperty(fe,"__esModule",{value:!0}),fe.PageExtensions=void 0;var e=Ie(0),Se=Ie(1),gt=function(){function Ze(){}return Ze.post=function(xe,Ce,Ge){var ot=Ze.hpm(xe),Sn=Ze.uid(xe),nn=Ze.contentWindow(xe);return ot.post(Ce,Ge,{uid:Sn},nn).then(function(Bt){return Bt.body},function(Bt){throw Bt.body})},Ze.contentWindow=function(xe){return xe.report.iframe.contentWindow},Ze.uid=function(xe){return xe.report.config.uniqueId},Ze.hpm=function(xe){return xe.report.service.hpm},Ze.prototype.initialize=function(){null!=e.Page?(e.Page.prototype.createVisual=function(xe,Ce,Ge){var ot=this;return Ze.post(this,"/report/pages/"+this.name+"/createVisual",{visualType:xe,layout:Ce,autoFocus:Ge}).then(function(nn){var Bt=nn.visual;return{visual:new e.VisualDescriptor(ot,Bt.name,Bt.title,Bt.type,Bt.layout)}},function(nn){throw nn})},e.Page.prototype.deleteVisual=function(xe){return Ze.post(this,"/report/pages/"+this.name+"/deleteVisual",{visualName:xe})}):console.error(Se.Errors.PowerBIClientIsNotInitialized)},Ze}();fe.PageExtensions=gt},function(w,fe,Ie){Object.defineProperty(fe,"__esModule",{value:!0}),fe.ReportExtensions=void 0;var e=Ie(0),Se=Ie(2),gt=Ie(1),Ze=function(){function xe(){}return xe.get=function(Ce,Ge){var ot=xe.hpm(Ce),Sn=xe.uid(Ce),nn=xe.contentWindow(Ce);return ot.get(Ge,{uid:Sn,sdkVersion:Se.Config.version},nn).then(function($e){return $e.body},function($e){throw $e.body})},xe.contentWindow=function(Ce){return Ce.iframe.contentWindow},xe.uid=function(Ce){return Ce.config.uniqueId},xe.hpm=function(Ce){return Ce.service.hpm},xe.prototype.initialize=function(){null!=e.Report?(e.Report.prototype.getVisualCapabilities=function(Ce){if(!Ce)throw{message:"visualType parameter is missing"};return xe.get(this,"/report/visuals/types/"+Ce+"/capabilities")},e.Report.prototype.getAvailableVisualTypes=function(){return xe.get(this,"/report/availableVisualTypes")}):console.error(gt.Errors.PowerBIClientIsNotInitialized)},xe}();fe.ReportExtensions=Ze},function(w,fe,Ie){Object.defineProperty(fe,"__esModule",{value:!0}),fe.VisualExtensions=void 0;var e=Ie(0),Se=Ie(2),gt=Ie(1),Ze=function(){function xe(){}return xe.delete=function(Ce,Ge,ot){return xe.sendRequestWithBody(Ce,"delete",Ge,ot)},xe.post=function(Ce,Ge,ot){return xe.sendRequestWithBody(Ce,"post",Ge,ot)},xe.put=function(Ce,Ge,ot){return xe.sendRequestWithBody(Ce,"put",Ge,ot)},xe.sendRequestWithBody=function(Ce,Ge,ot,Sn){var nn=xe.hpm(Ce),Bt=xe.uid(Ce),$e=xe.contentWindow(Ce);return nn[Ge](ot,Sn,{uid:Bt,sdkVersion:Se.Config.version},$e).then(function(Dt){return Dt.body},function(Dt){throw Dt.body})},xe.get=function(Ce,Ge){var ot=xe.hpm(Ce),Sn=xe.uid(Ce),nn=xe.contentWindow(Ce);return ot.get(Ge,{uid:Sn,sdkVersion:Se.Config.version},nn).then(function($e){return $e.body},function($e){throw $e.body})},xe.contentWindow=function(Ce){return Ce.page.report.iframe.contentWindow},xe.uid=function(Ce){return Ce.page.report.config.uniqueId},xe.hpm=function(Ce){return Ce.page.report.service.hpm},xe.prototype.initialize=function(){null!=e.VisualDescriptor?(e.VisualDescriptor.prototype.changeType=function(Ce){return xe.post(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/changeType",{visualType:Ce})},e.VisualDescriptor.prototype.getCapabilities=function(){return xe.get(this,"/report/visuals/types/"+this.type+"/capabilities")},e.VisualDescriptor.prototype.getDataFieldDisplayName=function(Ce,Ge){return xe.get(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/dataroles/"+Ce+"/fields/"+Ge+"/displayName")},e.VisualDescriptor.prototype.setDataFieldDisplayName=function(Ce,Ge,ot){return xe.put(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/dataroles/"+Ce+"/fields/"+Ge+"/displayName",{newDisplayName:ot})},e.VisualDescriptor.prototype.addDataField=function(Ce,Ge,ot){return xe.post(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/dataroles/"+Ce+"/fields/"+ot,Ge)},e.VisualDescriptor.prototype.getDataFields=function(Ce){return xe.get(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/dataroles/"+Ce+"/fields")},e.VisualDescriptor.prototype.removeDataField=function(Ce,Ge){return xe.delete(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/dataroles/"+Ce+"/fields/"+Ge,Ge)},e.VisualDescriptor.prototype.getProperty=function(Ce){return xe.post(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/property",Ce)},e.VisualDescriptor.prototype.setProperty=function(Ce,Ge){return xe.put(this,"/report/pages/"+this.page.name+"/visuals/"+this.name+"/property",{selector:Ce,value:Ge})},e.VisualDescriptor.prototype.resetProperty=function(Ce){return this.setProperty(Ce,{schema:"http://powerbi.com/product/schema#default",value:{}})}):console.error(gt.Errors.PowerBIClientIsNotInitialized)},xe}();fe.VisualExtensions=Ze}]))}}]);